<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>crossoverJie&#39;s Blog</title>
  
  <subtitle>baller</subtitle>
  <link href="http://crossoverjie.top/atom.xml" rel="self"/>
  
  <link href="http://crossoverjie.top/"/>
  <updated>2024-01-25T15:56:28.553Z</updated>
  <id>http://crossoverjie.top/</id>
  
  <author>
    <name>crossoverJie</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ‰‹æŠŠæ‰‹æ•™ä½ ä¸ºå¼€æºé¡¹ç›®è´¡çŒ®ä»£ç </title>
    <link href="http://crossoverjie.top/2024/01/25/ob/create-a-plugin-for-cprobe/"/>
    <id>http://crossoverjie.top/2024/01/25/ob/create-a-plugin-for-cprobe/</id>
    <published>2024-01-25T11:49:09.000Z</published>
    <updated>2024-01-25T15:56:28.553Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰æ®µæ—¶é—´æ— æ„é—´çœ‹åˆ°ä¸€ç¯‡å…¬ä¼—å· <a href="https://mp.weixin.qq.com/s/T8B3XnXd30vT7OvsFTnaFw">æ‹›è´¤ä»¤ï¼šä¸€èµ·æ¥æä¸€ä¸ªæ–°å¼€æºé¡¹ç›®</a>ï¼Œä½œè€…ä»‹ç»ä»–æƒ³è¦åšä¸€ä¸ªå¼€æºé¡¹ç›®ï¼š<a href="https://github.com/cprobe/cprobe">cprobe</a> ç”¨äºæ•´åˆç›®å‰å¸‚é¢ä¸Šæ•£è½åœ¨å„åœ°çš„ <code>Exporter</code>ï¼Œç»Ÿä¸€è¿›è¡Œç®¡ç†ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ <code>blackbox_exporter/mysqld_exporter</code> ç­‰ã€‚</p><blockquote><p>ä»¥å¾€çš„æ¯ä¸€ä¸ª Exporter éƒ½éœ€è¦å•ç‹¬éƒ¨ç½²è¿ç»´ã€‚</p></blockquote><span id="more"></span><p>åŒæ—¶åˆå®Œå…¨å…¼å®¹ <code>Prometheus</code> ç”Ÿæ€ï¼Œä¹Ÿå¯ä»¥å¤ç”¨ç°æœ‰çš„ç›‘æ§é¢æ¿ã€‚</p><p>æ°å¥½è¿™æ®µæ—¶é—´æˆ‘ä¹Ÿåœ¨å…¬å¸ä»äº‹å¯è§‚æµ‹æ€§ç›¸å…³çš„ä¸šåŠ¡ï¼Œå‘ç°è¿™ç¡®å®æ˜¯ä¸€ä¸ªç—›ç‚¹ã€‚</p><p>äºæ˜¯ä¾¿ä¸€ç›´åœ¨å…³æ³¨è¿™ä¸ªé¡¹ç›®ï¼ŒåŒæ—¶ä¹Ÿåšäº†äº›è´¡çŒ®ï¼›å› ä¸ºè¯¥é¡¹ç›®çš„æ ¸å¿ƒæ˜¯ç”¨äºæ•´åˆ exporterï¼Œæ‰€ä»¥ä¸ºå…¶ç¼–å†™æ’ä»¶ä¹Ÿæ˜¯éå¸¸é‡è¦çš„è´¡çŒ®äº†ã€‚</p><h1 id="ç¼–å†™æ’ä»¶"><a href="#ç¼–å†™æ’ä»¶" class="headerlink" title="ç¼–å†™æ’ä»¶"></a>ç¼–å†™æ’ä»¶</h1><p>æ•´ä¸ªé¡¹ç›®æ‰§è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š<br><img src="https://s2.loli.net/2024/01/25/SihX4C5PN8IeR3Z.png"></p><p>å¯ä»¥çœ‹åˆ°ç¼–å†™æ’ä»¶æœ€æ ¸å¿ƒçš„ä¾¿æ˜¯è‡ªå®šä¹‰æ’ä»¶è§£æè‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ã€æŠ“å–æŒ‡æ ‡çš„é€»è¾‘ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬éœ€è¦åœ¨é…ç½®ä¸­æŒ‡å®šæŠ“å–ç›®æ ‡çš„åŸŸåã€æŠ“å–è§„åˆ™ç­‰ã€‚</p><p>è¿™é‡Œ  <code>cprobe</code> å·²ç»æŠ½è±¡å‡ºäº†ä¸¤ä¸ªæ¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦åšå¯¹åº”çš„å®ç°å³å¯ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Plugin <span class="keyword">interface</span> &#123;  </span><br><span class="line">    <span class="comment">// ParseConfig is used to parse config  </span></span><br><span class="line">    ParseConfig(baseDir <span class="type">string</span>, bs []<span class="type">byte</span>) (any, <span class="type">error</span>)  </span><br><span class="line">    <span class="comment">// Scrape is used to scrape metrics, cfg need to be cast specific cfg  </span></span><br><span class="line">    Scrape(ctx context.Context, target <span class="type">string</span>, cfg any, ss *types.Samples) <span class="type">error</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±ä»¥æˆ‘ä¹‹å‰ç¼–å†™çš„ <a href="https://github.com/cprobe/cprobe/pull/29">Consul</a> ä¸ºä¾‹ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Allows any Consul server (non-leader) to service a read.  </span></span><br><span class="line"><span class="string">allow_stale</span> <span class="string">=</span> <span class="literal">true</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># === CA  </span></span><br><span class="line"><span class="comment"># File path to a PEM-encoded certificate authority used to validate the authenticity of a server certificate.  </span></span><br><span class="line"><span class="string">ca_file</span> <span class="string">=</span> <span class="string">&quot;/etc/consul.d/consul-agent-ca.pem&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># File path to a PEM-encoded certificate used with the private key to verify the exporter&#x27;s authenticity.  </span></span><br><span class="line"><span class="string">cert_file</span> <span class="string">=</span> <span class="string">&quot;/etc/consul.d/consul-agent.pem&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># Generate a health summary for each service instance. Needs n+1 queries to collect all information.  </span></span><br><span class="line"><span class="string">health_summary</span> <span class="string">=</span> <span class="literal">true</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># File path to a PEM-encoded private key used with the certificate to verify the exporter&#x27;s authenticity  </span></span><br><span class="line"><span class="string">key_file</span> <span class="string">=</span> <span class="string">&quot;/etc/consul.d/consul-agent-key.pem&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># Disable TLS host verification.  </span></span><br><span class="line"><span class="string">insecure</span> <span class="string">=</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ¯ä¸ªæ’ä»¶çš„é…ç½®éƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†é…ç½®è§£æåˆ°å…·ä½“çš„ç»“æ„ä½“ä¸­ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(*Consul)</span></span> ParseConfig(baseDir <span class="type">string</span>, bs []<span class="type">byte</span>) (any, <span class="type">error</span>) &#123;  </span><br><span class="line">    <span class="keyword">var</span> c Config  </span><br><span class="line">    err := toml.Unmarshal(bs, &amp;c)  </span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;  </span><br><span class="line">       <span class="keyword">return</span> <span class="literal">nil</span>, err  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> c.Timeout == <span class="number">0</span> &#123;  </span><br><span class="line">       c.Timeout = time.Millisecond * <span class="number">500</span>  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> &amp;c, <span class="literal">nil</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æé…ç½®æ–‡ä»¶æ²¡å•¥å¥½è¯´çš„ï¼Œæ ¹æ®è‡ªå·±çš„é€»è¾‘å®ç°å³å¯ï¼Œå¯èƒ½ä¼šé…ç½®ä¸€äº›é»˜è®¤å€¼è€Œå·²ã€‚</p><hr><p>ä¸‹é¢æ˜¯æ ¸å¿ƒçš„æŠ“å–é€»è¾‘ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä½¿ç”¨å¯¹åº”æ’ä»¶çš„ <code>Client</code> è·å–ä¸€äº›æ ¸å¿ƒæŒ‡æ ‡å°è£…ä¸º <code>Prometheus</code> çš„ <code>Metric</code>ï¼Œç„¶åç”± <code>cprobe</code> å†™å…¥åˆ°è¿œç«¯çš„ <code>Prometheus</code> ä¸­(æˆ–è€…æ˜¯å…¼å®¹ <code>Prometheus</code> çš„æ•°æ®åº“ä¸­)ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Create client</span></span><br><span class="line">config.HttpClient.Timeout = opts.Timeout  </span><br><span class="line">config.HttpClient.Transport = transport  </span><br><span class="line">  </span><br><span class="line">client, err := consul_api.NewClient(config)  </span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>, err  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> requestLimitChan <span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;  </span><br><span class="line"><span class="keyword">if</span> opts.RequestLimit &gt; <span class="number">0</span> &#123;  </span><br><span class="line">    requestLimitChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;, opts.RequestLimit)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/25/Hbnqz36wSDohuBJ.png"><br>æ‰€æœ‰çš„æŒ‡æ ‡æ•°æ®éƒ½æ˜¯é€šè¿‡å¯¹åº”çš„å®¢æˆ·ç«¯è·å–ã€‚</p><p>å¦‚æœæ˜¯è¿ç§»ä¸€ä¸ªå­˜åœ¨çš„  export åˆ° cprobe ä¸­æ—¶ï¼Œè¿™äº›æŠ“å–ä»£ç æˆ‘ä»¬éƒ½å¯ä»¥ç›´æ¥å¤åˆ¶å¯¹åº” <a href="https://github.com/prometheus/consul_exporter">repo</a> ä¸­çš„ä»£ç ã€‚</p><p>æ¯”å¦‚æˆ‘å°±æ˜¯å‚è€ƒçš„ï¼š<a href="https://github.com/prometheus/consul_exporter">https://github.com/prometheus/consul_exporter</a></p><p>é™¤éæˆ‘ä»¬æ˜¯é‡æ–°å†™ä¸€ä¸ªæ’ä»¶ï¼Œä¸ç„¶å¯¹äºä¸€äº›æµè¡Œçš„åº“æˆ–è€…æ˜¯ä¸­é—´ä»¶éƒ½å·²ç»æœ‰å¯¹åº”çš„ <code>exporter</code> äº†ã€‚</p><p>å…·ä½“çš„åˆ—è¡¨å¯ä»¥å‚è€ƒè¿™é‡Œï¼š<br><a href="https://prometheus.io/docs/instrumenting/exporters/">https://prometheus.io/docs/instrumenting/exporters/</a></p><p><img src="https://s2.loli.net/2024/01/25/6DEKwyWqA3MBm8f.png"></p><p>ä¹‹åä¾¿éœ€è¦åœ¨å¯¹åº”çš„æ’ä»¶ç›®å½•(<code>./conf.d</code>)åˆ›å»ºæˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ï¼š<br><img src="https://s2.loli.net/2024/01/25/BJuyoqNtmvZ15wr.png"></p><p>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œå¯ä»¥åœ¨å¯åŠ¨ cprobe æ—¶æ·»åŠ  <code>-no-writer</code> è®©æŒ‡æ ‡æ‰“å°åœ¨æ§åˆ¶å°ï¼Œä»è€Œæ–¹ä¾¿è°ƒè¯•ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¹‹å‰å°±æœ‰äººé—®æˆ‘æœ‰æ²¡æœ‰æ¯•ç«Ÿå¥½ä¸Šæ‰‹çš„å¼€æºé¡¹ç›®ï¼Œè¿™ä¸å°±æ¥äº†å—ï¼Ÿ</p><p>æ­£å¥½ç›®å‰é¡¹ç›®åˆ›å»ºæ—¶é—´ä¸é•¿ï¼Œä»£ç å’ŒåŠŸèƒ½ä¹Ÿæ¯”è¾ƒç®€å•ï¼ŒåŒæ—¶è¿˜æœ‰å¯è§‚å¯Ÿç³»ç»Ÿå¤§ä½¬å¸¦é˜Ÿï¼Œç¡®å®æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆæ–°æ‰‹å‚ä¸çš„å¼€æºé¡¹ç›®ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š</p><p><a href="https://github.com/cprobe/cprobe">https://github.com/cprobe/cprobe</a></p><h1 id="ç§è´§"><a href="#ç§è´§" class="headerlink" title="ç§è´§"></a>ç§è´§</h1><p><img src="https://s2.loli.net/2024/01/25/2K3um8dPlfneyLw.png"></p><p>æœ€åå¤¹å¸¦ä¸€ç‚¹ç§è´§ï¼šå‰ä¸¤å¤©å¸®ä¸€ä¸ªè¯»è€…æœ‹å‹åšäº†ä¸€æ¬¡ä»˜è´¹çš„æŠ€æœ¯å’¨è¯¢ï¼ˆä¸»è¦æ˜¯å…³äº Pulsar ç›¸å…³çš„ï¼‰ï¼Œä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡åšä»˜è´¹å†…å®¹ï¼Œè¿™ç§æ‹¿äººé’±è´¢æ›¿äººæ¶ˆç¾éš¾é“å°±æ˜¯çŸ¥è¯†ä»˜è´¹çš„å‘³é“å—ğŸ˜‚ï¼Ÿ</p><p><img src="https://s2.loli.net/2024/01/25/LJq6xlowRmdnrHv.png"></p><p>æ‰€ä»¥æˆ‘å°±è¶çƒ­æ‰“é“åœ¨æœ‹å‹åœˆå‘äº†ä¸ªå¹¿å‘Šï¼Œæ²¡æƒ³åˆ°åˆæœ‰ä¸ªæœ‹å‹æ‰¾æˆ‘åšå…³äºèŒåœºç›¸å…³å’¨è¯¢ï¼Œæœ€åèƒ½å¸®åŠ©åˆ°å¯¹æ–¹è‡ªå·±ä¹Ÿå¾ˆå¼€å¿ƒã€‚</p><p>å…¶å®ç»å¸¸ä¹Ÿæœ‰äººé€šè¿‡ç¤¾åª’ã€é‚®ä»¶ç­‰æ¸ é“æ‰¾æˆ‘å¸®å¿™çœ‹é—®é¢˜ï¼Œä¸€äº›ç®€å•çš„æˆ‘é€šå¸¸ä¹Ÿä¼šæŠ½æ—¶é—´å›å¤ã€‚</p><p>ä½†åé¢è¿™ä½æœ‹å‹ä¹Ÿæåˆ°ï¼Œå¦‚æœæˆ‘ä¸æ˜¯ä»˜è´¹ï¼Œä»–ä¹Ÿä¸å¥½æ„æ€æ¥æ‰¾æˆ‘èŠè¿™äº›å†…å®¹ï¼Œæ¯•ç«Ÿæ¶‰åŠåˆ°ä¸€äº›éšç§ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦å ç”¨åŒæ–¹ 1ï½2 å°æ—¶çš„æ—¶é—´ã€‚</p><p>è¿™æ ·æ˜ç æ ‡ä»·çš„æ–¹å¼ç¡®å®ä¹Ÿèƒ½æ›´æ–¹ä¾¿çš„æ²Ÿé€šï¼ŒåŒæ—¶ä¹Ÿèƒ½å‡è½»å¯¹æ–¹çš„å¿ƒé‡Œè´Ÿæ‹…ï¼Œç›´æ¥ä»ç™½å«–è½¬ä¸ºä»˜è´¹å¤§ä½¬ã€‚</p><p>é“ºå«äº†è¿™ä¹ˆå¤šï¼Œä¸»è¦ç›®çš„æ˜¯æƒ³è¿›è¡Œä¸€ä¸ªå°èŒƒå›´çš„å°è¯•ï¼Œå¦‚æœå¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£çš„æœ‹å‹æ¬¢è¿åŠ æˆ‘å¾®ä¿¡ç§èŠï¼š</p><blockquote><p>åŒ…æ‹¬ä½†ä¸é™äºæŠ€æœ¯ã€èŒåœºã€å¼€æºç­‰æˆ‘æœ‰ç»éªŒçš„è¡Œä¸šéƒ½å¯ä»¥èŠã€‚</p></blockquote><p><img src="https://s2.loli.net/2024/01/25/brqMxl5ZBvRz3mu.jpg"></p><p>åé¦ˆä¸é”™çš„è¯ä¹Ÿéœ€è¦å¯ä»¥ä½œä¸ºæˆ‘çš„é•¿æœŸå‰¯ä¸šåšä¸‹å»ã€‚<br>#Blog </p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´æ— æ„é—´çœ‹åˆ°ä¸€ç¯‡å…¬ä¼—å· &lt;a href=&quot;https://mp.weixin.qq.com/s/T8B3XnXd30vT7OvsFTnaFw&quot;&gt;æ‹›è´¤ä»¤ï¼šä¸€èµ·æ¥æä¸€ä¸ªæ–°å¼€æºé¡¹ç›®&lt;/a&gt;ï¼Œä½œè€…ä»‹ç»ä»–æƒ³è¦åšä¸€ä¸ªå¼€æºé¡¹ç›®ï¼š&lt;a href=&quot;https://github.com/cprobe/cprobe&quot;&gt;cprobe&lt;/a&gt; ç”¨äºæ•´åˆç›®å‰å¸‚é¢ä¸Šæ•£è½åœ¨å„åœ°çš„ &lt;code&gt;Exporter&lt;/code&gt;ï¼Œç»Ÿä¸€è¿›è¡Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ &lt;code&gt;blackbox_exporter/mysqld_exporter&lt;/code&gt; ç­‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥å¾€çš„æ¯ä¸€ä¸ª Exporter éƒ½éœ€è¦å•ç‹¬éƒ¨ç½²è¿ç»´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="OpenSource" scheme="http://crossoverjie.top/tags/OpenSource/"/>
    
    <category term="å¼€æº" scheme="http://crossoverjie.top/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>ç™½è¯ Pulsar Bookkeeper çš„å­˜å‚¨æ¨¡å‹</title>
    <link href="http://crossoverjie.top/2024/01/15/ob/Bookkeeper-storage/"/>
    <id>http://crossoverjie.top/2024/01/15/ob/Bookkeeper-storage/</id>
    <published>2024-01-15T11:20:59.000Z</published>
    <updated>2024-01-15T15:30:41.385Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2024/01/15/xU7FZCPjckRMBAD.png"></p><p>æœ€è¿‘æˆ‘ä»¬çš„ Pulsar å­˜å‚¨æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´æ•°æ®ä¸€ç›´å¾—ä¸åˆ°å›æ”¶ï¼Œä½†æ¶ˆæ¯ç¡®å®å·²ç»æ˜¯ ACK äº†ï¼Œç†è®ºä¸Šåº”è¯¥æ˜¯ä¼šè¢«å›æ”¶çš„ï¼Œéšç€æ—¶é—´æµé€ä¸ä½†æ²¡å›æ”¶è¿˜ä¸€ç›´å†æ¶¨ï¼Œæœ€ååœ¨æ²¡æ‰¾åˆ°åŸå› çš„æƒ…å†µä¸‹å°±åªæœ‰ä¸€ç›´ä¸åœçš„æ‰©å®¹ã€‚</p><blockquote><p>æœ€åç£ç›˜æ˜¯å¾—åˆ°äº†å›æ”¶ï¼Œè¿‡ç¨‹å…ˆä¸è¡¨ï¼Œä¹‹åå†è®¨è®ºã€‚</p></blockquote><p>ä¸ºäº†é˜²æ­¢ç±»ä¼¼çš„é—®é¢˜å†æ¬¡å‘ç”Ÿï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥ç›‘æ§åˆ°ç£ç›˜ç»´åº¦ï¼Œèƒ½å¤Ÿåˆ—å‡ºå„ä¸ªæ—¥å¿—æ–‡ä»¶çš„å¤§å°ä»¥åŠåˆ›å»ºæ—¶é—´ã€‚</p><p>è¿™æ—¶å°±éœ€è¦å¯¹ <code>Pulsar</code> çš„å­˜å‚¨æ¨¡å‹æœ‰ä¸€å®šçš„äº†è§£ï¼Œä¹Ÿå°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚</p><span id="more"></span><p><img src="https://s2.loli.net/2024/01/15/EjpuQKJN5MVIW8r.png" alt="image.png"><br>è®²åˆ° Pulsar çš„å­˜å‚¨æ¨¡å‹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ Bookkeeper çš„å­˜å‚¨æ¨¡å‹ã€‚</p><p>Pulsar æ‰€æœ‰çš„æ¶ˆæ¯è¯»å†™éƒ½æ˜¯é€šè¿‡ Bookkeeper å®ç°çš„ã€‚</p><blockquote><p><code>Bookkeeper</code> æ˜¯ä¸€ä¸ªå¯æ‰©å±•ã€å¯å®¹é”™ã€ä½å»¶è¿Ÿçš„æ—¥å¿—å­˜å‚¨æ•°æ®åº“ï¼ŒåŸºäº Append Only æ¨¡å‹ã€‚ï¼ˆæ•°æ®åªèƒ½è¿½åŠ ä¸èƒ½ä¿®æ”¹ï¼‰</p></blockquote><p><img src="https://s2.loli.net/2024/01/15/tMITYocL89ZapVG.png" alt="image.png"></p><p>è¿™é‡Œæˆ‘åˆ©ç”¨ Pulsar å’Œ Bookkeeper çš„ Admin API åˆ—å‡ºäº† Broker å’Œ BK ä¸­ Ledger åˆ†åˆ«å ç”¨çš„ç£ç›˜ç©ºé—´ã€‚</p><blockquote><p>å…³äºè¿™ä¸ªå¦‚ä½•è·å–å’Œè®¡ç®—çš„ï¼Œåç»­ä¹Ÿå‡†å¤‡æäº¤ç»™ç¤¾åŒºã€‚</p></blockquote><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>ä½†å’Œæˆ‘ä»¬å®é™… <code>kubernetes</code> ä¸­çš„ç£ç›˜å ç”¨é‡ä¾ç„¶å¯¹ä¸ä¸Šï¼Œæ‰€ä»¥å°±æƒ³çœ‹çœ‹åœ¨ BK ä¸­å®é™…çš„å­˜å‚¨æ—¥å¿—å’Œ <code>Ledger</code> åˆ°åº•å·®åœ¨å“ªé‡Œã€‚</p><blockquote><p>çŸ¥é“ Ledger å°±å¯ä»¥é€šè¿‡ Ledger çš„å…ƒæ•°æ®ä¸­æ‰¾åˆ°å¯¹åº”çš„ topicï¼Œä»è€Œåˆ¤æ–­å“ªäº› topic çš„æ•°æ®å¯¼è‡´ç»Ÿè®¡ä¸èƒ½åŒ¹é…ã€‚</p></blockquote><p>Bookkeeper æœ‰ææä¾›ä¸€ä¸ªAdmin API å¯ä»¥è¿”å›å½“å‰ BK æ‰€ä½¿ç”¨äº†å“ªäº›æ—¥å¿—æ–‡ä»¶çš„æ¥å£:<br><a href="https://bookkeeper.apache.org/docs/admin/http#endpoint-apiv1bookielist_disk_filefile_typetype">https://bookkeeper.apache.org/docs/admin/http#endpoint-apiv1bookielist_disk_filefile_typetype</a></p><p><img src="https://s2.loli.net/2024/01/15/ZOMcNSG53Ttz4eo.png"></p><p>ä»è¿”å›çš„ç»“æœå¯ä»¥çœ‹å‡ºï¼Œè½åˆ°å…·ä½“çš„ç£ç›˜ä¸Šåªæœ‰ä¸€ä¸ªæ–‡ä»¶åç§°ï¼Œæ˜¯æ— æ³•çŸ¥é“å…·ä½“å’Œå“ªäº› Ledger è¿›è¡Œå…³è”çš„ï¼Œä¹Ÿå°±æ— æ³•çŸ¥é“å…·ä½“çš„ topic äº†ã€‚</p><p>æ­¤æ—¶åªèƒ½å¤§èƒ†å‡è®¾ï¼Œåº”è¯¥æ¯ä¸ªæ–‡ä»¶å’Œå…·ä½“çš„æ¶ˆæ¯ ID æœ‰ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•ã€‚<br>æ‰€ä»¥éœ€è¦ææ¸…æ¥šè¿™ä¸ªç´¢å¼•æ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚</p><h1 id="å­˜å‚¨æ¨¡å‹"><a href="#å­˜å‚¨æ¨¡å‹" class="headerlink" title="å­˜å‚¨æ¨¡å‹"></a>å­˜å‚¨æ¨¡å‹</h1><p><img src="https://s2.loli.net/2024/01/15/uvPC1Y8kdOJ3m5B.png"></p><p>æˆ‘æŸ¥é˜…äº†ä¸€äº›ç½‘ä¸Šçš„æ–‡ç« å’Œæºç å¤§æ¦‚æ¢³ç†äº†ä¸€ä¸ªå­˜å‚¨æµç¨‹ï¼š</p><ol><li>BK æ”¶åˆ°å†™å…¥è¯·æ±‚ï¼Œæ•°æ®ä¼šå¼‚æ­¥å†™å…¥åˆ° <code>Journal</code>&#x2F;<code>Entrylog</code></li><li>Journal ç›´æ¥é¡ºåºå†™å…¥ï¼Œå¹¶ä¸”ä¼šå¿«é€Ÿæ¸…é™¤å·²ç»å†™å…¥çš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦çš„ç£ç›˜ç©ºé—´ä¸å¤šï¼ˆæ‰€ä»¥ä»ç›‘æ§ä¸­å…¶å®å¯ä»¥çœ‹åˆ° Journal çš„ç£ç›˜å æœ‰ç‡æ˜¯å¾ˆä½çš„ï¼‰ã€‚</li><li>è€ƒè™‘åˆ°ä¼šéšæœºè¯»æ¶ˆæ¯ï¼ŒEntryLog åœ¨å†™å…¥å‰è¿›è¡Œæ’åºï¼Œä¿è¯è½ç›˜çš„æ•°æ®ä¸­åŒä¸€ä¸ª Ledger çš„æ•°æ®å°½é‡æŒ¨åœ¨ä¸€èµ·ï¼Œå……åˆ†åˆ©ç”¨ PageCache.</li><li>æœ€ç»ˆæ•°æ®çš„ç´¢å¼•é€šè¿‡ <code>LedgerId+EntryId</code> ç”Ÿæˆç´¢å¼•ä¿¡æ¯å­˜æ”¾åˆ° <code>RockDB</code> ä¸­ï¼ˆ<code>Pulsar</code> çš„åœºæ™¯ä½¿ç”¨çš„æ˜¯ <code>DbLedgerStorage</code> å®ç°ï¼‰ã€‚</li><li>è¯»å–æ•°æ®æ—¶å…ˆä»è·å–ç´¢å¼•ï¼Œç„¶åå†ä»ç£ç›˜è¯»å–æ•°æ®ã€‚</li><li>åˆ©ç”¨ <code>Journal</code> å’Œ <code>EntryLog</code> å®ç°æ¶ˆæ¯çš„è¯»å†™åˆ†ç¦»ã€‚</li></ol><p>ç®€å•æ¥è¯´ BK åœ¨å­˜å‚¨æ•°æ®çš„æ—¶å€™ä¼šè¿›è¡ŒåŒå†™ï¼Œ<code>Journal</code> ç›®å½•ç”¨äºå­˜æ”¾å†™çš„æ•°æ®ï¼Œå¯¹æ¶ˆæ¯é¡ºåºæ²¡æœ‰è¦æ±‚ï¼Œå†™å®Œåå°±å¯ä»¥æ¸…é™¤äº†ã€‚</p><p>è€Œ <code>Entry</code> ç›®å½•ä¸»è¦ç”¨äºåç»­æ¶ˆè´¹æ¶ˆæ¯è¿›è¡Œè¯»å–ä½¿ç”¨ï¼Œå¤§éƒ¨åˆ†åœºæ™¯éƒ½æ˜¯é¡ºåºè¯»ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ¶ˆè´¹æ¶ˆæ¯çš„æ—¶å€™å¾ˆå°‘ä¼šå›æº¯ï¼Œæ‰€ä»¥éœ€è¦å……åˆ†åˆ©ç”¨ç£ç›˜çš„ PageCacheï¼Œå°†é¡ºåºçš„æ¶ˆæ¯å°½é‡çš„å­˜å‚¨åœ¨ä¸€èµ·ã€‚</p><blockquote><p>åŒä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å¯èƒ½ä¼šå­˜æ”¾å¤šä¸ª Ledger çš„æ¶ˆæ¯ï¼Œè¿™äº›æ•°æ®å¦‚æœä¸æ’åºç›´æ¥å†™å…¥å°±ä¼šå¯¼è‡´ä¹±åºï¼Œè€Œæ¶ˆè´¹æ—¶å¤§æ¦‚ç‡æ˜¯é¡ºåºçš„ï¼Œä½†å…·ä½“åˆ°ç£ç›˜çš„è¡¨ç°å°±æ˜¯éšæœºè¯»äº†ï¼Œè¿™æ ·è¯»å–æ•ˆç‡è¾ƒä½ã€‚</p></blockquote><p>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ <code>Helm</code> éƒ¨ç½² <code>Bookkeeper</code> çš„æ—¶å€™éœ€è¦åˆ†åˆ«æŒ‡å®š <code>journal</code> å’Œ <code>ledgers</code> çš„ç›®å½•</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">volumes:</span>  </span><br><span class="line">  <span class="comment"># use a persistent volume or emptyDir  </span></span><br><span class="line">  <span class="attr">persistence:</span> <span class="literal">true</span>  </span><br><span class="line">  <span class="attr">journal:</span>  </span><br><span class="line">    <span class="attr">name:</span> <span class="string">journal</span>  </span><br><span class="line">    <span class="attr">size:</span> <span class="string">20Gi</span>  </span><br><span class="line">    <span class="attr">local_storage:</span> <span class="literal">false</span>  </span><br><span class="line">    <span class="attr">multiVolumes:</span>  </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">journal0</span>  </span><br><span class="line">        <span class="attr">size:</span> <span class="string">10Gi</span>  </span><br><span class="line">        <span class="comment"># storageClassName: existent-storage-class  </span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/pulsar/data/bookkeeper/journal0</span>  </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">journal1</span>  </span><br><span class="line">        <span class="attr">size:</span> <span class="string">10Gi</span>  </span><br><span class="line">        <span class="comment"># storageClassName: existent-storage-class  </span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/pulsar/data/bookkeeper/journal1</span>  </span><br><span class="line">  <span class="attr">ledgers:</span>  </span><br><span class="line">    <span class="attr">name:</span> <span class="string">ledgers</span>  </span><br><span class="line">    <span class="attr">size:</span> <span class="string">50Gi</span>  </span><br><span class="line">    <span class="attr">local_storage:</span> <span class="literal">false</span>  </span><br><span class="line">    <span class="attr">storageClassName:</span> <span class="string">sc</span></span><br><span class="line">    <span class="comment"># storageClass:  </span></span><br><span class="line">      <span class="comment"># ...    useMultiVolumes: false  </span></span><br><span class="line">    <span class="attr">multiVolumes:</span>  </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ledgers0</span>  </span><br><span class="line">        <span class="attr">size:</span> <span class="string">1000Gi</span>  </span><br><span class="line">        <span class="comment"># storageClassName: existent-storage-class  </span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/pulsar/data/bookkeeper/ledgers0</span>  </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ledgers1</span>  </span><br><span class="line">        <span class="attr">size:</span> <span class="string">1000Gi</span>  </span><br><span class="line">        <span class="comment"># storageClassName: existent-storage-class  </span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">/pulsar/data/bookkeeper/ledgers1</span></span><br></pre></td></tr></table></figure><hr><p><img src="https://s2.loli.net/2024/01/15/nJeNDFbu2MIQp5a.png"><br>æ¯æ¬¡åœ¨å†™å…¥å’Œè¯»å–æ•°æ®çš„æ—¶å€™éƒ½éœ€è¦é€šè¿‡æ¶ˆæ¯ ID ä¹Ÿå°±æ˜¯ ledgerId å’Œ entryId æ¥è·å–ç´¢å¼•ä¿¡æ¯ã€‚</p><blockquote><p>ä¹Ÿå°è¯äº†ä¹‹å‰ç´¢å¼•çš„çŒœæµ‹ã€‚</p></blockquote><p>æ‰€ä»¥å€ŸåŠ©äº BK è¯»å†™åˆ†ç¦»çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å•ç‹¬ä¼˜åŒ–å­˜å‚¨ã€‚</p><p>æ¯”å¦‚å†™å…¥ <code>Journal</code> çš„ç£ç›˜å› ä¸ºæ˜¯é¡ºåºå†™å…¥ï¼Œæ‰€ä»¥å³ä¾¿æ˜¯æ™®é€šçš„ <code>HDD</code> ç¡¬ç›˜é€Ÿåº¦ä¹Ÿå¾ˆå¿«ã€‚</p><p>å¤§éƒ¨åˆ†åœºæ™¯ä¸‹éƒ½æ˜¯è¯»å¤§äºå†™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å•ç‹¬ä¸º <code>Ledger</code> åˆ†é…é«˜æ€§èƒ½ SSD ç£ç›˜ï¼ŒæŒ‰éœ€ä½¿ç”¨ã€‚</p><blockquote><p>å› ä¸ºåœ¨æœ€åº•å±‚çš„æ—¥å¿—æ–‡ä»¶ä¸­æ— æ³•ç›´æ¥é€šè¿‡ ledgerId å¾—çŸ¥å ç”¨ç£ç›˜çš„å¤§å°ï¼Œæ‰€ä»¥æˆ‘ä»¬å®é™…çš„ç£ç›˜å ç”¨ç‡å¯¹ä¸ä¸Šçš„é—®é¢˜ä¾ç„¶æ²¡æœ‰å¾—åˆ°è§£å†³ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘è¿˜ä¼šæŒç»­è·Ÿè¿›ï¼Œæœ‰æ–°çš„è¿›å±•å†ç»§ç»­åŒæ­¥ã€‚</p></blockquote><p>#Blog #Pulsar </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2024/01/15/xU7FZCPjckRMBAD.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æˆ‘ä»¬çš„ Pulsar å­˜å‚¨æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´æ•°æ®ä¸€ç›´å¾—ä¸åˆ°å›æ”¶ï¼Œä½†æ¶ˆæ¯ç¡®å®å·²ç»æ˜¯ ACK äº†ï¼Œç†è®ºä¸Šåº”è¯¥æ˜¯ä¼šè¢«å›æ”¶çš„ï¼Œéšç€æ—¶é—´æµé€ä¸ä½†æ²¡å›æ”¶è¿˜ä¸€ç›´å†æ¶¨ï¼Œæœ€ååœ¨æ²¡æ‰¾åˆ°åŸå› çš„æƒ…å†µä¸‹å°±åªæœ‰ä¸€ç›´ä¸åœçš„æ‰©å®¹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ€åç£ç›˜æ˜¯å¾—åˆ°äº†å›æ”¶ï¼Œè¿‡ç¨‹å…ˆä¸è¡¨ï¼Œä¹‹åå†è®¨è®ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢ç±»ä¼¼çš„é—®é¢˜å†æ¬¡å‘ç”Ÿï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥ç›‘æ§åˆ°ç£ç›˜ç»´åº¦ï¼Œèƒ½å¤Ÿåˆ—å‡ºå„ä¸ªæ—¥å¿—æ–‡ä»¶çš„å¤§å°ä»¥åŠåˆ›å»ºæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å°±éœ€è¦å¯¹ &lt;code&gt;Pulsar&lt;/code&gt; çš„å­˜å‚¨æ¨¡å‹æœ‰ä¸€å®šçš„äº†è§£ï¼Œä¹Ÿå°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
    <category term="Bookkeeper" scheme="http://crossoverjie.top/tags/Bookkeeper/"/>
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬åå››æœŸï¼šGolang ä½œè€… Rob Pike åœ¨ GopherConAU ä¸Šçš„åˆ†äº«</title>
    <link href="http://crossoverjie.top/2024/01/12/ob/newsletter/Newsletter12-202401012/"/>
    <id>http://crossoverjie.top/2024/01/12/ob/newsletter/Newsletter12-202401012/</id>
    <published>2024-01-12T09:28:25.000Z</published>
    <updated>2024-01-11T09:59:20.030Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2024/01/11/YMoyEKwUubfZA9a.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><span id="more"></span><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/12/15/ob/newsletter/Newsletter10-20231215/">20231215ï¼šç¬¬åæœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/22/ob/newsletter/Newsletter10-20231222/">20231122ï¼šç¬¬åä¸€æœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/29/ob/newsletter/Newsletter12-20231229/">20231129ï¼šç¬¬åäºŒæœŸ</a></li><li><a href="https://crossoverjie.top/2024/01/05/ob/newsletter/Newsletter12-20240105/">20240105ï¼šç¬¬åä¸‰æœŸï¼šä¸€äº›æé«˜ç”Ÿäº§åŠ›çš„ç»ˆç«¯å‘½ä»¤</a></li></ul><h2 id="What-We-Got-Right-What-We-Got-Wrong"><a href="#What-We-Got-Right-What-We-Got-Wrong" class="headerlink" title="What We Got Right, What We Got Wrong"></a>What We Got Right, What We Got Wrong</h2><p>URL: <a href="https://commandcenter.blogspot.com/2024/01/what-we-got-right-what-we-got-wrong.html?utm_source=changelog-news">https://commandcenter.blogspot.com/2024/01/what-we-got-right-what-we-got-wrong.html?utm_source=changelog-news</a></p><blockquote><p>æœ¬æ–‡æ˜¯ <code>Golang</code> æ ¸å¿ƒä½œè€…ä¹‹ä¸€  <a href="http://robpike.blogspot.com/">Rob Pike</a> å»å¹´åº•åœ¨æ¾³å¤§åˆ©äºš GopherConAU ä¼šè®®ä¸Šçš„åˆ†äº«ï¼›æ€»ç»“äº† Go è¯­è¨€ 14 å¹´æ¥çš„åšå¯¹äº†å“ªäº›äº‹æƒ…ã€åšé”™äº†å“ªäº›äº‹æƒ…ã€‚</p></blockquote><p><img src="https://s2.loli.net/2024/01/10/1MRo4ZTPwzmd6F2.png"></p><p>ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>è¯­è¨€æ¶‰åŠ</li><li>ç¤¾åŒºç®¡ç†</li><li>é¡¹ç›®è¿è¥<br>ç­‰æ–¹é¢ï¼Œæ„Ÿå…´è¶£çš„è¿˜å¯ä»¥çœ‹æ²¹ç®¡è§†é¢‘ã€‚<br><a href="https://www.youtube.com/watch?v=yE5Tpp2BSGw">https://www.youtube.com/watch?v=yE5Tpp2BSGw</a></li></ul><h2 id="Top-10-Platform-Engineering-Tools-You-Should-Consider-in-2024-by-Romaric-Philogene-Jan-2024-Medium"><a href="#Top-10-Platform-Engineering-Tools-You-Should-Consider-in-2024-by-Romaric-Philogene-Jan-2024-Medium" class="headerlink" title="Top 10 Platform Engineering Tools You Should Consider in 2024 | by Romaric PhilogÃ¨ne | Jan, 2024 | Medium"></a>Top 10 Platform Engineering Tools You Should Consider in 2024 | by Romaric PhilogÃ¨ne | Jan, 2024 | Medium</h2><p>URL: <a href="https://medium.com/@rphilogene/top-10-platform-engineering-tools-you-should-consider-in-2024-892e6e211b85">https://medium.com/@rphilogene/top-10-platform-engineering-tools-you-should-consider-in-2024-892e6e211b85</a><br><img src="https://s2.loli.net/2024/01/11/VUhodB7rn12lYwR.png"></p><blockquote><p>æœ¬æ–‡ä»‹ç»äº†ä½œä¸ºä¸€ä¸ªå¹³å°å·¥ç¨‹å¸ˆéœ€è¦æŒæ¡çš„å·¥å…·ã€‚</p></blockquote><p>å…ˆå®šä¹‰äº†ä»€ä¹ˆæ˜¯å¹³å°å·¥ç¨‹å¸ˆï¼š<br>ä¸ºç ”å‘äººå‘˜æä¾›å¹³å°èµ„æºè¿›è¡Œå¼€å‘ï¼Œè®©å¼€å‘äººå‘˜å¯ä»¥åœ¨äº‘ç¯å¢ƒä¸­è‡ªåŠ©å®Œæˆæ•´ä¸ªè½¯ä»¶ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªç¯èŠ‚ï¼Œæ¯”å¦‚åŸºç¡€ç¯å¢ƒæ­å»ºã€ä»£ç  pipelinesã€ç›‘æ§ç­‰ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¼šç”¨åˆ°çš„å·¥å…·ï¼š</p><ul><li>kubernetesï¼šè¿™ä¸ªå°±ä¸ç”¨å¤šè®²äº†ã€‚</li><li>Crossplaneï¼šç”¨äºç®¡ç†å¤šé›†ç¾¤çš„ kubernetes</li><li>Qoveryï¼šå†…éƒ¨å¼€å‘è€…å¹³å°</li><li>Github&#x2F;Gitlab CI&#x2F;CD</li><li>ArgoCDï¼škubernetes åŸç”Ÿæä¾›çš„æŒç»­éƒ¨ç½²å·¥å…·ã€‚</li><li>Docker</li><li>Terraformï¼š åŸºç¡€è®¾æ–½è‡ªåŠ¨åŒ–å·¥å…·,å¯ä»¥é€šè¿‡å£°æ˜å¼é…ç½®æ–‡ä»¶å®ç°å¤šäº‘åŸºç¡€è®¾æ–½çš„éƒ¨ç½²å’Œç®¡ç†ã€‚</li><li>Datadogï¼šç›‘æ§å’Œæ—¥å¿—åˆ†æå¹³å°ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ Prometheus&#x2F;Grafana ç­‰</li></ul><h2 id="Load-Balancing-Algorithms-Explained-Visually"><a href="#Load-Balancing-Algorithms-Explained-Visually" class="headerlink" title="Load Balancing Algorithms Explained Visually"></a>Load Balancing Algorithms Explained Visually</h2><p>URL: <a href="https://blog.quastor.org/p/load-balancing-algorithms-explained-visually?utm_source=tldrwebdev">https://blog.quastor.org/p/load-balancing-algorithms-explained-visually?utm_source=tldrwebdev</a></p><blockquote><p>æœ¬æ–‡ä»‹ç»äº†ä¸€äº›è´Ÿè½½å‡è¡¡ç®—æ³•ä»¥åŠå…¶ä¼˜ç¼ºç‚¹ã€‚</p></blockquote><p><img src="https://s2.loli.net/2024/01/11/NGV9YWJ6g7Dx2sy.gif" alt="Round Robin_1.gif"></p><ol><li><p>è½®è¯¢ç®—æ³•(Round Robin):æ¯ä¸ªè¯·æ±‚æŒ‰é¡ºåºåˆ†é…åˆ°ä¸åŒæœåŠ¡å™¨ã€‚å®ç°ç®€å•,ä½†ä¸èƒ½è€ƒè™‘æœåŠ¡å™¨è´Ÿè½½æƒ…å†µã€‚</p></li><li><p>åŠ æƒè½®è¯¢(Weighted Round Robin):è€ƒè™‘æœåŠ¡å™¨æ€§èƒ½ç»™å„æœåŠ¡å™¨è®¾ç½®æƒé‡,è¯·æ±‚åˆ†é…æŒ‰æƒé‡æ¯”ä¾‹è¿›è¡Œã€‚ä»ç„¶ä¸èƒ½å®æ—¶ååº”æœåŠ¡å™¨è´Ÿè½½å˜åŒ–ã€‚</p></li><li><p>æœ€å°‘è¿æ¥æ•°(Least Connections):å®æ—¶ç›‘æµ‹å„æœåŠ¡å™¨è¿æ¥æ•°,å°†è¯·æ±‚åˆ†é…åˆ°è¿æ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨ä¸Šã€‚å®ç°è¾ƒå¤æ‚,éœ€è¦å®šæœŸæ¢æµ‹å„æœåŠ¡å™¨çŠ¶æ€ã€‚</p></li><li><p>æœ€çŸ­å“åº”æ—¶é—´(Least Response Time):ç›‘æµ‹å„æœåŠ¡å™¨å“åº”æ—¶é—´,åˆ†é…ç»™å“åº”æœ€å¿«çš„æœåŠ¡å™¨ã€‚</p></li><li><p>åŒéšæœºé€‰æ‹©(Power of Two Choices):éšæœºé€‰æ‹©ä¸¤å°æœåŠ¡å™¨,å°†è¯·æ±‚åˆ†é…ç»™è´Ÿè½½è¾ƒè½»çš„ä¸€å°ã€‚å‡å°‘ç›‘æµ‹å¼€é”€ã€‚</p></li><li><p>ä¸€è‡´å“ˆå¸Œ(Consistent Hashing):æ ¹æ®è¯·æ±‚å…³é”®ä¿¡æ¯è®¡ç®—å“ˆå¸Œå€¼,å°†è¯·æ±‚åˆ†é…ç»™å¯¹åº”çš„æœºå™¨èŒƒå›´ã€‚è§£å†³ä¸»æœºæ·»åŠ å’Œåˆ é™¤é—®é¢˜ã€‚</p></li><li><p>å…¶ä»–ç®—æ³•å¦‚æ ¹æ®ç£ç›˜ã€å†…å­˜åˆ©ç”¨ç‡è¿›è¡Œè´Ÿè½½åˆ†é…ç­‰ã€‚</p></li></ol><h2 id="What-problem-did-Go-actually-solve-for-Google"><a href="#What-problem-did-Go-actually-solve-for-Google" class="headerlink" title="What problem did Go actually solve for Google"></a>What problem did Go actually solve for Google</h2><p>URL: <a href="https://www.reddit.com/r/golang/comments/176b5pn/what_problem_did_go_actually_solve_for_google/">https://www.reddit.com/r/golang/comments/176b5pn/what_problem_did_go_actually_solve_for_google/</a></p><blockquote><p>è¿™æ˜¯ä¸€ä¸ª Reddit ä¸Šçš„å¸–å­ï¼ŒOP çš„é—®é¢˜æ˜¯ Rob åœ¨ä¹‹å‰çš„åˆ†äº«ä¸­æåˆ° Golang åˆ›å»ºçš„åŸå› æ˜¯è¦è§£å†³ Google å†…éƒ¨çš„é—®é¢˜ï¼Œä½†æ²¡æœ‰å…·ä½“è®²  Google åˆ°åº•é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ<br>ä»€ä¹ˆé—®é¢˜æ˜¯å‡ ç™¾ç§ç¼–ç¨‹è¯­è¨€éƒ½æ— æ³•è§£å†³çš„é—®é¢˜ï¼Ÿ</p></blockquote><p>ä»¥ä¸‹æ˜¯ä¸€äº›é«˜èµå›ç­”ï¼š</p><ul><li>æ›´å¿«çš„æœ¬åœ°ç¼–è¯‘é€Ÿåº¦</li><li>å¯¹æ–°æ‰‹æ¥è¯´æ›´å¥½ç†è§£çš„ä»£ç </li><li>æ›´ä¸¥æ ¼çš„ä»£ç é£æ ¼ï¼Œä½¿å¾—å¤§å®¶çš„ä»£ç éƒ½å·®ä¸å¤šã€‚</li><li>æ›´å®¹æ˜“ç¼–å†™å¹¶å‘ç¨‹åº</li></ul><p>æ€»ä½“æ¥è¯´, Go ä¸»è¦è§£å†³çš„æ˜¯åœ¨å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¦‚ä½•æ›´é«˜æ•ˆåœ°è¿›è¡Œåä½œå¼€å‘ã€å®ç°é«˜æ€§èƒ½åˆæ˜“ç»´æŠ¤ã€‚è¿™æ­£æ˜¯ Google å½“æ—¶æœ€å…³å¿ƒçš„é—®é¢˜ã€‚</p><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://commandcenter.blogspot.com/2024/01/what-we-got-right-what-we-got-wrong.html?utm_source=changelog-news">https://commandcenter.blogspot.com/2024/01/what-we-got-right-what-we-got-wrong.html?utm_source=changelog-news</a></li><li><a href="https://medium.com/@rphilogene/top-10-platform-engineering-tools-you-should-consider-in-2024-892e6e211b85">https://medium.com/@rphilogene/top-10-platform-engineering-tools-you-should-consider-in-2024-892e6e211b85</a></li><li><a href="https://blog.quastor.org/p/load-balancing-algorithms-explained-visually?utm_source=tldrwebdev">https://blog.quastor.org/p/load-balancing-algorithms-explained-visually?utm_source=tldrwebdev</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2024/01/11/YMoyEKwUubfZA9a.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>è¯·æ³¨æ„ï¼Œä½ çš„ Pulsar é›†ç¾¤å¯èƒ½æœ‰åˆ é™¤æ•°æ®çš„é£é™©</title>
    <link href="http://crossoverjie.top/2024/01/09/ob/Pulsar-Delete-Topic/"/>
    <id>http://crossoverjie.top/2024/01/09/ob/Pulsar-Delete-Topic/</id>
    <published>2024-01-09T15:04:58.000Z</published>
    <updated>2024-01-08T15:26:11.780Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€ç¯‡ <a href="https://crossoverjie.top/2024/01/03/ob/Pulsar3.0-new-feature/#topic%E8%A2%AB%E5%88%A0%E9%99%A4">Pulsar3.0æ–°åŠŸèƒ½ä»‹ç»</a>ä¸­æåˆ°ï¼Œåœ¨å‡çº§åˆ° 3.0 çš„è¿‡ç¨‹ä¸­ç¢°åˆ°ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼Œå°±æ˜¯å‡çº§ä¹‹å topic è¢«åˆ é™¤äº†ã€‚</p><p>æ­£å¥½æœ€è¿‘ç¤¾åŒºä¹Ÿè¡¥å……äº†ç›¸å…³ç»†èŠ‚ï¼Œæœ¬æ¬¡ä¹Ÿæ¥ç€è¿™ä¸ªæœºä¼šå†æ¬¡å¤ç›˜ä¸€ä¸‹ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€ä¸ªéå¸¸è‡´å‘½çš„ Bugã€‚</p><span id="more"></span><p><img src="https://s2.loli.net/2024/01/08/MKFhYVL95C8qtHR.png"></p><h1 id="ç°è±¡"><a href="#ç°è±¡" class="headerlink" title="ç°è±¡"></a>ç°è±¡</h1><p>å…ˆæ¥å›é¡¾ä¸‹å½“æ—¶çš„æƒ…å†µï¼šå‡çº§å½“æ™šæ²¡æœ‰å‡ºç°å•¥é—®é¢˜ï¼Œå„ä¸ªæµé‡æŒ‡æ ‡ã€ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…æ•°é‡éƒ½æ˜¯åœ¨æ­£å¸¸èŒƒå›´å†…æ³¢åŠ¨ã€‚</p><blockquote><p>äº‹åæ‰çŸ¥é“ï¼Œå› ä¸ºåªæ˜¯åˆ é™¤äº†å¾ˆå°‘ä¸€éƒ¨åˆ†çš„ topicï¼Œæ‰€ä»¥ä»ç›‘æ§ä¸­ååº”ä¸å‡ºæ¥ã€‚</p></blockquote><p>æ—©ä¸Šä¸Šç­åé™†ç»­æœ‰éƒ¨åˆ†ä¸šåŠ¡åé¦ˆåº”ç”¨è¿ä¸ä¸Š topicï¼Œæç¤º <code>topic nof found</code>.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name <span class="string">&#x27;Producer&#x27;</span>: Invocation of init method failed; nested exception is org.apache.pulsar.client.api.PulsarClientException$TopicDoesNotExistException: Topic Not Found.</span><br></pre></td></tr></table></figure><p>å› ä¸ºåªæ˜¯éƒ¨åˆ†åº”ç”¨åœ¨åé¦ˆï¼Œæ‰€ä»¥èµ·åˆæ€€ç–‘æ˜¯ broker å‡çº§ä¹‹åå¯¼è‡´è€ç‰ˆæœ¬çš„ pulsar-client å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚</p><p>æ‰€ä»¥æˆ‘å°±æ‹¿äº†å¹³æ—¶æµ‹è¯•ç”¨çš„ topic å†é…åˆå¤šä¸ªè€ç‰ˆæœ¬çš„ sdk è¿›è¡Œæµ‹è¯•ï¼Œå‘ç°æ²¡æœ‰é—®é¢˜ã€‚</p><blockquote><p>ç›´åˆ°è¿™ä¸€æ­¥è¿˜å¥½ï¼Œè‡³å°‘è¯æ˜æ˜¯å°èŒƒæ•…éšœã€‚</p></blockquote><p>å› ä¸ºæç¤ºçš„æ˜¯ topic ä¸å­˜åœ¨ï¼Œæ‰€ä»¥å°±å‡†å¤‡æŸ¥ä¸€ä¸‹ topic çš„å…ƒæ•°æ®æ˜¯å¦æ­£å¸¸ã€‚</p><p><img src="https://s2.loli.net/2024/01/08/My6KVsTkRaF3SwQ.png"><br>æŸ¥è¯¢åå‘ç°å…ƒæ•°æ®æ˜¯å­˜åœ¨çš„ã€‚</p><p>ä¹‹åæˆ‘ä¾¿æƒ³çœ‹çœ‹æç¤ºäº† topic ä¸å­˜åœ¨çš„ topic çš„å½’å±ï¼Œç„¶åå†çœ‹çœ‹é‚£ä¸ª broker ä¸­æ˜¯å¦æœ‰å¼‚å¸¸æ—¥å¿—ã€‚</p><p><img src="https://s2.loli.net/2024/01/08/rWRdnbmXkisMvLB.png"><br>å‘ç°æŸ¥çœ‹å½’å±çš„æ¥å£ä¹Ÿæ˜¯æç¤º topic ä¸å­˜åœ¨ï¼Œæ­¤æ—¶æˆ‘ä¾¿æ€€ç–‘æ˜¯ topic çš„è´Ÿè½½å‡ºç°äº†é—®é¢˜ï¼Œå¯¼è‡´è¿™äº› topic æ²¡æœ‰ç»‘å®šåˆ°å…·ä½“çš„ brokerã€‚</p><p>äºæ˜¯ä¾¿é‡å¯äº† brokerï¼Œç»“æœä¾ç„¶æ²¡æœ‰è§£å†³é—®é¢˜ã€‚<br><img src="https://s2.loli.net/2024/01/08/s3BhMvLCOR7ES2k.png"><br>ä¹‹åæˆ‘ä»¬æŸ¥è¯¢äº† topic çš„ internal state å‘ç°å…ƒæ•°æ®ä¸­ä¼šå°‘ä¸€ä¸ªåˆ†åŒºã€‚</p><h1 id="ç´§æ€¥æ¢å¤"><a href="#ç´§æ€¥æ¢å¤" class="headerlink" title="ç´§æ€¥æ¢å¤"></a>ç´§æ€¥æ¢å¤</h1><p>æˆ‘ä»¬å°è¯•å°†è¿™ä¸ªåˆ†åŒºæ•°æ¢å¤åï¼Œå‘ç°è¿™ä¸ª topic å°±å¯ä»¥æ­£å¸¸è¿æ¥äº†ã€‚</p><p>äºæ˜¯å†æŒ‘é€‰äº†å‡ ä¸ªå¼‚å¸¸çš„ topic å‘ç°éƒ½æ˜¯åŒæ ·çš„é—®é¢˜ï¼Œæ¢å¤åˆ†åŒºæ•°ä¹‹åä¹Ÿå¯ä»¥æ­£å¸¸è¿æ¥äº†ã€‚</p><p>æ‰€ä»¥æˆ‘å†™äº†ä¸€ä¸ªå·¥å…·éå†äº†æ‰€æœ‰çš„ topicï¼Œæ£€æµ‹åˆ†åŒºæ•°æ˜¯å¦æ­£å¸¸ï¼Œä¸æ­£å¸¸æ—¶ä¾¿ä¿®å¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">checkPartition</span><span class="params">()</span> &#123;  </span><br><span class="line">    <span class="type">String</span> <span class="variable">namespace</span> <span class="operator">=</span> <span class="string">&quot;tenant/ns&quot;</span>;  </span><br><span class="line">    List&lt;String&gt; topicList = pulsarAdmin.topics().getPartitionedTopicList(namespace);  </span><br><span class="line">    <span class="keyword">for</span> (String topic : topicList) &#123;  </span><br><span class="line">        <span class="type">PartitionedTopicStats</span> <span class="variable">stats</span> <span class="operator">=</span> pulsarAdmin.topics().getPartitionedStats(topic, <span class="literal">true</span>);  </span><br><span class="line">        <span class="type">int</span> <span class="variable">partitions</span> <span class="operator">=</span> stats.getMetadata().partitions;  </span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> stats.getPartitions().size();  </span><br><span class="line">        <span class="keyword">if</span> (partitions != size) &#123;  </span><br><span class="line">            log.info(<span class="string">&quot;topic=&#123;&#125;,partitions=&#123;&#125;,size=&#123;&#125;&quot;</span>, topic, partitions, size);  </span><br><span class="line">            pulsarAdmin.topics().updatePartitionedTopic(topic, partitions);  </span><br><span class="line">        &#125;    </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ’æŸ¥"><a href="#æ’æŸ¥" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h1><p>ä¿®å¤å¥½æ‰€æœ‰ topic ä¹‹åä¾¿å¼€å§‹æ’æŸ¥æ ¹å› ï¼Œå› ä¸ºçœ‹åˆ°çš„æ˜¯å…ƒæ•°æ®ä¸ä¸€è‡´æ‰€ä»¥æ€€ç–‘æ˜¯ zk é‡Œçš„æ•°æ®å’Œ broker å†…å­˜ä¸­çš„æ•°æ®ä¸åŒå¯¼è‡´çš„è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½†æˆ‘ä»¬æŸ¥çœ‹äº† zookeeper ä¸­çš„æ•°æ®å‘ç°ä¸€åˆ‡åˆæ˜¯æ­£å¸¸çš„ï¼Œæ‰€ä»¥åªèƒ½è½¬å˜æ€è·¯ã€‚</p><p>ä¹‹åæˆ‘ä»¬é€šè¿‡æœ‰é—®é¢˜çš„ topic åœ¨æ—¥å¿—ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªå…³é”®æ—¥å¿—ï¼š<br><img src="https://s2.loli.net/2024/01/08/OfazoZRUt8W2ypk.png"><br><img src="https://s2.loli.net/2024/01/08/emZ7BGkcbiS2dpM.png"><br>ä»¥åŠå…·ä½“çš„å †æ ˆã€‚</p><p>æ­¤æ—¶å…·ä½“çš„åŸå› å·²ç»å¾ˆæ˜æ˜¾äº†ï¼Œå…ƒæ•°æ®è¿™äº›è‡ªç„¶æ˜¯æ²¡é—®é¢˜ï¼›æ ¹æœ¬åŸå› æ˜¯ topic è¢«åˆ é™¤äº†ï¼Œä½†è¢«åˆ é™¤çš„ topic åªæ˜¯æŸä¸ªåˆ†åŒºï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æŸ¥è¯¢ <code>internalState</code> æ—¶æ‰å‘å‘ç°å°‘ä¸€ä¸ª topicã€‚</p><p>é€šè¿‡è¿™ä¸ªåˆ é™¤æ—¥å¿—å®šä½åˆ°å…·ä½“çš„åˆ é™¤ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.apache.pulsar.broker.service.persistent.PersistentTopic#checkReplication</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/08/9Rb1AyHfpGcPqZO.png"><br>åŸæ¥æ˜¯è¿™é‡Œçš„  <code>configuredClusters</code> å€¼ä¸ºç©ºæ‰å¯¼è‡´çš„ topic è°ƒç”¨äº† <code>deleteForcefully()</code>è¢«åˆ é™¤ã€‚</p><p>è€Œè¿™ä¸ªå€¼æ˜¯ä» topic çš„ Policy ä¸­è·å–çš„ã€‚</p><h2 id="å¤ç°é—®é¢˜"><a href="#å¤ç°é—®é¢˜" class="headerlink" title="å¤ç°é—®é¢˜"></a>å¤ç°é—®é¢˜</h2><p>é€šè¿‡ä¸Šå›¾ä¸­çš„å †æ ˆè·Ÿè¸ªï¼Œæ€€ç–‘æ˜¯é‡å¯  broker å¯¼è‡´çš„ topic unload ï¼ŒåŒæ—¶ broker åˆåœ¨æ„å»º topic å¯¼è‡´äº†å¯¹ topicPolicy çš„è¯»å†™ã€‚</p><p>æœ€ç»ˆå¯¼è‡´ topicPolicy ä¸ºç©ºã€‚</p><p>åªè¦å†™ä¸ªå•æµ‹å¯ä»¥å¤ç°è¿™ä¸ªé—®é¢˜å°±å¥½åŠäº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCreateTopicAndUpdatePolicyConcurrent</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">topicNum</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">partition</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (1) Init topic</span></span><br><span class="line">    admin.namespaces().createNamespace(<span class="string">&quot;public/retention&quot;</span>);</span><br><span class="line">    <span class="keyword">final</span> <span class="type">String</span> <span class="variable">topicName</span> <span class="operator">=</span> <span class="string">&quot;persistent://public/retention/policy_with_broker_restart&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; topicNum; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">shadowTopicNames</span> <span class="operator">=</span> topicName + <span class="string">&quot;_&quot;</span> + i;</span><br><span class="line">        admin.topics().createPartitionedTopic(shadowTopicNames, partition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (2) Set Policy</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">90</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">shadowTopicNames</span> <span class="operator">=</span> topicName + <span class="string">&quot;_&quot;</span> + i;</span><br><span class="line">        CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">PublishRate</span> <span class="variable">publishRate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PublishRate</span>();</span><br><span class="line">                publishRate.publishThrottlingRateInMsg = <span class="number">100</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    admin.topicPolicies().setPublishRate(shadowTopicNames, publishRate);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (PulsarAdminException e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">90</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">shadowTopicNames</span> <span class="operator">=</span> topicName + <span class="string">&quot;_&quot;</span> + i;</span><br><span class="line">        CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    admin.lookups().lookupPartitionedTopic(shadowTopicNames);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    admin.namespaces().unload(<span class="string">&quot;public/retention&quot;</span>);</span><br><span class="line">    admin.namespaces().unload(<span class="string">&quot;public/retention&quot;</span>);</span><br><span class="line">    admin.namespaces().unload(<span class="string">&quot;public/retention&quot;</span>);</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>* <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; topicNum; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">shadowTopicNames</span> <span class="operator">=</span> topicName + <span class="string">&quot;_&quot;</span> + i;</span><br><span class="line">        log.info(<span class="string">&quot;check topic: &#123;&#125;&quot;</span>, shadowTopicNames);</span><br><span class="line">        <span class="type">PartitionedTopicStats</span> <span class="variable">partitionedStats</span> <span class="operator">=</span> admin.topics().getPartitionedStats(shadowTopicNames, <span class="literal">true</span>);</span><br><span class="line">        Assert.assertEquals(partitionedStats.getPartitions().size(), partition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶è¿˜å¾—æŸ¥è¯¢å…ƒæ•°æ®æœ‰è€—æ—¶æ‰èƒ½å¤ç°ï¼š<br><img src="https://s2.loli.net/2024/01/08/2ry5Ife4aTvwxGM.png"></p><blockquote><p>åªèƒ½æ‰‹åŠ¨ sleep æ¨¡æ‹Ÿè¿™ä¸ªè€—æ—¶</p></blockquote><p>å…·ä½“ä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ª issue<br><a href="https://github.com/apache/pulsar/issues/21653#issuecomment-1842962452">https://github.com/apache/pulsar/issues/21653#issuecomment-1842962452</a></p><p>æ­¤æ—¶å°±ä¼šå‘ç°æœ‰ topic è¢«åˆ é™¤äº†ï¼Œè€Œä¸”æ˜¯éšæœºåˆ é™¤çš„ï¼Œå› ä¸ºå‡ºç°å¹¶å‘çš„å‡ ç‡æœ¬èº«ä¹Ÿæ˜¯éšæœºçš„ã€‚</p><p><img src="https://s2.loli.net/2024/01/08/wYSoGHDc7Arp13j.png"></p><p>è¿™é‡Œç”»äº†ä¸€ä¸ªæµç¨‹å›¾å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œåœ¨ broker é‡å¯çš„æ—¶å€™ä¼šæœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶topicPolicy è¿›è¡Œæ“ä½œã€‚</p><p>åœ¨ thread3 è¯»å– topicPolicy è¿›è¡Œåˆ¤æ–­æ—¶ï¼Œthread2 å¯èƒ½è¿˜æ²¡æœ‰æŠŠæ•°æ®å‡†å¤‡å¥½ï¼Œæ‰€ä»¥å°±å¯¼è‡´äº† topic è¢«åˆ é™¤ã€‚</p><h1 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h1><p><img src="https://s2.loli.net/2024/01/08/15iyVmOFe72X6tl.png"><br>æ—¢ç„¶çŸ¥é“äº†é—®é¢˜åŸå› å°±å¥½ä¿®å¤äº†ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠ thread3 å’Œ thread2 ä¿®æ”¹ä¸ºä¸²è¡Œæ‰§è¡Œå°±å¥½äº†ã€‚</p><blockquote><p>è¿™ä¹Ÿæ˜¯å¤„ç†å¹¶å‘æœ€ç®€å•é«˜æ•ˆçš„æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥é¿å…å¹¶å‘ï¼›åŠ é”ã€é˜Ÿåˆ—å•¥çš„è™½ç„¶ä¹Ÿå¯ä»¥è§£å†³ï¼Œä½†ä»£ç å¤æ‚åº¦ä¹Ÿé«˜äº†å¾ˆå¤šï¼Œæ‰€ä»¥èƒ½ä¸å¹¶å‘å°±å°½é‡ä¸è¦å¹¶å‘ã€‚</p></blockquote><p>ä½†è¦æŠŠè¿™ä¸ªä¿®å¤æ¨é€åˆ°ç¤¾åŒºä¸Šæ¸¸ä¸»åˆ†æ”¯æœ€å¥½æ˜¯è¦åŠ ä¸Šå•æµ‹ï¼Œè¿™æ ·å³ä¾¿æ˜¯åç»­æœ‰å…¶ä»–çš„æ”¹åŠ¨ä¹Ÿèƒ½ä¿è¯è¿™ä¸ª bug ä¸ä¼šå†æ¬¡å‡ºç°ã€‚</p><p>ä¹‹ååœ¨ç¤¾åŒºå¤§ä½¬çš„å¸®åŠ©ä¸‹å®Œå–„äº†å•æµ‹ï¼Œæœ€ç»ˆåˆå¹¶äº†è¿™ä¸ªä¿®å¤ã€‚</p><blockquote><p>å†æ¬¡è¯æ˜å†™å•æµ‹å¾€å¾€æ¯”ä»£ç æ›´å¤æ‚ï¼Œä¹Ÿæ›´èŠ±è´¹æ—¶é—´ã€‚</p></blockquote><p>PRï¼š<a href="https://github.com/apache/pulsar/pull/21704">https://github.com/apache/pulsar/pull/21704</a></p><h2 id="ä½¿ç”¨ä¿®å¤é•œåƒ"><a href="#ä½¿ç”¨ä¿®å¤é•œåƒ" class="headerlink" title="ä½¿ç”¨ä¿®å¤é•œåƒ"></a>ä½¿ç”¨ä¿®å¤é•œåƒ</h2><p>å› ä¸ºç¤¾åŒºåˆå¹¶ä»£ç å†å‘ç‰ˆçš„å‘¨æœŸè¾ƒé•¿ï¼Œè€Œæˆ‘ä»¬åˆæ€¥äºä¿®å¤è¯¥é—®é¢˜ï¼›ä¸ç„¶éƒ½ä¸æ•¢é‡å¯ brokerï¼Œå› ä¸ºæ¯é‡å¯ä¸€æ¬¡éƒ½å¯èƒ½ä¼šå¯¼è‡´ä¸çŸ¥é“å“ªä¸ª topic å°±è¢«åˆ é™¤äº†ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è‡ªå·±åœ¨æœ¬åœ°æ„å»ºäº†ä¸€ä¸ªä¿®å¤çš„é•œåƒï¼Œå‡†å¤‡åœ¨çº¿ä¸Šè¿›è¡Œæ›¿æ¢ã€‚</p><p>æ­¤æ—¶å‘åˆæ¥äº†ï¼Œæˆ‘ä»¬æ»¡æ€€ä¿¡å¿ƒçš„æ›¿æ¢äº†ä¸€ä¸ªé•œåƒå†è§‚å¯Ÿæ—¥å¿—å‘ç°å±…ç„¶è¿˜æœ‰åˆ é™¤çš„æ—¥å¿—ğŸ˜±ã€‚</p><p>å†·é™ä¸‹æ¥ä¸€åˆ†æï¼ŒåŸæ¥æ˜¯å½“å‰æ›¿æ¢è¿›è¡Œçš„ broker æ²¡æœ‰é—®é¢˜äº†ï¼Œä½†å®ƒå¤„ç†çš„ topic è¢«è½¬ç§»åˆ°äº†å…¶ä»– broker ä¸­ï¼Œè€Œå…¶ä»–çš„ broker å¹¶æ²¡æœ‰æ›¿æ¢ä¸ºæˆ‘ä»¬æœ€æ–°çš„é•œåƒã€‚</p><p>æ‰€ä»¥å¯¼è‡´ topic åœ¨å…¶ä»– broker ä¸­ä¾ç„¶è¢«åˆ é™¤äº†ã€‚</p><blockquote><p>é™¤éæˆ‘ä»¬åœæœºï¼Œå°†æ‰€æœ‰çš„é•œåƒéƒ½æ›¿æ¢ä¹‹åå†ä¸€èµ·é‡å¯ã€‚</p></blockquote><p>ä½†è¿™æ ·çš„æˆæœ¬å¤ªé«˜äº†ï¼Œæœ€å¥½æ˜¯å¯ä»¥å¹³æ»‘å‘å¸ƒã€‚</p><p>æœ€ç»ˆæˆ‘ä»¬æƒ³åˆ°ä¸€ä¸ªåŠæ³•ï¼Œä½¿ç”¨ <code>arthas</code> å»å…³é—­äº†ä¸€ä¸ª broker çš„ä¸€ä¸ªé€‰é¡¹ï¼Œä¹‹åå°±ä¸ä¼šæ‰§è¡Œå‡ºç° bug çš„é‚£æ®µä»£ç äº†ã€‚</p><p><img src="https://s2.loli.net/2024/01/08/nVrWLYjzs5e9UXw.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://arthas.aliyun.com/arthas-boot.jar &amp;&amp; java -jar arthas-boot.jar 1 -c &quot;vmtool -x 3 --action getInstances --className org.apache.pulsar.broker.ServiceConfiguration  --express &#x27;instances[0].setTopicLevelPoliciesEnabled(false)&#x27;&quot;</span><br></pre></td></tr></table></figure><p>æˆ‘ä¹Ÿå°†æ“ä½œæ–¹æ³•è´´åˆ°äº†å¯¹äº issue çš„è¯„è®ºåŒºã€‚<br><a href="https://github.com/apache/pulsar/issues/21653#issuecomment-1857548997">https://github.com/apache/pulsar/issues/21653#issuecomment-1857548997</a><br>å¦‚æœä¸å¹¸ç¢°åˆ°äº†è¿™ä¸ª bugï¼Œå¯ä»¥å‚è€ƒä¿®å¤ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åˆ é™¤çš„è¿™äº› topic çš„åŒæ—¶å®ƒçš„è®¢é˜…è€…ä¹Ÿè¢«åˆ é™¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¿®å¤è®¢é˜…è€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">topicName</span> <span class="operator">=</span> <span class="string">&quot;persistent://tenant/ns/topicName&quot;</span>;  </span><br><span class="line">pulsarTopicService.createSubscription(topicName, <span class="string">&quot;subName&quot;</span>, MessageId.latest);</span><br></pre></td></tr></table></figure><p>ä¹‹æ‰€ä»¥è¯´è¿™ä¸ª bug éå¸¸è‡´å‘½ï¼Œæ˜¯å› ä¸ºè¿™æ ·ä¼šå¯¼è‡´ topic çš„æ•°æ®ä¸¢å¤±ï¼ŒåŒæ—¶è¿™äº› topic ä¸Šçš„æ•°æ®ä¹Ÿä¼šè¢«åˆ é™¤ã€‚</p><hr><p>åç»­ <a href="https://github.com/apache/pulsar/pull/21704#issuecomment-1878315926">https://github.com/apache/pulsar/pull/21704#issuecomment-1878315926</a>ç¤¾åŒºä¹Ÿè¡¥å……äº†ä¸€äº›åœºæ™¯ã€‚</p><p><img src="https://s2.loli.net/2024/01/08/q4OjXGPtibF8csU.png"></p><blockquote><p>å…¶å®åœºæ™¯ 2 æ›´å®¹æ˜“å‡ºç°å¤ç°ï¼Œæ¯•ç«Ÿæ›´å®¹æ˜“å‡ºç°å¹¶å‘ï¼›ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç¢°åˆ°çš„åœºæ™¯</p></blockquote><p>è¯´æ¥ä¹Ÿå¥‡æ€ªï¼Œç»“åˆç¤¾åŒºçš„ issue å’Œå…¶ä»–å¤§ä½¬çš„åé¦ˆï¼Œè¿™ä¸ªé—®é¢˜åªæœ‰æˆ‘ä»¬ç¢°åˆ°äº†ï¼Œä¼°è®¡ä¹Ÿæ˜¯è¿™ä¸ªé—®é¢˜çš„è§¦å‘æ¡ä»¶ä¹Ÿæ¯”è¾ƒè‹›åˆ»ï¼š</p><ul><li>å¼€å¯ <code>systemTopic/topicLevelPolices</code><br>  systemTopicEnabled: â€œtrueâ€<br>  topicLevelPoliciesEnabled: â€œtrueâ€</li><li>è®¾ç½®è¶³å¤Ÿå¤šçš„ topicPolicies</li><li>é‡å¯ broker<ul><li>é‡å¯è¿‡ç¨‹ä¸­ä» zk ä¸­è·å–æ•°æ®å‡ºç°è€—æ—¶</li></ul></li></ul><p>ç¬¦åˆä»¥ä¸Šæ¡ä»¶çš„é›†ç¾¤å°±éœ€è¦æ³¨æ„äº†ã€‚</p><p>å…¶å®è¿™ä¸ªé—®é¢˜åœ¨è¿™ä¸ª PR å°±å·²ç»å¼•å…¥äº†<br><a href="https://github.com/apache/pulsar/pull/11021">https://github.com/apache/pulsar/pull/11021</a></p><p>æ‰€ä»¥å·²ç»å­˜åœ¨è›®ä¹…äº†ï¼Œåç»­æˆ‘ä»¬ä¹Ÿå°†æ£€æµ‹å…ƒæ•°æ®ä½œä¸ºå‡çº§æµç¨‹ä¹‹ä¸€äº†ï¼Œç¡®ä¿å‡çº§åæ•°æ®ä¾ç„¶æ˜¯å®Œæ•´çš„ã€‚</p><p>ç›¸å…³çš„ issue å’Œ PRï¼š<br><a href="https://github.com/apache/pulsar/issues/21653">https://github.com/apache/pulsar/issues/21653</a><br><a href="https://github.com/apache/pulsar/pull/21704">https://github.com/apache/pulsar/pull/21704</a></p><p>#Blog #Pulsar </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨ä¸Šä¸€ç¯‡ &lt;a href=&quot;https://crossoverjie.top/2024/01/03/ob/Pulsar3.0-new-feature/#topic%E8%A2%AB%E5%88%A0%E9%99%A4&quot;&gt;Pulsar3.0æ–°åŠŸèƒ½ä»‹ç»&lt;/a&gt;ä¸­æåˆ°ï¼Œåœ¨å‡çº§åˆ° 3.0 çš„è¿‡ç¨‹ä¸­ç¢°åˆ°ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼Œå°±æ˜¯å‡çº§ä¹‹å topic è¢«åˆ é™¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¥½æœ€è¿‘ç¤¾åŒºä¹Ÿè¡¥å……äº†ç›¸å…³ç»†èŠ‚ï¼Œæœ¬æ¬¡ä¹Ÿæ¥ç€è¿™ä¸ªæœºä¼šå†æ¬¡å¤ç›˜ä¸€ä¸‹ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€ä¸ªéå¸¸è‡´å‘½çš„ Bugã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬åä¸‰æœŸï¼šä¸€äº›æé«˜ç”Ÿäº§åŠ›çš„ç»ˆç«¯å‘½ä»¤</title>
    <link href="http://crossoverjie.top/2024/01/05/ob/newsletter/Newsletter12-20240105/"/>
    <id>http://crossoverjie.top/2024/01/05/ob/newsletter/Newsletter12-20240105/</id>
    <published>2024-01-05T09:28:25.000Z</published>
    <updated>2024-01-08T04:01:31.588Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2024/01/05/wU8gPSzaoitBerC.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><span id="more"></span><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/12/01/ob/newsletter/Newsletter08-20231201/">20231201ï¼šç¬¬å…«æœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/15/ob/newsletter/Newsletter10-20231215/">20231215ï¼šç¬¬åæœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/22/ob/newsletter/Newsletter10-20231222/">20231122ï¼šç¬¬åä¸€æœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/29/ob/newsletter/Newsletter12-20231229/">20231129ï¼šç¬¬åäºŒæœŸ</a><!--more--></li></ul><h2 id="ç”Ÿå­˜è¿˜æ˜¯æ¯ç­ï¼Ÿä¸€æ–‡å¸¦ä½ çœ‹æ‡‚-Pulsar-çš„æ¶ˆæ¯ä¿ç•™å’Œè¿‡æœŸç­–ç•¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘"><a href="#ç”Ÿå­˜è¿˜æ˜¯æ¯ç­ï¼Ÿä¸€æ–‡å¸¦ä½ çœ‹æ‡‚-Pulsar-çš„æ¶ˆæ¯ä¿ç•™å’Œè¿‡æœŸç­–ç•¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘" class="headerlink" title="ç”Ÿå­˜è¿˜æ˜¯æ¯ç­ï¼Ÿä¸€æ–‡å¸¦ä½ çœ‹æ‡‚ Pulsar çš„æ¶ˆæ¯ä¿ç•™å’Œè¿‡æœŸç­–ç•¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘"></a>ç”Ÿå­˜è¿˜æ˜¯æ¯ç­ï¼Ÿä¸€æ–‡å¸¦ä½ çœ‹æ‡‚ Pulsar çš„æ¶ˆæ¯ä¿ç•™å’Œè¿‡æœŸç­–ç•¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</h2><p>URL: <a href="https://cloud.tencent.com/developer/article/2245703">https://cloud.tencent.com/developer/article/2245703</a></p><p><img src="https://s2.loli.net/2024/01/05/ZYRxDydaIn2W4jJ.png"></p><blockquote><p>æœ¬æ–‡åˆ†æäº† Pulsar æ¶ˆæ¯çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸»è¦æ˜¯å¦‚ä½•ä¿ç•™å’Œå›æ”¶æ¶ˆæ¯</p></blockquote><ul><li>TTLï¼ˆTime To Liveï¼‰ï¼šä½¿å¾—æœª ACK çš„æ¶ˆæ¯è¿›å…¥ ACK çŠ¶æ€ï¼Œä¾›åç»­å›æ”¶çš„æ—¶å€™ä½¿ç”¨</li><li><strong>Retention</strong>ä¿ç•™ç­–ç•¥ï¼šé»˜è®¤æƒ…å†µä¸‹å·²ç»è¢«æ‰€æœ‰è®¢é˜…è€… ACK çš„æ¶ˆæ¯ä¼šè¢«ç«‹å³å›æ”¶æ‰ï¼Œé…ç½®ä¿ç•™ç­–ç•¥å¯ä»¥ä¿ç•™ä¸€å®šæ—¶é—´ã€ä¸€å®šæ•°é‡çš„ ACK æ¶ˆæ¯ï¼Œåˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®å¯ä»¥åšæ¶ˆæ¯å›æŸ¥</li><li>Backlog: æœªè¢«ç¡®è®¤æ¶ˆæ¯çš„é›†åˆï¼Œä¹Ÿå°±æ˜¯ç§¯å‹æ¶ˆæ¯ï¼›ä¹Ÿå¯ä»¥é…ç½®åªä¿ç•™ä¸€å®šæ—¶é—´ã€æ•°é‡çš„æ¶ˆæ¯ï¼Œä»è€Œå‡å°‘ç£ç›˜å‹åŠ›ï¼›å½“è¶…è¿‡æˆ‘ä»¬é…ç½®çš„é˜ˆå€¼æ—¶ï¼Œæœ‰ä»¥ä¸‹å‡ ç§é€‰æ‹©ï¼š<br><img src="https://s2.loli.net/2024/01/04/pdEKHRT4v2fAkBm.png" alt="image.png"></li></ul><h2 id="è¿™äº›æµè¡Œçš„K8Så·¥å…·ï¼Œä½ éƒ½ç”¨ä¸Šäº†å—"><a href="#è¿™äº›æµè¡Œçš„K8Så·¥å…·ï¼Œä½ éƒ½ç”¨ä¸Šäº†å—" class="headerlink" title="è¿™äº›æµè¡Œçš„K8Så·¥å…·ï¼Œä½ éƒ½ç”¨ä¸Šäº†å—"></a>è¿™äº›æµè¡Œçš„K8Så·¥å…·ï¼Œä½ éƒ½ç”¨ä¸Šäº†å—</h2><p>URL: <a href="https://mp.weixin.qq.com/s/EC-YLm71YB4cMDoTjrdfyg">https://mp.weixin.qq.com/s/EC-YLm71YB4cMDoTjrdfyg</a></p><blockquote><p>æ¨èäº†ä¸€äº›å¸¸ç”¨çš„ kubernetes ç®¡ç†å·¥å…·</p></blockquote><p><img src="https://s2.loli.net/2024/01/05/kWbLtETcey9Gmzp.png"></p><ul><li>Helm: kubernetes å¹³å°çš„å¿…å¤‡çš„åŒ…ç®¡ç†å·¥å…·</li><li>æœ¬åœ°è¿è¡Œçš„ kubernetes å·¥å…·ï¼šæœ‰æ—¶å€™éœ€è¦åœ¨æœ¬åœ°è¿›è¡Œå¼€å‘å’Œæµ‹è¯•ï¼Œè¿™ç±»å·¥å…·å°±å¾ˆæœ‰ç”¨ï¼š<ul><li>Docker Desktop</li><li>minikube</li><li>kind</li><li>k3s</li><li>è¿™ç±»å·¥å…·åœ¨ingressã€è´Ÿè½½å‡è¡¡ã€é›†ç¾¤å¤–è®¿é—®ç­‰éœ€è¦å•ç‹¬é…ç½®ã€‚</li></ul></li><li>é›†ç¾¤è‡ªåŠ¨ç¼©æ”¾å™¨ï¼šç”¨äºç¼©æ”¾åº•å±‚èŠ‚ç‚¹<ul><li>ä¸€äº›äº‘æœåŠ¡å‚å•†è‡ªåŠ¨é›†æˆäº†è¿™ç±»åŠŸèƒ½ï¼Œå¦‚æœæ˜¯è‡ªå»ºé›†ç¾¤ï¼š</li><li>kubernetes Autoscaler</li><li>Karpenter</li></ul></li><li>å¤‡ä»½å’Œè¿ç§»<ul><li>å¦‚æœéƒ¨ç½²äº†æœ‰çŠ¶æ€çš„åº”ç”¨ï¼Œéœ€è¦è¿›è¡Œæ•°æ®è¿ç§»å’Œå¤‡ä»½æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>velero</code></li></ul></li><li>å‘½ä»¤è¡Œå·¥å…·<ul><li>kube-ps1 ç”¨äºç»ˆç«¯çš„ kubernetes å‘½ä»¤æç¤º</li><li>kubectx ç”¨äºåœ¨ç»ˆç«¯è¿›è¡Œ é›†ç¾¤ã€namespace ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul></li><li>IDE<ul><li>OpenLens ä¸€ä¸ªå®¢æˆ·ç«¯å¯è§†åŒ– appï¼Œç”¨äºæ–¹ä¾¿ç®¡ç† kubernetes é›†ç¾¤</li></ul></li></ul><h2 id="3-Terminal-Commands-to-Increase-Your-Productivity-DEV-Community"><a href="#3-Terminal-Commands-to-Increase-Your-Productivity-DEV-Community" class="headerlink" title="3 Terminal Commands to Increase Your Productivity - DEV Community"></a>3 Terminal Commands to Increase Your Productivity - DEV Community</h2><p>URL: <a href="https://dev.to/pankajgupta221b/3-terminal-commands-to-increase-your-productivity-57dm?ref=dailydev">https://dev.to/pankajgupta221b/3-terminal-commands-to-increase-your-productivity-57dm?ref=dailydev</a></p><blockquote><p>ä½œè€…ä»‹ç»äº†å‡ ä¸ªå¸¸ç”¨çš„å¯ä»¥æé«˜ç”Ÿäº§åŠ›çš„ç»ˆç«¯å‘½ä»¤</p></blockquote><p><img src="https://s2.loli.net/2024/01/05/9UQjHvpaLEqMldW.png"></p><h3 id="alias-åˆ«å"><a href="#alias-åˆ«å" class="headerlink" title="alias åˆ«å"></a>alias åˆ«å</h3><p>åˆ«åéå¸¸å¥½ç”¨ï¼Œä»¥ä¸‹æ˜¯æˆ‘å¸¸ç”¨çš„ä¸€äº›åˆ«å:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-=&#x27;cd -&#x27;</span><br><span class="line">...=../..</span><br><span class="line">....=../../..</span><br><span class="line">.....=../../../..</span><br><span class="line">......=../../../../..</span><br><span class="line">1=&#x27;cd -&#x27;</span><br><span class="line">2=&#x27;cd -2&#x27;</span><br><span class="line">3=&#x27;cd -3&#x27;</span><br><span class="line">4=&#x27;cd -4&#x27;</span><br><span class="line">5=&#x27;cd -5&#x27;</span><br><span class="line">6=&#x27;cd -6&#x27;</span><br><span class="line">7=&#x27;cd -7&#x27;</span><br><span class="line">8=&#x27;cd -8&#x27;</span><br><span class="line">9=&#x27;cd -9&#x27;</span><br><span class="line">dc=docker</span><br><span class="line">jdk11=&#x27;export JAVA_HOME=~/jdk/jdk-11.0.16.1.jdk/Contents/Home&#x27;</span><br><span class="line">jdk17=&#x27;export JAVA_HOME=~/Users/chenjie/Documents/dev~/jdk/jdk-17.0.1.jdk/Contents/Home/&#x27;</span><br><span class="line">jdk21=&#x27;export JAVA_HOME=~/jdk/jdk-21.0.1.jdk/Contents/Home&#x27;</span><br><span class="line">jdk8=&#x27;export JAVA_HOME=&#x27;</span><br><span class="line">k=kubectl</span><br><span class="line">pp=&#x27;sh hexo-push.sh&#x27;</span><br></pre></td></tr></table></figure><h3 id="pbcopy"><a href="#pbcopy" class="headerlink" title="pbcopy"></a>pbcopy</h3><p>è¿™ä¸ªåœ¨æœ‰æ—¶å€™éœ€è¦ debug æ—¥å¿—æˆ–è€…å¤åˆ¶ä¸€äº›é•¿æ–‡æœ¬åˆ°å‰ªè´´æ¿é‡Œéå¸¸æœ‰ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat xx.properties |grep timeout | pbcopy</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥æŠŠ timeout è¿™ä¸ªå…³é”®å­—ä»æ–‡ä»¶ä¸­å¤åˆ¶åˆ°ç²˜è´´æ¿ï¼Œæˆ‘å°±å¯ä»¥å°†å®ƒå¤åˆ¶åˆ°å…¶ä»–åœ°æ–¹ä½¿ç”¨ã€‚</p><h3 id="åå‘æœç´¢"><a href="#åå‘æœç´¢" class="headerlink" title="åå‘æœç´¢"></a>åå‘æœç´¢</h3><p>åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ ctrl+r å°±å¯ä»¥æ ¹æ®å…³é”®å­—åœ¨å†å²å‘½ä»¤ä¸­æŸ¥æ‰¾å‘½ä»¤ï¼Œè¿™ä¸ªåœ¨å¿˜è®°äº†ä¸€äº›å‘½ä»¤ä½†åªè®°å¾—å…³é”®å­—çš„æ—¶å€™éå¸¸æœ‰ç”¨ã€‚<br><img src="https://s2.loli.net/2024/01/05/dfuDG6L2n7h5BNP.png"></p><p>æˆ‘è¿™é‡Œä½¿ç”¨çš„ç»ˆç«¯æ˜¯ Warp ï¼Œäº¤äº’ä¸Šæ›´åŠ å¥½ç”¨ä¸€äº›ã€‚</p><h3 id="cal"><a href="#cal" class="headerlink" title="cal"></a>cal</h3><p>å¯ä»¥ç”¨äºæ˜¾ç¤ºæ—¥å†<br><img src="https://s2.loli.net/2024/01/05/5yCL9oKWIrjB2Dc.png"></p><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://cloud.tencent.com/developer/article/2245703">https://cloud.tencent.com/developer/article/2245703</a></li><li><a href="https://mp.weixin.qq.com/s/EC-YLm71YB4cMDoTjrdfyg">https://mp.weixin.qq.com/s/EC-YLm71YB4cMDoTjrdfyg</a></li><li><a href="https://dev.to/pankajgupta221b/3-terminal-commands-to-increase-your-productivity-57dm?ref=dailydev">https://dev.to/pankajgupta221b/3-terminal-commands-to-increase-your-productivity-57dm?ref=dailydev</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2024/01/05/wU8gPSzaoitBerC.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>Pulsar3.0æ–°åŠŸèƒ½ä»‹ç»</title>
    <link href="http://crossoverjie.top/2024/01/03/ob/Pulsar3.0-new-feature/"/>
    <id>http://crossoverjie.top/2024/01/03/ob/Pulsar3.0-new-feature/</id>
    <published>2024-01-03T15:04:58.000Z</published>
    <updated>2024-01-02T16:41:35.234Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2024/01/03/1QuX3wI6P8hefLa.png" alt="Pulsar3.0-NewFeature.png"></p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç«  <a href="https://crossoverjie.top/2023/12/24/ob/Pulsar3.0-upgrade/">Pulsar3.0 å‡çº§æŒ‡åŒ—</a>è®²äº†å…³äºå‡çº§ Pulsar é›†ç¾¤çš„å…³é”®æ­¥éª¤ä¸ç¾éš¾æ¢å¤ï¼Œæœ¬æ¬¡ä¸»è¦åˆ†äº«ä¸€äº› <code>Pulsar3.0</code> çš„æ–°åŠŸèƒ½ä¸å¯èƒ½å¸¦æ¥çš„ä¸€äº›é—®é¢˜ã€‚</p><h1 id="å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜"><a href="#å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜"></a>å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜</h1><p>å…ˆæ¥ä¸ªæ¬²æ‰¬å…ˆæŠ‘ï¼ŒèŠèŠå‡çº§åæ‰€ç¢°åˆ°çš„é—®é¢˜å§ã€‚</p><p>å…¶ä¸­æœ‰ä¸¤ä¸ªé—®é¢˜æˆ‘ä»¬æ„ŸçŸ¥æ¯”è¾ƒæ˜æ˜¾ï¼Œç‰¹åˆ«æ˜¯ç¬¬ä¸€ä¸ªã€‚</p><span id="more"></span><h2 id="topicè¢«åˆ é™¤"><a href="#topicè¢«åˆ é™¤" class="headerlink" title="topicè¢«åˆ é™¤"></a>topicè¢«åˆ é™¤</h2><p>æˆ‘ä»¬åœ¨ä¸Šä¸ªæœˆæŸå¤©å‡Œæ™¨ä» <code>2.11.2</code> å‡çº§åˆ° <code>3.0.1</code> ä¹‹åï¼Œè¿›è¡Œäº†ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ‰€æåˆ°çš„åŠŸèƒ½æ€§æµ‹è¯•ï¼Œå‘ç°æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œè§‰å¾—ä¸€åˆ‡éƒ½è¿˜æŒºé¡ºåˆ©çš„ï¼ŒåŠä¸ªå°æ—¶æå®šåå°±ä¸‹ç­äº†ã€‚</p><p>ç»“æœå“ªçŸ¥é“ç¬¬äºŒå¤©æ˜¯è¢«ç”µè¯å«é†’çš„ï¼Œæœ‰éƒ¨åˆ†ä¸šåŠ¡åé¦ˆä¸šåŠ¡é‡å¯ä¹‹åå°±æ— æ³•è¿æ¥åˆ° Pulsar äº†ã€‚</p><p><img src="https://s2.loli.net/2024/01/02/KUAnZ8W65jO3x7d.png" alt="image.png"><br>æœ€ç»ˆå®šä½æ˜¯ topic è¢«åˆ é™¤äº†ã€‚</p><blockquote><p>å…¶ä¸­çš„ç»†èŠ‚è¿˜è›®å¤šçš„ï¼Œä¿®å¤è¿‡ç¨‹ä¹Ÿæ˜¯ä¸€æ³¢ä¸‰æŠ˜ï¼Œåé¢æˆ‘ä¼šå•ç‹¬å†™ä¸€ç¯‡æ–‡ç« æ¥è¯¦ç»†æ¢³ç†è¿™ä¸ªè¿‡ç¨‹ã€‚</p></blockquote><p>åœ¨è¿™ä¸ª issue å’Œ PR ä¸­æœ‰è¯¦ç»†çš„æè¿°ï¼š<br><a href="https://github.com/apache/pulsar/issues/21653">https://github.com/apache/pulsar/issues/21653</a><br><a href="https://github.com/apache/pulsar/pull/21704">https://github.com/apache/pulsar/pull/21704</a></p><p>æ„Ÿå…´è¶£çš„æœ‹å‹ä¹Ÿå¯ä»¥å…ˆçœ‹çœ‹ã€‚</p><h2 id="ç›‘æ§æŒ‡æ ‡ä¸¢å¤±"><a href="#ç›‘æ§æŒ‡æ ‡ä¸¢å¤±" class="headerlink" title="ç›‘æ§æŒ‡æ ‡ä¸¢å¤±"></a>ç›‘æ§æŒ‡æ ‡ä¸¢å¤±</h2><p>ç¬¬äºŒä¸ªé—®é¢˜ä¸æ˜¯é‚£ä¹ˆä¸¥é‡ï¼Œæ˜¯å‡çº§åå‘ç°  bookkeeper çš„ä¸€äº›ç›‘æ§æŒ‡æ ‡ä¸¢å¤±äº†ï¼Œæ¯”å¦‚è¿™é‡Œçš„å†™å…¥å»¶è¿Ÿï¼š<br><img src="https://s2.loli.net/2024/01/02/9c7qs4CX1lejOIn.png" alt="image.png"><br>æˆ‘ä¹Ÿå®šä½äº†è›®ä¹…ï¼Œä½†ä¸ç®¡æ˜¯å®˜æ–¹çš„ docker é•œåƒè¿˜æ˜¯æºç ç¼–è¯‘éƒ½æ— æ³•å¤ç°è¿™ä¸ªé—®é¢˜ã€‚</p><p>æœ€ç»ˆä¸¢å¤±çš„æŒ‡æ ‡æœ‰è¿™äº›ï¼š</p><ul><li>bookkeeper_server_ADD_ENTRY_REQUEST</li><li>bookkeeper_server_ADD_ENTRY_BLOCKED</li><li>bookkeeper_server_READ_ENTRY_BLOCKED</li><li>bookie_journal_JOURNAL_CB_QUEUE_SIZE</li><li>bookie_read_cache_hits_count</li><li>bookie_read_cache_misses_count</li><li>bookie_DELETED_LEDGER_COUNT</li><li>bookie_MAJOR_COMPACTION_COUNT</li></ul><p>è¯¦ç»†å†…å®¹å¯ä»¥å‚è€ƒè¿™ä¸ª issueï¼š<br><a href="https://github.com/apache/pulsar/issues/21766">https://github.com/apache/pulsar/issues/21766</a></p><h1 id="æ–°ç‰¹æ€§"><a href="#æ–°ç‰¹æ€§" class="headerlink" title="æ–°ç‰¹æ€§"></a>æ–°ç‰¹æ€§</h1><p>è®²å®Œäº†é‡åˆ°çš„ bugï¼Œå†æ¥çœ‹çœ‹å¸¦æ¥çš„æ–°ç‰¹æ€§ï¼Œé‡ç‚¹ä»‹ç»æˆ‘ä»¬ç”¨å¾—ä¸Šçš„ç‰¹æ€§ã€‚</p><h2 id="æ”¯æŒä½è´Ÿè½½å‡è¡¡"><a href="#æ”¯æŒä½è´Ÿè½½å‡è¡¡" class="headerlink" title="æ”¯æŒä½è´Ÿè½½å‡è¡¡"></a>æ”¯æŒä½è´Ÿè½½å‡è¡¡</h2><p><img src="https://s2.loli.net/2024/01/02/KVpW4DyNimlMhqH.png" alt="image.png"></p><p>å½“æˆ‘ä»¬å‡çº§æˆ–è€…æ˜¯é‡å¯ broker çš„æ—¶å€™ï¼Œå…¨éƒ¨é‡å¯æˆåŠŸåå…¶å®ä¼šå‘ç°æœ€åé‡å¯çš„é‚£ä¸ª broker æ˜¯æ²¡æœ‰æµé‡çš„ã€‚</p><p>è¿™ä¸ªåŸç†å’Œä¼˜åŒ–åœ¨ä¹‹å‰å†™è¿‡çš„ <a href="https://crossoverjie.top/2023/02/07/pulsar/pulsar-load-banance/#Pulsar-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%8E%9F%E7%90%86">Pulsarè´Ÿè½½å‡è¡¡åŸç†åŠä¼˜åŒ–</a> å…¶å®æœ‰è¯¦ç»†ä»‹ç»ã€‚</p><p>æœ¬æ¬¡ 3.0 ç»ˆäºå°†é‚£ä¸ªä¼˜åŒ–å‘ç‰ˆäº†ï¼Œä¹‹ååªè¦æˆ‘ä»¬é…ç½® <code>lowerBoundarySheddingEnabled: true</code> å°±èƒ½å¼€å¯è¿™ä¸ªä½è´Ÿè½½å‡è¡¡çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä½¿å¾—ä½è´Ÿè½½çš„ broker ä¾ç„¶æœ‰æµé‡è¿›å…¥ã€‚</p><h2 id="è·³è¿‡ç©ºæ´æ¶ˆæ¯"><a href="#è·³è¿‡ç©ºæ´æ¶ˆæ¯" class="headerlink" title="è·³è¿‡ç©ºæ´æ¶ˆæ¯"></a>è·³è¿‡ç©ºæ´æ¶ˆæ¯</h2><p><img src="https://s2.loli.net/2024/01/02/nj2IyteVUQ79SBZ.png" alt="image.png"><br>Pulsar å¯èƒ½ä¼šå› ä¸ºæ¶ˆæ¯æ¶ˆè´¹å¼‚å¸¸å¯¼è‡´æ¸¸æ ‡å‡ºç°ç©ºæ´ï¼Œä»è€Œå¯¼è‡´ç£ç›˜å¾—ä¸åˆ°é‡Šæ”¾ï¼›</p><p>æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œä¼šå®šæœŸæ‰«æç§¯å‹æ¶ˆæ¯çš„ topic åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç©ºæ´æ¶ˆæ¯ï¼Œå¦‚æœå­˜åœ¨ä¾¿å¯ä»¥åœ¨ç®¡ç†å°ä½¿ç”¨ skipMessage API è·³è¿‡ç©ºæ´æ¶ˆæ¯ï¼Œä»è€Œé‡Šæ”¾ç£ç›˜ã€‚</p><p>ä½†åœ¨ 3.0 ä¹‹å‰è¿™ä¸ªè·³è¿‡ API å­˜åœ¨ bugï¼Œåªè¦è·³è¿‡çš„æ•°é‡è¶…è¿‡ 8 æ—¶ï¼Œå®é™…è·³è¿‡çš„æ•°é‡å°±ä¼šå°äº 8.</p><p>å…·ä½“ issue å’Œä¿®å¤è¿‡ç¨‹åœ¨è¿™é‡Œï¼š<br><a href="https://github.com/apache/pulsar/issues/20262">https://github.com/apache/pulsar/issues/20262</a><br><a href="https://github.com/apache/pulsar/pull/20326">https://github.com/apache/pulsar/pull/20326</a></p><p>æ€»ä¹‹è¿™ä¸ªé—®é¢˜åœ¨ 3.0 ä¹‹åä¹Ÿæ˜¯ä¿®å¤äº†ï¼Œæœ‰ç±»ä¼¼éœ€æ±‚çš„æœ‹å‹ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p><h2 id="æ–°çš„è´Ÿè½½å‡è¡¡å™¨"><a href="#æ–°çš„è´Ÿè½½å‡è¡¡å™¨" class="headerlink" title="æ–°çš„è´Ÿè½½å‡è¡¡å™¨"></a>æ–°çš„è´Ÿè½½å‡è¡¡å™¨</h2><p>åŒæ—¶ä¹Ÿæ”¯æŒäº†ä¸€ä¸ªæ–°çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œè§£å†³äº†ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li>ä»¥å‰çš„è´Ÿè½½å‡è¡¡å¤§é‡ä¾èµ– zkï¼Œå½“ topic æ•°é‡å¢å¤šæ—¶å¯¹æ‰©å±•æ€§å¸¦æ¥é—®é¢˜ã€‚<ul><li>æ–°çš„è´Ÿè½½å‡è¡¡å™¨ä½¿ç”¨ <code>non-persistent</code> æ¥å­˜å‚¨è´Ÿè½½ä¿¡æ¯ï¼Œå°±ä¸å†ä¾èµ– zk ã€‚</li></ul></li><li>ä»¥å‰çš„è´Ÿè½½å‡è¡¡å™¨éœ€è¦ä¾èµ– <code>leader broker</code> è¿›è¡Œé‡å®šå‘åˆ°å…·ä½“çš„ brokerï¼Œå…¶å®è¿™äº›é‡å®šå‘å¹¶æ— æ„ä¹‰ï¼Œå¾’å¢äº†ç³»ç»Ÿå¼€é”€ã€‚<ul><li>æ–°çš„è´Ÿè½½å‡è¡¡å™¨ä½¿ç”¨äº† SystemTopic æ¥å­˜æ”¾ topic çš„æ‰€æœ‰æƒä¿¡æ¯ï¼Œè¿™æ ·æ¯ä¸ª broker éƒ½å¯ä»¥æ‹¿åˆ°æ•°æ®ï¼Œä»è€Œä¸å†éœ€è¦ä» leader broker é‡å®šå‘äº†ã€‚</li></ul></li></ul><p>æ›´å¤šå®Œæ•´ä¿¡æ¯å¯ä»¥å‚è€ƒè¿™ä¸ª PIP: <a href="https://github.com/apache/pulsar/issues/16691">PIP-192: New Pulsar Broker Load Balancer</a></p><h2 id="æ”¯æŒå¤§è§„æ¨¡å»¶è¿Ÿæ¶ˆæ¯"><a href="#æ”¯æŒå¤§è§„æ¨¡å»¶è¿Ÿæ¶ˆæ¯" class="headerlink" title="æ”¯æŒå¤§è§„æ¨¡å»¶è¿Ÿæ¶ˆæ¯"></a>æ”¯æŒå¤§è§„æ¨¡å»¶è¿Ÿæ¶ˆæ¯</h2><p>ç¬¬äºŒä¸ªé‡å¤§ç‰¹æ€§æ˜¯æ”¯æŒå¤§è§„æ¨¡å»¶è¿Ÿæ¶ˆæ¯ï¼Œç›¸ä¿¡æ˜¯æœ‰ä¸å°‘ä¼ä¸šé€‰æ‹© Pulsar ä¹Ÿæ˜¯å› ä¸ºä»–åŸç”Ÿå°±æ”¯æŒå»¶è¿Ÿæ¶ˆæ¯ã€‚</p><p>æˆ‘ä»¬ä¹Ÿæ˜¯å¤§é‡åœ¨ä¸šåŠ¡ä¸­ä½¿ç”¨å»¶è¿Ÿæ¶ˆæ¯ï¼Œä»¥å¾€çš„å»¶è¿Ÿæ¶ˆæ¯æœ‰ç€ä»¥ä¸‹ä¸€äº›é—®é¢˜ï¼š</p><ul><li>å†…å­˜å¼€é”€è¿‡å¤§ï¼Œå»¶è¿Ÿæ¶ˆæ¯çš„ç´¢å¼•éƒ½æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå³ä¾¿æ˜¯å¯ä»¥åˆ†å¸ƒåœ¨å¤šä¸ª broker ä¸­åˆ†æ•£å­˜å‚¨ï¼Œä½†æ¶ˆè€—ä¾ç„¶è¾ƒå¤§<ul><li>é‡ç‚¹ä¼˜åŒ–äº†ç´¢å¼•çš„å†…å­˜å æœ‰é‡ã€‚</li></ul></li><li>é‡å¯ broker æ—¶ä¼šæ¶ˆè€—å¤§é‡æ—¶å€™é‡å»ºç´¢å¼•<ul><li>æ”¯æŒäº†ç´¢å¼•å¿«ç…§ï¼Œæœ€å¤§é™åº¦çš„é™ä½äº†æ„å»ºç´¢å¼•çš„èµ„æºæ¶ˆè€—ã€‚</li></ul></li></ul><h1 id="å¾…ä¼˜åŒ–åŠŸèƒ½"><a href="#å¾…ä¼˜åŒ–åŠŸèƒ½" class="headerlink" title="å¾…ä¼˜åŒ–åŠŸèƒ½"></a>å¾…ä¼˜åŒ–åŠŸèƒ½</h1><h2 id="ç›‘æ§é¢æ¿ä¼˜åŒ–"><a href="#ç›‘æ§é¢æ¿ä¼˜åŒ–" class="headerlink" title="ç›‘æ§é¢æ¿ä¼˜åŒ–"></a>ç›‘æ§é¢æ¿ä¼˜åŒ–</h2><p>æœ€åå³ä¾¿æ˜¯å‡çº§åˆ°äº† 3.0 ä¾ç„¶è¿˜æœ‰ä¸€äº›å¾…ä¼˜åŒ–çš„åŠŸèƒ½ï¼Œåœ¨ä¹‹å‰çš„ <a href="https://crossoverjie.top/2023/08/03/ob/Pulsar-Client/">ä» Pulsar Client çš„åŸç†åˆ°å®ƒçš„ç›‘æ§é¢æ¿</a>ä¸­æœ‰æåˆ°ç»™å®¢æˆ·ç«¯åŠ äº†ä¸€äº›ç›‘æ§åŸ‹ç‚¹ä¿¡æ¯ã€‚</p><p>æœ€ç»ˆä½¿ç”¨ä¸‹æ¥å‘ç°è¿˜ç¼ºä¸€ä¸ª ack è€—æ—¶çš„ä¸€ä¸ªé¢æ¿ï¼Œå…¶å®æ—¥å¸¸ç¢°åˆ°æœ€å¤šçš„é—®é¢˜å°±æ˜¯çªç„¶ä¸èƒ½æ¶ˆè´¹äº†ï¼ˆæˆ–è€…æ¶ˆè´¹è¿‡æ…¢ï¼‰ã€‚</p><p>è¿™æ—¶å¦‚æœæœ‰è¿™æ ·çš„è€—æ—¶é¢æ¿ï¼Œé¦–å…ˆå°±å¯ä»¥å®šä½å‡ºæ˜¯å¦æ˜¯æ¶ˆè´¹è€…æœ¬èº«çš„é—®é¢˜ã€‚</p><p><img src="https://s2.loli.net/2024/01/03/YFoy4PfnRbz72qX.png" alt="image.png"><br>ç›®å‰è¿˜åœ¨å¼€å‘ä¸­ï¼Œå¤§æ¦‚ç±»ä¼¼äºè¿™æ ·çš„æ•°æ®ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Pulsar3.0 æ˜¯ Pulsar çš„ç¬¬ä¸€ä¸ª LTS ç‰ˆæœ¬ï¼Œæ¨èå°½å¿«å‡çº§å¯ä»¥è·å¾—é•¿æœŸæ”¯æŒã€‚<br>ä½†åªè¦æ˜¯è½¯ä»¶å°±ä¼šæœ‰ bugï¼Œå³ä¾¿æ˜¯ LTS ç‰ˆæœ¬ï¼Œæ‰€ä»¥å¤§å®¶æ—¥å¸¸ä½¿ç”¨ç¢°åˆ° Bug å»ºè®®å¤šå‘ç¤¾åŒºåé¦ˆï¼Œä¸€èµ·æ¨åŠ¨ Pulsar çš„è¿›æ­¥ã€‚</p><p>#Blog #Pulsar </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2024/01/03/1QuX3wI6P8hefLa.png&quot; alt=&quot;Pulsar3.0-NewFeature.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šä¸€ç¯‡æ–‡ç«  &lt;a href=&quot;https://crossoverjie.top/2023/12/24/ob/Pulsar3.0-upgrade/&quot;&gt;Pulsar3.0 å‡çº§æŒ‡åŒ—&lt;/a&gt;è®²äº†å…³äºå‡çº§ Pulsar é›†ç¾¤çš„å…³é”®æ­¥éª¤ä¸ç¾éš¾æ¢å¤ï¼Œæœ¬æ¬¡ä¸»è¦åˆ†äº«ä¸€äº› &lt;code&gt;Pulsar3.0&lt;/code&gt; çš„æ–°åŠŸèƒ½ä¸å¯èƒ½å¸¦æ¥çš„ä¸€äº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id=&quot;å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜&quot;&gt;&lt;a href=&quot;#å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜&quot;&gt;&lt;/a&gt;å‡çº§åæ‰€é‡åˆ°çš„é—®é¢˜&lt;/h1&gt;&lt;p&gt;å…ˆæ¥ä¸ªæ¬²æ‰¬å…ˆæŠ‘ï¼ŒèŠèŠå‡çº§åæ‰€ç¢°åˆ°çš„é—®é¢˜å§ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­æœ‰ä¸¤ä¸ªé—®é¢˜æˆ‘ä»¬æ„ŸçŸ¥æ¯”è¾ƒæ˜æ˜¾ï¼Œç‰¹åˆ«æ˜¯ç¬¬ä¸€ä¸ªã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬åäºŒæœŸ</title>
    <link href="http://crossoverjie.top/2023/12/29/ob/newsletter/Newsletter12-20231229/"/>
    <id>http://crossoverjie.top/2023/12/29/ob/newsletter/Newsletter12-20231229/</id>
    <published>2023-12-29T09:28:25.000Z</published>
    <updated>2023-12-29T06:10:06.808Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/12/29/t1FmIn4i6HAOoDB.png" alt="image.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><span id="more"></span><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/12/01/ob/newsletter/Newsletter08-20231201/">20231201ï¼šç¬¬å…«æœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/15/ob/newsletter/Newsletter10-20231215/">20231215ï¼šç¬¬åæœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/22/ob/newsletter/Newsletter10-20231222/">20231122ï¼šç¬¬åä¸€æœŸ</a><!--more--></li></ul><h2 id="Deno-vs-Go-Native-hello-world-performance-Tech-Tonic"><a href="#Deno-vs-Go-Native-hello-world-performance-Tech-Tonic" class="headerlink" title="Deno vs Go: Native hello world performance | Tech Tonic"></a>Deno vs Go: Native hello world performance | Tech Tonic</h2><p>URL: <a href="https://medium.com/deno-the-complete-reference/deno-vs-go-native-hello-world-performance-c57d8fc13c75">https://medium.com/deno-the-complete-reference/deno-vs-go-native-hello-world-performance-c57d8fc13c75</a></p><blockquote><p>ä½¿ç”¨ Deno å’Œ Go è¿›è¡ŒåŸºæœ¬çš„æ¥å£å¯¹æ¯”</p></blockquote><ul><li>MacBook Pro M2 with 16GB of RAM</li><li><code>Deno</code> v1.38.0</li><li>Go v1.21.3</li></ul><p>éƒ½æ˜¯æœ€ç®€å•çš„ httpServer:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Deno</span>.<span class="title function_">serve</span>(&#123;</span><br><span class="line">  <span class="attr">port</span>: <span class="number">3000</span>,</span><br><span class="line">&#125;, <span class="function">(<span class="params">req</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> pathName = <span class="keyword">new</span> <span class="title function_">URL</span>(req.<span class="property">url</span>).<span class="property">pathname</span>;</span><br><span class="line">    <span class="keyword">if</span> (pathName !== <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="literal">null</span>, &#123; <span class="attr">status</span>: <span class="number">404</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&quot;Hello world!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="literal">null</span>, &#123; <span class="attr">status</span>: <span class="number">500</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;io&quot;</span></span><br><span class="line">  <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  http.HandleFunc(<span class="string">&quot;/&quot;</span>, helloWorld)</span><br><span class="line">  http.ListenAndServe(<span class="string">&quot;:3000&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">helloWorld</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">  io.WriteString(w, <span class="string">&quot;Hello world!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/12/25/6GdkNpm8V7azrtR.png" alt="image.png"></p><p>æ€»çš„æ¥è¯´ Deno æ¯” Go æ…¢äº† 30% å·¦å³ï¼Œä½† CPU å æœ‰ç‡æ¯” Go æ›´å°‘ï¼ŒGo çš„å†…å­˜å ç”¨æ›´ä½ã€‚</p><blockquote><p>è¿™ä¸ªå¯¹æ¯”å°±å›¾ä¸€ä¹ã€‚</p></blockquote><h2 id="Top-7-Spring-Boot-Design-Patterns-Unveiled-by-Dharmendra-Awasthi-Dec-2023-Stackademic"><a href="#Top-7-Spring-Boot-Design-Patterns-Unveiled-by-Dharmendra-Awasthi-Dec-2023-Stackademic" class="headerlink" title="Top 7 Spring Boot Design Patterns Unveiled | by Dharmendra Awasthi | Dec, 2023 | Stackademic"></a>Top 7 Spring Boot Design Patterns Unveiled | by Dharmendra Awasthi | Dec, 2023 | Stackademic</h2><p>URL: <a href="https://blog.stackademic.com/top-7-spring-boot-design-patterns-unveiled-4a2569f8d324">https://blog.stackademic.com/top-7-spring-boot-design-patterns-unveiled-4a2569f8d324</a></p><blockquote><p>7 ä¸ªæˆ‘ä»¬å¯ä»¥å­¦ä¹ çš„ Spring Boot çš„è®¾è®¡æ¨¡å¼</p></blockquote><h3 id="Singleton-Pattern-å•ä¾‹æ¨¡å¼"><a href="#Singleton-Pattern-å•ä¾‹æ¨¡å¼" class="headerlink" title="Singleton Pattern å•ä¾‹æ¨¡å¼"></a><code>Singleton Pattern</code> å•ä¾‹æ¨¡å¼</h3><p>è¿™ä¸ªæ²¡å•¥å¥½è¯´çš„ï¼Œé¢è¯•éƒ½è¢«è®²çƒ‚äº†ï¼Œä¾ç„¶å¾ˆç»å…¸ã€‚<br>å½“æˆ‘ä»¬ä½¿ç”¨è¿™äº›æ³¨è§£å£°æ˜ä¸€ä¸ª Bean æ—¶<code>@Component</code>,Â <code>@Service</code>,Â <code>@Repository</code>, orÂ <code>@Controller</code>ï¼Œå°±ä¼šè¢«åˆ›å»ºä¸€ä¸ªå•ä¾‹å¯¹è±¡æ³¨å…¥åˆ° IOC å®¹å™¨ä¸­ã€‚</p><h3 id="Factory-Pattern-å·¥å‚æ¨¡å¼"><a href="#Factory-Pattern-å·¥å‚æ¨¡å¼" class="headerlink" title="Factory Pattern å·¥å‚æ¨¡å¼"></a>Factory Pattern å·¥å‚æ¨¡å¼</h3><p>Spring ä¹Ÿæä¾›äº†å·¥å‚æ¨¡å¼çš„æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰åˆ›å»ºé€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.FactoryBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFactoryBean</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;MyBean&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MyBean <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// Custom logic to create and return MyBean instance</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyBean</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> MyBean.class;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// Or false, depending on your bean&#x27;s scope</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Builder-åˆ›å»ºè€…æ¨¡å¼"><a href="#Builder-åˆ›å»ºè€…æ¨¡å¼" class="headerlink" title="Builder åˆ›å»ºè€…æ¨¡å¼"></a>Builder åˆ›å»ºè€…æ¨¡å¼</h3><p>è¿™ä¸ªå…¶å®ä¸ç®—æ˜¯ Spring æ‰€æä¾›çš„ï¼Œä½†ç¡®å®å¾ˆå¥½ç”¨ï¼›é€šå¸¸ç”¨äºåˆ›å»ºéœ€è¦å¾ˆå¤šå¯é€‰å‚æ•°çš„å¯¹è±¡æ—¶ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Builder;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="comment">// Other fields</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> User.builder()</span><br><span class="line">    .username(<span class="string">&quot;john_doe&quot;</span>)</span><br><span class="line">    .email(<span class="string">&quot;john@example.com&quot;</span>)</span><br><span class="line">    .age(<span class="number">30</span>)</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure><h3 id="Proxy-ä»£ç†æ¨¡å¼"><a href="#Proxy-ä»£ç†æ¨¡å¼" class="headerlink" title="Proxy ä»£ç†æ¨¡å¼"></a>Proxy ä»£ç†æ¨¡å¼</h3><p>ä»£ç†æ¨¡å¼åœ¨ spring ä¸­é€šå¸¸ç”¨äº AOP åˆ‡é¢ï¼Œå¯ä»¥å®ç°ä¸€äº›é€šç”¨çš„éä¸šåŠ¡é€»è¾‘åŠŸèƒ½ï¼›æ¯”å¦‚æ—¥å¿—ã€ç¼“å­˜ã€å®‰å…¨æ£€æµ‹ç­‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoggingAspect</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.example.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeServiceMethods</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Logic to be executed before service methods</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Logging before service methods...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Observe-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#Observe-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="Observe è§‚å¯Ÿè€…æ¨¡å¼"></a>Observe è§‚å¯Ÿè€…æ¨¡å¼</h3><p>æœ¬è´¨ä¸Šæ˜¯å°†ä¸šåŠ¡è§£è€¦ï¼Œç”Ÿäº§è€…å‘å¸ƒäº‹ä»¶ï¼Œè®¢é˜…è€…æ¥æ”¶äº‹ä»¶ï¼Œåªæ˜¯ spring å¸®æˆ‘ä»¬å°è£…å¥½äº†é€»è¾‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderPlacedEvent</span> <span class="keyword">extends</span> <span class="title class_">ApplicationEvent</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Order order;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OrderPlacedEvent</span><span class="params">(Object source, Order order)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(source);</span><br><span class="line">        <span class="built_in">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getters for order information</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationEventPublisher;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ApplicationEventPublisher eventPublisher;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OrderService</span><span class="params">(ApplicationEventPublisher eventPublisher)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.eventPublisher = eventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">placeOrder</span><span class="params">(Order order)</span> &#123;</span><br><span class="line">        <span class="comment">// Logic to place order</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Publish OrderPlacedEvent</span></span><br><span class="line">        eventPublisher.publishEvent(<span class="keyword">new</span> <span class="title class_">OrderPlacedEvent</span>(<span class="built_in">this</span>, order));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.event.EventListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmailService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendEmailOnOrderPlacement</span><span class="params">(OrderPlacedEvent event)</span> &#123;</span><br><span class="line">        <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> event.getOrder();</span><br><span class="line">        <span class="comment">// Logic to send email based on the placed order</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è½¬è½¬ä¸€ä½“åŒ–ç›‘æ§ç³»ç»Ÿâ€”â€”PrometheusÂ·Grafanaæˆæœ¬æ²»ç†-TakinTalksç¨³å®šæ€§æŠ€æœ¯äº¤æµå¹³å°"><a href="#è½¬è½¬ä¸€ä½“åŒ–ç›‘æ§ç³»ç»Ÿâ€”â€”PrometheusÂ·Grafanaæˆæœ¬æ²»ç†-TakinTalksç¨³å®šæ€§æŠ€æœ¯äº¤æµå¹³å°" class="headerlink" title="è½¬è½¬ä¸€ä½“åŒ–ç›‘æ§ç³»ç»Ÿâ€”â€”PrometheusÂ·Grafanaæˆæœ¬æ²»ç†_TakinTalksç¨³å®šæ€§æŠ€æœ¯äº¤æµå¹³å°"></a>è½¬è½¬ä¸€ä½“åŒ–ç›‘æ§ç³»ç»Ÿâ€”â€”PrometheusÂ·Grafanaæˆæœ¬æ²»ç†_TakinTalksç¨³å®šæ€§æŠ€æœ¯äº¤æµå¹³å°</h2><p>URL: <a href="https://news.shulie.io/?p=8229">https://news.shulie.io/?p=8229</a><br><img src="https://s2.loli.net/2023/12/29/WSl4PQDKh9g3Hiu.png" alt="image.png"></p><p>é“¾æ¥é‡Œæœ‰ B ç«™è§†é¢‘ï¼Œæ–‡å­—ç‰ˆé“¾æ¥ï¼š<a href="https://mp.weixin.qq.com/s/FySeVBL7EfihOlNDBvAPpw">https://mp.weixin.qq.com/s/FySeVBL7EfihOlNDBvAPpw</a></p><blockquote><p>è½¬è½¬çš„ç›‘æ§æ–¹æ¡ˆ</p></blockquote><ul><li>åŸºäº Prometheus æ¶æ„ï¼ˆç¡®å®å·²ç»æ˜¯ç›‘æ§é¢†åŸŸçš„æ ‡å‡†äº†ï¼‰</li><li>ä½¿ç”¨ <strong>M3DB</strong> æ›¿æ¢äº†å•æœºçš„ Prometheusã€‚<ul><li>æˆ‘ä»¬ä½¿ç”¨ VM æ›¿æ¢çš„ Prometheusï¼Œè½¬è½¬æ²¡æœ‰é€‰æ‹© VM æ˜¯å› ä¸º M3DB çš„å‹ç¼©ç‡æ›´é«˜ã€‚</li></ul></li><li>é‡‡ç”¨ Push æ¨¡å‹æ¨é€æ•°æ®<ul><li>ç”± SDK è¿›è¡Œæ¨é€ï¼Œå¯¹ä¸šåŠ¡æ— æ„ŸçŸ¥</li><li>çœç•¥äº†æ³¨å†Œä¸­å¿ƒï¼Œæ”¹ä¸ºäº†æ•°æ®åº“å­˜å‚¨æœåŠ¡èŠ‚ç‚¹ä¿¡æ¯ã€‚<ul><li>ç”±äºæˆ‘ä»¬ä½¿ç”¨äº† <code>kubernetes</code>ï¼Œæ‰€ä»¥æ˜¯åŸºäº kubernetes çš„ SD å®ç°çš„æœåŠ¡å‘ç°ã€‚</li><li>æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨çš„ä¹Ÿæ˜¯ Pull æ‹‰å–æ¨¡å‹</li></ul></li></ul></li><li>é‡å†™äº†å‘Šè­¦ç³»ç»Ÿï¼ŒPrometheus è‡ªå¸¦çš„å‘Šè­¦ç³»ç»Ÿå­˜åœ¨å­¦ä¹ éš¾åº¦å¤§ç­‰é—®é¢˜ã€‚</li></ul><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://medium.com/deno-the-complete-reference/deno-vs-go-native-hello-world-performance-c57d8fc13c75">https://medium.com/deno-the-complete-reference/deno-vs-go-native-hello-world-performance-c57d8fc13c75</a></li><li><a href="https://blog.stackademic.com/top-7-spring-boot-design-patterns-unveiled-4a2569f8d324">https://blog.stackademic.com/top-7-spring-boot-design-patterns-unveiled-4a2569f8d324</a></li><li><a href="https://news.shulie.io/?p=8229">https://news.shulie.io/?p=8229</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/29/t1FmIn4i6HAOoDB.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>Pulsar3.0 å‡çº§æŒ‡åŒ—</title>
    <link href="http://crossoverjie.top/2023/12/24/ob/Pulsar3.0-upgrade/"/>
    <id>http://crossoverjie.top/2023/12/24/ob/Pulsar3.0-upgrade/</id>
    <published>2023-12-24T09:08:27.000Z</published>
    <updated>2023-12-28T02:14:11.229Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/12/24/4EVJDOaxl1WI3j9.png" alt="Pulsar3.0-upgrade.png"></p><h1 id="Pulsar3-0-ä»‹ç»"><a href="#Pulsar3-0-ä»‹ç»" class="headerlink" title="Pulsar3.0 ä»‹ç»"></a>Pulsar3.0 ä»‹ç»</h1><p>Pulsar3.0 æ˜¯ Pulsar ç¤¾åŒºæ¨å‡ºçš„ç¬¬ä¸€ä¸ª LTS é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚</p><p><img src="https://s2.loli.net/2023/12/22/RL2AvFCQiIseMxH.png" alt="image.png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼ŒLTS ç‰ˆæœ¬ä¼šæœ€é•¿æ”¯æŒåˆ° 36 ä¸ªæœˆï¼Œè€Œ Feature ç‰ˆæœ¬æœ€å¤šåªæœ‰å…­ä¸ªæœˆï¼›ç±»ä¼¼äºæˆ‘ä»¬ä½¿ç”¨çš„ <code>JDK11,17,21</code> éƒ½æ˜¯å¯ä»¥é•¿æœŸä½¿ç”¨çš„ï¼›æ‰€ä»¥ä¹Ÿæ¨èå¤§å®¶éƒ½å‡çº§åˆ° LTS ç‰ˆæœ¬ã€‚</p><hr><p>ä½œä¸ºé¦–ä¸ª LTS ç‰ˆæœ¬ï¼Œ3.0 è‡ªç„¶ä¹Ÿæ˜¯è‡ªå¸¦äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œè¿™ä¸ªä¼šåœ¨åç»­ä»‹ç»ã€‚</p><span id="more"></span><h1 id="å‡çº§æŒ‡å—"><a href="#å‡çº§æŒ‡å—" class="headerlink" title="å‡çº§æŒ‡å—"></a>å‡çº§æŒ‡å—</h1><p>å…ˆæ¥çœ‹çœ‹å‡çº§æŒ‡å—ï¼š<br><img src="https://s2.loli.net/2023/12/24/ZAc2845LvhsBHfx.png" alt="image.png"><br>åœ¨å®˜æ–¹çš„å…¼å®¹è¡¨ä¸­ä¼šå‘ç°ï¼šä¸æ¨èè·¨ç‰ˆæœ¬å‡çº§ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ ç°åœ¨è¿˜åœ¨ä½¿ç”¨çš„æ˜¯ 2.10.xï¼Œé‚£ä¹ˆæ¨èæ˜¯å…ˆå‡çº§åˆ° 2.11.x ç„¶åå†å‡çº§åˆ° 3.0.x.</p><p>è€Œä¸”æ ¹æ®æˆ‘ä»¬çš„ä½¿ç”¨ç»éªŒæ¥çœ‹ï¼Œé¦–ä¸ªç‰ˆæœ¬æ˜¯ä¸ä¿é™©çš„ï¼Œå³ä¾¿æ˜¯ LTS ç‰ˆæœ¬ï¼›<br>æ‰€ä»¥ä¸æ¨èç›´æ¥å‡çº§åˆ° 3.0.0ï¼Œè€Œæ˜¯æ›´æ¨è 3.0.1+ï¼Œè¿™ä¸ªå°ç‰ˆæœ¬ä¼šä¿®å¤ 3.0 æ‰€å¸¦æ¥çš„ä¸€äº› bugã€‚</p><p>å…ˆè®²ä¸€ä¸‹æˆ‘ä»¬çš„å‡çº§æµç¨‹ï¼Œå¤§å®¶å¯ä»¥ç”¨åšå‚è€ƒã€‚</p><h2 id="å‡çº§å‰å‡†å¤‡"><a href="#å‡çº§å‰å‡†å¤‡" class="headerlink" title="å‡çº§å‰å‡†å¤‡"></a>å‡çº§å‰å‡†å¤‡</h2><p>æ ¹æ®æˆ‘ä»¬çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸ºäº†ä»¥é˜²ä¸‡ä¸€ï¼Œé¦–å…ˆéœ€è¦å°†æˆ‘ä»¬çš„æ’ä»¶ä¾èµ–å‡çº§åˆ°å¯¹åº”çš„ç‰ˆæœ¬ã€‚<br><img src="https://s2.loli.net/2023/12/24/8NzRJUrBWqKPkm9.png" alt="image.png"><br>å…¶å®ç®€å•æ¥è¯´å°±æ˜¯æ›´æ–°ä¸‹ä¾èµ–ï¼Œç„¶åå†é‡æ–°æ‰“åŒ…ï¼Œåœ¨åç»­çš„æµç¨‹è¿›è¡Œæµ‹è¯•ã€‚</p><h3 id="é¢„çƒ­é•œåƒ"><a href="#é¢„çƒ­é•œåƒ" class="headerlink" title="é¢„çƒ­é•œåƒ"></a>é¢„çƒ­é•œåƒ</h3><p>ä¹‹åæ˜¯é¢„çƒ­é•œåƒï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>harbor</code> æ­å»ºäº†è‡ªå·±çš„ docker é•œåƒä»“åº“ï¼Œè¿™æ ·åœ¨å‡çº§é‡å¯é•œåƒçš„æ—¶å€™å¯ä»¥æ›´å¿«çš„ä»å†…ç½‘æ‹‰å–é•œåƒã€‚</p><blockquote><p>æ¯•ç«Ÿä¸€ä¸ª pulsar-all çš„é•œåƒä¹Ÿä¸å°ï¼Œå°½é‡çš„ç¼©çŸ­å¯åŠ¨æ—¶é—´ã€‚</p></blockquote><p>é¢„çƒ­çš„è¿‡ç¨‹ä¹Ÿå¾ˆç®€å•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker pull apachepulsar/pulsar-all:3.0.1</span><br><span class="line"></span><br><span class="line">docker tag apachepulsar/pulsar-all:3.0.1 harbor-private.xx.com/pulsar/pulsar-all:3.0.1</span><br><span class="line"></span><br><span class="line">docker image push harbor-private.xx.com/pulsar/pulsar-all:3.0.1</span><br></pre></td></tr></table></figure><p>ä¹‹åå‡çº§çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ç§æœçš„é•œåƒäº†ã€‚</p><h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p>æˆ‘è¿™è¾¹æœ‰å†™äº†ä¸€ä¸ª <code>cli</code> å¯ä»¥å¸®æˆ‘å¿«é€Ÿåˆ›å»ºæˆ–å‡çº§ä¸€ä¸ªé›†ç¾¤ï¼Œç„¶åè§¦å‘æˆ‘æ‰€ç¼–å†™çš„åŠŸèƒ½æµ‹è¯•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pulsar-upgrade-cli upgrade pulsar-test ./charts/pulsar --version x.x.x -f charts/pulsar/values.yaml -n pulsar-test</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª cli å¾ˆç®€å•ï¼Œä¸€å…±å°±åšä¸‰ä»¶äº‹ï¼š</p><ul><li>ä½¿ç”¨ helm æ¥å£å‡çº§é›†ç¾¤</li><li>ç­‰å¾…æ‰€æœ‰çš„ Pod éƒ½å‡çº§æˆåŠŸ</li><li>è§¦å‘åŠŸèƒ½æµ‹è¯•</li></ul><p>ä¹‹åçš„æ•ˆæœå¦‚ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/12/24/m85XPGr9nLqtp17.png" alt="image.png"></p><p>ä¸»è¦å°±æ˜¯è¦†ç›–äº†æˆ‘ä»¬çš„ä½¿ç”¨åœºæ™¯ï¼Œéƒ½è·‘é€šè¿‡ä¹‹åæ‰ä¼šèµ°åç»­çš„æµç¨‹ã€‚</p><h2 id="è¿è¡Œç›‘æ§"><a href="#è¿è¡Œç›‘æ§" class="headerlink" title="è¿è¡Œç›‘æ§"></a>è¿è¡Œç›‘æ§</h2><p><img src="https://s2.loli.net/2023/12/24/2iDHdwPB4UJXsGh.png" alt="image.png"></p><p>ä¹‹åä¼šå¯åŠ¨ä¸€ä¸ª 200 å·¦å³çš„å¹¶å‘ç”Ÿäº§å’Œæ¶ˆè´¹æ•°æ®ï¼Œæ¨¡æ‹Ÿçº¿ä¸Šçš„ä½¿ç”¨æƒ…å†µï¼Œä¼šä¸€ç›´è®©è¿™ä¸ªä»»åŠ¡è·‘ç€ï¼Œå¤§æ¦‚ä¸€æ™šä¸Šå°±å¯ä»¥äº†ï¼Œç¬¬äºŒå¤©é€šè¿‡ç›‘æ§æŸ¥çœ‹ï¼š</p><ul><li>åº”ç”¨æœ‰æ— å¼‚å¸¸æ—¥å¿—</li><li>æµé‡æ˜¯å¦æ­£å¸¸</li><li>å„ä¸ªç»„ä»¶çš„å†…å­˜å ç”¨</li><li>å†™å…¥å»¶è¿Ÿç­‰ä¿¡æ¯</li></ul><h2 id="å‡çº§æ­¥éª¤"><a href="#å‡çº§æ­¥éª¤" class="headerlink" title="å‡çº§æ­¥éª¤"></a>å‡çº§æ­¥éª¤</h2><p>ç»„ä»¶çš„å‡çº§æ­¥éª¤è¿™é‡Œå‚è€ƒäº†å®˜æ–¹æŒ‡å—ï¼š<br><a href="https://pulsar.apache.org/docs/3.1.x/administration-upgrade/#upgrade-zookeeper-optional">https://pulsar.apache.org/docs/3.1.x/administration-upgrade/#upgrade-zookeeper-optional</a><br><img src="https://s2.loli.net/2023/12/24/9dXxSTOwb8lFm1v.png" alt="image.png"></p><ul><li>å‡çº§ZK</li><li>å…³é—­auto recovery</li><li>å‡çº§Bookkeeper</li><li>å‡çº§Broker</li><li>å‡çº§Proxy</li><li>å¼€å¯auto recovery</li></ul><p>åªè¦ä¸€æ­¥æ­¥æŒ‰ç…§è¿™ä¸ªæµç¨‹èµ°ï¼Œé—®é¢˜ä¸å¤§ï¼Œå“ªä¸€æ­¥å‡ºç°é—®é¢˜åéœ€è¦åŠæ—¶å›æ»šï¼Œå›æ»šæµç¨‹å‚è€ƒä¸‹é¢çš„å›æ»šéƒ¨åˆ†ã€‚</p><p>åŒæ—¶åœ¨å‡çº§è¿‡ç¨‹ä¸­éœ€è¦ä¸€ç›´æŸ¥çœ‹ broker çš„ error æ—¥å¿—ï¼Œå¦‚æœæœ‰æ˜æ˜¾çš„ä¸ç¬¦åˆé¢„æœŸçš„æ—¥å¿—ä¸€å®šè¦æ³¨æ„ã€‚</p><blockquote><p>åœ¨å‡çº§  bookkeeper çš„æ—¶å€™ï¼Œbroker å¯èƒ½ä¼šå‡ºç° bk è¿æ¥å¤±è´¥çš„å¼‚å¸¸ï¼Œè¿™ä¸ªå¯ä»¥ä¸ç”¨åœ¨æ„ã€‚</p></blockquote><h2 id="çº¿ä¸ŠéªŒè¯"><a href="#çº¿ä¸ŠéªŒè¯" class="headerlink" title="çº¿ä¸ŠéªŒè¯"></a>çº¿ä¸ŠéªŒè¯</h2><p>éƒ½å‡çº§å®Œåå°±æ˜¯çº¿ä¸Šä¸šåŠ¡éªŒè¯ç¯èŠ‚äº†ï¼š</p><ul><li><input checked="" disabled="" type="checkbox"> æŸ¥çœ‹ç›‘æ§é¢æ¿ï¼Œæ˜¯å¦æœ‰æ˜æ˜¾çš„æµé‡ã€å†…å­˜ã€å»¶è¿Ÿçš„å¼‚å¸¸æŒ‡æ ‡ã€‚ âœ… 2023-12-24</li><li><input checked="" disabled="" type="checkbox"> topic å…ƒæ•°æ®å®Œæ•´æ€§éªŒè¯ï¼šè¿™ä¸ªæ˜¯å› ä¸ºæˆ‘ä»¬è¿™æ¬¡å‡çº§å‡ºäº†ä¸€ä¸ª topic è¢«åˆ é™¤çš„ bugï¼Œæ‰€ä»¥éœ€è¦é‡ç‚¹éªŒè¯ä¸‹ï¼›è¿™éƒ¨åˆ†ä¼šåœ¨ä¸‹æ¬¡è¯¦ç»†åˆ†æã€‚ âœ… 2023-12-24</li><li><input checked="" disabled="" type="checkbox"> æŸ¥çœ‹ä¸šåŠ¡æ¶ˆæ¯æ”¶å‘æœ‰æ— å¼‚å¸¸ âœ… 2023-12-24</li><li><input checked="" disabled="" type="checkbox"> é“¾è·¯æŸ¥è¯¢æ˜¯å¦æ­£å¸¸ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¶ˆæ¯é“¾è·¯æŸ¥è¯¢çš„é¡µé¢ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ <code>Pulsar-SQL</code> å’Œ <code>broker-interceptor</code> å®ç°çš„ã€‚ âœ… 2023-12-24</li></ul><h2 id="å¼‚å¸¸å›æ»š"><a href="#å¼‚å¸¸å›æ»š" class="headerlink" title="å¼‚å¸¸å›æ»š"></a>å¼‚å¸¸å›æ»š</h2><p>å½“å‡ºç°å¼‚å¸¸çš„æ—¶å€™éœ€è¦ç«‹å³å›æ»šï¼Œè¿™é‡Œçš„å¼‚å¸¸ä¸€èˆ¬å°±æ˜¯æ¶ˆæ¯æ”¶å‘å¼‚å¸¸ï¼Œå®¢æˆ·ç«¯æ‰çº¿ç­‰ã€‚</p><p>ç»è¿‡æˆ‘çš„æµ‹è¯• 3.0.x çš„å­˜å‚¨å’Œä¹‹å‰çš„ç‰ˆæœ¬æ˜¯å…¼å®¹çš„ï¼Œæ‰€ä»¥ <code>bookkeeper</code> éƒ½èƒ½é™çº§å…¶ä»–çš„ç»„ä»¶å°±æ²¡å•¥å¯æ‹…å¿ƒçš„äº†ã€‚</p><p>éœ€è¦é™çº§æ—¶ç›´æ¥å°†æ‰€æœ‰ç»„ä»¶é™çº§ä¸ºä¸Šä¸€ä¸ªç‰ˆæœ¬å³å¯ã€‚</p><h2 id="ç¾éš¾æ¢å¤"><a href="#ç¾éš¾æ¢å¤" class="headerlink" title="ç¾éš¾æ¢å¤"></a>ç¾éš¾æ¢å¤</h2><p>å› ä¸ºæ˜¯ä» 2.x å‡çº§åˆ° 3.x ä¹Ÿæ˜¯æ¶‰åŠåˆ°äº†è·¨å¤§ç‰ˆæœ¬ï¼Œæ‰€ä»¥ä¹Ÿå‡†å¤‡äº†ç¾éš¾æ¢å¤çš„æ–¹æ¡ˆã€‚</p><blockquote><p>æ¯”å¦‚æç«¯æƒ…å†µä¸‹å‡çº§å¤±è´¥ï¼Œæ‰€æœ‰æ•°æ®ä¸¢å¤±çš„æƒ…å†µã€‚</p></blockquote><p>æ•´ä¸ªç¾éš¾æ¢å¤çš„ä¸»è¦ç›®çš„å°±æ˜¯æ¢å¤åçš„é›†ç¾¤å¯¹å¤–æä¾›çš„åŸŸåä¸å‘ç”Ÿå˜åŒ–ï¼ŒåŒæ—¶æ‰€æœ‰çš„å®¢æˆ·ç«¯å¯ä»¥è‡ªåŠ¨é‡è¿ä¸Šæ¥ï¼Œä¹Ÿå°±æ˜¯æœ€åçš„æƒ…å†µä¸‹æ‰€æœ‰çš„æ•°æ®ä¸¢äº†å¯ä»¥æ¥å—ï¼Œä½†ä¸èƒ½å½±å“ä¸šåŠ¡æ­£å¸¸ä½¿ç”¨ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬çš„æµç¨‹å¦‚ä¸‹ï¼š</p><h3 id="å¤‡ä»½-topic"><a href="#å¤‡ä»½-topic" class="headerlink" title="å¤‡ä»½ topic"></a>å¤‡ä»½ topic</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SneakyThrows</span>  </span><br><span class="line"><span class="meta">@Test</span>  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">backup</span><span class="params">()</span>&#123;  </span><br><span class="line">    List&lt;String&gt; topicList = pulsarAdmin.topics().getPartitionedTopicList(<span class="string">&quot;tenant/namespace&quot;</span>);  </span><br><span class="line">    log.info(<span class="string">&quot;topic size=&#123;&#125;&quot;</span>,topicList.size());  </span><br><span class="line">    <span class="comment">// create a custom thread pool  </span></span><br><span class="line">    CopyOnWriteArrayList&lt;TopicMeta&gt; dataList = <span class="keyword">new</span> <span class="title class_">CopyOnWriteArrayList</span>&lt;&gt;();  </span><br><span class="line">    <span class="type">ExecutorService</span> <span class="variable">customThreadPool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">10</span>);  </span><br><span class="line">    <span class="keyword">for</span> (String topicName : topicList) &#123;  </span><br><span class="line">        customThreadPool.execute(()-&gt; &#123;  </span><br><span class="line">            PartitionedTopicMetadata metadata;  </span><br><span class="line">            <span class="keyword">try</span> &#123;  </span><br><span class="line">                metadata = pulsarAdmin.topics().getPartitionedTopicMetadata(topicName);  </span><br><span class="line">                <span class="type">TopicMeta</span> <span class="variable">topicMeta</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TopicMeta</span>();  </span><br><span class="line">  </span><br><span class="line">                <span class="comment">// backup topic  </span></span><br><span class="line">                topicMeta.setName(topicName);  </span><br><span class="line">                topicMeta.setPartition(metadata.partitions);  </span><br><span class="line">  </span><br><span class="line">                <span class="comment">// backup permission  </span></span><br><span class="line">                Map&lt;String, Set&lt;AuthAction&gt;&gt; permissions = pulsarAdmin.topics().getPermissions(topicName);  </span><br><span class="line">                topicMeta.setPermissions(permissions);  </span><br><span class="line">  </span><br><span class="line">                <span class="comment">// back sub  </span></span><br><span class="line">                List&lt;String&gt; subscriptions = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">                <span class="type">PartitionedTopicStats</span> <span class="variable">topicStats</span> <span class="operator">=</span> pulsarAdmin.topics().getPartitionedStats(topicName, <span class="literal">true</span>);  </span><br><span class="line">                topicStats.getSubscriptions().forEach((k,v)-&gt; subscriptions.add(k));  </span><br><span class="line">                topicMeta.setSubscriptions(subscriptions);  </span><br><span class="line">  </span><br><span class="line">                dataList.add(topicMeta);  </span><br><span class="line">            &#125; <span class="keyword">catch</span> (PulsarAdminException e) &#123;  </span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);  </span><br><span class="line">            &#125;        &#125;);    &#125;  </span><br><span class="line">    customThreadPool.shutdown();  </span><br><span class="line">    <span class="keyword">while</span> (!customThreadPool.isTerminated()) &#123;  </span><br><span class="line">    &#125;  </span><br><span class="line">    log.info(<span class="string">&quot;&#123;&#125;&quot;</span>,dataList.size());  </span><br><span class="line">    log.info(<span class="string">&quot;&#123;&#125;&quot;</span>,JSONUtil.toJsonStr(dataList));  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// TopicMetaData</span></span><br><span class="line"><span class="meta">@Data</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicMeta</span> &#123;  </span><br><span class="line">    <span class="keyword">private</span> String name;  </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> partition;  </span><br><span class="line">    Map&lt;String, Set&lt;AuthAction&gt;&gt; permissions;  </span><br><span class="line">    List&lt;String&gt; subscriptions = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ­¥æ˜¯å¤‡ä»½ topicï¼š</p><ul><li>topic ä¸»è¦æ˜¯åç§°å’Œåˆ†åŒºæ•°é‡</li><li>å¤‡ä»½æƒé™</li><li>å¤‡ä»½ topic çš„è®¢é˜…è€…</li></ul><h3 id="å…¬ç§é’¥å¤‡ä»½"><a href="#å…¬ç§é’¥å¤‡ä»½" class="headerlink" title="å…¬ç§é’¥å¤‡ä»½"></a>å…¬ç§é’¥å¤‡ä»½</h3><p>å› ä¸ºæˆ‘ä»¬å®¢æˆ·ç«¯ä½¿ç”¨äº† JWT éªŒè¯ï¼Œæ‰€æœ‰ä¸ºäº†ä½¿å¾—æ¢å¤çš„ Pulsar é›†ç¾¤å¯ä»¥è®©å®¢æˆ·ç«¯æ— ç¼åˆ‡æ¢åˆ°æ–°é›†ç¾¤ï¼Œå› æ­¤å¿…é¡»å¾—ä½¿ç”¨ç›¸åŒçš„å…¬ç§é’¥ã€‚</p><p>è¿™ä¸ªå…¶å®æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ helm å®‰è£…çš„é›†ç¾¤ï¼Œæ‰€ä»¥åªéœ€è¦å¤‡ä»½å¥½ <code>Secret</code> å³å¯ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span>  </span><br><span class="line"><span class="attr">data:</span>  </span><br><span class="line">  <span class="attr">PRIVATEKEY:</span> <span class="string">XXX</span>  </span><br><span class="line">  <span class="attr">PUBLICKEY:</span> <span class="string">XXX</span> </span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">pulsar-token-asymmetric-key</span>  </span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">pulsar</span>  </span><br><span class="line"><span class="attr">type:</span> <span class="string">Opaque</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿˜æœ‰å‡ ä¸ª superUser çš„ Secret</span></span><br></pre></td></tr></table></figure><h3 id="æ•°æ®æ¢å¤"><a href="#æ•°æ®æ¢å¤" class="headerlink" title="æ•°æ®æ¢å¤"></a>æ•°æ®æ¢å¤</h3><h4 id="åˆ›å»ºæ–°é›†ç¾¤"><a href="#åˆ›å»ºæ–°é›†ç¾¤" class="headerlink" title="åˆ›å»ºæ–°é›†ç¾¤"></a>åˆ›å»ºæ–°é›†ç¾¤</h4><p>é¦–å…ˆä½¿ç”¨ helm é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°é›†ç¾¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./scripts/pulsar/prepare_helm_release.sh -n pulsar -k pulsar</span><br><span class="line"></span><br><span class="line">helm install \    --values charts/pulsar/values.yaml \    --set namespace=pulsar\  </span><br><span class="line">    --set initialize=true \  </span><br><span class="line">    pulsar ./charts/pulsar -n pulsar</span><br></pre></td></tr></table></figure><h4 id="æ¢å¤å…¬ç§é’¥"><a href="#æ¢å¤å…¬ç§é’¥" class="headerlink" title="æ¢å¤å…¬ç§é’¥"></a>æ¢å¤å…¬ç§é’¥</h4><p>ç›´æ¥ä½¿ç”¨åˆšæ‰å¤‡ä»½çš„å…¬ç§é’¥è¦†ç›–åˆ°æ–°é›†ç¾¤å³å¯ã€‚</p><h4 id="æ¢å¤namespace"><a href="#æ¢å¤namespace" class="headerlink" title="æ¢å¤namespace"></a>æ¢å¤namespace</h4><p>è¿›å…¥ toolset pod åˆ›å»ºéœ€è¦ä½¿ç”¨çš„ <code>tenant/namespace</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">k exec -it pulsar-toolset-0 -n pulsar bash</span><br><span class="line"></span><br><span class="line">bin/pulsar-admin tenants create tenant</span><br><span class="line"></span><br><span class="line">bin/pulsar-admin namespaces create tenant/namespace</span><br></pre></td></tr></table></figure><h4 id="å…ƒæ•°æ®æ¢å¤"><a href="#å…ƒæ•°æ®æ¢å¤" class="headerlink" title="å…ƒæ•°æ®æ¢å¤"></a>å…ƒæ•°æ®æ¢å¤</h4><p>ä¹‹åä¾¿æ˜¯æœ€é‡è¦çš„å…ƒæ•°æ®æ¢å¤äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SneakyThrows</span>  </span><br><span class="line"><span class="meta">@Test</span>  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">restore</span><span class="params">()</span> &#123;  </span><br><span class="line">    <span class="type">PulsarAdmin</span> <span class="variable">pulsarAdmin</span> <span class="operator">=</span> PulsarAdmin.builder().serviceHttpUrl(<span class="string">&quot;http://url:8080&quot;</span>)  </span><br><span class="line">            .authentication(AuthenticationFactory.token(token))  </span><br><span class="line">            .build();  </span><br><span class="line">    <span class="type">Path</span> <span class="variable">filePath</span> <span class="operator">=</span> Path.of(<span class="string">&quot;restore-ns.json&quot;</span>);  </span><br><span class="line">    <span class="type">String</span> <span class="variable">fileContent</span> <span class="operator">=</span> Files.readString(filePath);  </span><br><span class="line">    List&lt;TopicMeta&gt; topicMetaList = JSON.parseArray(fileContent, TopicMeta.class);  </span><br><span class="line">    <span class="type">ExecutorService</span> <span class="variable">customThreadPool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">50</span>);  </span><br><span class="line">    <span class="keyword">for</span> (TopicMeta topicMeta : topicMetaList) &#123;  </span><br><span class="line">        customThreadPool.execute(() -&gt; &#123;  </span><br><span class="line">            <span class="comment">// Create topic  </span></span><br><span class="line">            <span class="keyword">try</span> &#123;  </span><br><span class="line">                pulsarAdmin.topics().createPartitionedTopic(topicMeta.getName(), topicMeta.getPartition());  </span><br><span class="line">            &#125; <span class="keyword">catch</span> (PulsarAdminException e) &#123;  </span><br><span class="line">                log.error(<span class="string">&quot;Create topic error&quot;</span>);  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="comment">// Create sub  </span></span><br><span class="line">            <span class="keyword">for</span> (String subscription : topicMeta.getSubscriptions()) &#123;  </span><br><span class="line">                <span class="keyword">try</span> &#123;  </span><br><span class="line">                    pulsarAdmin.topics().createSubscription(topicMeta.getName(), subscription, MessageId.latest);  </span><br><span class="line">                &#125; <span class="keyword">catch</span> (PulsarAdminException e) &#123;  </span><br><span class="line">                    log.error(<span class="string">&quot;createSubscription error&quot;</span>);  </span><br><span class="line">                &#125;            &#125;  </span><br><span class="line">            <span class="comment">// Grant permission  </span></span><br><span class="line">            topicMeta.getPermissions().forEach((role, authActions) -&gt; &#123;  </span><br><span class="line">                permission(pulsarAdmin, topicMeta.getName(), role, authActions);  </span><br><span class="line">            &#125;);  </span><br><span class="line">            log.info(<span class="string">&quot;topic:&#123;&#125; restore success&quot;</span>, topicMeta.getName());  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">        &#125;);    &#125;  </span><br><span class="line">    customThreadPool.shutdown();  </span><br><span class="line">    <span class="keyword">while</span> (!customThreadPool.isTerminated()) &#123;  </span><br><span class="line">    &#125;    log.info(<span class="string">&quot;restore success&quot;</span>);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">permission</span><span class="params">(PulsarAdmin pulsarAdmin, String topic, String role, Set&lt;AuthAction&gt; authActions)</span> &#123;  </span><br><span class="line">    <span class="keyword">try</span> &#123;  </span><br><span class="line">        pulsarAdmin.topics().grantPermission(topic, role, authActions);  </span><br><span class="line">    &#125; <span class="keyword">catch</span> (PulsarAdminException e) &#123;  </span><br><span class="line">        log.error(<span class="string">&quot;grantPermission error&quot;</span>, e);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµç¨‹å’Œå¤‡ä»½ç±»ä¼¼ï¼š</p><ul><li>åˆ›å»ºåˆ†åŒº topic</li><li>åˆ›å»ºè®¢é˜…è€…</li><li>æˆæƒè§’è‰²ä¿¡æ¯</li></ul><p>å› ä¸ºæˆæƒæ¥å£é™åˆ¶äº†å¹¶å‘è°ƒç”¨ï¼Œæ‰€æœ‰éœ€è¦åŠ é”ï¼Œå¯¼è‡´æ•´ä¸ªæ¢å¤çš„æµç¨‹å°±ä¼šæ¯”è¾ƒæ…¢ã€‚</p><p>8000 topic çš„ namespace å¤§æ¦‚æ¢å¤æ—¶é—´ä¸º 40min å·¦å³ã€‚</p><p>ä¹‹åä¾æ¬¡æ¢å¤å…¶ä»– namespace å³å¯ã€‚</p><h4 id="æ¢å¤-police"><a href="#æ¢å¤-police" class="headerlink" title="æ¢å¤ police"></a>æ¢å¤ police</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin.namespaces().setNamespaceMessageTTL(<span class="string">&quot;tenant/namespace&quot;</span>, <span class="number">3600</span> * <span class="number">6</span>);</span><br><span class="line">admin.namespaces().setBacklogQuota(<span class="string">&quot;tenant/namespace&quot;</span>,Â BacklogQuota)</span><br></pre></td></tr></table></figure><p>å¦‚æœä¹‹å‰çš„é›†ç¾¤æœ‰è®¾ç½® TTL æˆ–è€…æ˜¯ backlogQuota æ—¶éƒ½éœ€è¦æ‰‹åŠ¨æ¢å¤ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä»¥ä¸Šå°±æ˜¯æ•´ä¸ªå‡çº§å’Œç¾éš¾æ¢å¤çš„æµç¨‹ï¼Œå½“ç„¶ç¾éš¾æ¢å¤å¸Œæœ›å¤§å®¶ä¸è¦ç¢°åˆ°ã€‚</p><p>æˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡è¯¦ç»†ä»‹ç» <code>Pulsar 3.0</code> çš„æ–°åŠŸèƒ½ä»¥åŠæ‰€ç¢°åˆ°çš„ä¸€äº›å‘ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/24/4EVJDOaxl1WI3j9.png&quot; alt=&quot;Pulsar3.0-upgrade.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;Pulsar3-0-ä»‹ç»&quot;&gt;&lt;a href=&quot;#Pulsar3-0-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;Pulsar3.0 ä»‹ç»&quot;&gt;&lt;/a&gt;Pulsar3.0 ä»‹ç»&lt;/h1&gt;&lt;p&gt;Pulsar3.0 æ˜¯ Pulsar ç¤¾åŒºæ¨å‡ºçš„ç¬¬ä¸€ä¸ª LTS é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/22/RL2AvFCQiIseMxH.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼ŒLTS ç‰ˆæœ¬ä¼šæœ€é•¿æ”¯æŒåˆ° 36 ä¸ªæœˆï¼Œè€Œ Feature ç‰ˆæœ¬æœ€å¤šåªæœ‰å…­ä¸ªæœˆï¼›ç±»ä¼¼äºæˆ‘ä»¬ä½¿ç”¨çš„ &lt;code&gt;JDK11,17,21&lt;/code&gt; éƒ½æ˜¯å¯ä»¥é•¿æœŸä½¿ç”¨çš„ï¼›æ‰€ä»¥ä¹Ÿæ¨èå¤§å®¶éƒ½å‡çº§åˆ° LTS ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ä½œä¸ºé¦–ä¸ª LTS ç‰ˆæœ¬ï¼Œ3.0 è‡ªç„¶ä¹Ÿæ˜¯è‡ªå¸¦äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œè¿™ä¸ªä¼šåœ¨åç»­ä»‹ç»ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬åä¸€æœŸ</title>
    <link href="http://crossoverjie.top/2023/12/22/ob/newsletter/Newsletter10-20231222/"/>
    <id>http://crossoverjie.top/2023/12/22/ob/newsletter/Newsletter10-20231222/</id>
    <published>2023-12-22T09:28:25.000Z</published>
    <updated>2023-12-23T08:19:14.951Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/12/23/VibnQF1pM2K6fsd.png" alt="image.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><span id="more"></span><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/11/24/ob/newsletter/Newsletter07-20231124/">20231124ï¼šç¬¬ä¸ƒæœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/01/ob/newsletter/Newsletter08-20231201/">20231201ï¼šç¬¬å…«æœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/15/ob/newsletter/Newsletter10-20231215/">20231215ï¼šç¬¬åæœŸ</a><!--more--></li></ul><h2 id="A-Comprehensive-guide-to-Spring-Boot-3-2-with-Java-21-Virtual-Threads-Spring-Security-PostgreSQL-Flyway-Caching-Micrometer-Opentelemetry-JUnit-5-RabbitMQ-Keycloak-Integration-and-More-10-x2F-17-by-Jonathan-Chevalier-Nov-2023-Medium"><a href="#A-Comprehensive-guide-to-Spring-Boot-3-2-with-Java-21-Virtual-Threads-Spring-Security-PostgreSQL-Flyway-Caching-Micrometer-Opentelemetry-JUnit-5-RabbitMQ-Keycloak-Integration-and-More-10-x2F-17-by-Jonathan-Chevalier-Nov-2023-Medium" class="headerlink" title="A Comprehensive guide to Spring Boot 3.2 with Java 21, Virtual Threads, Spring Security, PostgreSQL, Flyway, Caching, Micrometer, Opentelemetry, JUnit 5, RabbitMQ, Keycloak Integration, and More! (10&#x2F;17) | by Jonathan Chevalier | Nov, 2023 | Medium"></a>A Comprehensive guide to Spring Boot 3.2 with Java 21, Virtual Threads, Spring Security, PostgreSQL, Flyway, Caching, Micrometer, Opentelemetry, JUnit 5, RabbitMQ, Keycloak Integration, and More! (10&#x2F;17) | by Jonathan Chevalier | Nov, 2023 | Medium</h2><p>URL: <a href="https://medium.com/@jojoooo/exploring-a-base-spring-boot-application-with-java-21-virtual-thread-spring-security-flyway-c0fde13c1eca#551c">https://medium.com/@jojoooo/exploring-a-base-spring-boot-application-with-java-21-virtual-thread-spring-security-flyway-c0fde13c1eca#551c</a></p><blockquote><p>æœ¬æ–‡è®²è§£äº†åŸºäºæœ€æ–°çš„ Spring Boot3.2 å’Œ Java 21 æ‰€ä½¿ç”¨åˆ°çš„æŠ€æœ¯æ ˆ</p></blockquote><h3 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h3><p>æ•°æ®åº“ä½¿ç”¨ <code>Postgres15</code> å’Œ flyway æ¥ç®¡ç†æ•°æ®åº“ schema çš„è¿ç§»ã€‚<br><img src="https://s2.loli.net/2023/12/20/nNEkQpBhHfe6VWb.png" alt="image.png"></p><h3 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h3><p>Spring6 å®ç°äº†æ–°çš„ <a href="https://datatracker.ietf.org/doc/html/rfc9457#name-members-of-a-problem-detail">RFC9457</a>è§„èŒƒï¼Œå®ç°ä»¥ä¸‹æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> <span class="keyword">extends</span> <span class="title class_">ResponseEntityExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Process @Valid</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> ResponseEntity&lt;Object&gt; <span class="title function_">handleMethodArgumentNotValid</span><span class="params">(</span></span><br><span class="line"><span class="params">      <span class="meta">@NonNull</span> <span class="keyword">final</span> MethodArgumentNotValidException ex,</span></span><br><span class="line"><span class="params">      <span class="meta">@NonNull</span> <span class="keyword">final</span> HttpHeaders headers,</span></span><br><span class="line"><span class="params">      <span class="meta">@NonNull</span> <span class="keyword">final</span> HttpStatusCode status,</span></span><br><span class="line"><span class="params">      <span class="meta">@NonNull</span> <span class="keyword">final</span> WebRequest request)</span> &#123;</span><br><span class="line">    log.info(ex.getMessage(), ex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> List&lt;ApiErrorDetails&gt; errors = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">final</span> ObjectError err : ex.getBindingResult().getAllErrors()) &#123;</span><br><span class="line">      errors.add(</span><br><span class="line">          ApiErrorDetails.builder()</span><br><span class="line">              .pointer(((FieldError) err).getField())</span><br><span class="line">              .reason(err.getDefaultMessage())</span><br><span class="line">              .build());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ResponseEntity.status(BAD_REQUEST)</span><br><span class="line">        .body(<span class="built_in">this</span>.buildProblemDetail(BAD_REQUEST, <span class="string">&quot;Validation failed.&quot;</span>, errors));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> ProblemDetail <span class="title function_">buildProblemDetail</span><span class="params">(</span></span><br><span class="line"><span class="params">      <span class="keyword">final</span> HttpStatus status, <span class="keyword">final</span> String detail, <span class="keyword">final</span> List&lt;ApiErrorDetails&gt; errors)</span> &#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">final</span> <span class="type">ProblemDetail</span> <span class="variable">problemDetail</span> <span class="operator">=</span></span><br><span class="line">        ProblemDetail.forStatusAndDetail(status, StringUtils.normalizeSpace(detail));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Adds errors fields on validation errors, following RFC 9457 best practices.</span></span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isNotEmpty(errors)) &#123;</span><br><span class="line">      problemDetail.setProperty(<span class="string">&quot;errors&quot;</span>, errors);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> problemDetail;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;about:blank&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Bad Request&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">400</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;detail&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Validation failed.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;instance&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/management/companies&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;errors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;pointer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;name&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;must not be blank&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;pointer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;slug&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;must not be blank&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨å¼‚å¸¸"><a href="#åº”ç”¨å¼‚å¸¸" class="headerlink" title="åº”ç”¨å¼‚å¸¸"></a>åº”ç”¨å¼‚å¸¸</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RootException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Serial</span> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">6378336966214073013L</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> HttpStatus httpStatus;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> List&lt;ApiErrorDetails&gt; errors = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">RootException</span><span class="params">(<span class="meta">@NonNull</span> <span class="keyword">final</span> HttpStatus httpStatus)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">    <span class="built_in">this</span>.httpStatus = httpStatus;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">RootException</span><span class="params">(<span class="meta">@NonNull</span> <span class="keyword">final</span> HttpStatus httpStatus, <span class="keyword">final</span> String message)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(message);</span><br><span class="line">    <span class="built_in">this</span>.httpStatus = httpStatus;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExceptionHandler(RootException.class)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;ProblemDetail&gt; <span class="title function_">rootException</span><span class="params">(<span class="keyword">final</span> RootException ex)</span> &#123;</span><br><span class="line">  log.info(ex.getMessage(), ex);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Uses default message, can be adapted to use ex.getMessage().</span></span><br><span class="line">  <span class="keyword">final</span> <span class="type">ProblemDetail</span> <span class="variable">problemDetail</span> <span class="operator">=</span></span><br><span class="line">      <span class="built_in">this</span>.buildProblemDetail(</span><br><span class="line">          ex.getHttpStatus(), API_DEFAULT_REQUEST_FAILED_MESSAGE, ex.getErrors());</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> ResponseEntity.status(ex.getHttpStatus()).body(problemDetail);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;about:blank&quot;</span>,</span><br><span class="line">    <span class="string">&quot;title&quot;</span>: <span class="string">&quot;Internal Server Error&quot;</span>,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="string">&quot;detail&quot;</span>: <span class="string">&quot;Request failed.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;instance&quot;</span>: <span class="string">&quot;/back-office/hello-world&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼‚å¸¸é™çº§"><a href="#å¼‚å¸¸é™çº§" class="headerlink" title="å¼‚å¸¸é™çº§"></a>å¼‚å¸¸é™çº§</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span></span><br><span class="line"><span class="meta">@ExceptionHandler(Throwable.class)</span></span><br><span class="line"><span class="keyword">public</span> ProblemDetail <span class="title function_">handleAllExceptions</span><span class="params">(<span class="keyword">final</span> Throwable ex, <span class="keyword">final</span> WebRequest request)</span> &#123;</span><br><span class="line">  log.warn(ex.getMessage(), ex);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">this</span>.slack.notify(format(<span class="string">&quot;[API] InternalServerError: %s&quot;</span>, ex.getMessage()));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.buildProblemDetail(HttpStatus.INTERNAL_SERVER_ERROR, API_DEFAULT_ERROR_MESSAGE);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;about:blank&quot;</span>,</span><br><span class="line">    <span class="string">&quot;title&quot;</span>: <span class="string">&quot;Internal Server Error&quot;</span>,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="string">&quot;detail&quot;</span>: <span class="string">&quot;Something went wrong. Please try again later or enter in contact with our service.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;instance&quot;</span>: <span class="string">&quot;/back-office/hello-world&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“æœ‰æ— æ³•å¤„ç†çš„å¼‚å¸¸æ—¶ï¼Œå°±éœ€è¦é…ç½®ä¸€ä¸ªå…œåº•çš„å¼‚å¸¸ã€‚</p><h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CompanyRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;Company, Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="type">String</span> <span class="variable">CACHE_NAME</span> <span class="operator">=</span> <span class="string">&quot;company&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@NonNull</span></span><br><span class="line">  <span class="meta">@Cacheable(value = CACHE_NAME, key = &quot;&#123;&#x27;byId&#x27;, #id&#125;&quot;)</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  Optional&lt;Company&gt; <span class="title function_">findById</span><span class="params">(<span class="meta">@NonNull</span> Long id)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Cacheable(value = CACHE_NAME, key = &quot;&#123;&#x27;bySlug&#x27;, #slug&#125;&quot;)</span></span><br><span class="line">  Optional&lt;Company&gt; <span class="title function_">findBySlug</span><span class="params">(String slug)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Caching(</span></span><br><span class="line"><span class="meta">      evict = &#123;</span></span><br><span class="line"><span class="meta">        @CacheEvict(value = CACHE_NAME, key = &quot;&#123;&#x27;byId&#x27;, #entity.id&#125;&quot;),</span></span><br><span class="line"><span class="meta">        @CacheEvict(value = CACHE_NAME, key = &quot;&#123;&#x27;bySlug&#x27;, #entity.slug&#125;&quot;),</span></span><br><span class="line"><span class="meta">      &#125;)</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  &lt;S <span class="keyword">extends</span> <span class="title class_">Company</span>&gt; <span class="meta">@NonNull</span> S <span class="title function_">save</span><span class="params">(<span class="meta">@NonNull</span> S entity)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * This cache implementation is only valid if the table is not</span></span><br><span class="line"><span class="comment">   * frequently updated since it will clear the cache at every update operation</span></span><br><span class="line"><span class="comment">   * If you want to be more performant you can use something like https://github.com/ms100/cache-as-multi</span></span><br><span class="line"><span class="comment">   * */</span></span><br><span class="line">  <span class="meta">@NonNull</span></span><br><span class="line">  <span class="meta">@CacheEvict(cacheNames = CACHE_NAME, allEntries = true)</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  &lt;S <span class="keyword">extends</span> <span class="title class_">Company</span>&gt; List&lt;S&gt; <span class="title function_">saveAll</span><span class="params">(<span class="meta">@NonNull</span> Iterable&lt;S&gt; entities)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Caching(</span></span><br><span class="line"><span class="meta">      evict = &#123;</span></span><br><span class="line"><span class="meta">        @CacheEvict(value = CACHE_NAME, key = &quot;&#123;&#x27;byId&#x27;, #entity.id&#125;&quot;),</span></span><br><span class="line"><span class="meta">        @CacheEvict(value = CACHE_NAME, key = &quot;&#123;&#x27;bySlug&#x27;, #entity.slug&#125;&quot;),</span></span><br><span class="line"><span class="meta">      &#125;)</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(<span class="meta">@NonNull</span> Company entity)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * This cache implementation is only valid if the table is not</span></span><br><span class="line"><span class="comment">   * frequently updated since it will clear the cache at every delete operation</span></span><br><span class="line"><span class="comment">   * If you want to be more performant you can use something like https://github.com/ms100/cache-as-multi</span></span><br><span class="line"><span class="comment">   * */</span></span><br><span class="line">  <span class="meta">@CacheEvict(cacheNames = CACHE_NAME, allEntries = true)</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">(<span class="meta">@NonNull</span> Iterable&lt;? extends Company&gt; entities)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Spring æä¾›äº†æ ‡å‡†çš„ç¼“å­˜æ¥å£ï¼Œå³ä¾¿æ˜¯åç»­éœ€è¦åˆ‡æ¢åˆ° Redisï¼Œä½¿ç”¨çš„ API å’Œæ³¨è§£éƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚</p><h3 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h3><p>Java21 åæ”¯æŒäº†è™šæ‹Ÿçº¿ç¨‹ï¼Œå‡ ä¹å¯ä»¥æ— é™çš„å®ç°çº¿ç¨‹ï¼Œåœ¨ Spring Boot 3.2 éœ€è¦å•ç‹¬å¼€å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.threads.virtual.enabled</span><br></pre></td></tr></table></figure><h3 id="å¯è§‚æµ‹æ€§"><a href="#å¯è§‚æµ‹æ€§" class="headerlink" title="å¯è§‚æµ‹æ€§"></a>å¯è§‚æµ‹æ€§</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-registry-prometheus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">info,</span> <span class="string">health,</span> <span class="string">prometheus,</span> <span class="string">metrics</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/12/20/Wh3toXGSJV7AU45.png" alt="image.png"></p><blockquote><p>æ³¨æ„åœ¨ç”Ÿæˆç¯å¢ƒä¸è¦æš´éœ²ç®¡ç† API</p></blockquote><h3 id="Trace"><a href="#Trace" class="headerlink" title="Trace"></a>Trace</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bridge-otel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.ttddyy.observation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>datasource-micrometer-spring-boot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;datasource-micrometer.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.opentelemetry<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>opentelemetry-exporter-otlp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;opentelemetry-exporter-otlp.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åŒæ­¥è¯·æ±‚çš„æ—¶å€™æ¯ä¸ªè¯·æ±‚éƒ½ä¼šå¸¦ä¸Š <code>traceId</code> å’Œ <code>spanId</code> ï¼Œå¦‚æœæ˜¯å¼‚æ­¥è¯·æ±‚æ—¶å€™éœ€è¦é…ç½®ï¼š<code>spring.reactor.context-propagation=true</code></p><p>å¦‚æœä½¿ç”¨ <code>@Async</code>æ—¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskExecutorConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Override default SimpleAsyncTaskExecutor to provide context propagation in @Async function</span></span><br><span class="line"><span class="comment">   * */</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="keyword">public</span> TaskExecutor <span class="title function_">simpleAsyncTaskExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">SimpleAsyncTaskExecutor</span> <span class="variable">taskExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleAsyncTaskExecutor</span>();</span><br><span class="line">    taskExecutor.setTaskDecorator(<span class="keyword">new</span> <span class="title class_">ContextPropagatingTaskDecorator</span>());</span><br><span class="line">    <span class="keyword">return</span> taskExecutor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æµ‹è¯•æ—¶å€™å¯ä»¥ä½¿ç”¨ <a href="https://github.com/CtrlSpice/otel-desktop-viewer">Otel Desktop Viewer</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span>  </span><br><span class="line">  <span class="attr">tracing:</span></span><br><span class="line">    <span class="attr">sampling:</span></span><br><span class="line">      <span class="attr">probability:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">otlp:</span></span><br><span class="line">    <span class="attr">tracing:</span></span><br><span class="line">      <span class="attr">endpoint:</span> <span class="string">http://localhost:4317</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/12/20/r8ko5fm1xTFDLc3.png" alt="image.png"></p><h2 id="Rust-Vs-Go-A-Hands-On-Comparison"><a href="#Rust-Vs-Go-A-Hands-On-Comparison" class="headerlink" title="Rust Vs Go: A Hands-On Comparison"></a>Rust Vs Go: A Hands-On Comparison</h2><p>URL: <a href="https://www.shuttle.rs/blog/2023/09/27/rust-vs-go-comparison">https://www.shuttle.rs/blog/2023/09/27/rust-vs-go-comparison</a></p><blockquote><p>åŠ¨æ‰‹æ¯”è¾ƒ Rust å’Œ Go</p></blockquote><p><img src="https://s2.loli.net/2023/12/23/O5frBYd1pPevzXE.png" alt="image.png"></p><p>æœ¬æ–‡æ˜¯é€šè¿‡ç¼–å†™ä¸€ä¸ª web æœåŠ¡æ¥è¿›è¡Œæ¯”è¾ƒçš„ã€‚</p><ul><li>Go æ›´åŠ ç®€å•æ˜“å­¦ï¼ŒåŒæ—¶æ ‡å‡†åº“éå¸¸å¼ºå¤§ï¼Œåªéœ€è¦é…åˆ gin+sqlx è¿™ä¸¤ä¸ªç¬¬ä¸‰æ–¹åº“å°±èƒ½å®ç°ä¸€ä¸ª web æœåŠ¡</li><li>Rustä¹Ÿå¯ä»¥å¿«é€Ÿçš„æ„å»ºä¸€ä¸ªå®‰å…¨çš„ web æœåŠ¡ï¼Œä½†éœ€è¦ä¾èµ–è®¸å¤šç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚http&#x2F;JSON&#x2F;æ¨¡æ¿å¼•æ“&#x2F;æ—¶é—´å¤„ç†ç­‰</li><li>ä½† Rust åœ¨å¼‚å¸¸å¤„ç†æ–¹é¢å¿ƒæ™ºè´Ÿæ‹…æ›´ä½ï¼Œä»£ç æ›´å®¹æ˜“é˜…è¯»ã€‚</li><li>å¦‚æœæ˜¯ä¸€ä¸ªåˆåˆ›å°å›¢é˜Ÿï¼Œä½¿ç”¨ Go çš„ä¸Šæ‰‹éš¾åº¦ç¡®å®æ›´ä½ï¼›</li><li>ä½†å¦‚æœå›¢é˜Ÿæ„¿æ„èŠ±æ—¶é—´æŠ•å…¥åˆ° Rust ä¸­ï¼Œç»“åˆä»–å‡ºè‰²çš„é”™è¯¯å¤„ç†ï¼Œå’Œå¼ºå¤§çš„ç¼–è¯‘æ£€æŸ¥ï¼Œé•¿æ—¶é—´æ¥çœ‹ä¼šå¾—åˆ°æ›´å¥½çš„æ•ˆæœã€‚</li></ul><h2 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Go-è¯­è¨€ï¼ŸGo-è¯­è¨€çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Ÿ-çŸ¥ä¹"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Go-è¯­è¨€ï¼ŸGo-è¯­è¨€çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Ÿ-çŸ¥ä¹" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Go è¯­è¨€ï¼ŸGo è¯­è¨€çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Ÿ - çŸ¥ä¹"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Go è¯­è¨€ï¼ŸGo è¯­è¨€çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Ÿ - çŸ¥ä¹</h2><p>URL: <a href="https://www.zhihu.com/question/21409296/answer/1040884859">https://www.zhihu.com/question/21409296/answer/1040884859</a></p><blockquote><p>å›¾æ–‡å¹¶èŒ‚ï¼Œè®²è§£äº† G-M-P å„è‡ªä¹‹é—´çš„å…³ç³»ï¼Œä»¥åŠè°ƒåº¦æ¨¡å‹ã€‚</p></blockquote><p><img src="https://s2.loli.net/2023/12/23/mpNuQKGijy3d6WC.png" alt="image.png"></p><ul><li>G: <strong>Goroutine</strong>ï¼Œç”¨æˆ·åˆ›å»ºçš„åç¨‹ï¼Œå›¾ä¸­æ¬è¿çš„ç –å¤´ã€‚</li><li>M: <strong>Machine</strong>ï¼ŒOS å†…æ ¸çš„çº¿ç¨‹çš„æŠ½è±¡ï¼Œä»£è¡¨çœŸæ­£æ‰§è¡Œçš„èµ„æºï¼›å¯¹åº”åˆ°å°±æ˜¯å›¾ä¸­çš„åœ°é¼ ï¼Œåœ°é¼ ä¸èƒ½ç”¨æˆ·ç›´æ¥åˆ›å»ºï¼›å¾—æ˜¯ç –å¤´ G å¤ªå¤šï¼Œåœ°é¼  M æœ¬èº«å¤ªå°‘ï¼ŒåŒæ—¶è¿˜æœ‰ç©ºé—²çš„å°è½¦ Pï¼Œæ­¤æ—¶å°±ä¼šä»å…¶ä»–åœ°æ–¹å€Ÿä¸€äº›åœ°é¼  M è¿‡æ¥ç›´åˆ°æŠŠå°è½¦ P ç”¨å®Œä¸ºæ­¢ã€‚</li><li>P: Processor å¤„ç†å™¨ï¼ŒG åªæœ‰ç»‘å®šåˆ° P æ‰èƒ½è¢«è°ƒåº¦ï¼›P æ˜¯å›¾ä¸­çš„å°è½¦ï¼Œç”±ç”¨æˆ·è®¾ç½®çš„ <code>GoMAXPROCS</code> å†³å®šå°è½¦çš„æ•°é‡ã€‚</li></ul><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://blog.canopas.com/golang-14-shorthand-tricks-you-might-not-know-8d8d21954c49">https://blog.canopas.com/golang-14-shorthand-tricks-you-might-not-know-8d8d21954c49</a></li><li><a href="https://medium.com/@jojoooo/exploring-a-base-spring-boot-application-with-java-21-virtual-thread-spring-security-flyway-c0fde13c1eca#551c">https://medium.com/@jojoooo/exploring-a-base-spring-boot-application-with-java-21-virtual-thread-spring-security-flyway-c0fde13c1eca#551c</a></li><li><a href="https://www.zhihu.com/question/21409296/answer/1040884859">https://www.zhihu.com/question/21409296/answer/1040884859</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/23/VibnQF1pM2K6fsd.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ç»™å¼€æºé¡¹ç›®å‘èµ·ææ¡ˆ</title>
    <link href="http://crossoverjie.top/2023/12/21/ob/Pulsar%20Proposal/"/>
    <id>http://crossoverjie.top/2023/12/21/ob/Pulsar%20Proposal/</id>
    <published>2023-12-21T03:09:52.000Z</published>
    <updated>2023-12-21T10:10:37.367Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰æ®µæ—¶é—´åœ¨ä½¿ç”¨ Pulsar çš„ admin API æ—¶ï¼Œå‘ç°å…¶ä¸­çš„ä¸€ä¸ªæ¥å£å“åº”éå¸¸æ…¢ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin.topics().getPartitionedStats(topic);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ curl æ‹¿åˆ°çš„å“åº”ç»“æœéå¸¸å¤§ï¼ŒåŒæ—¶ä¹Ÿéå¸¸è€—æ—¶ï¼š<br><img src="https://s2.loli.net/2023/12/21/dMsUq1eFNz9IoYC.png" alt="image.png"></p><p>å…·ä½“çš„ issue åœ¨è¿™é‡Œï¼š<a href="https://github.com/apache/pulsar/issues/21200">https://github.com/apache/pulsar/issues/21200</a></p><span id="more"></span><p>åé¢ç»è¿‡åˆ†æï¼Œæ˜¯å› ä¸ºæŸäº› topic çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éå¸¸å¤šï¼Œå¯¼è‡´è¿™ä¸ªæŸ¥è¯¢ topic ç»Ÿè®¡çš„æ¥å£æ•°æ®é‡éå¸¸å¤§ã€‚<br><img src="https://s2.loli.net/2023/12/21/CIwr3qivSQyPnEx.png" alt="image.png"></p><p>ä½†åœ¨æˆ‘è¿™ä¸ªåœºæ™¯å…¶å®æ˜¯ä¸éœ€è¦è¿™äº›ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¿¡æ¯çš„ï¼Œç°åœ¨å°±å¯¼è‡´è¿™ä¸ª topic æ— æ³•æŸ¥çœ‹çŠ¶æ€ï¼Œæ‰€ä»¥å°±å»ºè®®æ–°å¢ä¸¤ä¸ªå‚æ•°å¯ä»¥è¿‡æ»¤è¿™ä¸¤ä¸ªå­—æ®µã€‚</p><h1 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h1><p>å› ä¸ºæ¶‰åŠåˆ°æ–°å¢ API äº†ï¼Œæ‰€ä»¥ç¤¾åŒºç»´æŠ¤è€…å°±å»ºè®®æˆ‘èµ·è‰ä¸€ä¸ªææ¡ˆè¯•è¯•ï¼š<br><img src="https://s2.loli.net/2023/12/21/qyDmVHRsFBoewiQ.png" alt="image.png"></p><h2 id="ä»€ä¹ˆæ—¶å€™éœ€è¦ææ¡ˆ"><a href="#ä»€ä¹ˆæ—¶å€™éœ€è¦ææ¡ˆ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™éœ€è¦ææ¡ˆ"></a>ä»€ä¹ˆæ—¶å€™éœ€è¦ææ¡ˆ</h2><p>æ­¤æ—¶å°±æ¶‰åŠåˆ°ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç»™ç¤¾åŒºå‘èµ·ä¸€ä¸ªææ¡ˆçš„é—®é¢˜äº†ã€‚<br><img src="https://s2.loli.net/2023/12/21/VH8NqwgWcROLXhP.png" alt="image.png"><br>åœ¨å®˜æ–¹çš„ææ¡ˆæŒ‡å—ä¸­æœ‰ç€è¯¦ç»†çš„è¯´æ˜ï¼Œç®€å•æ¥è¯´å°±æ˜¯ï¼š</p><ul><li>å¯¹ä»»ä½•æ¨¡å—æ–°å¢äº† APIã€æˆ–è€…æ˜¯é‡å¤§æ”¹åŠ¨çš„æ–°ç‰¹æ€§ã€ç›‘æ§æŒ‡æ ‡ã€é…ç½®å‚æ•°æ—¶éƒ½éœ€è¦å‘èµ·ææ¡ˆ</li><li>å¯¹åº”çš„å¦‚æœåªæ˜¯å¯¹ç°æœ‰ bug çš„ä¿®å¤ã€æ–‡æ¡£ç­‰ä¸€äº›å¯æ§çš„å˜æ›´æ—¶ï¼Œæ˜¯ä¸éœ€è¦å‘èµ·ææ¡ˆçš„ï¼Œç›´æ¥æäº¤ PR å³å¯ã€‚</li></ul><h3 id="ææ¡ˆæ­¥éª¤"><a href="#ææ¡ˆæ­¥éª¤" class="headerlink" title="ææ¡ˆæ­¥éª¤"></a>ææ¡ˆæ­¥éª¤</h3><h4 id="èµ·è‰"><a href="#èµ·è‰" class="headerlink" title="èµ·è‰"></a>èµ·è‰</h4><p>é¦–å…ˆç¬¬ä¸€æ­¥å°±æ˜¯æ ¹æ®å®˜æ–¹æ¨¡ç‰ˆèµ·è‰ä¸€ä¸ªææ¡ˆï¼š<br>é‡ç‚¹æè¿°èƒŒæ™¯ã€ç›®çš„ã€è¯¦ç»†è®¾è®¡ç­‰ã€‚<br><img src="https://s2.loli.net/2023/12/21/eT7xQEk3li6Rdyp.png" alt="image.png"><br>å¹¶å‘èµ·ä¸€ä¸ª PRï¼Œå¦‚æœä¸ç¡®å®šæ€ä¹ˆå†™çš„è¯å¯ä»¥å‚è€ƒå·²ç»åˆå¹¶äº†çš„ææ¡ˆã€‚</p><h4 id="é‚®ä»¶è®¨è®º"><a href="#é‚®ä»¶è®¨è®º" class="headerlink" title="é‚®ä»¶è®¨è®º"></a>é‚®ä»¶è®¨è®º</h4><p>ä¹‹ååˆ™æ˜¯å°†è¿™ä¸ª PR å‘é€åˆ°å¼€å‘ç»„é‚®ç®±ä¸­ï¼Œè®©ç¤¾åŒºæˆå‘˜å‚ä¸è®¨è®ºã€‚</p><p><img src="https://s2.loli.net/2023/12/21/cAlZLYGEOqiyMoh.png" alt="image.png"><br>è¿™ä¸€æ­¥å¯èƒ½ä¼šæ¯”è¾ƒè€—æ—¶ï¼Œææ¡ˆå†…å®¹å¯èƒ½ä¼šè¢«åå¤ä¿®æ”¹ã€‚</p><p>å‘èµ·ææ¡ˆçš„ä¸€ä¸ªé‡è¦ç›®çš„æ˜¯å¯ä»¥è®©ç¤¾åŒºæˆå‘˜è¿›è¡Œè®¨è®ºï¼Œè¯„ä¼°æ˜¯å¦éœ€è¦è¿™ä¸ªææ¡ˆæˆ–è€…æ˜¯å¦<br>æœ‰å…¶ä»–è§£å†³æ–¹æ³•ã€‚</p><h4 id="å‘èµ·æŠ•ç¥¨"><a href="#å‘èµ·æŠ•ç¥¨" class="headerlink" title="å‘èµ·æŠ•ç¥¨"></a>å‘èµ·æŠ•ç¥¨</h4><p>ç»è¿‡è®¨è®ºï¼Œå¦‚æœææ¡ˆè·å¾—é€šè¿‡åå°±å¯ä»¥å‘èµ·æŠ•ç¥¨äº†ï¼Œè‡³å°‘éœ€è¦æœ‰ä¸‰ä¸ª binding é€šè¿‡çš„æŠ•ç¥¨åè¿™ä¸ªææ¡ˆå°±é€šè¿‡äº†ã€‚</p><blockquote><p>è™½ç„¶ä»»ä½•äººéƒ½å¯ä»¥å‚ä¸æŠ•ç¥¨ï¼Œä½†ç¤¾åŒºåªä¼šè€ƒè™‘ PMC çš„æŠ•ç¥¨å»ºè®®ï¼›æŠ•ç¥¨çš„æ—¶æ•ˆæ€§ä¹Ÿåªæœ‰ 48hã€‚</p></blockquote><p><img src="https://s2.loli.net/2023/12/21/SiHbGyRzX1kBTjt.png" alt="image.png"></p><p>48 å°æ—¶å€™ä¾¿å¯ä»¥å‘ä¸€ä¸ªæŠ•ç¥¨ç»“æœçš„é‚®ä»¶ï¼Œå¦‚æœè¾¾åˆ°é€šè¿‡æ¡ä»¶ä¾¿å¯ä»¥é€šçŸ¥å‚ä¸æŠ•ç¥¨çš„ PMC åˆå¹¶è¿™ä¸ª PR äº†ã€‚<br><img src="https://s2.loli.net/2023/12/21/r7tm8pyVER6QvCf.png" alt="image.png"></p><h4 id="å®ç°ææ¡ˆ"><a href="#å®ç°ææ¡ˆ" class="headerlink" title="å®ç°ææ¡ˆ"></a>å®ç°ææ¡ˆ</h4><p>ä¹‹åå°±æ˜¯æ²¡å•¥å¥½è¯´çš„å®ç°è¿‡ç¨‹ï¼Œå› ä¸ºé€šå¸¸æˆ‘ä»¬æ˜¯éœ€è¦åœ¨ææ¡ˆé‡Œè¯¦ç»†æè¿°å®ç°è¿‡ç¨‹ä»¥åŠæ¶‰åŠåˆ°ä¿®æ”¹çš„åœ°æ–¹ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åªè¦ææ¡ˆè¢« review é€šè¿‡åå®ç°èµ·æ¥å°±éå¸¸ç®€å•äº†ï¼Œè·Ÿç€ææ¡ˆé‡Œçš„æµç¨‹å®ç°å°±å¥½äº†ã€‚</p><blockquote><p>è¿™ç‚¹éå¸¸ç±»ä¼¼äºæˆ‘ä»¬åœ¨ä¼ä¸šä¸­å¯¹æŸä¸ªä¸šåŠ¡åšæŠ€æœ¯æ–¹æ¡ˆï¼Œå¦‚æœå¤§å®¶éƒ½æŒ‰ç…§ç±»ä¼¼çš„æµç¨‹ä¸¥æ ¼å®¡æ ¸æ–¹æ¡ˆï¼Œé‚£å®ç°èµ·æ¥æ˜¯éå¸¸å¿«çš„ï¼Œè€Œä¸”å¯ä»¥å°½é‡çš„å‡å°‘äº‹åæ‰¯çš®ã€‚</p></blockquote><p>æ‰€ä»¥æœ€åæˆ‘çš„å®ç° PR æäº¤ä¹‹åï¼Œéƒ½æ²¡æœ‰ä»»ä½•çš„ä¿®æ”¹æ„è§ï¼Œç›´æ¥å°±åˆå¹¶äº†ï¼›ä¹Ÿå¤§å¤§é™ä½äº†å®¡æ ¸äººå‘˜çš„è´Ÿæ‹…ï¼Œæé«˜æ•´ä½“æ•ˆç‡ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚ä¸ Pulsar ç¤¾åŒºçš„ææ¡ˆè¿‡ç¨‹ï¼Œæˆ‘çŒœæµ‹å…¶ä»–ç¤¾åŒºçš„æµç¨‹ä¹Ÿæ˜¯å¤§å·®ä¸å·®ï¼›å…¶ä¸­é‡ç‚¹å°±æ˜¯å¼‚æ­¥æ²Ÿé€šï¼›å¤§å®¶éƒ½è®¤å¯ä¹‹åçœŸçš„ä¼šæ¯”å®æ—¶é€šä¿¡çš„æ•ˆç‡é«˜å¾ˆå¤šã€‚</p><p>å…·ä½“çš„ææ¡ˆç»†èŠ‚å¯ä»¥é˜…è¯»å®˜æ–¹æŒ‡å— <a href="https://github.com/apache/pulsar/blob/master/pip/README.md">https://github.com/apache/pulsar/blob/master/pip/README.md</a></p><p>#Blog #Pulsar </p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´åœ¨ä½¿ç”¨ Pulsar çš„ admin API æ—¶ï¼Œå‘ç°å…¶ä¸­çš„ä¸€ä¸ªæ¥å£å“åº”éå¸¸æ…¢ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;admin.topics().getPartitionedStats(topic);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨ curl æ‹¿åˆ°çš„å“åº”ç»“æœéå¸¸å¤§ï¼ŒåŒæ—¶ä¹Ÿéå¸¸è€—æ—¶ï¼š&lt;br&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/21/dMsUq1eFNz9IoYC.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„ issue åœ¨è¿™é‡Œï¼š&lt;a href=&quot;https://github.com/apache/pulsar/issues/21200&quot;&gt;https://github.com/apache/pulsar/issues/21200&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬ğŸ”ŸæœŸ</title>
    <link href="http://crossoverjie.top/2023/12/15/ob/newsletter/Newsletter10-20231215/"/>
    <id>http://crossoverjie.top/2023/12/15/ob/newsletter/Newsletter10-20231215/</id>
    <published>2023-12-15T09:28:25.000Z</published>
    <updated>2023-12-16T07:59:26.164Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/12/16/keYlOC74XMoPAvZ.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><span id="more"></span><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/11/17/ob/newsletter/Newsletter06-20231117/">20231117ï¼šç¬¬å…­æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/24/ob/newsletter/Newsletter07-20231124/">20231124ï¼šç¬¬ä¸ƒæœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/01/ob/newsletter/Newsletter08-20231201/">20231201ï¼šç¬¬å…«æœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/08/ob/newsletter/Newsletter09-20231208/">20231215ï¼šç¬¬ä¹æœŸ</a><!--more--></li></ul><h2 id="Golang-14-Shorthand-Tricks-You-Might-Not-Know-by-Nidhi-D-Dec-2023-Canopas"><a href="#Golang-14-Shorthand-Tricks-You-Might-Not-Know-by-Nidhi-D-Dec-2023-Canopas" class="headerlink" title="Golang: 14 Shorthand Tricks You Might Not Know! | by Nidhi D | Dec, 2023 | Canopas"></a>Golang: 14 Shorthand Tricks You Might Not Know! | by Nidhi D | Dec, 2023 | Canopas</h2><p>URL: <a href="https://blog.canopas.com/golang-14-shorthand-tricks-you-might-not-know-8d8d21954c49">https://blog.canopas.com/golang-14-shorthand-tricks-you-might-not-know-8d8d21954c49</a></p><h3 id="åŒæ—¶å£°æ˜å’Œåˆå§‹åŒ–å˜é‡"><a href="#åŒæ—¶å£°æ˜å’Œåˆå§‹åŒ–å˜é‡" class="headerlink" title="åŒæ—¶å£°æ˜å’Œåˆå§‹åŒ–å˜é‡"></a>åŒæ—¶å£°æ˜å’Œåˆå§‹åŒ–å˜é‡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line"><span class="keyword">var</span> message <span class="type">string</span>  </span><br><span class="line">message = <span class="string">&quot;Hello, Golang!&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line">message := <span class="string">&quot;Hello, Golang!&quot;</span></span><br></pre></td></tr></table></figure><h3 id="å£°æ˜å’Œåˆå§‹åŒ–å¤šä¸ªå˜é‡"><a href="#å£°æ˜å’Œåˆå§‹åŒ–å¤šä¸ªå˜é‡" class="headerlink" title="å£°æ˜å’Œåˆå§‹åŒ–å¤šä¸ªå˜é‡"></a>å£°æ˜å’Œåˆå§‹åŒ–å¤šä¸ªå˜é‡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line"><span class="keyword">var</span> a, b, c <span class="type">int</span>  </span><br><span class="line">a = <span class="number">1</span>  </span><br><span class="line">b = <span class="number">2</span>  </span><br><span class="line">c = <span class="number">3</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line">a, b, c := <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br></pre></td></tr></table></figure><h3 id="äº¤æ¢å˜é‡"><a href="#äº¤æ¢å˜é‡" class="headerlink" title="äº¤æ¢å˜é‡"></a>äº¤æ¢å˜é‡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a, b := <span class="number">1</span>, <span class="number">2</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Long form  </span></span><br><span class="line">temp := a  </span><br><span class="line">a = b  </span><br><span class="line">b = temp  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line">a, b = b, a</span><br></pre></td></tr></table></figure><h3 id="Defer-å‡½æ•°è°ƒç”¨"><a href="#Defer-å‡½æ•°è°ƒç”¨" class="headerlink" title="Defer å‡½æ•°è°ƒç”¨"></a>Defer å‡½æ•°è°ƒç”¨</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cleanup</span><span class="params">()</span></span> &#123;  </span><br><span class="line"><span class="comment">// Cleanup logic  </span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">defer</span> cleanup()  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line"><span class="comment">// Cleanup logic  </span></span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure><h3 id="æ£€æµ‹-Map-ä¸­çš„æ•°æ®æ˜¯å¦å­˜åœ¨"><a href="#æ£€æµ‹-Map-ä¸­çš„æ•°æ®æ˜¯å¦å­˜åœ¨" class="headerlink" title="æ£€æµ‹ Map ä¸­çš„æ•°æ®æ˜¯å¦å­˜åœ¨"></a>æ£€æµ‹ Map ä¸­çš„æ•°æ®æ˜¯å¦å­˜åœ¨</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line">value, exists := myMap[key]  </span><br><span class="line"><span class="keyword">if</span> !exists &#123;  </span><br><span class="line">    <span class="comment">// Key doesn&#x27;t exist in the map  </span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line"><span class="keyword">if</span> value, exists := myMap[key]; !exists &#123;  </span><br><span class="line">    <span class="comment">// Key doesn&#x27;t exist in the map  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨ä¸‹æ ‡å’Œå€¼è¿­ä»£åˆ‡ç‰‡"><a href="#ä½¿ç”¨ä¸‹æ ‡å’Œå€¼è¿­ä»£åˆ‡ç‰‡" class="headerlink" title="ä½¿ç”¨ä¸‹æ ‡å’Œå€¼è¿­ä»£åˆ‡ç‰‡"></a>ä½¿ç”¨ä¸‹æ ‡å’Œå€¼è¿­ä»£åˆ‡ç‰‡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(numbers); i++ &#123;  </span><br><span class="line">fmt.Println(i, numbers[i])  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line"><span class="keyword">for</span> i, value := <span class="keyword">range</span> numbers &#123;  </span><br><span class="line">fmt.Println(i, value)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é”™è¯¯æ£€æµ‹"><a href="#é”™è¯¯æ£€æµ‹" class="headerlink" title="é”™è¯¯æ£€æµ‹"></a>é”™è¯¯æ£€æµ‹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line">result, err := someFunction()  </span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;  </span><br><span class="line"><span class="comment">// Handle the error  </span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line"><span class="keyword">if</span> result, err := someFunction(); err != <span class="literal">nil</span> &#123;  </span><br><span class="line"><span class="comment">// Handle the error  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºä¸€ä¸ªå˜é‡çš„æŒ‡é’ˆ"><a href="#åˆ›å»ºä¸€ä¸ªå˜é‡çš„æŒ‡é’ˆ" class="headerlink" title="åˆ›å»ºä¸€ä¸ªå˜é‡çš„æŒ‡é’ˆ"></a>åˆ›å»ºä¸€ä¸ªå˜é‡çš„æŒ‡é’ˆ</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line"><span class="keyword">var</span> x <span class="type">int</span>  </span><br><span class="line">ptr := &amp;x  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line">ptr := <span class="built_in">new</span>(<span class="type">int</span>)</span><br></pre></td></tr></table></figure><h3 id="åŒ¿åå‡½æ•°"><a href="#åŒ¿åå‡½æ•°" class="headerlink" title="åŒ¿åå‡½æ•°"></a>åŒ¿åå‡½æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(x, y <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;  </span><br><span class="line"><span class="keyword">return</span> x + y  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line">add := <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;  </span><br><span class="line"><span class="keyword">return</span> x + y  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå’Œåˆå§‹åŒ–-Map"><a href="#åˆ›å»ºå’Œåˆå§‹åŒ–-Map" class="headerlink" title="åˆ›å»ºå’Œåˆå§‹åŒ– Map"></a>åˆ›å»ºå’Œåˆå§‹åŒ– Map</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line">colors := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)  </span><br><span class="line">colors[<span class="string">&quot;red&quot;</span>] = <span class="string">&quot;#ff0000&quot;</span>  </span><br><span class="line">colors[<span class="string">&quot;green&quot;</span>] = <span class="string">&quot;#00ff00&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line">colors := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;  </span><br><span class="line"><span class="string">&quot;red&quot;</span>: <span class="string">&quot;#ff0000&quot;</span>,  </span><br><span class="line"><span class="string">&quot;green&quot;</span>: <span class="string">&quot;#00ff00&quot;</span>,  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å£°æ˜å¤šä¸ªå¸¸é‡"><a href="#å£°æ˜å¤šä¸ªå¸¸é‡" class="headerlink" title="å£°æ˜å¤šä¸ªå¸¸é‡"></a>å£°æ˜å¤šä¸ªå¸¸é‡</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Long form  </span></span><br><span class="line"><span class="keyword">const</span> pi <span class="type">float64</span> = <span class="number">3.14159</span>  </span><br><span class="line"><span class="keyword">const</span> maxAttempts <span class="type">int</span> = <span class="number">3</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Shorthand  </span></span><br><span class="line"><span class="keyword">const</span> (  </span><br><span class="line">pi = <span class="number">3.14159</span>  </span><br><span class="line">maxAttempts = <span class="number">3</span>  </span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="Java-Mastery-Unleashed-12-Essential-Tips-Every-Developer-Must-Embrace"><a href="#Java-Mastery-Unleashed-12-Essential-Tips-Every-Developer-Must-Embrace" class="headerlink" title="Java Mastery Unleashed: 12 Essential Tips Every Developer Must Embrace"></a>Java Mastery Unleashed: 12 Essential Tips Every Developer Must Embrace</h2><p>URL: <a href="https://blog.stackademic.com/boost-your-java-skills-12-must-know-programming-tips-for-java-developers-34f8381ec431">https://blog.stackademic.com/boost-your-java-skills-12-must-know-programming-tips-for-java-developers-34f8381ec431</a></p><blockquote><p>ä¸€äº›å¸¸ç”¨çš„ Java æŠ€å·§</p></blockquote><ul><li><p>å–„ç”¨ Lambda è¡¨è¾¾å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before</span></span><br><span class="line">List&lt;String&gt; names = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line"><span class="keyword">for</span> (Person person : people) &#123;  </span><br><span class="line">names.add(person.getName());  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// After</span></span><br><span class="line">List&lt;String&gt; names = people.stream()  </span><br><span class="line">.map(Person::getName)  </span><br><span class="line">.collect(Collectors.toList());</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ Optionals æ›¿ä»£ null</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; maybeName = Optional.ofNullable(person.getName());  </span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> maybeName.orElse(<span class="string">&quot;Unknown&quot;</span>);</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ stream ç®€åŒ–é›†åˆæ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; evenNumbers = numbers.stream()  </span><br><span class="line">.filter(num -&gt; num % <span class="number">2</span> == <span class="number">0</span>)  </span><br><span class="line">.collect(Collectors.toList());</span><br></pre></td></tr></table></figure></li><li><p>String.format æ‹¼æ¥å­—ç¬¦ä¸²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;Hello&quot;</span>;  </span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot; World&quot;</span>;  </span><br><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s%s&quot;</span>, s1, s2);</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ default method æ‰©å±•æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TimeClient</span> &#123;  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">setTime</span><span class="params">(<span class="type">int</span> hour, <span class="type">int</span> minute, <span class="type">int</span> second)</span>;  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">setDate</span><span class="params">(<span class="type">int</span> day, <span class="type">int</span> month, <span class="type">int</span> year)</span>;  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">setDateAndTime</span><span class="params">(<span class="type">int</span> day, <span class="type">int</span> month, <span class="type">int</span> year, <span class="type">int</span> hour, <span class="type">int</span> minute, <span class="type">int</span> second)</span>;  </span><br><span class="line">LocalDateTime <span class="title function_">getLocalDateTime</span><span class="params">()</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨æšä¸¾æ›¿æ¢å¸¸é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Level</span> &#123; LOW, MEDIUM, HIGH &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Level</span> <span class="variable">myVar</span> <span class="operator">=</span> Level.MEDIUM;</span><br><span class="line">        System.out.println(myVar);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ try-with-Resource ç®¡ç†èµ„æº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">FileReader</span> <span class="variable">fileReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(<span class="string">&quot;example.txt&quot;</span>);</span><br><span class="line">     <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(fileReader)) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> bufferedReader.readLine();</span><br><span class="line">    <span class="comment">// Process the file</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    <span class="comment">// Handle the exception</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="SpringBoot-Webflux-vs-Vert-x-Performance-comparison-for-hello-world-case-Tech-Tonic"><a href="#SpringBoot-Webflux-vs-Vert-x-Performance-comparison-for-hello-world-case-Tech-Tonic" class="headerlink" title="SpringBoot Webflux vs Vert.x: Performance comparison for hello world case | Tech Tonic"></a>SpringBoot Webflux vs Vert.x: Performance comparison for hello world case | Tech Tonic</h2><p>URL: <a href="https://medium.com/deno-the-complete-reference/springboot-webflux-vs-vert-x-performance-comparison-for-hello-world-case-41a6bd8e9f8c">https://medium.com/deno-the-complete-reference/springboot-webflux-vs-vert-x-performance-comparison-for-hello-world-case-41a6bd8e9f8c</a></p><blockquote><p>æœ¬æ–‡å¯¹æ¯”äº† SpringBoot Webflux å’Œ Vert.x çš„æ€§èƒ½å¯¹æ¯”</p></blockquote><p>ä»¥ä¸‹æ˜¯ä¸¤ä¸ªæ¡†æ¶å†™çš„å‹æµ‹æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hello;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ConfigurableApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.config.EnableWebFlux;</span><br><span class="line"><span class="keyword">import</span> org.reactivestreams.Publisher;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableWebFlux</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        SpringApplication.run(Application.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> Publisher&lt;String&gt; <span class="title function_">handler</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.just(<span class="string">&quot;Hello world!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vert.x</span></span><br><span class="line"><span class="keyword">package</span> com.example.starter;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> io.vertx.core.AbstractVerticle;  </span><br><span class="line"><span class="keyword">import</span> io.vertx.core.Promise;  </span><br><span class="line"><span class="keyword">import</span> io.vertx.core.http.HttpServer;  </span><br><span class="line"><span class="keyword">import</span> io.vertx.ext.web.Router;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainVerticle</span> <span class="keyword">extends</span> <span class="title class_">AbstractVerticle</span> &#123;  </span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span>  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">(Promise&lt;Void&gt; startPromise)</span> <span class="keyword">throws</span> Exception &#123;  </span><br><span class="line">    <span class="type">HttpServer</span> <span class="variable">server</span> <span class="operator">=</span> vertx.createHttpServer();  </span><br><span class="line">    <span class="type">Router</span> <span class="variable">router</span> <span class="operator">=</span> Router.router(vertx);  </span><br><span class="line">  </span><br><span class="line">    router.get(<span class="string">&quot;/&quot;</span>).respond(ctx -&gt; ctx  </span><br><span class="line">        .response()  </span><br><span class="line">        .putHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/plain&quot;</span>)  </span><br><span class="line">        .end(<span class="string">&quot;hello world!&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">    server.requestHandler(router).listen(<span class="number">3000</span>);  </span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åç›´æ¥çœ‹å¯¹æ¯”ç»“æœå§ï¼š<br><img src="https://s2.loli.net/2023/12/13/smHjAKqN32ETX6I.png" alt="image.png"><br><img src="https://s2.loli.net/2023/12/13/ylwjNGvxUEmgQ5i.png" alt="image.png"><br><img src="https://s2.loli.net/2023/12/13/yY72ipAab8jetUT.png" alt="image.png"><br>æœ€ç»ˆä½œè€…æ ¹æ®ä¸€ä¸ªè®¡ç®—å…¬å¼å¾—å‡ºä¸¤ä¸ªæ¡†æ¶çš„å¾—åˆ†ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>å·®è·å°äº 5% ä¸å¾—åˆ†</li><li>5ï½20 å¾— 1 åˆ†</li><li>20ï½50 å¾—ä¸¤åˆ†</li><li>å¤§äº 50ï¼Œå¾—ä¸‰åˆ†<br><img src="https://s2.loli.net/2023/12/13/wNPSTLRyIt79k85.png" alt="image.png"><br>æœ€ç»ˆæ˜¯ <code>Vert.x</code> å¾—åˆ†è¶…è¿‡ <code>Webflux</code> 55%â¬†ï¸</li></ul><p>ä¸è¿‡ä¸ªäººè§‰å¾—å‹æµ‹ç»“æœå†å¥½ï¼Œå¥—ä¸Šä¸šåŠ¡åï¼Œæ¯”å¦‚ä¸€ä¸ªæ¥å£æŸ¥è¯¢äº†å¤šä¸ªåç«¯æœåŠ¡ï¼Œåç«¯æœåŠ¡æœ‰ä¾èµ–äºå¤šä¸ªæ•°æ®åº“ï¼Œæœ€ç»ˆå‡ºæ¥çš„ RT å¤§å®¶éƒ½å·®ä¸å¤šã€‚</p><p>é™¤éæ˜¯æŸäº›å¯¹æ€§èƒ½æè‡´è¦æ±‚çš„åœºæ™¯ï¼Œæ¯”å¦‚å®æ—¶æ•°æ®åˆ†æã€ç‰©è”ç½‘ä¸­é—´ä»¶ç­‰å’Œç›´æ¥ä¸šåŠ¡ä¸å¤ªç›¸å…³é¢†åŸŸã€‚</p><p>å®ƒçš„åº•å±‚ä¾ç„¶æ˜¯ Nettyï¼Œä½†æ¯” Netty æä¾›äº†è·Ÿæ˜“ç”¨çš„ APIã€‚</p><h2 id="Git-Cherry-Pick-Examples-to-Apply-Hot-Fixes-and-Security-Patches-â€”-Nick-Janetakis"><a href="#Git-Cherry-Pick-Examples-to-Apply-Hot-Fixes-and-Security-Patches-â€”-Nick-Janetakis" class="headerlink" title="Git Cherry Pick Examples to Apply Hot Fixes and Security Patches â€” Nick Janetakis"></a>Git Cherry Pick Examples to Apply Hot Fixes and Security Patches â€” Nick Janetakis</h2><p>URL: <a href="https://nickjanetakis.com/blog/git-cherry-pick-examples-to-apply-hot-fixes-and-security-patches?ref=dailydev">https://nickjanetakis.com/blog/git-cherry-pick-examples-to-apply-hot-fixes-and-security-patches?ref=dailydev</a></p><blockquote><p>è®²è§£äº† git cherry-pick çš„ä½œç”¨ï¼Œä»€ä¹ˆæ—¶å€™è¯¥ç”¨ï¼Œä»€ä¹ˆæ—¶å€™ä¸ç”¨ã€‚</p></blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼š<br>ä¸€äº›å¤§å‹çš„å¼€æºé¡¹ç›®å¾€å¾€éƒ½ä¼šæœ‰ä¸€ä¸ªä¸»åˆ†å­ï¼ŒåŒæ—¶ç»´æŠ¤äº†ä¸åŒç‰ˆæœ¬çš„å­åˆ†æ”¯ï¼Œæœ‰äº›ç”¨æˆ·å¯èƒ½å°±ä¼šä¸€ç›´ä½¿ç”¨ä¸€äº›é•¿æœŸç»´æŠ¤çš„å­åˆ†æ”¯ï¼Œæ¯”å¦‚ <code>v2.1.0 \ v2.3.0</code></p><p>ä½†å¯¹äºå¤§éƒ¨åˆ†çš„å¼€å‘è€…æ¥è¯´ä¸»è¦ä¼šç»´æŠ¤ä¸»åˆ†æ”¯ï¼Œä¹Ÿä¼šåœ¨ä¸»åˆ†æ”¯ä¸Šæ¨è¿›ä¸€äº›æ–°åŠŸèƒ½ï¼Œè¿™äº›æ–°åŠŸèƒ½ä¸ä¸€å®šä¼šåŒæ­¥åˆ°ä¸Šè¿°æåˆ°çš„ä¸¤ä¸ªè€ç‰ˆæœ¬ä¸­ã€‚</p><p>ä½†å¯¹äºä¸€äº›å®‰å…¨æ¼æ´ï¼Œé‡å¤§ bug ç­‰æ˜¯éœ€è¦åŒæ­¥åˆ°è¿™äº›å­åˆ†æ”¯çš„ï¼Œä½†åˆä¸èƒ½æŠŠä¸€äº›ä¸å…¼å®¹çš„æ–°ç‰¹æ€§åŒæ­¥åˆ°å­åˆ†æ”¯ä¸­ã€‚</p><p>æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨  cherry-pick è¿™ä¸ªåŠŸèƒ½ï¼Œåªå°†æŸä¸€ä¸ªæäº¤ç»™ pick åˆ°ç›®æ ‡åˆ†æ”¯ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cherry pick more than 1 SHA.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This could be useful if you have a handful of commits that you want to bring over,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">you<span class="string">&#x27;ll likely want to order them with the oldest commit being first in the list.</span></span></span><br><span class="line">git cherry-pick &lt;SHA&gt; &lt;SHA&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Edit the git commit message for the newly applied commit.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># This could be useful if want to customize the git commit message with extra context.</span></span></span><br><span class="line">git cherry-pick &lt;SHA&gt; --edit</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Avoid automatically creating the commit which lets you edit the files first.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># This could be useful if you need to make manual code adjustments before committing,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">such as applying a security patch which uses an older library with a different API.</span></span></span><br><span class="line">git cherry-pick &lt;SHA&gt; --no-commit</span><br></pre></td></tr></table></figure><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://blog.canopas.com/golang-14-shorthand-tricks-you-might-not-know-8d8d21954c49">https://blog.canopas.com/golang-14-shorthand-tricks-you-might-not-know-8d8d21954c49</a></li><li><a href="https://blog.stackademic.com/boost-your-java-skills-12-must-know-programming-tips-for-java-developers-34f8381ec431">https://blog.stackademic.com/boost-your-java-skills-12-must-know-programming-tips-for-java-developers-34f8381ec431</a></li><li><a href="https://medium.com/deno-the-complete-reference/springboot-webflux-vs-vert-x-performance-comparison-for-hello-world-case-41a6bd8e9f8c">https://medium.com/deno-the-complete-reference/springboot-webflux-vs-vert-x-performance-comparison-for-hello-world-case-41a6bd8e9f8c</a></li><li><a href="https://nickjanetakis.com/blog/git-cherry-pick-examples-to-apply-hot-fixes-and-security-patches?ref=dailydev">https://nickjanetakis.com/blog/git-cherry-pick-examples-to-apply-hot-fixes-and-security-patches?ref=dailydev</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/16/keYlOC74XMoPAvZ.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ç¼–å†™ä¸€ä¸ª Pulsar Broker Interceptor æ’ä»¶</title>
    <link href="http://crossoverjie.top/2023/12/11/ob/Pulsar-Broker-Interceptor/"/>
    <id>http://crossoverjie.top/2023/12/11/ob/Pulsar-Broker-Interceptor/</id>
    <published>2023-12-11T08:38:27.000Z</published>
    <updated>2023-12-28T02:14:15.211Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡æ–‡ç«  <a href="https://crossoverjie.top/2023/08/23/ob/VictoriaLogs-Intro/">VictoriaLogsï¼šä¸€æ¬¾è¶…ä½å ç”¨çš„ ElasticSearch æ›¿ä»£æ–¹æ¡ˆ</a>è®²åˆ°äº†æˆ‘ä»¬ä½¿ç”¨ <code>Victorialogs</code> æ¥å­˜å‚¨ Pulsar æ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯ trace ä¿¡æ¯ã€‚</p><p><img src="https://s2.loli.net/2023/12/11/UYdMH19uyjrNA2I.png" alt="image.png"></p><p>è€Œå…¶ä¸­çš„å…³é”®çš„åŸ‹ç‚¹ä¿¡æ¯æ˜¯é€šè¿‡ Pulsar çš„ <code>BrokerInterceptor</code> å®ç°çš„ï¼Œåé¢å°±æœ‰æœ‹å‹å’¨è¯¢è¿™å—ä»£ç æ˜¯å¦å¼€æºï¼Œç›®å‰æ˜¯æ²¡æœ‰å¼€æºçš„ï¼Œä¸è¿‡å€Ÿæ­¤æœºä¼šå¯ä»¥èŠèŠå¦‚ä½•å®ç°ä¸€ä¸ª <code>BrokerInterceptor</code> æ’ä»¶ï¼Œå½“å‰è¿˜æ²¡æœ‰ç›¸å…³çš„ä»‹ç»æ–‡æ¡£ã€‚</p><span id="more"></span><p>å…¶å®å½“æ—¶æˆ‘åœ¨æ‰¾ <code>BrokerInterceptor</code> çš„ç›¸å…³èµ„æ–™æ—¶å°±å‘ç°å®˜æ–¹å¹¶æ²¡æœ‰æä¾›å¯¹åº”çš„å¼€å‘æ–‡æ¡£ã€‚</p><p>åªæœ‰ä¸€ä¸ª <a href="https://pulsar.apache.org/docs/3.1.x/develop-plugin/#what-is-an-additional-servlet">additional servlet</a>çš„å¼€å‘æ–‡æ¡£ï¼Œè€Œ <code>BrokerInterceptor</code> åªåœ¨ <a href="https://www.youtube.com/watch?v=alzv7FyOoP0">YouTube</a> ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªç¤¾åŒºåˆ†äº«çš„è§†é¢‘ã€‚<br><img src="https://s2.loli.net/2023/12/11/H3rs8OdYZecQEn5.png" alt="image.png"></p><p>è™½è¯´çœ‹è§†é¢‘å¯ä»¥è·Ÿç€å®ç°ï¼Œä½†æ€»å½’æ˜¯æ²¡æœ‰æ–‡æ¡£æ–¹ä¾¿ã€‚</p><hr><p>åœ¨è¿™ä¹‹å‰è¿˜æ˜¯å…ˆè®²è®² <code>BrokerInterceptor</code> æœ‰ä»€ä¹ˆç”¨ï¼Ÿ<br><img src="https://s2.loli.net/2023/12/11/F8cxdwsTyWuaVGg.png" alt="image.png"></p><p>å…¶å®ä»å®ƒæ‰€æä¾›çš„æ¥å£å°±èƒ½çœ‹å‡ºï¼Œåœ¨æ¶ˆæ¯åˆ°è¾¾ Broker åçš„ä¸€äº›å…³é”®èŠ‚ç‚¹éƒ½æä¾›äº†ç›¸å…³çš„æ¥å£ï¼Œå®ç°è¿™äº›æ¥å£å°±èƒ½åšå¾ˆå¤šäº‹æƒ…äº†ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œæ‰€éœ€è¦çš„æ¶ˆæ¯è¿½è¸ªã€‚</p><h1 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h1><p>ä¸‹é¢å¼€å§‹å¦‚ä½•ä½¿ç”¨ <code>BrokerInterceptor</code>ï¼š<br>é¦–å…ˆæ˜¯åˆ›å»ºä¸€ä¸ª <code>Maven</code> é¡¹ç›®ï¼Œç„¶åå¼•å…¥ç›¸å…³çš„ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pulsar<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pulsar-broker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;pulsar.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="å®ç°æ¥å£"><a href="#å®ç°æ¥å£" class="headerlink" title="å®ç°æ¥å£"></a>å®ç°æ¥å£</h1><p>ç„¶åæˆ‘ä»¬ä¾¿å¯ä»¥å®ç° <code>org.apache.pulsar.broker.intercept.BrokerInterceptor</code> æ¥å®Œæˆå…·ä½“çš„ä¸šåŠ¡äº†ã€‚</p><p>åœ¨æˆ‘ä»¬åšæ¶ˆæ¯è¿½è¸ªçš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å®ç°äº†ä»¥ä¸‹å‡ ä¸ªæ¥å£ï¼š</p><ul><li>messageProduced</li><li>messageDispatched</li><li>messageAcked</li></ul><p>ä»¥ <code>messageProduced</code> ä¸ºä¾‹ï¼Œéœ€è¦è§£æå‡ºæ¶ˆæ¯IDï¼Œç„¶åæ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥ <code>Victorialogs</code> å­˜å‚¨ä¸­ï¼Œå…¶ä½™çš„ä¸¤ä¸ªåŸ‹ç‚¹ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">messageProduced</span><span class="params">(ServerCnx cnx, Producer producer, <span class="type">long</span> startTimeNs, <span class="type">long</span> ledgerId, <span class="type">long</span> entryId,  </span></span><br><span class="line"><span class="params">                            Topic.PublishContext publishContext)</span> &#123;  </span><br><span class="line">    <span class="type">String</span> <span class="variable">ns</span> <span class="operator">=</span> getNs(producer.getTopic().getName());  </span><br><span class="line">    <span class="keyword">if</span> (!LogSender.checkNamespace(ns)) &#123;  </span><br><span class="line">        <span class="keyword">return</span>;  </span><br><span class="line">    &#125;    <span class="type">String</span> <span class="variable">topic</span> <span class="operator">=</span> producer.getTopic().getName();  </span><br><span class="line">    <span class="type">String</span> <span class="variable">partition</span> <span class="operator">=</span> getPartition(topic);  </span><br><span class="line">    <span class="type">String</span> <span class="variable">msgId</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s:%s:%s&quot;</span>, ledgerId, entryId, partition);  </span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Event</span>.Publish(msgId, producer.getClientAddress(), System.currentTimeMillis(),  </span><br><span class="line">            producer.getProducerName(), topic).toString();  </span><br><span class="line">    LogSender.send(s);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç¼–å†™é¡¹ç›®æè¿°æ–‡ä»¶"><a href="#ç¼–å†™é¡¹ç›®æè¿°æ–‡ä»¶" class="headerlink" title="ç¼–å†™é¡¹ç›®æè¿°æ–‡ä»¶"></a>ç¼–å†™é¡¹ç›®æè¿°æ–‡ä»¶</h1><p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªé¡¹ç›®æè¿°æ–‡ä»¶ï¼Œè·¯å¾„å¦‚ä¸‹ï¼š<br><code>src/main/resources/META-INF/services/broker_interceptor.yml</code><br>åå­—ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œbroker ä¼šåœ¨å¯åŠ¨çš„æ—¶å€™è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">interceptor-name</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">description</span></span><br><span class="line"><span class="attr">interceptorClass:</span> <span class="string">com.xx.CustomInterceptor</span></span><br></pre></td></tr></table></figure><p>é‡ç‚¹æ˜¯å¡«å†™è‡ªå®šä¹‰å®ç°ç±»çš„å…¨é™å®šåã€‚</p><h1 id="é…ç½®æ‰“åŒ…æ’ä»¶"><a href="#é…ç½®æ‰“åŒ…æ’ä»¶" class="headerlink" title="é…ç½®æ‰“åŒ…æ’ä»¶"></a>é…ç½®æ‰“åŒ…æ’ä»¶</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.nifi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nifi-nar-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">extensions</span>&gt;</span>true<span class="tag">&lt;/<span class="name">extensions</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">executions</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>default-nar<span class="tag">&lt;/<span class="name">id</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;<span class="name">goals</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>nar<span class="tag">&lt;/<span class="name">goal</span>&gt;</span>  </span><br><span class="line">          <span class="tag">&lt;/<span class="name">goals</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;/<span class="name">executions</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç”±äº Broker è¯†åˆ«çš„æ˜¯ nar åŒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é…ç½® nar åŒ…æ’ä»¶ï¼Œä¹‹åä½¿ç”¨ <code>mvn package</code> å°±ä¼šç”Ÿæˆå‡º nar åŒ…ã€‚</p><h1 id="é…ç½®-broker-conf"><a href="#é…ç½®-broker-conf" class="headerlink" title="é…ç½® broker.conf"></a>é…ç½® broker.conf</h1><p>æˆ‘ä»¬è¿˜éœ€è¦åœ¨ broker.conf ä¸­é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brokerInterceptors: &quot;interceptor-name&quot;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯åˆšæ‰é…ç½®çš„æ’ä»¶åç§°ã€‚</p><p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨ helm å®‰è£…çš„ pulsarï¼Œåœ¨ 3.1 ç‰ˆæœ¬ä¹‹å‰éœ€è¦æ‰‹åŠ¨å°†<code>brokerInterceptors</code> å†™å…¥åˆ° <code>broker.conf</code> ä¸­ã€‚</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> apachepulsar/pulsar-all:<span class="number">3.0</span>.<span class="number">1</span>  </span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> target/interceptor-1.0.1.nar /pulsar/interceptors/  </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;\n&quot;</span> &gt;&gt; /pulsar/conf/broker.conf  </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;brokerInterceptors=&quot;</span> &gt;&gt; /pulsar/conf/broker.conf</span></span><br></pre></td></tr></table></figure><p>ä¸ç„¶åœ¨æœ€ç»ˆå®¹å™¨ä¸­çš„ <code>broker.conf</code> ä¸­æ˜¯è¯»å–ä¸åˆ°è¿™ä¸ªé…ç½®çš„ï¼Œå¯¼è‡´æ’ä»¶æ²¡æœ‰ç”Ÿæ•ˆã€‚</p><blockquote><p>æˆ‘ä»¬æ˜¯é‡æ–°åŸºäºå®˜æ–¹é•œåƒæ‰“çš„ä¸€ä¸ªåŒ…å«è‡ªå®šä¹‰æ’ä»¶çš„é•œåƒï¼Œæœ€ç»ˆä½¿ç”¨è¿™ä¸ªé•œåƒè¿›è¡Œéƒ¨ç½²ã€‚</p></blockquote><p><a href="https://github.com/apache/pulsar/pull/20719">https://github.com/apache/pulsar/pull/20719</a><br>æˆ‘åœ¨è¿™ä¸ª PR ä¸­å·²ç»å°†é…ç½®åŠ å…¥è¿›å»äº†ï¼Œä½†å¾—åœ¨ 3.1 ä¹‹åæ‰èƒ½ç”Ÿæ•ˆï¼›ä¹Ÿå°±æ˜¯åœ¨ 3.1 ä¹‹å‰éƒ½å¾—åŠ ä¸ŠåŠ ä¸Šè¿™è¡Œï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;\n&quot;</span> &gt;&gt; /pulsar/conf/broker.conf  </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;brokerInterceptors=&quot;</span> &gt;&gt; /pulsar/conf/broker.conf</span></span><br></pre></td></tr></table></figure><hr><p>ç›®å‰æ¥çœ‹ Pulsar çš„ <code>BrokerInterceptor</code> åº”è¯¥ä½¿ç”¨ä¸å¤šï¼Œä¸ç„¶ä½¿ç”¨ helm å®‰è£…æ—¶æ˜¯ä¸å¯èƒ½ç”Ÿæ•ˆçš„ï¼›è€Œä¸”å®˜æ–¹æ–‡æ¡£ä¹Ÿæ²¡ç”¨ç›¸å…³çš„æè¿°ã€‚</p><p>#Blog #Pulsar </p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;ä¹‹å‰å†™è¿‡ä¸€ç¯‡æ–‡ç«  &lt;a href=&quot;https://crossoverjie.top/2023/08/23/ob/VictoriaLogs-Intro/&quot;&gt;VictoriaLogsï¼šä¸€æ¬¾è¶…ä½å ç”¨çš„ ElasticSearch æ›¿ä»£æ–¹æ¡ˆ&lt;/a&gt;è®²åˆ°äº†æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;Victorialogs&lt;/code&gt; æ¥å­˜å‚¨ Pulsar æ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯ trace ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/11/UYdMH19uyjrNA2I.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;è€Œå…¶ä¸­çš„å…³é”®çš„åŸ‹ç‚¹ä¿¡æ¯æ˜¯é€šè¿‡ Pulsar çš„ &lt;code&gt;BrokerInterceptor&lt;/code&gt; å®ç°çš„ï¼Œåé¢å°±æœ‰æœ‹å‹å’¨è¯¢è¿™å—ä»£ç æ˜¯å¦å¼€æºï¼Œç›®å‰æ˜¯æ²¡æœ‰å¼€æºçš„ï¼Œä¸è¿‡å€Ÿæ­¤æœºä¼šå¯ä»¥èŠèŠå¦‚ä½•å®ç°ä¸€ä¸ª &lt;code&gt;BrokerInterceptor&lt;/code&gt; æ’ä»¶ï¼Œå½“å‰è¿˜æ²¡æœ‰ç›¸å…³çš„ä»‹ç»æ–‡æ¡£ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬9ï¸âƒ£æœŸ</title>
    <link href="http://crossoverjie.top/2023/12/08/ob/newsletter/Newsletter09-20231208/"/>
    <id>http://crossoverjie.top/2023/12/08/ob/newsletter/Newsletter09-20231208/</id>
    <published>2023-12-08T09:28:25.000Z</published>
    <updated>2023-12-08T09:36:45.730Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/12/08/CXqYjtI7fBUlhma.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><span id="more"></span><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/11/10/ob/newsletter/Newsletter05-20231110/">20231107ï¼šç¬¬äº”æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/17/ob/newsletter/Newsletter06-20231117/">20231117ï¼šç¬¬å…­æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/24/ob/newsletter/Newsletter07-20231124/">20231124ï¼šç¬¬ä¸ƒæœŸ</a></li><li><a href="https://crossoverjie.top/2023/12/01/ob/newsletter/Newsletter08-20231201/">20231201ï¼šç¬¬å…«æœŸ</a><!--more--></li></ul><h2 id="ç¾å›¢æŠ€æœ¯åšå®¢åå‘¨å¹´ï¼Œæ„Ÿè°¢ä¸€è·¯ç›¸ä¼´-ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ"><a href="#ç¾å›¢æŠ€æœ¯åšå®¢åå‘¨å¹´ï¼Œæ„Ÿè°¢ä¸€è·¯ç›¸ä¼´-ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ" class="headerlink" title="ç¾å›¢æŠ€æœ¯åšå®¢åå‘¨å¹´ï¼Œæ„Ÿè°¢ä¸€è·¯ç›¸ä¼´ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ"></a>ç¾å›¢æŠ€æœ¯åšå®¢åå‘¨å¹´ï¼Œæ„Ÿè°¢ä¸€è·¯ç›¸ä¼´ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ</h2><p>URL: <a href="https://tech.meituan.com/2023/12/04/ten-years-of-meituan-technology-blog.html">https://tech.meituan.com/2023/12/04/ten-years-of-meituan-technology-blog.html</a><br><img src="https://s2.loli.net/2023/12/06/1z4f7UOyJ2HPpu6.png" alt="image.png"></p><blockquote><p>ç¾å›¢æŠ€æœ¯åšå®¢æ›´æ–°åå‘¨å¹´äº†ï¼Œè¿™ä¸ªåšå®¢ç¡®å®åœ¨å¹¿å¤§å¼€å‘è€…å¿ƒä¸­éƒ½æ˜¯æœ‰å£çš†ç¢‘çš„ï¼›è®°å¾—å½“åˆåœ¨è¿™é‡Œçœ‹è¿‡ HashMap çš„åŸç†åˆ†æã€åŠ¨æ€çº¿ç¨‹æ± ç­‰æŠ€æœ¯ï¼›<br>ç°åœ¨ä¹Ÿæœ‰åŠ åˆ°è®¢é˜…åˆ—è¡¨é‡Œï¼Œæœ‰æ›´æ–°æ—¶ä¼šç¬¬ä¸€æ—¶é—´é˜…è¯»</p></blockquote><h2 id="CompletableFutureåŸç†ä¸å®è·µ-å¤–å–å•†å®¶ç«¯APIçš„å¼‚æ­¥åŒ–-ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ"><a href="#CompletableFutureåŸç†ä¸å®è·µ-å¤–å–å•†å®¶ç«¯APIçš„å¼‚æ­¥åŒ–-ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ" class="headerlink" title="CompletableFutureåŸç†ä¸å®è·µ-å¤–å–å•†å®¶ç«¯APIçš„å¼‚æ­¥åŒ– - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ"></a>CompletableFutureåŸç†ä¸å®è·µ-å¤–å–å•†å®¶ç«¯APIçš„å¼‚æ­¥åŒ– - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ</h2><p>URL: <a href="https://tech.meituan.com/2022/05/12/principles-and-practices-of-completablefuture.html">https://tech.meituan.com/2022/05/12/principles-and-practices-of-completablefuture.html</a><br><img src="https://s2.loli.net/2023/12/06/F42yeBdRsJOkon8.png" alt="image.png"></p><blockquote><p>æœ¬æ–‡æè¿°äº†ç¾å›¢å¯¹ API åšå¼‚æ­¥ä¼˜åŒ–çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆé€‰æ‹©äº† CompletableFuture çš„è¿‡ç¨‹<br><code>CompletableFuture</code> ä½¿ç”¨èµ·æ¥çš„å‘è¿˜æ˜¯è›®å¤šçš„ï¼Œæ¨èå¤§å®¶éƒ½åº”è¯¥é˜…è¯»ä¸‹ã€‚</p></blockquote><ul><li>æ˜ç¡®çŸ¥é“è‡ªå·±çš„ä»£ç è¿è¡Œåœ¨å“ªä¸ªçº¿ç¨‹ä¸Šï¼Œå¦‚æœä¸ä¼ å…¥çº¿ç¨‹æ± é‚£å°±æ˜¯å…¬å…±çš„ <code>ForkJoinPool</code> çº¿ç¨‹æ± ï¼Œå¯èƒ½ä¼šæœ‰é˜»å¡çš„æƒ…å†µï¼›ä¹Ÿå¯ä»¥ç›´æ¥ä¼ å…¥è‡ªå®šä¹‰çš„çº¿ç¨‹æ± </li><li>çº¿ç¨‹æ± å¾ªç¯ä½¿ç”¨å¯èƒ½ä¼šå¼•èµ·æ­»é”ï¼Œå½“ A çº¿ç¨‹ä¾èµ–äº B çº¿ç¨‹çš„æ‰§è¡Œç»“æœæ—¶ï¼Œå¦‚æœæ­¤æ—¶æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå¹¶ä¸”çº¿ç¨‹æ± å·²æ»¡ï¼ŒB çº¿ç¨‹ä¸€ç›´å¾—ä¸åˆ°æœºä¼šæ‰§è¡Œï¼Œé‚£ A çº¿ç¨‹ä¹Ÿæ— æ³•è¿è¡Œï¼Œä»è€Œå¯¼è‡´æ­»é”ã€‚</li><li><code>CompletableFuture</code> çš„å¼‚å¸¸å¾€å¾€ä¼šè¢«åŒ…è£…ä¸ºCompletionExceptionï¼Œæ‰€ä»¥æœ€å¥½æ˜¯è¦å¼‚å¸¸å·¥å…·ç±»è¿›è¡Œæå–<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionUtils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Throwable <span class="title function_">extractRealException</span><span class="params">(Throwable throwable)</span> &#123;</span><br><span class="line">          <span class="comment">//è¿™é‡Œåˆ¤æ–­å¼‚å¸¸ç±»å‹æ˜¯å¦ä¸ºCompletionExceptionã€ExecutionExceptionï¼Œå¦‚æœæ˜¯åˆ™è¿›è¡Œæå–ï¼Œå¦åˆ™ç›´æ¥è¿”å›ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (throwable <span class="keyword">instanceof</span> CompletionException || throwable <span class="keyword">instanceof</span> ExecutionException) &#123;</span><br><span class="line">            <span class="keyword">if</span> (throwable.getCause() != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> throwable.getCause();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> throwable;</span><br><span class="line">   </span><br></pre></td></tr></table></figure></li></ul><h2 id="æ²¡é”™ï¼Œæ•°æ®åº“ç¡®å®åº”è¯¥æ”¾å…¥-K8s-é‡Œï¼"><a href="#æ²¡é”™ï¼Œæ•°æ®åº“ç¡®å®åº”è¯¥æ”¾å…¥-K8s-é‡Œï¼" class="headerlink" title="æ²¡é”™ï¼Œæ•°æ®åº“ç¡®å®åº”è¯¥æ”¾å…¥ K8s é‡Œï¼"></a>æ²¡é”™ï¼Œæ•°æ®åº“ç¡®å®åº”è¯¥æ”¾å…¥ K8s é‡Œï¼</h2><p>URL: <a href="https://mp.weixin.qq.com/s/QJn6-EzPp7PXar-GdMITCA">https://mp.weixin.qq.com/s/QJn6-EzPp7PXar-GdMITCA</a></p><blockquote><p>è™½ç„¶è¿™æ˜¯ä¸€ç¯‡è½¯æ–‡ï¼Œä¸è¿‡å…¶ä¸­å‡ ä¸ªè®ºæ®ç¡®å®æ˜¯æœ‰é“ç†çš„ã€‚<br>è€Œ K8s çš„æ§åˆ¶å™¨åˆ™æ˜¯åŸºäºå¦ä¸€ç§æ€è·¯ï¼š<strong>æœºå™¨èƒ½åšçš„äº‹å°±ä¸åº”è¯¥ç”±äººæ¥åš</strong>ã€‚é€šè¿‡ Operatorï¼Œå¯ä»¥å®ç°<strong>24 å°æ—¶ä¸é—´æ–­åœ°åŒæ­¥æœŸæœ›çŠ¶æ€å’Œå®é™…çŠ¶æ€</strong>ï¼Œè€Œè¿™æ˜¯ç”¨ Ansible å¾ˆéš¾å®ç°çš„ï¼Œä½ ç”¨ Ansible å®ç°æ˜¯æƒ³å†™ä¸ªå®šæ—¶ä»»åŠ¡å˜›ï¼Ÿ</p></blockquote><ul><li>å¤æ‚åº¦ï¼š<ul><li>Sealos æä¾›äº†ä¸€é”®å®‰è£…å‘½ä»¤ï¼Œæœ‰æ•ˆé™ä½å…¶å¤æ‚åº¦</li></ul></li><li>ç¨³å®šæ€§ï¼š<ul><li>ä¸€ä¸ªè‰¯å¥½çš„è½¯ä»¶æ¶æ„ä¼šä¸æ–­æå‡å’Œæ”¶æ•›å…¶é²æ£’æ€§ï¼Œå¹¶é€æ¸å‡å°‘å¯¹äººçš„ä¾èµ–ï¼Œæ¯”å¦‚ä½¿ç”¨ Oracle çš„äººå–èŒ¶æ—¶é—´ä¸€å®šæ¯”ç”¨å¼€æº MySQL çš„äººå–èŒ¶æ—¶é—´å¤š</li></ul></li><li>æ€§èƒ½ï¼š<ul><li>è€Œä¸”ï¼Œå®¹å™¨å¯¹æ•°æ®åº“æ€§èƒ½çš„å½±å“å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ï¼ŒçœŸæ­£é‡è¦çš„æ˜¯ç£ç›˜ IO å’Œç½‘ç»œå¸¦å®½æ—¶å»¶ç­‰å› ç´ ã€‚</li></ul></li></ul><p>ç›®å‰å¸‚é¢ä¸Šå¤§éƒ¨åˆ†äº‘æœåŠ¡å‚å•†æ‰€æä¾›çš„æ•°æ®åº“æœåŠ¡ä¹Ÿéƒ½æ˜¯è·‘åœ¨  kubernetes ä¸­çš„ã€‚</p><h2 id="deckarep-x2F-golang-set-A-simple-battle-tested-and-generic-set-type-for-the-Go-language-Trusted-by-Docker-1Password-Ethereum-and-Hashicorp"><a href="#deckarep-x2F-golang-set-A-simple-battle-tested-and-generic-set-type-for-the-Go-language-Trusted-by-Docker-1Password-Ethereum-and-Hashicorp" class="headerlink" title="deckarep&#x2F;golang-set: A simple, battle-tested and generic set type for the Go language. Trusted by Docker, 1Password, Ethereum and Hashicorp."></a>deckarep&#x2F;golang-set: A simple, battle-tested and generic set type for the Go language. Trusted by Docker, 1Password, Ethereum and Hashicorp.</h2><p>URL: <a href="https://github.com/deckarep/golang-set">https://github.com/deckarep/golang-set</a><br><img src="https://s2.loli.net/2023/12/08/ru6dAXPx3G7WlL4.png" alt="image.png"></p><blockquote><p>ä¸€ä¸ªæ³›å‹çš„ Go Set åº“, è¿˜æä¾›äº†ä¸€äº›é›†åˆå¸¸ç”¨çš„æ“ä½œå·¥å…·ï¼Œæ¯”å¦‚ Contains&#x2F;Difference&#x2F;Intersect ç­‰å‡½æ•°ã€‚</p></blockquote><p>å·²ç»è¢«è¿™äº›å…¬å¸é‡‡ç”¨äº†ï¼š</p><ul><li>Ethereum</li><li>Docker</li><li>1Password</li><li>Hashicorp</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Syntax example, doesn&#x27;t compile.</span></span><br><span class="line">mySet := mapset.NewSet[T]() <span class="comment">// T æ˜¯å…·ä½“çš„ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Therefore this code creates an int set</span></span><br><span class="line">mySet := mapset.NewSet[<span class="type">int</span>]()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Or perhaps you want a string set</span></span><br><span class="line">mySet := mapset.NewSet[<span class="type">string</span>]()</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> myStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">  name <span class="type">string</span></span><br><span class="line">  age <span class="type">uint8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Alternatively a set of structs</span></span><br><span class="line">mySet := mapset.NewSet[myStruct]()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lastly a set that can hold anything using the any or empty interface keyword: interface&#123;&#125;. This is effectively removes type safety.</span></span><br><span class="line">mySet := mapset.NewSet[any]()</span><br></pre></td></tr></table></figure><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://tech.meituan.com/2023/12/04/ten-years-of-meituan-technology-blog.html">https://tech.meituan.com/2023/12/04/ten-years-of-meituan-technology-blog.html</a></li><li><a href="https://tech.meituan.com/2022/05/12/principles-and-practices-of-completablefuture.html">https://tech.meituan.com/2022/05/12/principles-and-practices-of-completablefuture.html</a></li><li><a href="https://mp.weixin.qq.com/s/QJn6-EzPp7PXar-GdMITCA">https://mp.weixin.qq.com/s/QJn6-EzPp7PXar-GdMITCA</a></li><li><a href="https://github.com/deckarep/golang-set">https://github.com/deckarep/golang-set</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/08/CXqYjtI7fBUlhma.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬8ï¸âƒ£æœŸ</title>
    <link href="http://crossoverjie.top/2023/12/01/ob/newsletter/Newsletter08-20231201/"/>
    <id>http://crossoverjie.top/2023/12/01/ob/newsletter/Newsletter08-20231201/</id>
    <published>2023-12-01T09:28:25.000Z</published>
    <updated>2023-12-11T02:27:07.559Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/12/01/AXc16Ty8hoUw3sC.png" alt="image.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><span id="more"></span><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/11/03/ob/newsletter/Newsletter04-20231103/">20231103ï¼šç¬¬å››æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/10/ob/newsletter/Newsletter05-20231110/">20231107ï¼šç¬¬äº”æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/17/ob/newsletter/Newsletter06-20231117/">20231117ï¼šç¬¬å…­æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/24/ob/newsletter/Newsletter07-20231124/">20231124ï¼šç¬¬ä¸ƒæœŸ</a><!--more--></li></ul><h2 id="Prometheus-vs-VictoriaMetrics-VM-Last9"><a href="#Prometheus-vs-VictoriaMetrics-VM-Last9" class="headerlink" title="Prometheus vs. VictoriaMetrics (VM) | Last9"></a>Prometheus vs. VictoriaMetrics (VM) | Last9</h2><p>URL: <a href="https://last9.io/blog/prometheus-vs-victoriametrics/?ref=dailydev">https://last9.io/blog/prometheus-vs-victoriametrics/?ref=dailydev</a><br><img src="https://s2.loli.net/2023/11/28/NPR6nvLI2aTmJ9g.png" alt="image.png"></p><blockquote><p>å¯¹æ¯”äº† Prometheus å’Œ VM çš„åŒºåˆ«<br><img src="https://s2.loli.net/2023/11/28/1Oqd5Zgxt8R4EQm.png" alt="image.png"><br>è€ƒè™‘åˆ°å’Œäº‘åŸç”Ÿçš„ç¯å¢ƒçš„å…¼å®¹æ€§ï¼Œé‚£ Prometheus å¯èƒ½æ›´åˆé€‚äº›ï¼Œæ¯•ç«Ÿæ˜¯ CNCF ç»„ç»‡ä¸‹çš„é¡¹ç›®ã€‚<br>ä½†å¦‚æœè€ƒè™‘åˆ°æ€§èƒ½ã€å­˜å‚¨ã€èµ„æºå ç”¨æ€§ï¼ŒVM ä¼šæ›´åˆé€‚ä¸€äº›ã€‚</p></blockquote><h2 id="28-Rust-in-Action-10-Project-Ideas-to-Elevate-Your-Skills"><a href="#28-Rust-in-Action-10-Project-Ideas-to-Elevate-Your-Skills" class="headerlink" title="28 - Rust in Action: 10 Project Ideas to Elevate Your Skills"></a>28 - Rust in Action: 10 Project Ideas to Elevate Your Skills</h2><p>URL: <a href="https://rust-trends.com/newsletter/rust-in-action-10-project-ideas-to-elevate-your-skills/?ref=dailydev">https://rust-trends.com/newsletter/rust-in-action-10-project-ideas-to-elevate-your-skills/?ref=dailydev</a><br><img src="https://s2.loli.net/2023/11/28/3LBGgx8YTXdftSp.png" alt="image.png"></p><blockquote><p>è¿™æ˜¯ä¸€ä¸ª Rust çš„ newsletterï¼Œä»‹ç»äº†åä¸ªé¡¹ç›® idea å¯ä»¥æé«˜ä½ çš„ Rust çš„æ°´å¹³ï¼Œæˆ‘çœ‹äº†ä¸‹è¿™äº›é¡¹ç›®ä¹Ÿä¸æ€ä¹ˆé™åˆ¶è¯­è¨€ï¼Œä»»ä½•è¯­è¨€éƒ½å¯ä»¥å°è¯•ä¸‹ã€‚</p></blockquote><ul><li><code>ç®€æ˜“ç‰ˆçš„ grep å‘½ä»¤</code>ç®€å•ï¼šè¯»å–æ–‡ä»¶æ ¹æ®æœç´¢æ¡ä»¶è¾“å‡ºæœç´¢ç»“æœï¼Œæ¶‰åŠåˆ°çš„æŠ€æœ¯æ ˆï¼š<ul><li>æ–‡ä»¶ IO</li><li>æ­£åˆ™è¡¨è¾¾å¼</li><li>å‘½ä»¤è¡Œå·¥å…·</li></ul></li><li><code>çŸ­åŸŸåæœåŠ¡</code>ä¸­ç­‰ï¼šæ¥æ”¶ä¸€ä¸ªé•¿åŸŸåï¼Œè½¬æ¢ä¸ºä¸€ä¸ªçŸ­åŸŸåï¼Œè®¿é—®çŸ­åŸŸåæ—¶å¯ä»¥è‡ªåŠ¨é‡å®šå‘åˆ°é•¿åŸŸåã€‚<ul><li>Web æ¡†æ¶</li><li>æ•°æ®å­˜å‚¨ï¼Œå¯ä»¥æ˜¯ SQLite&#x2F;Redis</li><li>ç”ŸæˆçŸ­é“¾æ¥çš„å­—ç¬¦ä¸²ç®—æ³•</li></ul></li><li><code>åŸºäºæ–‡æœ¬çš„å†’é™©æ¸¸æˆ</code>ä¸­ç­‰ï¼šç”¨æˆ·å¯ä»¥æ¢ç´¢æˆ¿é—´ï¼Œé€‰æ‹©ç‰©å“ï¼Œè§£å¯†ç­‰ã€‚<ul><li>è¾“å…¥è¾“å‡º</li><li>æ¸¸æˆç»“æ„ä½“å®šä¹‰ã€ä»¥åŠçŠ¶æ€æµè½¬ã€‚</li></ul></li><li><code>åŸºæœ¬çš„ç½‘ç»œçˆ¬è™«</code>ç®€å•ï¼šçˆ¬å–ä¸€ä¸ªç½‘é¡µç„¶åæå–æŒ‡å®šçš„ä¿¡æ¯ã€‚<ul><li>HTTP</li><li>HTML è§£æ</li><li>å­—ç¬¦ä¸²åŒ¹é…ã€æ­£åˆ™ã€‚</li></ul></li><li><code>å®æ—¶èŠå¤©åº”ç”¨</code>ä¸­ç­‰ï¼šæ”¯æŒå¤šä¸ªäººç”¨æˆ·åŠ å…¥æˆ¿é—´ï¼Œå¯ä»¥ç»™æ¯ä¸ªäººå‘é€æ¶ˆæ¯ã€‚<ul><li>ç½‘ç»œç¼–ç¨‹</li><li>å¤šçº¿ç¨‹å¤„ç†å®¢æˆ·ç«¯è¿æ¥</li></ul></li><li><code>Markdown è§£æä¸º HTML</code>ä¸­ç­‰ï¼š<ul><li>æ–‡æœ¬è§£æ</li><li>æ–‡ä»¶ IO</li></ul></li><li><code>ç®€å•çš„ HTTP æœåŠ¡</code>ä¸­ç­‰ï¼šæ”¯æŒé™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥å¤„ç† RESTful è¯·æ±‚ã€‚</li></ul><h2 id="Implementing-a-Bloom-Filter-in-Go-by-Francisco-Escher-Nov-2023-ITNEXT"><a href="#Implementing-a-Bloom-Filter-in-Go-by-Francisco-Escher-Nov-2023-ITNEXT" class="headerlink" title="Implementing a Bloom Filter in Go | by Francisco Escher | Nov, 2023 | ITNEXT"></a>Implementing a Bloom Filter in Go | by Francisco Escher | Nov, 2023 | ITNEXT</h2><p>URL: <a href="https://itnext.io/bloom-filters-and-go-1d5ac62557de">https://itnext.io/bloom-filters-and-go-1d5ac62557de</a><br><img src="https://s2.loli.net/2023/12/01/aY5dn6zIZp7UxNw.png" alt="image.png"></p><blockquote><p>å¤šå¹´å‰æˆ‘ä¹Ÿç”¨ Java <a href="https://crossoverjie.top/2018/11/26/guava/guava-bloom-filter/?highlight=%E5%B8%83%E9%9A%86">å†™è¿‡ä¸€ä¸ªå¸ƒéš†è¿‡æ»¤å™¨</a>ï¼Œæœ¬æ–‡ä½œè€…ä»‹ç»ç”¨ Go æ¥å®ç°ï¼Œä¸è¿‡åŸç†éƒ½å·®ä¸å¤šã€‚</p></blockquote><p>å¸ƒéš†è¿‡æ»¤å™¨æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>ç”¨æå°‘çš„å†…å­˜å¯ä»¥å­˜æ”¾å¤§é‡çš„æ•°æ®</li><li>å­˜åœ¨è¯¯æŠ¥çš„å¯èƒ½</li><li>ä½†è¿”å›æ•°æ®ä¸å­˜åœ¨æ—¶ä¸€å®šä¸å­˜åœ¨</li><li>è¿”å›æ•°æ®å­˜åœ¨æœ‰ä¸€å®šæ¦‚ç‡æ˜¯ä¸å­˜åœ¨çš„</li></ul><p>æ‰€ä»¥åŸºäºä»¥ä¸Šç‰¹æ€§å°±æœ‰äº†ä¸‹é¢è¿™äº›åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ç½‘ç»œå®‰å…¨ï¼šå¯ä»¥å¿«é€Ÿåˆ¤æ–­ IP é‡Šæ”¾åœ¨é»‘åå•ä¸­</li><li>web ç¼“å­˜ï¼šåˆ¤æ–­è¯·æ±‚æ˜¯å¦åœ¨ç¼“å­˜ä¸­</li><li>æ•°æ®åº“ç¼“å­˜ï¼ŒåŸç†åŒä¸Š</li><li>è¯­æ³•æ£€æµ‹ï¼šä¸€äº›æ–‡æœ¬å·¥å…·å¯ä»¥å¿«é€Ÿæ£€æµ‹ä½ è¾“å…¥çš„æ”¯ä»˜æ˜¯å¦åœ¨å­—å…¸é‡Œï¼Œä¸å­˜åœ¨æ—¶è¿›è¡Œæç¤º</li><li>åŒºå—é“¾è®¤è¯</li><li>é‚®ä»¶è¿‡æ»¤</li></ul><h2 id="Mastering-Concurrency-In-Go-â€”-With-Select-Goroutines-and-Channels-by-Yair-Fernando-Better-Programming"><a href="#Mastering-Concurrency-In-Go-â€”-With-Select-Goroutines-and-Channels-by-Yair-Fernando-Better-Programming" class="headerlink" title="Mastering Concurrency In Go â€” With Select, Goroutines, and Channels | by Yair Fernando | Better Programming"></a>Mastering Concurrency In Go â€” With Select, Goroutines, and Channels | by Yair Fernando | Better Programming</h2><p>URL: <a href="https://betterprogramming.pub/concurrency-with-select-goroutines-and-channels-9786e0c6be3c">https://betterprogramming.pub/concurrency-with-select-goroutines-and-channels-9786e0c6be3c</a><br><img src="https://s2.loli.net/2023/12/01/K1eQ8J7zHS6ogMb.png" alt="image.png"></p><blockquote><p>ä½¿ç”¨ select goroutine channel æŒæ¡å¹¶å‘</p></blockquote><h3 id="åˆ©ç”¨-select-å¤šä¸ª-channelï¼Œæ¥æ§åˆ¶æœ€æ—©å®Œæˆçš„çº¿ç¨‹ï¼ŒåŒæ—¶æŠ›å¼ƒå…¶ä»–çº¿ç¨‹"><a href="#åˆ©ç”¨-select-å¤šä¸ª-channelï¼Œæ¥æ§åˆ¶æœ€æ—©å®Œæˆçš„çº¿ç¨‹ï¼ŒåŒæ—¶æŠ›å¼ƒå…¶ä»–çº¿ç¨‹" class="headerlink" title="åˆ©ç”¨ select å¤šä¸ª channelï¼Œæ¥æ§åˆ¶æœ€æ—©å®Œæˆçš„çº¿ç¨‹ï¼ŒåŒæ—¶æŠ›å¼ƒå…¶ä»–çº¿ç¨‹"></a>åˆ©ç”¨ select å¤šä¸ª channelï¼Œæ¥æ§åˆ¶æœ€æ—©å®Œæˆçš„çº¿ç¨‹ï¼ŒåŒæ—¶æŠ›å¼ƒå…¶ä»–çº¿ç¨‹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">quickestApiResponse</span><span class="params">(functions []*Function)</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> articles []*Article</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, function := <span class="keyword">range</span> functions &#123;</span><br><span class="line">function.Run()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> googleNewsResponse := &lt;-google:</span><br><span class="line">fmt.Printf(<span class="string">&quot;Source: %s\n&quot;</span>, googleNewsResponse.Source)</span><br><span class="line">articles = googleNewsResponse.Articles</span><br><span class="line"><span class="keyword">case</span> freeNewsReponse := &lt;-free:</span><br><span class="line">fmt.Printf(<span class="string">&quot;Source: %s\n&quot;</span>, freeNewsReponse.Source)</span><br><span class="line">articles = freeNewsReponse.Articles</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;Articles %v\n&quot;</span>, articles)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ©ç”¨-time-After-è¿”å›çš„-channelï¼Œæ¥æ§åˆ¶è¾¾åˆ°è¶…æ—¶æ—¶é—´åé€€å‡ºæ‰€æœ‰çš„çº¿ç¨‹"><a href="#åˆ©ç”¨-time-After-è¿”å›çš„-channelï¼Œæ¥æ§åˆ¶è¾¾åˆ°è¶…æ—¶æ—¶é—´åé€€å‡ºæ‰€æœ‰çš„çº¿ç¨‹" class="headerlink" title="åˆ©ç”¨ time.After è¿”å›çš„ channelï¼Œæ¥æ§åˆ¶è¾¾åˆ°è¶…æ—¶æ—¶é—´åé€€å‡ºæ‰€æœ‰çš„çº¿ç¨‹"></a>åˆ©ç”¨ time.After è¿”å›çš„ channelï¼Œæ¥æ§åˆ¶è¾¾åˆ°è¶…æ—¶æ—¶é—´åé€€å‡ºæ‰€æœ‰çš„çº¿ç¨‹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;, <span class="number">1</span>)  </span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">fmt.Println(<span class="string">&quot;do something...&quot;</span>)  </span><br><span class="line">time.Sleep(<span class="number">4</span>*time.Second)  </span><br><span class="line">ch&lt;- <span class="keyword">struct</span>&#123;&#125;&#123;&#125;  </span><br><span class="line">&#125;()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">select</span> &#123;  </span><br><span class="line"><span class="keyword">case</span> &lt;-ch:  </span><br><span class="line">fmt.Println(<span class="string">&quot;done&quot;</span>)  </span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(<span class="number">3</span>*time.Second):  </span><br><span class="line">fmt.Println(<span class="string">&quot;timeout&quot;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Context-Withtimeout-æ¥æ§åˆ¶è¶…æ—¶"><a href="#Context-Withtimeout-æ¥æ§åˆ¶è¶…æ—¶" class="headerlink" title="Context.Withtimeout æ¥æ§åˆ¶è¶…æ—¶"></a>Context.Withtimeout æ¥æ§åˆ¶è¶…æ—¶</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>)  </span><br><span class="line">timeout, cancel := context.WithTimeout(context.Background(), <span class="number">3</span>*time.Second)  </span><br><span class="line"><span class="keyword">defer</span> cancel()  </span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">time.Sleep(time.Second * <span class="number">4</span>)  </span><br><span class="line">  </span><br><span class="line">ch &lt;- <span class="string">&quot;done&quot;</span>  </span><br><span class="line">&#125;()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">select</span> &#123;  </span><br><span class="line"><span class="keyword">case</span> res := &lt;-ch:  </span><br><span class="line">fmt.Println(res)  </span><br><span class="line"><span class="keyword">case</span> &lt;-timeout.Done():  </span><br><span class="line">fmt.Println(<span class="string">&quot;timout&quot;</span>, timeout.Err())  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://last9.io/blog/prometheus-vs-victoriametrics/?ref=dailydev">https://last9.io/blog/prometheus-vs-victoriametrics/?ref=dailydev</a></li><li><a href="https://rust-trends.com/newsletter/rust-in-action-10-project-ideas-to-elevate-your-skills/?ref=dailydev">https://rust-trends.com/newsletter/rust-in-action-10-project-ideas-to-elevate-your-skills/?ref=dailydev</a></li><li><a href="https://itnext.io/bloom-filters-and-go-1d5ac62557de">https://itnext.io/bloom-filters-and-go-1d5ac62557de</a></li><li><a href="https://betterprogramming.pub/concurrency-with-select-goroutines-and-channels-9786e0c6be3c">https://betterprogramming.pub/concurrency-with-select-goroutines-and-channels-9786e0c6be3c</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/12/01/AXc16Ty8hoUw3sC.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>k8så…¥é—¨åˆ°å®æˆ˜-æ»šåŠ¨æ›´æ–°ä¸ä¼˜é›…åœæœº</title>
    <link href="http://crossoverjie.top/2023/11/29/ob/k8s-rollout/"/>
    <id>http://crossoverjie.top/2023/11/29/ob/k8s-rollout/</id>
    <published>2023-11-29T06:40:10.000Z</published>
    <updated>2023-11-29T11:00:47.297Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/11/29/BPVLoC2UfX5Drv8.png" alt="rollout.png"></p><p>å½“æˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒå‘å¸ƒåº”ç”¨æ—¶ï¼Œå¿…é¡»è¦è€ƒè™‘åˆ°å½“å‰ç³»ç»Ÿè¿˜æœ‰ç”¨æˆ·æ­£åœ¨ä½¿ç”¨çš„æƒ…å†µï¼Œæ‰€ä»¥å°½é‡éœ€è¦åšåˆ°ä¸åœæœºå‘ç‰ˆã€‚</p><span id="more"></span><p>æ‰€ä»¥åœ¨å‘å¸ƒè¿‡ç¨‹ä¸­ç†è®ºä¸Šä¹‹å‰çš„ v1 ç‰ˆæœ¬ä¾ç„¶å­˜åœ¨ï¼Œå¿…é¡»å¾—ç­‰å¾… v2 ç‰ˆæœ¬å¯åŠ¨æˆåŠŸåå†åˆ é™¤å†å²çš„ v1 ç‰ˆæœ¬ã€‚</p><blockquote><p>å¦‚æœ v2 ç‰ˆæœ¬å¯åŠ¨å¤±è´¥ v1 ç‰ˆæœ¬ä¸ä¼šåšä»»ä½•æ“ä½œï¼Œä¾ç„¶èƒ½å¯¹å¤–æä¾›æœåŠ¡ã€‚</p></blockquote><h1 id="æ»šåŠ¨æ›´æ–°"><a href="#æ»šåŠ¨æ›´æ–°" class="headerlink" title="æ»šåŠ¨æ›´æ–°"></a>æ»šåŠ¨æ›´æ–°</h1><p><img src="https://s2.loli.net/2023/11/29/stqYlaFwecvhouS.png" alt="image.png"></p><p>è¿™æ˜¯æˆ‘ä»¬é¢„æœŸä¸­çš„å‘å¸ƒæµç¨‹ï¼Œè¦åœ¨ kubernetes ä½¿ç”¨è¯¥åŠŸèƒ½ä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ spec ä¸‹é…ç½®ç›¸å…³ç­–ç•¥å³å¯ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">strategy:</span></span><br><span class="line">    <span class="attr">rollingUpdate:</span></span><br><span class="line">      <span class="attr">maxSurge:</span> <span class="number">25</span><span class="string">%</span></span><br><span class="line">      <span class="attr">maxUnavailable:</span> <span class="number">25</span><span class="string">%</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">RollingUpdate</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé…ç½®çš„å«ä¹‰æ˜¯ï¼š</p><ul><li>ä½¿ç”¨æ»šåŠ¨æ›´æ–°ï¼Œå½“ç„¶è¿˜æœ‰ <strong>Recreate</strong> ç”¨äºåˆ é™¤æ—§ç‰ˆæœ¬çš„ Podï¼Œæˆ‘ä»¬åŸºæœ¬ä¸ä¼šç”¨è¿™ä¸ªç­–ç•¥ã€‚</li><li><code>maxSurge</code>ï¼šæ»šåŠ¨æ›´æ–°è¿‡ç¨‹ä¸­å¯ä»¥æœ€å¤šè¶…è¿‡é¢„æœŸ Pod æ•°é‡çš„ç™¾åˆ†æ¯”ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¡«æ•´æ•°ã€‚</li><li><code>maxUnavailable</code>ï¼šæ»šåŠ¨æ›´æ–°è¿‡ç¨‹ä¸­æœ€å¤§ä¸å¯ç”¨ Pod æ•°é‡è¶…è¿‡é¢„æœŸçš„ç™¾åˆ†æ¯”ã€‚</li></ul><p>è¿™æ ·ä¸€æ—¦æˆ‘ä»¬æ›´æ–°äº† Pod çš„é•œåƒæ—¶ï¼Œkubernetes å°±ä¼šå…ˆåˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„ Pod ç­‰å¾…ä»–å¯åŠ¨æˆåŠŸåå†é€æ­¥æ›´æ–°å‰©ä¸‹çš„ Podã€‚<br><img src="https://s2.loli.net/2023/11/29/s52LOSvECPReUnT.png"></p><h1 id="ä¼˜é›…åœæœº"><a href="#ä¼˜é›…åœæœº" class="headerlink" title="ä¼˜é›…åœæœº"></a>ä¼˜é›…åœæœº</h1><p>æ»šåŠ¨å‡çº§è¿‡ç¨‹ä¸­ä¸å¯é¿å…çš„åˆä¼šç¢°åˆ°ä¸€ä¸ªä¼˜é›…åœæœºçš„é—®é¢˜ï¼Œæ¯•ç«Ÿæ˜¯éœ€è¦åœæ‰è€çš„ Podã€‚</p><p>è¿™æ—¶æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸¤ç§æƒ…å†µï¼š</p><ul><li>åœæœºè¿‡ç¨‹ä¸­ï¼Œå·²ç»è¿›å…¥ Pod çš„è¯·æ±‚éœ€è¦æ‰§è¡Œå®Œæ¯•æ‰èƒ½é€€å‡ºã€‚</li><li>åœæœºä¹‹åä¸èƒ½å†æœ‰è¯·æ±‚è·¯ç”±åˆ°å·²ç»åœæœºçš„ Pod</li></ul><p>ç¬¬ä¸€ä¸ªé—®é¢˜å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ <code>Go</code>ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªé’©å­æ¥ç›‘å¬  <code>kubernetes</code> å‘å‡ºçš„é€€å‡ºä¿¡å·ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">quit := <span class="built_in">make</span>(<span class="keyword">chan</span> os.Signal)  </span><br><span class="line">signal.Notify(quit, syscall.SIGHUP, syscall.SIGINT, syscall.SIGTERM, syscall.SIGQUIT, syscall.SIGPIPE)  </span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;  </span><br><span class="line">    &lt;-quit  </span><br><span class="line">    log.Printf(<span class="string">&quot;quit signal received, exit \n&quot;</span>)  </span><br><span class="line">    os.Exit(<span class="number">0</span>)  </span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œæ‰§è¡Œå¯¹åº”çš„èµ„æºé‡Šæ”¾ã€‚</p><p>å¦‚æœä½¿ç”¨çš„æ˜¯ <code>spring boot</code> ä¹Ÿæœ‰å¯¹åº”çš„é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span> </span><br><span class="line"><span class="attr">shutdown:</span> <span class="string">&quot;graceful&quot;</span></span><br><span class="line"><span class="attr">spring:</span> </span><br><span class="line"><span class="attr">lifecycle:</span> </span><br><span class="line"><span class="attr">timeout-per-shutdown-phase:</span> <span class="string">&quot;20s&quot;</span></span><br></pre></td></tr></table></figure><p>å½“åº”ç”¨æ”¶åˆ°é€€å‡ºä¿¡å·åï¼Œspring boot å°†ä¸ä¼šå†æ¥æ”¶æ–°çš„è¯·æ±‚ï¼Œå¹¶ç­‰å¾…ç°æœ‰çš„è¯·æ±‚å¤„ç†å®Œæ¯•ã€‚</p><p>ä½† kubernetes ä¹Ÿä¸ä¼šæ— é™ç­‰å¾…åº”ç”¨å°† Pod å°†ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Pod ä¸­é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">terminationGracePeriodSeconds:</span> <span class="number">30</span></span><br></pre></td></tr></table></figure><p>æ¥å®šä¹‰éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ï¼Œè¿™é‡Œæ˜¯è¶…è¿‡ 30s ä¹‹åå°±ä¼šå¼ºè¡Œ kill Podã€‚</p><blockquote><p>å…·ä½“å€¼å¤§å®¶å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé…ç½®</p></blockquote><hr><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">example-container</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">example-image</span></span><br><span class="line">    <span class="attr">lifecycle:</span></span><br><span class="line">      <span class="attr">preStop:</span></span><br><span class="line">        <span class="attr">exec:</span></span><br><span class="line">          <span class="attr">command:</span> [<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;sleep 10&quot;</span>]</span><br></pre></td></tr></table></figure><p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é…ç½® <code>preStop</code> åšä¸€ä¸ª sleep æ¥ç¡®ä¿ <code>kubernetes</code> å°†å‡†å¤‡åˆ é™¤çš„ Pod åœ¨ <code>Iptable</code> ä¸­å·²ç»æ›´æ–°äº†ä¹‹åå†åˆ é™¤ <code>Pod</code>ã€‚</p><p>è¿™æ ·å¯ä»¥é¿å…ç¬¬äºŒç§æƒ…å†µï¼šå·²ç»åˆ é™¤çš„ <code>Pod</code> ä¾ç„¶è¿˜æœ‰è¯·æ±‚è·¯ç”±è¿‡æ¥ã€‚<br>å…·ä½“å¯ä»¥å‚è€ƒ <code>spring boot</code> æ–‡æ¡£ï¼š<br><a href="https://docs.spring.io/spring-boot/docs/2.4.4/reference/htmlsingle/#cloud-deployment-kubernetes-container-lifecycle">https://docs.spring.io/spring-boot/docs/2.4.4/reference/htmlsingle/#cloud-deployment-kubernetes-container-lifecycle</a></p><h1 id="å›æ»š"><a href="#å›æ»š" class="headerlink" title="å›æ»š"></a>å›æ»š</h1><p>å›æ»šå…¶å®ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å‡çº§çš„ä¸€ç§ï¼Œåªæ˜¯å‡çº§åˆ°äº†å†å²ç‰ˆæœ¬ï¼Œåœ¨ <code>kubernetes</code> ä¸­å›æ»šåº”ç”¨éå¸¸ç®€å•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</span></span><br><span class="line"> k rollout undo deployment/abc</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬</span></span><br><span class="line">k rollout undo daemonset/abc --to-revision=3</span><br></pre></td></tr></table></figure><p>åŒæ—¶ kubernetes ä¹Ÿèƒ½ä¿è¯æ˜¯æ»šåŠ¨å›æ»šçš„ã€‚</p><h1 id="ä¼˜é›…é‡å¯"><a href="#ä¼˜é›…é‡å¯" class="headerlink" title="ä¼˜é›…é‡å¯"></a>ä¼˜é›…é‡å¯</h1><p>åœ¨ä¹‹å‰çš„ <a href="https://crossoverjie.top/2023/10/19/ob/k8s-restart-pod/">å¦‚ä½•ä¼˜é›…é‡å¯ kubernetes çš„ Pod</a> é‚£ç¯‡æ–‡ç« ä¸­å†™è¿‡ï¼Œå¦‚æœæƒ³è¦ä¼˜é›…é‡å¯ Pod ä¹Ÿå¯ä»¥ä½¿ç”¨ rollout å‘½ä»¤ï¼Œå®ƒä¹Ÿä¹Ÿå¯ä»¥ä¿è¯æ˜¯æ»šåŠ¨é‡å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k rollout restart deployment/nginx</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>kubernetes</code> çš„æ»šåŠ¨æ›´æ–°ç¡®å®è¦æ¯”æˆ‘ä»¬ä»¥å¾€çš„ä¼ ç»Ÿè¿ç»´ç®€å•è®¸å¤šï¼Œå°±å‡ ä¸ªå‘½ä»¤çš„äº‹æƒ…ä¹‹å‰å¾—å†™ä¸€äº›å¤æ‚çš„è¿ç»´è„šæœ¬æ‰èƒ½å®ç°ã€‚</p><p>æœ¬æ–‡çš„æ‰€æœ‰æºç åœ¨è¿™é‡Œå¯ä»¥è®¿é—®ï¼š<br><a href="https://github.com/crossoverJie/k8s-combat">https://github.com/crossoverJie/k8s-combat</a><br>#Blog #K8s </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/11/29/BPVLoC2UfX5Drv8.png&quot; alt=&quot;rollout.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒå‘å¸ƒåº”ç”¨æ—¶ï¼Œå¿…é¡»è¦è€ƒè™‘åˆ°å½“å‰ç³»ç»Ÿè¿˜æœ‰ç”¨æˆ·æ­£åœ¨ä½¿ç”¨çš„æƒ…å†µï¼Œæ‰€ä»¥å°½é‡éœ€è¦åšåˆ°ä¸åœæœºå‘ç‰ˆã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
  </entry>
  
  <entry>
    <title>k8så…¥é—¨åˆ°å®æˆ˜-åº”ç”¨æ¢é’ˆ</title>
    <link href="http://crossoverjie.top/2023/11/25/ob/k8s-probe/"/>
    <id>http://crossoverjie.top/2023/11/25/ob/k8s-probe/</id>
    <published>2023-11-25T15:20:13.000Z</published>
    <updated>2023-11-27T05:29:50.220Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/11/26/5uwvC1TrsjMYDZF.png" alt="Probe.png"></p><p>ä»Šå¤©è¿›å…¥ <code>kubernetes</code> çš„è¿ç»´éƒ¨åˆ†ï¼ˆå¹¶ä¸æ˜¯è¿ç»´ <code>kubernetes</code>ï¼Œè€Œæ˜¯è¿ç»´åº”ç”¨ï¼‰ï¼Œå…¶å®æ—¥å¸¸æˆ‘ä»¬å¤§éƒ¨åˆ†ä½¿ç”¨ <code>kubernetes</code> çš„åŠŸèƒ½å°±æ˜¯ä»¥å¾€è¿ç»´çš„å·¥ä½œï¼Œç°åœ¨äº‘åŸç”Ÿå°†è¿ç»´å’Œç ”å‘å…³ç³»å˜å¾—æ›´ç´§å¯†äº†ã€‚</p><span id="more"></span><p>ä»Šå¤©ä¸»è¦è®²è§£ <code>Probe</code> æ¢é’ˆç›¸å…³çš„åŠŸèƒ½ï¼Œæ¢é’ˆæœ€å®ç”¨çš„åŠŸèƒ½å°±æ˜¯å¯ä»¥æ§åˆ¶åº”ç”¨ä¼˜é›…ä¸Šçº¿ã€‚</p><h1 id="å°±ç»ªæ¢é’ˆ"><a href="#å°±ç»ªæ¢é’ˆ" class="headerlink" title="å°±ç»ªæ¢é’ˆ"></a>å°±ç»ªæ¢é’ˆ</h1><p>ä¸¾ä¸ªä¾‹å­ï¼Œå½“æˆ‘ä»¬çš„ service å…³è”äº†å¤šä¸ª Pod çš„æ—¶å€™ï¼Œå…¶ä¸­ä¸€ä¸ª Pod æ­£åœ¨é‡å¯ä½†è¿˜æ²¡è¾¾åˆ°å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡çš„çŠ¶æ€ï¼Œè¿™æ—¶å€™å¦‚æœæœ‰æµé‡è¿›å…¥ã€‚</p><p>é‚£è¿™ä¸ªè¯·æ±‚è‚¯å®šå°±ä¼šå‡ºç°å¼‚å¸¸ï¼Œä»è€Œå¯¼è‡´é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå’Œ <code>kubernetes</code> æ²Ÿé€šçš„æ¸ é“ï¼Œå‘Šè¯‰å®ƒä»€ä¹ˆæ—¶å€™å¯ä»¥å°†æµé‡æ”¾è¿›æ¥ã€‚<br><img src="https://s2.loli.net/2023/11/26/StHngQR4K9vCxjf.png" alt="image.png"><br>æ¯”å¦‚å¦‚å›¾æ‰€ç¤ºçš„æƒ…å†µï¼Œçº¢è‰² <code>Pod</code> åœ¨æœªå°±ç»ªçš„æ—¶å€™å°±ä¸ä¼šæœ‰æµé‡ã€‚</p><p>ä½¿ç”¨å°±ç»ªæ¢é’ˆå°±å¯ä»¥è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">readinessProbe:</span>  </span><br><span class="line">  <span class="attr">failureThreshold:</span> <span class="number">3</span>  </span><br><span class="line">  <span class="attr">httpGet:</span>  </span><br><span class="line">    <span class="attr">path:</span> <span class="string">/ping</span>  </span><br><span class="line">    <span class="attr">port:</span> <span class="number">8081</span>  </span><br><span class="line">    <span class="attr">scheme:</span> <span class="string">HTTP</span>  </span><br><span class="line">  <span class="attr">periodSeconds:</span> <span class="number">3</span>  </span><br><span class="line">  <span class="attr">successThreshold:</span> <span class="number">1</span>  </span><br><span class="line">  <span class="attr">timeoutSeconds:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé…ç½®ä¹Ÿå¾ˆç›´æ¥ï¼š</p><ul><li>é…ç½®ä¸€ä¸ª HTTP çš„ ping æ¥å£</li><li>æ¯ä¸‰ç§’æ£€æµ‹ä¸€æ¬¡</li><li>å¤±è´¥ 3 æ¬¡åˆ™è®¤ä¸ºæ£€æµ‹å¤±è´¥</li><li>æˆåŠŸä¸€æ¬¡å°±è®¤ä¸ºæ£€æµ‹æˆåŠŸ</li></ul><blockquote><p>ä½†æ²¡æœ‰é…ç½®å°±ç»ªæ¢é’ˆæ—¶ï¼Œä¸€æ—¦ Pod çš„ <code>Endpoint</code> åŠ å…¥åˆ° service ä¸­(Pod è¿›å…¥ <code>Running</code> çŠ¶æ€)ï¼Œè¯·æ±‚å°±æœ‰å¯èƒ½è¢«è½¬å‘è¿‡æ¥ï¼Œæ‰€ä»¥é…ç½®å°±ç»ªæ¢é’ˆæ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p></blockquote><h1 id="å¯åŠ¨æ¢é’ˆ"><a href="#å¯åŠ¨æ¢é’ˆ" class="headerlink" title="å¯åŠ¨æ¢é’ˆ"></a>å¯åŠ¨æ¢é’ˆ</h1><p>è€Œå¯åŠ¨æ¢é’ˆå¾€å¾€æ˜¯å’Œå°±ç»ªæ¢é’ˆæ­é…å¹²æ´»çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸€ä¸ª Pod å¯åŠ¨æ—¶é—´è¿‡é•¿ï¼Œæ¯”å¦‚è¶…è¿‡ä¸Šé¢é…ç½®çš„å¤±è´¥æ£€æµ‹æ¬¡æ•°ï¼Œæ­¤æ—¶ Pod å°±ä¼šè¢« kubernetes é‡å¯ï¼Œè¿™æ ·å¯èƒ½ä¼šè¿›å…¥æ— é™é‡å¯çš„å¾ªç¯ã€‚</p><p>æ‰€ä»¥å¯åŠ¨æ¢é’ˆå¯ä»¥å…ˆæ£€æµ‹ä¸€æ¬¡æ˜¯å¦å·²ç»å¯åŠ¨ï¼Œç›´åˆ°å¯åŠ¨æˆåŠŸåæ‰ä¼šåšåç»­çš„æ£€æµ‹ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">startupProbe:</span>  </span><br><span class="line">  <span class="attr">failureThreshold:</span> <span class="number">30</span>  </span><br><span class="line">  <span class="attr">httpGet:</span>  </span><br><span class="line">    <span class="attr">path:</span> <span class="string">/ping</span>  </span><br><span class="line">    <span class="attr">port:</span> <span class="number">8081</span>  </span><br><span class="line">    <span class="attr">scheme:</span> <span class="string">HTTP</span>  </span><br><span class="line">  <span class="attr">periodSeconds:</span> <span class="number">5</span>  </span><br><span class="line">  <span class="attr">successThreshold:</span> <span class="number">1</span>  </span><br><span class="line">  <span class="attr">timeoutSeconds:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><blockquote><p>æˆ‘è¿™é‡Œä¸¤ä¸ªæ£€æµ‹æ¥å£æ˜¯åŒä¸€ä¸ªï¼Œå…·ä½“å¾—æ ¹æ®è‡ªå·±æ˜¯å®é™…ä¸šåŠ¡è¿›è¡Œé…ç½®ï¼›<br>æ¯”å¦‚åº”ç”¨ç«¯å£å¯åŠ¨ä¹‹åå¹¶ä¸ä»£è¡¨ä¸šåŠ¡å·²ç»å°±ç»ªäº†ï¼Œå¯èƒ½æŸäº›åŸºç¡€æ•°æ®è¿˜æ²¡åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è‡ªå·±å†™å…¶ä»–çš„æ¥å£æ¥é…ç½®å°±ç»ªæ¢é’ˆäº†ã€‚</p></blockquote><p><img src="https://s2.loli.net/2023/11/26/AskpbIJiBovPGZ7.png" alt="image.png"></p><p>æ‰€æœ‰å…³äºæ¢é’ˆç›¸å…³çš„æ—¥å¿—éƒ½å¯ä»¥åœ¨ Pod çš„äº‹ä»¶ä¸­æŸ¥çœ‹ï¼Œæ¯”å¦‚å¦‚æœä¸€ä¸ªåº”ç”¨åœ¨å¯åŠ¨çš„è¿‡ç¨‹ä¸­é¢‘ç¹é‡å¯ï¼Œé‚£å°±å¯ä»¥çœ‹çœ‹æ˜¯ä¸æ˜¯æŸä¸ªæ¢é’ˆæ£€æµ‹å¤±è´¥äº†ã€‚</p><h1 id="å­˜æ´»æ¢é’ˆ"><a href="#å­˜æ´»æ¢é’ˆ" class="headerlink" title="å­˜æ´»æ¢é’ˆ"></a>å­˜æ´»æ¢é’ˆ</h1><p>å­˜æ´»æ¢é’ˆå¾€å¾€æ˜¯ç”¨äºä¿è¯åº”ç”¨é«˜å¯ç”¨çš„ï¼Œè™½ç„¶ kubernetes å¯ä»¥åœ¨ Pod é€€å‡ºåè‡ªåŠ¨é‡å¯ï¼Œæ¯”å¦‚ <code>Pod OOM</code>ï¼›ä½†åº”ç”¨å‡æ­»ä»–æ˜¯æ£€æµ‹ä¸å‡ºæ¥çš„ã€‚</p><p>ä¸ºäº†ä¿è¯è¿™ç§æƒ…å†µä¸‹ Pod ä¹Ÿèƒ½è¢«è‡ªåŠ¨é‡å¯ï¼Œå°±å¯ä»¥é…åˆå­˜æ´»æ¢é’ˆä½¿ç”¨ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">livenessProbe:</span>  </span><br><span class="line">  <span class="attr">failureThreshold:</span> <span class="number">3</span>  </span><br><span class="line">  <span class="attr">httpGet:</span>  </span><br><span class="line">    <span class="attr">path:</span> <span class="string">/ping</span>  </span><br><span class="line">    <span class="attr">port:</span> <span class="number">8081</span>  </span><br><span class="line">    <span class="attr">scheme:</span> <span class="string">HTTP</span>  </span><br><span class="line">  <span class="attr">periodSeconds:</span> <span class="number">3</span>  </span><br><span class="line">  <span class="attr">successThreshold:</span> <span class="number">1</span>  </span><br><span class="line">  <span class="attr">timeoutSeconds:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>ä¸€æ—¦æ¥å£å“åº”å¤±è´¥ï¼Œkubernetes å°±ä¼šå°è¯•é‡å¯ã€‚</p><p><img src="https://s2.loli.net/2023/11/26/khZlsDHLyX2WOxT.png" alt="image.png"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><img src="https://s2.loli.net/2023/11/26/jRqSIbk4HmnsTWl.png" alt="image.png"></p><p>ä»¥ä¸Šæ¢é’ˆé…ç½®æœ€å¥½æ˜¯å¯ä»¥åœ¨ç ”æ•ˆå¹³å°å¯è§†åŒ–é…ç½®ï¼Œè¿™æ ·ç»´æŠ¤èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ã€‚</p><p>æ¢é’ˆæ˜¯ç»´æŠ¤åº”ç”¨å¥åº·çš„å¿…è¦æ‰‹æ®µï¼Œå¼ºçƒˆæ¨èå¤§å®¶éƒ½è¿›è¡Œé…ç½®ã€‚</p><p>æœ¬æ–‡çš„æ‰€æœ‰æºç åœ¨è¿™é‡Œå¯ä»¥è®¿é—®ï¼š<br><a href="https://github.com/crossoverJie/k8s-combat">https://github.com/crossoverJie/k8s-combat</a><br>#Blog </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/11/26/5uwvC1TrsjMYDZF.png&quot; alt=&quot;Probe.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä»Šå¤©è¿›å…¥ &lt;code&gt;kubernetes&lt;/code&gt; çš„è¿ç»´éƒ¨åˆ†ï¼ˆå¹¶ä¸æ˜¯è¿ç»´ &lt;code&gt;kubernetes&lt;/code&gt;ï¼Œè€Œæ˜¯è¿ç»´åº”ç”¨ï¼‰ï¼Œå…¶å®æ—¥å¸¸æˆ‘ä»¬å¤§éƒ¨åˆ†ä½¿ç”¨ &lt;code&gt;kubernetes&lt;/code&gt; çš„åŠŸèƒ½å°±æ˜¯ä»¥å¾€è¿ç»´çš„å·¥ä½œï¼Œç°åœ¨äº‘åŸç”Ÿå°†è¿ç»´å’Œç ”å‘å…³ç³»å˜å¾—æ›´ç´§å¯†äº†ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬ç¬¬7ï¸âƒ£æœŸ</title>
    <link href="http://crossoverjie.top/2023/11/24/ob/newsletter/Newsletter07-20231124/"/>
    <id>http://crossoverjie.top/2023/11/24/ob/newsletter/Newsletter07-20231124/</id>
    <published>2023-11-24T09:28:25.000Z</published>
    <updated>2023-11-24T03:32:53.691Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/11/24/zGKworjfL7JkyQt.png" alt="image.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/10/13/ob/newsletter/Newsletter01-20231013/">20231013ï¼šç¬¬ä¸€æœŸ</a></li><li><a href="https://crossoverjie.top/2023/10/22/ob/newsletter/Newsletter02-20231022/">20231022ï¼šç¬¬äºŒæœŸ</a></li><li><a href="https://crossoverjie.top/2023/10/27/ob/newsletter/Newsletter03-20231027/">20231027ï¼šç¬¬ä¸‰æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/03/ob/newsletter/Newsletter04-20231103/">20231103ï¼šç¬¬å››æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/10/ob/newsletter/Newsletter05-20231110/">20231107ï¼šç¬¬äº”æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/17/ob/newsletter/Newsletter06-20231117/">20231117ï¼šç¬¬å…­æœŸ</a><span id="more"></span></li></ul><h2 id="What-is-a-JWT-Understanding-JSON-Web-Tokens"><a href="#What-is-a-JWT-Understanding-JSON-Web-Tokens" class="headerlink" title="What is a JWT? Understanding JSON Web Tokens"></a>What is a JWT? Understanding JSON Web Tokens</h2><p>URL: <a href="https://supertokens.com/blog/what-is-jwt">https://supertokens.com/blog/what-is-jwt</a></p><blockquote><p>æœ¬æ–‡ä¸»è¦è®²äº†ä¸€äº› JWT çš„åŸºæœ¬åŸç†ï¼Œä»¥åŠä¼˜ç¼ºç‚¹<br><img src="https://s2.loli.net/2023/11/20/iltd8qpuH6b75PY.png" alt="image.png"></p></blockquote><ul><li>JWT çš„ç”Ÿæˆè§„åˆ™ <code>&lt;header&gt;.&lt;body&gt;.&lt;signature&gt;</code><ul><li>ä½¿ç”¨è¯ä¹¦+ç­¾åç®—æ³•åˆ›å»ºç­¾å Key</li><li>å°† header å’Œ body çš„ç©ºæ ¼æ¢è¡Œéƒ½å»æ‰åè¿›è¡Œ base64ï¼Œç„¶åä½¿ç”¨ <code>.</code> æ‹¼æ¥èµ·æ¥ã€‚</li><li>å°†åˆšæ‰æ‹¼æ¥çš„å­—ç¬¦ä¸²ä½¿ç”¨ <code>Base64 + HMACSHA256</code> ç”Ÿæˆç­¾åã€‚</li><li>æœ€ç»ˆå°† <code>&lt;header&gt;.&lt;body&gt;.&lt;signature&gt;</code> æ‹¼æ¥æˆ <code>JWT</code>ã€‚<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Base64URLSafe</span>(   <span class="title class_">HMACSHA256</span>(<span class="string">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOiJhYmNkMTIzIiwiZXhwaXJ5IjoxNjQ2NjM1NjExMzAxfQ&quot;</span>, <span class="string">&quot;NTNv7j0TuYARvmNMmWXo6fKvM4o6nv/aUi9ryX38ZH+L1bkrnD1ObOQ8JAUmHCBq7Iy7otZcyAagBLHVKvvYaIpmMuxmARQ97jUVG16Jkpkp1wXOPsrF9zwew6TpczyHkHgX5EuLg2MeBuiT/qJACs1J0apruOOJCg/gOtkjB4c=&quot;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="title class_">Results</span> <span class="attr">in</span>:</span><br><span class="line">3Thp81rDFrKXr3WrY1MyMnNK8kKoZBX9lg-<span class="title class_">JwFznR</span>-M</span><br></pre></td></tr></table></figure></li></ul></li><li>éªŒè¯ JWT<ul><li>å…ˆè·å– headerï¼Œæ ¡éªŒå¤´é‡Œçš„ç­¾åç±»å‹å’Œç®—æ³•</li><li>è·å– bodyï¼Œç„¶åæŒ‰ç…§ä¹‹å‰çš„æ–¹å¼ <code>Base64 + HMACSHA256</code> ç”Ÿæˆç­¾å</li><li>åˆ¤æ–­ä¸¤è€…ç­¾åæ˜¯å¦ç›¸åŒï¼Œä¸åŒåˆ™éªŒè¯å¤±è´¥</li><li>åˆ¤æ–­è¿‡æœŸæ—¶é—´æ˜¯å¦è¿‡æœŸ</li></ul></li><li>JWT çš„ä¼˜ç‚¹<ul><li>å®‰å…¨æ€§ï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†ä¿è¯æ•°æ®ä¸è¢«ç¯¡æ”¹</li><li>é«˜æ•ˆï¼Œæ— çŠ¶æ€ï¼šä¸éœ€è¦å•ç‹¬ä½¿ç”¨æ•°æ®åº“å­˜å‚¨æ•°æ®ï¼Œåªä½¿ç”¨ç®—æ³•å°±èƒ½éªŒè¯</li></ul></li><li>ç¼ºç‚¹<ul><li>å› ä¸ºä»–çš„ç‹¬ç«‹æ€§å’Œæ— çŠ¶æ€ï¼Œé™¤éæ˜¯ token è¿‡æœŸäº†ï¼Œä¸ç„¶å¾ˆéš¾æ’¤é”€</li><li>ä¾èµ–äºç¬¬ä¸€æ­¥é‡Œç”Ÿæˆçš„ç­¾å Keyï¼Œä¸€æ—¦è¿™ä¸ª Key è¢«æ³„éœ²å°±ä¼šè¢«ä¼ªé€ ã€‚</li></ul></li></ul><h2 id="Go-å¼€å‘ä¸­çš„åå¤§å¸¸è§é™·é˜±-è¯‘"><a href="#Go-å¼€å‘ä¸­çš„åå¤§å¸¸è§é™·é˜±-è¯‘" class="headerlink" title="Go å¼€å‘ä¸­çš„åå¤§å¸¸è§é™·é˜±[è¯‘]"></a>Go å¼€å‘ä¸­çš„åå¤§å¸¸è§é™·é˜±[è¯‘]</h2><p>URL: <a href="https://tomotoes.com/blog/the-top-10-most-common-mistakes-ive-seen-in-go-projects/">https://tomotoes.com/blog/the-top-10-most-common-mistakes-ive-seen-in-go-projects/</a></p><blockquote><p>æœ€è¿‘åœ¨  Reddit ä¸Šçœ‹åˆ°ä¸€ä¸ªå¸–å­ï¼Œè®©æ¨èä¸€æœ¬ Go ç›¸å…³çš„ä¹¦ç±ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯æ¨èçš„ â€œ100 Go Mistakes and How to Avoid Themâ€ï¼Œç›®å‰è¿˜æ²¡æœ‰ä¸­è¯‘ç‰ˆæœ¬ï¼Œä¸è¿‡ä½œè€…ä¹‹å‰å†™è¿‡ä¸€ä¸ªåä¸ªé”™è¯¯çš„åšå®¢ï¼Œä¹Ÿå¯ä»¥é¢„å…ˆçœ‹çœ‹ã€‚</p></blockquote><ul><li>æœªçŸ¥çš„æšä¸¾å€¼ï¼Œå°†æšä¸¾çš„æœªçŸ¥å€¼è®¾ç½®ä¸º 0</li><li>è‡ªåŠ¨ä¼˜åŒ–çš„åŸºå‡†æµ‹è¯•</li><li>è¢«è½¬ç§»çš„æŒ‡é’ˆï¼Œæ—¥å¸¸å¼€å‘ä¸­å»ºè®®ä¼ å€¼ï¼Œé€Ÿåº¦ä¼šæ›´å¿«ã€‚<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">loop:  </span><br><span class="line">  <span class="keyword">for</span> &#123;  </span><br><span class="line">    <span class="keyword">select</span> &#123;  </span><br><span class="line">    <span class="keyword">case</span> &lt;-ch:  </span><br><span class="line">    <span class="comment">// Do something  </span></span><br><span class="line">    <span class="keyword">case</span> &lt;-ctx.Done():  </span><br><span class="line">      <span class="keyword">break</span> loop  </span><br><span class="line">    &#125;  </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li>å‡ºä¹æ„æ–™çš„ breakï¼Œåœ¨ select è¯­å¥ä¸­æƒ³è¦é€€å‡º for å¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨æ ‡ç­¾ã€‚</li><li>æ­£ç¡®ä¼ é€’é”™è¯¯ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨ <a href="https://github.com/pkg/errors">https://github.com/pkg/errors</a></li><li>æ‰©å®¹åˆ‡ç‰‡æœ‰æ€§èƒ½æŸè€—ï¼Œå¦‚æœçŸ¥é“é•¿åº¦å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶æŒ‡å®šé•¿åº¦ã€‚</li><li>æ­£ç¡®ä½¿ç”¨ context</li><li>åšå¥½å‡½æ•°æŠ½è±¡ï¼Œå¯ä»¥å‚è€ƒ <code>io.Reader/io.Writer</code></li><li>åœ¨ goroutine ä¸­ä½¿ç”¨å¾ªç¯è°ƒç”¨çš„æ—¶å€™éœ€è¦é¢å¤–èµ‹å€¼ï¼Œè¿™ä¸ªåœ¨  1.22 å·²ç»ä¿®å¤äº†ã€‚</li></ul><h2 id="Dapr-A-Portable-Event-Driven-Runtime-for-Building-Distributed-Applications-by-Seifeddine-Rajhi-Nov-2023-Medium"><a href="#Dapr-A-Portable-Event-Driven-Runtime-for-Building-Distributed-Applications-by-Seifeddine-Rajhi-Nov-2023-Medium" class="headerlink" title="Dapr: A Portable, Event-Driven Runtime for Building Distributed Applications | by Seifeddine Rajhi | Nov, 2023 | Medium"></a>Dapr: A Portable, Event-Driven Runtime for Building Distributed Applications | by Seifeddine Rajhi | Nov, 2023 | Medium</h2><p>URL: <a href="https://medium.com/@seifeddinerajhi/dapr-a-portable-event-driven-runtime-for-building-distributed-applications-c2ea8254406c">https://medium.com/@seifeddinerajhi/dapr-a-portable-event-driven-runtime-for-building-distributed-applications-c2ea8254406c</a></p><blockquote><p>æœ¬æ–‡ä»‹ç»äº† Dapr æ˜¯ä»€ä¹ˆï¼Œä»¥åŠç»™äº†ä¸€ä¸ªå…¥é—¨ç¤ºä¾‹</p></blockquote><p><img src="https://s2.loli.net/2023/11/23/v1LOZia9uxS8PUR.png" alt="image.png"></p><ul><li>Dapr æ˜¯ <strong>Distributed Application Runtime</strong> çš„ç®€ç§°ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯åˆ†å¸ƒå¼åº”ç”¨è¿è¡Œæ—¶ã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€ï¼Œä»»ä½•æ¡†æ¶ã€è¿è¡Œåœ¨ä»»ä½•åœ°æ–¹æ„å»ºä½ çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åº</li><li>Dapr æŠ½è±¡äº†æˆ‘ä»¬åº”ç”¨å¼€å‘ä¸­æ‰€éœ€è¦çš„å¤§éƒ¨åˆ† APIï¼Œæ‰€æœ‰ä¸è¿™äº› API äº¤äº’çš„ SDK éƒ½æ˜¯ç”± Dapr æä¾›ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å…³ç³»ä»–çš„åº•å±‚æ˜¯ä»€ä¹ˆã€‚</li></ul><h2 id="3-years-managing-Kubernetes-clusters-my-10-lessons-by-Herve-Khg-Nov-2023-Medium"><a href="#3-years-managing-Kubernetes-clusters-my-10-lessons-by-Herve-Khg-Nov-2023-Medium" class="headerlink" title="3 years managing Kubernetes clusters, my 10 lessons. | by Herve Khg | Nov, 2023 | Medium"></a>3 years managing Kubernetes clusters, my 10 lessons. | by Herve Khg | Nov, 2023 | Medium</h2><p>URL: <a href="https://hervekhg.medium.com/3-years-managing-kubernetes-clusters-my-10-lessons-b565a5509f0e">https://hervekhg.medium.com/3-years-managing-kubernetes-clusters-my-10-lessons-b565a5509f0e</a></p><blockquote><p>ä½œè€…æè¿°ä»–ä¸‰å¹´çš„ kubernetes é›†ç¾¤ç®¡ç†çš„åæ¡ç»éªŒ</p></blockquote><ul><li>åœ¨äº‘ç¯å¢ƒä½¿ç”¨ kubernetesï¼Œè¿™ä¼šæ¯”è‡ªå·±ç»´æŠ¤è¦ç®€å•å¾ˆå¤šï¼Œå³ä¾¿æ˜¯è‡ªå·±ç»´æŠ¤ä¹Ÿä¸ä¼šè®©è‡ªå·±çš„ä¸šåŠ¡èƒ½åŠ›å¾—åˆ°æˆé•¿ï¼Œæˆ–è€…æ”¶ç›Šæ€§ä»·æ¯”ä¸é«˜</li><li>ä½¿ç”¨ä»£ç æ¥éƒ¨ç½²åº”ç”¨ï¼Œé¿å…ç›´æ¥åœ¨æ§åˆ¶å°ç”¨å‘½ä»¤æ“ä½œï¼Œè¿™æ ·éš¾ä»¥è®°å½•æ“ä½œã€‚</li><li>é¿å…è¿‡åº¦ä½¿ç”¨ helmï¼ŒåŒæ—¶è¦å¯¹å……åˆ†ç†è§£å…¶ä¸­çš„é…ç½®é¡¹ï¼›è¿™ä¸ªä¹Ÿå¾ˆé‡è¦ã€‚</li><li>ä¸è¦ç›´æ¥è¿ç§»åº”ç”¨åˆ° kubernetesï¼Œå¾€å¾€éœ€è¦åšç›¸å…³çš„é€‚é…ã€‚</li><li>éå¿…è¦ä¸è¦ä½¿ç”¨ Mesh</li><li>é¿å…è¿‡å¤šçš„ä½¿ç”¨ç®¡ç†å·¥å…·ï¼Œ<code>kubernetes</code> çš„ç®¡ç†å·¥å…·æœ‰å¾ˆå¤šï¼Œä½†å¤§éƒ¨åˆ†æ“ä½œå°±é  <code>kubectl</code> å°±å¤Ÿç”¨äº†ã€‚</li><li>ä¸€å®šè¦è®°å¾—å®šä¹‰èµ„æºçš„é™åˆ¶ï¼ˆå†…å­˜å’Œ CPUï¼‰ï¼Œé¿å…ç¨‹åº bug å¯¼è‡´ kubernetes é›†ç¾¤å‡ºç°é—®é¢˜</li><li>å°½é‡ä¸è¦åœ¨ Pod ä¸­å­˜å‚¨æ•°æ®ï¼Œæ¨èä½¿ç”¨ NASã€äº‘å­˜å‚¨</li><li>é…ç½® HPAï¼Œå¯ä»¥æ ¹æ®è´Ÿè½½è‡ªåŠ¨æ‰©å®¹ Pod</li><li>ä¸è¦ç•æƒ§æ”¹å˜ï¼Œæ¯å¹´éœ€è¦å¯¹ <code>kubernetes</code> è¿›è¡Œå‡çº§ï¼Œå‡çº§å‰éœ€è¦å……åˆ†é˜…è¯» <code>ReleaseNote</code>.</li></ul><h2 id="Ten-Optimization-Tricks-to-Make-Your-Java-Application-Run-Faster-by-lance-Javarevisited-Medium"><a href="#Ten-Optimization-Tricks-to-Make-Your-Java-Application-Run-Faster-by-lance-Javarevisited-Medium" class="headerlink" title="Ten Optimization Tricks to Make Your Java Application Run Faster | by lance | Javarevisited | Medium"></a>Ten Optimization Tricks to Make Your Java Application Run Faster | by lance | Javarevisited | Medium</h2><p>URL: <a href="https://medium.com/javarevisited/ten-optimization-tricks-to-make-your-java-application-run-faster-9742f568ed6f">https://medium.com/javarevisited/ten-optimization-tricks-to-make-your-java-application-run-faster-9742f568ed6f</a></p><blockquote><p>åä¸ªä¼˜åŒ–è®© Java åº”ç”¨æ›´å¿«</p></blockquote><ol><li>å¾ªç¯æ‹¼æ¥å­—ç¬¦ä¸²ä½¿ç”¨ StringBuilder</li><li>çº¿ç¨‹æ± ä»£æ›¿è‡ªå®šä¹‰çº¿ç¨‹</li><li>å®¹å™¨ç±»é¢„å…ˆåˆ†é…å¤§å°</li><li>ç”¨æšä¸¾ä»£æ›¿å¸¸é‡</li><li>ç”¨ NIO ä»£æ›¿ä¼ ç»Ÿ IO</li><li>ç”¨ä½ç§»æ“ä½œ</li><li>å¤šä½¿ç”¨å•ä¾‹æ¨¡å¼</li><li>å‡å°‘é”çš„èŒƒå›´</li><li>å°½é‡å°‘ä½¿ç”¨å…¨å±€å˜é‡</li><li>å¤šä½¿ç”¨åŸºç¡€æ•°æ®ç±»å‹</li></ol><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://supertokens.com/blog/what-is-jwt">https://supertokens.com/blog/what-is-jwt</a></li><li><a href="https://tomotoes.com/blog/the-top-10-most-common-mistakes-ive-seen-in-go-projects/">https://tomotoes.com/blog/the-top-10-most-common-mistakes-ive-seen-in-go-projects/</a></li><li><a href="https://medium.com/@seifeddinerajhi/dapr-a-portable-event-driven-runtime-for-building-distributed-applications-c2ea8254406c">https://medium.com/@seifeddinerajhi/dapr-a-portable-event-driven-runtime-for-building-distributed-applications-c2ea8254406c</a></li><li><a href="https://hervekhg.medium.com/3-years-managing-kubernetes-clusters-my-10-lessons-b565a5509f0e">https://hervekhg.medium.com/3-years-managing-kubernetes-clusters-my-10-lessons-b565a5509f0e</a></li><li><a href="https://medium.com/javarevisited/ten-optimization-tricks-to-make-your-java-application-run-faster-9742f568ed6f">https://medium.com/javarevisited/ten-optimization-tricks-to-make-your-java-application-run-faster-9742f568ed6f</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/11/24/zGKworjfL7JkyQt.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;å†å²æ›´æ–°&quot;&gt;&lt;a href=&quot;#å†å²æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;å†å²æ›´æ–°&quot;&gt;&lt;/a&gt;å†å²æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/10/13/ob/newsletter/Newsletter01-20231013/&quot;&gt;20231013ï¼šç¬¬ä¸€æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/10/22/ob/newsletter/Newsletter02-20231022/&quot;&gt;20231022ï¼šç¬¬äºŒæœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/10/27/ob/newsletter/Newsletter03-20231027/&quot;&gt;20231027ï¼šç¬¬ä¸‰æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/11/03/ob/newsletter/Newsletter04-20231103/&quot;&gt;20231103ï¼šç¬¬å››æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/11/10/ob/newsletter/Newsletter05-20231110/&quot;&gt;20231107ï¼šç¬¬äº”æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/11/17/ob/newsletter/Newsletter06-20231117/&quot;&gt;20231117ï¼šç¬¬å…­æœŸ&lt;/a&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>å‡çº§åˆ° Pulsar3.0 åæ·±å…¥äº†è§£ JWT é‰´æƒ</title>
    <link href="http://crossoverjie.top/2023/11/19/ob/Pulsar-JWT/"/>
    <id>http://crossoverjie.top/2023/11/19/ob/Pulsar-JWT/</id>
    <published>2023-11-19T08:19:28.000Z</published>
    <updated>2023-12-28T02:14:19.273Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/11/19/gAadEDNG4piBbSl.png" alt="image.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘åœ¨æµ‹è¯•å°† <code>Pulsar</code> 2.11.2 å‡çº§åˆ° <code>3.0.1</code>çš„è¿‡ç¨‹ä¸­ç¢°åˆ°ä¸€ä¸ªé‰´æƒé—®é¢˜ï¼Œæ­£å¥½å€Ÿç€è¿™ä¸ªé—®é¢˜å……åˆ†äº†è§£ä¸‹ <code>Pulsar</code> çš„é‰´æƒæœºåˆ¶æ˜¯å¦‚ä½•è¿è½¬çš„ã€‚</p><span id="more"></span><p>Pulsar æ”¯æŒ <code>Namespace/Topic</code> çº§åˆ«çš„é‰´æƒï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¾€å¾€ä¼šä½¿ç”¨ <code>topic</code> çº§åˆ«çš„é‰´æƒï¼Œä»è€Œé˜²æ­¢æ¶ˆæ¯æ³„éœ²æˆ–è€…å…¶ä»–å› ä¸ºæƒé™ç®¡æ§ä¸ä¸¥æ ¼è€Œå¯¼è‡´çš„é—®é¢˜ã€‚</p><p><img src="https://s2.loli.net/2023/11/19/1HGIlndNFCWwAzK.png" alt="image.png"></p><p>æˆ‘ä»¬ä¼šåœ¨åˆ›å»º <code>topic</code> çš„æ—¶å€™ä¸º <code>topic</code> ç»‘å®šä¸€ä¸ªåº”ç”¨ï¼Œè¿™æ ·å°±åªèƒ½ç”±è¿™ä¸ªåº”ç”¨å‘é€æ¶ˆæ¯ï¼Œå…¶ä»–çš„åº”ç”¨å°è¯•å‘é€æ¶ˆæ¯çš„æ—¶å€™ä¼šé‡åˆ° 401 é‰´æƒçš„å¼‚å¸¸ã€‚</p><blockquote><p>åŒç†ï¼Œå¯¹äºè®¢é˜…è€…ä¹Ÿå¯ä»¥å…³è”æŒ‡å®šçš„åº”ç”¨ï¼Œä»è€Œä½¿å¾—åªæœ‰è§„å®šçš„åº”ç”¨å¯ä»¥æ¶ˆè´¹æ¶ˆæ¯ã€‚</p></blockquote><h1 id="é‰´æƒæµç¨‹"><a href="#é‰´æƒæµç¨‹" class="headerlink" title="é‰´æƒæµç¨‹"></a>é‰´æƒæµç¨‹</h1><p>ä»¥ä¸Šçš„ä¸¤ä¸ªåŠŸèƒ½æœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡ <code>Pulsar</code> çš„ <code>admin-API</code> å®ç°çš„ã€‚</p><p><img src="https://s2.loli.net/2023/11/19/zlLxTZi7rV8XvJg.png" alt="image.png"><br>è¿™é‡Œå…³é”®çš„å°±æ˜¯ <code>role</code>ï¼Œåœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸‹é€šå¸¸æ˜¯ä¸€ä¸ªåº”ç”¨çš„ <code>AppId</code>ï¼Œåªè¦æ˜¯ä¸€ä¸ªå’Œé¡¹ç›®å”¯ä¸€ç»‘å®šçš„ <code>ID</code> å³å¯ã€‚</p><p>è¿™åªæ˜¯æˆæƒçš„ä¸€æ­¥ï¼Œæ•´ä¸ªé‰´æƒæµç¨‹å›¾å¦‚ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/11/19/mGcIvBYo6SNy8gH.png"></p><h2 id="è¯¦ç»†æ­¥éª¤"><a href="#è¯¦ç»†æ­¥éª¤" class="headerlink" title="è¯¦ç»†æ­¥éª¤"></a>è¯¦ç»†æ­¥éª¤</h2><h3 id="ç”Ÿæˆå…¬ç§é’¥"><a href="#ç”Ÿæˆå…¬ç§é’¥" class="headerlink" title="ç”Ÿæˆå…¬ç§é’¥"></a>ç”Ÿæˆå…¬ç§é’¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/pulsar tokens create-key-pair --output-private-key my-private.key --output-public-key my-public.key</span><br></pre></td></tr></table></figure><p>å°†å…¬é’¥åˆ†å‘åˆ° <code>broker</code> çš„èŠ‚ç‚¹ä¸Šï¼Œé‰´æƒçš„æ—¶å€™ <code>broker</code> ä¼šä½¿ç”¨å…¬é’¥è¿›è¡ŒéªŒè¯ã€‚</p><p>è€Œç§é’¥é€šå¸¸æ˜¯ç®¡ç†å‘˜å•ç‹¬ä¿å­˜èµ·æ¥ç”¨äºåœ¨åç»­çš„æ­¥éª¤ä¸ºå®¢æˆ·ç«¯ç”Ÿæˆ <code>token</code></p><h3 id="ä½¿ç”¨ç§é’¥ç”Ÿæˆ-token"><a href="#ä½¿ç”¨ç§é’¥ç”Ÿæˆ-token" class="headerlink" title="ä½¿ç”¨ç§é’¥ç”Ÿæˆ token"></a>ä½¿ç”¨ç§é’¥ç”Ÿæˆ token</h3><p>ä¹‹åæˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨è¿™ä¸ªç§é’¥ç”Ÿæˆ <code>token</code> äº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bin/pulsar tokens create --private-key file:///path/to/my-private.key \</span><br><span class="line">            --subject 123456</span><br><span class="line"></span><br><span class="line">eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhZG1pbiJ9</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­çš„ <code>subject</code> å’Œæœ¬æ–‡é•¿æåˆ°çš„ <code>role</code> ç›¸ç­‰</p></blockquote><h3 id="ä½¿ç”¨-subject-æˆæƒ"><a href="#ä½¿ç”¨-subject-æˆæƒ" class="headerlink" title="ä½¿ç”¨ subject æˆæƒ"></a>ä½¿ç”¨ subject æˆæƒ</h3><p>åªæ˜¯å•çº¯ç”Ÿæˆäº† <code>token</code> å…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Œè¿˜å¾—å°† <code>subject</code>(role) ä¸ <code>topic</code> è¿›è¡Œæˆæƒç»‘å®šã€‚</p><p><img src="https://s2.loli.net/2023/11/19/zlLxTZi7rV8XvJg.png" alt="image.png"><br>ä¹Ÿå°±æ˜¯ä¸Šå›¾çš„è¿™ä¸ªæ­¥éª¤ã€‚</p><blockquote><p>è¿™é‡Œåˆ›å»ºçš„ <code>admin</code> å®¢æˆ·ç«¯ä¹Ÿå¾—ä½¿ç”¨ä¸€ä¸ª <code>superRole</code> è§’è‰²çš„ <code>token</code> æ‰æœ‰æƒé™è¿›è¡Œæˆæƒã€‚<br> <code>superRole</code> ä½¿ç”¨åœ¨  <code>broker.conf</code> ä¸­è¿›è¡Œé…ç½®ã€‚</p></blockquote><h3 id="å®¢æˆ·ç«¯ä½¿ç”¨-token-æ¥å…¥-broker"><a href="#å®¢æˆ·ç«¯ä½¿ç”¨-token-æ¥å…¥-broker" class="headerlink" title="å®¢æˆ·ç«¯ä½¿ç”¨ token æ¥å…¥ broker"></a>å®¢æˆ·ç«¯ä½¿ç”¨ token æ¥å…¥ broker</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PulsarClient</span> <span class="variable">client</span> <span class="operator">=</span> PulsarClient.builder()</span><br><span class="line">    .serviceUrl(<span class="string">&quot;pulsar://broker.example.com:6650/&quot;</span>)</span><br><span class="line">    .authentication(AuthenticationFactory.token(<span class="string">&quot;eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJKb2UifQ.ipevRNuRP6HflG8cFKnmUPtypruRC4fb1DWtoLL62SY&quot;</span>)ï¼‰</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åˆšæ‰ç§é’¥ç”Ÿæˆçš„ token æ¥å…¥ broker æ‰èƒ½ç”Ÿäº§æˆ–è€…æ¶ˆè´¹æ•°æ®ã€‚</p><h2 id="originalPrincipal-cannot-be-a-proxy-role"><a href="#originalPrincipal-cannot-be-a-proxy-role" class="headerlink" title="originalPrincipal cannot be a proxy role"></a>originalPrincipal cannot be a proxy role</h2><p>è¿™äº›æµç¨‹æ­£å¸¸éƒ½æ²¡å•¥é—®é¢˜ï¼Œä½†ç›´åˆ°æˆ‘å‡çº§äº† <code>Pulsar3.0</code> åå®¢æˆ·ç«¯ç›´æ¥å°±è¿ä¸ä¸Šäº†ã€‚</p><p>åœ¨ <code>broker</code> ä¸­çœ‹åˆ°äº† <code>WARN</code> çš„è­¦å‘Šæ—¥å¿—ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cannot specify originalPrincipal when connecting without valid proxy role</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/11/19/8atrUwAj2Tg6GLu.jpg" alt="image.png"><br>ä¹‹ååœ¨ 3.0 çš„å‡çº§æ—¥å¿—ä¸­çœ‹åˆ°ç›¸å…³çš„ <a href="https://github.com/apache/pulsar/pull/19455">Issue</a>ã€‚</p><p>ä»è¿™ä¸ª PR ç›¸å…³çš„ä»£ç å’Œå˜æ›´çš„æ–‡æ¡£å¯ä»¥å¾—çŸ¥ï¼š<br><img src="https://s2.loli.net/2023/11/19/3ktMOS6IjDu9nmE.png" alt="image.png"><br><img src="https://s2.loli.net/2023/11/19/fpJ8CuwnlXdhxWm.png" alt="image.png"></p><p>å‡çº§åˆ° 3.0 ä¹‹åé£é™©æ ¡éªŒç­‰çº§æé«˜äº†ï¼Œ<code>proxyRole</code> è¿™ä¸ªå­—æ®µéœ€è¦åœ¨ <code>broker</code> ä¸­è¿›è¡ŒæŒ‡å®šï¼ˆä¹‹å‰çš„ç‰ˆæœ¬ä¸éœ€è¦å¼ºåˆ¶å¡«å†™ï¼‰ã€‚</p><p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº† Proxy ç»„ä»¶ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½éœ€è¦ä» proxy ä¸­è½¬ä¸€æ¬¡ï¼Œè¿™ä¸ª proxyRole æ˜¯ä¸ºäº†å‘Šè¯‰ brokerï¼šåªæœ‰ä½¿ç”¨äº† <code>proxyRole</code> ä½œä¸º <code>token</code> çš„ <code>Proxy</code> æ‰èƒ½è®¿é—® brokerï¼Œè¿™æ ·ä¿è¯äº† <code>broker</code> çš„å®‰å…¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">superUserRoles: broker-admin,admin,proxy-admin </span><br><span class="line">proxyRoles: proxy-admin</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯æˆ‘çš„é…ç½®ï¼Œæˆ‘çš„ Proxy é…ç½®çš„ä¹Ÿæ˜¯ <code>proxy-admin</code> è¿™ä¸ª tokenï¼Œæ‰€ä»¥ç†è®ºä¸Šæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†ä¾ç„¶é‰´æƒå¤±è´¥äº†ï¼ŒæŸ¥çœ‹ broker çš„æ—¥å¿—åæ‹¿åˆ°ä»¥ä¸‹æ—¥å¿—ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Illegal combination of role [proxy-admin] and originalPrincipal [proxy-admin]: originalPrincipal cannot be a proxy role.</span><br></pre></td></tr></table></figure><p>æ’æŸ¥äº†è®¸ä¹…ä¾ç„¶æ²¡æœ‰å¤ªå¤šå¤´ç»ªï¼Œæ‰€ä»¥æˆ‘æäº†ç›¸å…³çš„ issue:<br><a href="https://github.com/apache/pulsar/issues/21583">https://github.com/apache/pulsar/issues/21583</a><br>ä¹‹åæˆ‘å’¨è¯¢äº† <code>Pulsar</code> çš„ PMC <a href="https://github.com/Technoboy-">@Technoboy</a>  åœ¨ä»–çš„æç¤ºä¸‹å‘ç°æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯ <code>proxy-admin</code>ï¼Œæ­£å¥½å’Œ <code>proxyRoles</code> ç›¸ç­‰ã€‚<br><img src="https://s2.loli.net/2023/11/19/AuoY8Sq4FPUVHjN.png" alt="image.png"><br>é˜…è¯»æºç å’Œè¿™ä¸ª <code>PR</code> çš„ <code>comment</code> ä¹‹åå¾—çŸ¥ï¼š<br><img src="https://s2.loli.net/2023/11/19/pTbQkj2rOKnHNwS.png" alt="image.png"><br>ä¹Ÿå°±æ˜¯è¯´å®¢æˆ·ç«¯ä¸èƒ½ä½¿ç”¨å’Œ <code>proxyRole</code> ç›¸åŒçš„è§’è‰²è¿›è¡Œè¿æ¥ï¼Œè¿™ä¸ªè§’è‰²åº”å½“ä¹Ÿåªèƒ½ç»™ <code>Proxy</code> ä½¿ç”¨ï¼Œè¿™æ ·çš„å®‰å…¨æ€§æ‰ä¼šé«˜ã€‚</p><p>æ‰€ä»¥è¿™ä¸ª Comment è¿˜åœ¨è®¨è®ºè¿™æ˜¯ä¸€ä¸ª <code>breaking change?</code> è¿˜æ˜¯ä¸€ä¸ªå¢å¼ºè¡¥ä¸ã€‚<br>å› ä¸ºåˆå¹¶è¿™ä¸ª PR åå¯¹æ²¡æœ‰ä½¿ç”¨ <code>proxyRole</code> çš„å®¢æˆ·ç«¯å°†æ— æ³•è¿æ¥ï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½å‡ºç°æˆ‘è¿™ç§ <code>proxyRole</code> å°±æ˜¯å®¢æˆ·ç«¯ä½¿ç”¨çš„è§’è‰²ï¼Œè¿™ç§æƒ…å†µä¹Ÿä¼šé‰´æƒå¤±è´¥ã€‚</p><p>æ‰€ä»¥æˆ‘æ¢äº†ä¸€ä¸ª superRole è§’è‰²å°±å¯ä»¥äº†ï¼Œæ¯”å¦‚æ¢æˆäº† <code>admin</code>ã€‚</p><blockquote><p>ä½†å…¶å®å³ä¾¿æ˜¯æ”¾åˆ°æˆ‘ä»¬çš„ç”Ÿäº§ç³»ç»Ÿï¼Œåªè¦é…ç½®äº† <code>proxyRole</code> ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬åº”ç”¨æ‰€ä½¿ç”¨çš„ role éƒ½æ˜¯ä¸è¿™é‡Œçš„ <code>superUserRole</code>ï¼Œå…¨éƒ¨éƒ½æ˜¯ä½¿ç”¨ <code>AppId</code> ç”Ÿæˆçš„ã€‚</p></blockquote><h1 id="token-ä¸ä¸€è‡´"><a href="#token-ä¸ä¸€è‡´" class="headerlink" title="token ä¸ä¸€è‡´"></a>token ä¸ä¸€è‡´</h1><p>ä½†ä¹Ÿæœ‰ä¸€ä¸ªç–‘æƒ‘ï¼Œæˆ‘åœ¨æ¢ä¸ºå­˜æ”¾åœ¨ <code>configmap</code> ä¸­çš„ admin token ä¹‹å‰(æµ‹è¯•ç¯å¢ƒä½¿ç”¨çš„æ˜¯ helm å®‰è£…é›†ç¾¤ï¼Œæ‰€ä»¥è¿™äº› token éƒ½æ˜¯å­˜æ”¾åœ¨ configmap ä¸­çš„)ï¼Œ</p><p>ä¸ºäº†éªŒè¯æ˜¯å¦åªè¦é <code>proxyRole</code> çš„ <code>superRole</code> éƒ½å¯ä»¥ä½¿ç”¨ï¼Œæˆ‘å°±è‡ªå·±ä½¿ç”¨äº†ç§é’¥é‡æ–°ç”Ÿæˆäº†ä¸€ä¸ª <code>admin</code> çš„ <code>token</code>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/pulsar tokens create --private-key file:///pulsar/private/private.key --subject admin</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç”Ÿæˆçš„ <code>token</code> ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œä½†æ˜¯æˆ‘å°† token å¤åˆ¶å‡ºæ¥ä¹‹åå´å‘ç° helm ç”Ÿæˆçš„ <code>token</code> ä¸æˆ‘ç”¨ <code>pulsar</code> å‘½ä»¤è¡Œç”Ÿæˆçš„ <code>token</code> å¹¶ä¸ç›¸åŒã€‚</p><p>ä¸ºäº†ææ¸…æ¥šä¸ºä»€ä¹ˆ token ä¸åŒä½†é‰´æƒä¾ç„¶å¯ä»¥é€šè¿‡çš„åŸå› ï¼Œä¹‹åæˆ‘å°† token decodeä¹‹åçŸ¥é“äº†åŸå› ï¼š<br><img src="https://s2.loli.net/2023/11/19/rKMRqGsmTDvLnZ2.png" alt="image.png"><br><img src="https://s2.loli.net/2023/11/19/xZn4v5EIFwXMRKk.png" alt="image.png"><br>åŸæ¥æ˜¯ Header ä¸åŒä»è€Œå¯¼è‡´æœ€ç»ˆçš„ token ä¸åŒï¼Œhelm ç”Ÿæˆçš„ <code>token</code> ä¸­å¤šäº†ä¸€ä¸ª typ å­—æ®µã€‚</p><hr><p>ä¹‹åæˆ‘æ£€æŸ¥äº† helm å®‰è£…çš„æµç¨‹ï¼Œå‘ç°åŸæ¥ helm çš„è„šæœ¬ä¸­ä½¿ç”¨çš„å¹¶ä¸æ˜¯ Java çš„å‘½ä»¤è¡Œå·¥å…·ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;PULSARCTL_BIN&#125; token create -a RS256 --private-key-file <span class="variable">$&#123;privatekeytmpfile&#125;</span> --subject <span class="variable">$&#123;role&#125;</span> 2&amp;&gt; <span class="variable">$&#123;tokentmpfile&#125;</span></span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ª <code>PULSARCTL_BIN</code> æ˜¯ä¸€ä¸ªç”± Go å†™çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæˆ‘æŸ¥çœ‹äº†å…¶ä¸­çš„æºç ï¼Œæ‰çŸ¥é“ Go çš„ JWT å·¥å…·ä¼šè‡ªå¸¦ä¸€ä¸ª headerã€‚<br><a href="https://github.com/streamnative/pulsarctl">https://github.com/streamnative/pulsarctl</a></p><p><img src="https://s2.loli.net/2023/11/19/kZ2zaOfo7PbvT4j.png" alt="image.png"><br>è€Œ <code>Java</code> æ˜¯æ²¡æœ‰è¿™ä¸ªé€»è¾‘çš„ï¼Œä½†ä¹Ÿåªæ˜¯åŠ äº† <code>header</code>ï¼Œ<code>payload</code> çš„å€¼éƒ½æ˜¯ç›¸åŒçš„ã€‚<br>è¿™æ ·ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆ <code>token</code> ä¸åŒä½†ç¡®ä¾ç„¶èƒ½ä½¿ç”¨çš„åŸå› ã€‚</p><p>#Blog #Pulsar </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/11/19/gAadEDNG4piBbSl.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;æœ€è¿‘åœ¨æµ‹è¯•å°† &lt;code&gt;Pulsar&lt;/code&gt; 2.11.2 å‡çº§åˆ° &lt;code&gt;3.0.1&lt;/code&gt;çš„è¿‡ç¨‹ä¸­ç¢°åˆ°ä¸€ä¸ªé‰´æƒé—®é¢˜ï¼Œæ­£å¥½å€Ÿç€è¿™ä¸ªé—®é¢˜å……åˆ†äº†è§£ä¸‹ &lt;code&gt;Pulsar&lt;/code&gt; çš„é‰´æƒæœºåˆ¶æ˜¯å¦‚ä½•è¿è½¬çš„ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
  </entry>
  
  <entry>
    <title>æŠ€æœ¯é˜…è¯»å‘¨åˆŠç¬¬ç¬¬6ï¸âƒ£æœŸ</title>
    <link href="http://crossoverjie.top/2023/11/17/ob/newsletter/Newsletter06-20231117/"/>
    <id>http://crossoverjie.top/2023/11/17/ob/newsletter/Newsletter06-20231117/</id>
    <published>2023-11-17T09:28:25.000Z</published>
    <updated>2023-11-17T06:00:24.349Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/11/17/yZANlmctghPTJDj.png" alt="image.png"></p><p><strong>æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚</strong></p><h2 id="å†å²æ›´æ–°"><a href="#å†å²æ›´æ–°" class="headerlink" title="å†å²æ›´æ–°"></a>å†å²æ›´æ–°</h2><ul><li><a href="https://crossoverjie.top/2023/10/13/ob/newsletter/Newsletter01-20231013/">20231013ï¼šç¬¬ä¸€æœŸ</a></li><li><a href="https://crossoverjie.top/2023/10/22/ob/newsletter/Newsletter02-20231022/">20231022ï¼šç¬¬äºŒæœŸ</a></li><li><a href="https://crossoverjie.top/2023/10/27/ob/newsletter/Newsletter03-20231027/">20231027ï¼šç¬¬ä¸‰æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/03/ob/newsletter/Newsletter04-20231103/">20231103ï¼šç¬¬å››æœŸ</a></li><li><a href="https://crossoverjie.top/2023/11/10/ob/newsletter/Newsletter05-20231110/ni">20231007ï¼šç¬¬äº”æœŸ</a><span id="more"></span></li></ul><h2 id="5-Skills-the-Best-Engineers-I-Know-Have-in-Common"><a href="#5-Skills-the-Best-Engineers-I-Know-Have-in-Common" class="headerlink" title="5 Skills the Best Engineers I Know Have in Common"></a>5 Skills the Best Engineers I Know Have in Common</h2><p>URL: <a href="https://www.developing.dev/p/5-skills-all-10x-engineers-have?utm_source=post-email-title&amp;publication_id=1340878&amp;post_id=138715343&amp;utm_campaign=email-post-title&amp;isFreemail=true&amp;r=4buvd&amp;utm_medium=email">https://www.developing.dev/p/5-skills-all-10x-engineers-have?utm_source=post-email-title&amp;publication_id=1340878&amp;post_id=138715343&amp;utm_campaign=email-post-title&amp;isFreemail=true&amp;r=4buvd&amp;utm_medium=email</a></p><blockquote><p>ä½œè€…è®²è¿°äº†ä»–èº«è¾¹æœ€å¥½çš„å·¥ç¨‹å¸ˆéƒ½å…·å¤‡çš„äº”ä¸ªé€šç”¨æŠ€èƒ½</p></blockquote><p><img src="https://s2.loli.net/2023/11/13/5NCshr4JWIemotP.png" alt="image.png"></p><ul><li>æŠ€æœ¯çš„æ·±åº¦ä¸å¹¿åº¦<ul><li>å¯¹äºæœ€å¥½çš„å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œæ·±åº¦å’Œå¹¿åº¦ä»–ä»¬éƒ½ä¼šæŒæ¡</li><li>è¦ä¿æŒå¥½å¥‡å¿ƒï¼Œå¥½å¥‡å¿ƒæ˜¯å­¦ä¹ ä»»ä½•æ–°ä¸œè¥¿çš„åŸå§‹åŠ¨åŠ›</li><li>å’Œèº«è¾¹å‰å®³çš„å·¥ç¨‹å¸ˆä¸€èµ·å·¥ä½œï¼Œä¼šå¿«é€Ÿä»ä»–ä»¬èº«ä¸Šå­¦åˆ°ä¸œè¥¿</li></ul></li><li>ä¸ç”¨æƒå¨å»å½±å“ä»–äºº<ul><li>æˆ‘ç†è§£çš„æ˜¯ä¸æ˜¯ä¾é èµ„å†ã€ç»éªŒæ¥å‘ä»–äººè¾“å‡ºè§‚ç‚¹ï¼›è€Œæ˜¯å°±äº‹è®ºäº‹ï¼Œåˆ©ç”¨çŸ¥è¯†ã€æŠ€èƒ½æ¥è¾“å‡ºã€‚</li><li>é”»ç‚¼å†™ä½œå’Œå£è¯­</li><li>å­¦ä¼šé”€å”®</li></ul></li><li>æå‡ä»–äºº<ul><li>åˆ†äº«çŸ¥è¯†ï¼Œå†™ WIKIã€åšåˆ†äº«</li><li>å›¢é˜Ÿåä½œï¼šcodereviewã€å›¢é˜Ÿè®¨è®ºç­‰</li><li>æ„å»ºå·¥å…·ï¼Œè§£å†³å¤§å®¶é‡åˆ°çš„ä¸€äº›å…±æ€§é—®é¢˜ã€‚</li></ul></li><li>è¦æœ‰ä¸»äººå…¬æ„è¯†<ul><li>è¿™äº›å·¥ç¨‹å¸ˆéƒ½æœ‰ä¸»äººå…¬æ„è¯†ã€‚</li><li>åƒè€æ¿ä¸€æ ·æ€è€ƒé—®é¢˜</li></ul></li></ul><h2 id="Explaining-9-Types-of-API-Testing"><a href="#Explaining-9-Types-of-API-Testing" class="headerlink" title="Explaining 9 Types of API Testing"></a>Explaining 9 Types of API Testing</h2><p>URL: <a href="https://blog.bytebytego.com/p/ep83-explaining-9-types-of-api-testing?ref=dailydev">https://blog.bytebytego.com/p/ep83-explaining-9-types-of-api-testing?ref=dailydev</a><br><img src="https://s2.loli.net/2023/11/14/LrPN8GQ4FjuTISa.gif"></p><blockquote><p>ä»‹ç»äº†ä¹ç§å¸¸è§çš„ API æµ‹è¯•æ–¹æ³•</p></blockquote><ul><li>å†’çƒŸæµ‹è¯•ï¼šç®€å•çš„éªŒè¯ API æ˜¯å¦å¯ä»¥æ­£å¸¸å·¥ä½œ</li><li>åŠŸèƒ½æµ‹è¯•ï¼šæ ¹æ®éœ€æ±‚è¿›è¡Œæµ‹è¯•ï¼Œæœ‰é¢„æœŸç»“æœè¿›è¡Œæ¯”è¾ƒ</li><li>é›†æˆæµ‹è¯•ï¼šç»“åˆå¤šä¸ª API å®Œæˆé›†æˆæµ‹è¯•ï¼Œæ›´å®Œå–„çš„åŠŸèƒ½æµ‹è¯•</li><li>å›å½’æµ‹è¯•ï¼šç¡®ä¿æ–°å¢åŠŸèƒ½æ²¡æœ‰å½±å“åˆ°åŸæœ‰çš„ API</li><li>è´Ÿè½½æµ‹è¯•ï¼šæ¨¡æ‹Ÿä¸åŒçš„è´Ÿè½½è¿›è¡Œæµ‹è¯•ï¼Œæµ‹å‡ºç³»ç»Ÿå¯æ”¯æŒçš„æœ€å¤§å®¹é‡</li><li>å‹åŠ›æµ‹è¯•ï¼šæ¨¡æ‹Ÿé«˜è´Ÿè½½åœºæ™¯ï¼Œåœ¨è¿™ç§å‹åŠ›æƒ…å†µä¸‹è§‚å¯Ÿ API è¡Œä¸º</li><li>å®‰å…¨æµ‹è¯•ï¼šæ¨¡æ‹Ÿå¤–éƒ¨å®‰å…¨æµ‹è¯•</li><li>UIæµ‹è¯•ï¼šé…åˆ UI äº¤äº’è¿›è¡ŒåŠŸèƒ½æµ‹è¯•</li><li>æ¨¡ç³Šæµ‹è¯•ï¼šå¯¹ API è¿›è¡Œæ— æ•ˆè¾“å…¥ï¼Œå°è¯•è®© API å´©æºƒ</li></ul><blockquote><p>å®é™…æƒ…å†µå¯èƒ½å¹¶ä¸ä¼šåˆ†çš„è¿™ä¹ˆç»†ï¼Œå¾€å¾€ä¼šå°†ä¸€äº›æ­¥éª¤åˆå¹¶åœ¨ä¸€èµ·ã€‚</p></blockquote><h2 id="Prometheus-14-ç‚¹å®è·µç»éªŒåˆ†äº«"><a href="#Prometheus-14-ç‚¹å®è·µç»éªŒåˆ†äº«" class="headerlink" title="Prometheus 14 ç‚¹å®è·µç»éªŒåˆ†äº«"></a>Prometheus 14 ç‚¹å®è·µç»éªŒåˆ†äº«</h2><p>URL: <a href="https://mp.weixin.qq.com/s/z2IVP26swYaTeiPTeOMoQw">https://mp.weixin.qq.com/s/z2IVP26swYaTeiPTeOMoQw</a><br><img src="https://s2.loli.net/2023/11/16/8TKa5VBeX4jfdMr.png" alt="image.png"><br>è¿™æ˜¯ä¸€ç¯‡ 17 å¹´çš„ <code>Prometheus</code> ä½¿ç”¨åˆ†äº«ï¼Œä½†æ”¾åˆ°ç°åœ¨ä¸€ç‚¹ä¹Ÿä¸è¿‡æ—¶ã€‚</p><ul><li>ä½¿ç”¨ USE ç†è®ºæ¥åˆ¤æ–­èµ„æºæ˜¯å¦å¥åº·<ul><li>Utilization åˆ©ç”¨ç‡</li><li>Saturation é¥±å’Œç‡</li><li>Errors é”™è¯¯</li></ul></li><li>ä½¿ç”¨ RED ç†è®º<ul><li>Request rate è¯·æ±‚é€Ÿç‡</li><li>Error rate é”™è¯¯é€Ÿç‡</li><li>Duration æŒç»­æ—¶é—´</li></ul></li><li>æŒ‡æ ‡å‘½åéœ€è¦æœ‰è§„èŒƒ<ul><li>é€šå¸¸ä½¿ç”¨æ¡†æ¶ç”Ÿæˆçš„éƒ½æ²¡å•¥é—®é¢˜</li><li>å¯ä»¥å‚è€ƒ Prometheus çš„å®˜æ–¹å®è·µ <a href="https://prometheus.io/docs/practices/naming/">https://prometheus.io/docs/practices/naming/</a></li></ul></li><li>æ³¨æ„æŒ‡æ ‡åŸºæ•°<ul><li>é¿å…åŸºæ•°çˆ†ç‚¸çš„ï¼Œæ¯”å¦‚ä¸èƒ½ä½¿ç”¨ user_id, trace_id ç­‰ä½œä¸ºæŒ‡æ ‡çš„ label</li></ul></li><li>ç»Ÿè®¡å¤±è´¥+æ€»é‡è€Œä¸è¦ç»Ÿè®¡å¤±è´¥+æˆåŠŸé‡</li><li>å‘Šè­¦ç—‡çŠ¶è€ŒéåŸå› </li><li>å‘Šè­¦è§„åˆ™éœ€è¦é…ç½®æŒç»­æ—¶é—´ï¼Œé¿å…æ— æ•ˆå‘Šè­¦</li><li>æŸ¥è¯¢æ—¶å€™é€šå¸¸å…ˆæ±‚ rate() å†æ±‚ sum()</li></ul><h2 id="ç¨‹åºå‘˜å¯èƒ½å¿…è¯»ä¹¦å•æ¨èï¼ˆä¸€ï¼‰-é¢å‘ä¿¡ä»°ç¼–ç¨‹"><a href="#ç¨‹åºå‘˜å¯èƒ½å¿…è¯»ä¹¦å•æ¨èï¼ˆä¸€ï¼‰-é¢å‘ä¿¡ä»°ç¼–ç¨‹" class="headerlink" title="ç¨‹åºå‘˜å¯èƒ½å¿…è¯»ä¹¦å•æ¨èï¼ˆä¸€ï¼‰ - é¢å‘ä¿¡ä»°ç¼–ç¨‹"></a>ç¨‹åºå‘˜å¯èƒ½å¿…è¯»ä¹¦å•æ¨èï¼ˆä¸€ï¼‰ - é¢å‘ä¿¡ä»°ç¼–ç¨‹</h2><p>URL: <a href="https://draveness.me//books-1">https://draveness.me//books-1</a></p><blockquote><p>draveness å¤§ä½¬æ¨èçš„éƒ½æ˜¯ä¸€äº›åä½å±‚çš„ï¼Œé™å¾—ä¸‹å¿ƒçš„å¯ä»¥çœ‹çœ‹ï¼Œæˆ‘è§‰å¾—æˆ‘æ˜¯çœ‹ä¸ä¸‹æ¥çš„ã€‚</p></blockquote><ul><li>SICP ã€Šè®¡ç®—æœºç¨‹åºçš„æ„é€ å’Œè§£é‡Šã€‹</li><li>CTMCP ã€Šè®¡ç®—æœºç¨‹åºè®¾è®¡çš„æ¦‚å¿µã€æŠ€æœ¯å’Œæ¨¡å‹ã€‹</li><li>DDIA ã€Šè®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨ã€‹</li></ul><h2 id="TOP-20-Goæœ€ä½³å®è·µ"><a href="#TOP-20-Goæœ€ä½³å®è·µ" class="headerlink" title="TOP 20 Goæœ€ä½³å®è·µ"></a>TOP 20 Goæœ€ä½³å®è·µ</h2><p>URL: <a href="https://colobu.com/2023/11/17/golang-quick-reference-top-20-best-coding-practices/">https://colobu.com/2023/11/17/golang-quick-reference-top-20-best-coding-practices/</a></p><blockquote><p>éƒ½æ˜¯ä¸€äº›åŸºæœ¬å¥—è·¯ï¼Œå„ç§è¯­è¨€çš„ä½¿ç”¨è€…éƒ½æ¨èæŒæ¡</p></blockquote><ul><li>é€‚å½“ä½¿ç”¨ç¼©è¿›ï¼Œæ¨èç»Ÿä¸€ä½¿ç”¨ <code>gofmt</code></li><li>å˜é‡å’Œå‡½æ•°åå…·æœ‰æ„ä¹‰</li><li>é™åˆ¶è¡Œé•¿åº¦ï¼ŒIDE é€šå¸¸éƒ½ä¼šæœ‰æç¤º</li><li>ä½¿ç”¨å¸¸é‡ä»£æ›¿é­”æ³•å€¼</li><li>æ˜¾ç¤ºå¤„ç†é”™è¯¯</li><li>é¿å…ä½¿ç”¨å…¨å±€å˜é‡</li><li>ä½¿ç”¨ç»“æ„ä½“å¤„ç†å¤æ‚é€»è¾‘ï¼Œæ›´æ˜“ç»´æŠ¤</li><li>ä½¿ç”¨ <code>goroutines</code> å¤„ç†å¹¶å‘</li><li>ä½¿ç”¨ Recover å¤„ç† panic</li><li>é¿å…ä½¿ç”¨ Init å‡½æ•°ï¼Œæ›´å®¹æ˜“ç»´æŠ¤</li><li>ä½¿ç”¨ Defer æ¸…ç†èµ„æº</li><li>ä½¿ç”¨å¤åˆå­—é¢å€¼è€Œéæ„é€ å‡½æ•°</li><li>ä½¿ç”¨æ˜¾ç¤ºè¿”å›å€¼è€Œéå…·åè¿”å›å€¼ï¼Œä¹Ÿæ˜¯ä»£ç æ›´æ˜“è¯»</li><li>é¿å…å˜é‡å±è”½ï¼Œæ˜“è¯»æ€§</li><li>ä½¿ç”¨æ¥å£æŠ½è±¡</li></ul><p>æ–‡ç« é“¾æ¥ï¼š</p><ul><li><a href="https://www.developing.dev/p/5-skills-all-10x-engineers-have?utm_source=post-email-title&amp;publication_id=1340878&amp;post_id=138715343&amp;utm_campaign=email-post-title&amp;isFreemail=true&amp;r=4buvd&amp;utm_medium=email">https://www.developing.dev/p/5-skills-all-10x-engineers-have?utm_source=post-email-title&amp;publication_id=1340878&amp;post_id=138715343&amp;utm_campaign=email-post-title&amp;isFreemail=true&amp;r=4buvd&amp;utm_medium=email</a></li><li><a href="https://blog.bytebytego.com/p/ep83-explaining-9-types-of-api-testing?ref=dailydev">https://blog.bytebytego.com/p/ep83-explaining-9-types-of-api-testing?ref=dailydev</a></li><li><a href="https://mp.weixin.qq.com/s/z2IVP26swYaTeiPTeOMoQw">https://mp.weixin.qq.com/s/z2IVP26swYaTeiPTeOMoQw</a></li><li><a href="https://draveness.me//books-1">https://draveness.me//books-1</a></li><li><a href="https://colobu.com/2023/11/17/golang-quick-reference-top-20-best-coding-practices/">https://colobu.com/2023/11/17/golang-quick-reference-top-20-best-coding-practices/</a></li></ul><p>#Newletters </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/11/17/yZANlmctghPTJDj.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯é˜…è¯»å‘¨åˆŠï¼Œæ¯å‘¨æ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;å†å²æ›´æ–°&quot;&gt;&lt;a href=&quot;#å†å²æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;å†å²æ›´æ–°&quot;&gt;&lt;/a&gt;å†å²æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/10/13/ob/newsletter/Newsletter01-20231013/&quot;&gt;20231013ï¼šç¬¬ä¸€æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/10/22/ob/newsletter/Newsletter02-20231022/&quot;&gt;20231022ï¼šç¬¬äºŒæœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/10/27/ob/newsletter/Newsletter03-20231027/&quot;&gt;20231027ï¼šç¬¬ä¸‰æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/11/03/ob/newsletter/Newsletter04-20231103/&quot;&gt;20231103ï¼šç¬¬å››æœŸ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crossoverjie.top/2023/11/10/ob/newsletter/Newsletter05-20231110/ni&quot;&gt;20231007ï¼šç¬¬äº”æœŸ&lt;/a&gt;</summary>
    
    
    
    <category term="OB" scheme="http://crossoverjie.top/categories/OB/"/>
    
    <category term="Newsletter" scheme="http://crossoverjie.top/categories/OB/Newsletter/"/>
    
    
  </entry>
  
  <entry>
    <title>k8så®æˆ˜-Istio ç½‘å…³</title>
    <link href="http://crossoverjie.top/2023/11/13/ob/k8s-istio03/"/>
    <id>http://crossoverjie.top/2023/11/13/ob/k8s-istio03/</id>
    <published>2023-11-13T14:07:18.000Z</published>
    <updated>2023-11-14T08:03:13.523Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€æœŸ <a href="https://crossoverjie.top/2023/11/07/ob/k8s-Istio02/">k8s-æœåŠ¡ç½‘æ ¼å®æˆ˜-é…ç½® Mesh</a> ä¸­è®²è§£äº†å¦‚ä½•é…ç½®é›†ç¾¤å†…çš„ Mesh è¯·æ±‚ï¼ŒIstio åŒæ ·ä¹Ÿå¯ä»¥å¤„ç†é›†ç¾¤å¤–éƒ¨æµé‡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è§çš„ç½‘å…³ã€‚<br><img src="https://s2.loli.net/2023/11/14/TSCmnecrjHKfLzi.png" alt="image.png"></p><span id="more"></span><p>å…¶å®å’Œä¹‹å‰è®²åˆ°çš„<a href="https://crossoverjie.top/2023/09/15/ob/k8s-Ingress/">k8så…¥é—¨åˆ°å®æˆ˜-ä½¿ç”¨Ingress</a> <code>Ingress</code> ä½œç”¨ç±»ä¼¼ï¼Œéƒ½æ˜¯å°†å†…éƒ¨æœåŠ¡æš´éœ²å‡ºå»çš„æ–¹æ³•ã€‚</p><p>åªæ˜¯ä½¿ç”¨ <code>Istio-gateway</code> ä¼šæ›´åŠ çµæ´»ã€‚<br><img src="https://s2.loli.net/2023/11/14/hVFUTLB2CHjeRuM.png" alt="image.png"></p><p>è¿™é‡Œæœ‰ä¸€å¼ åŠŸèƒ½å¯¹æ¯”å›¾ï¼Œå¯ä»¥æ˜æ˜¾çš„çœ‹å‡º <code>Istio-gateway</code> æ”¯æŒçš„åŠŸèƒ½ä¼šæ›´å¤šï¼Œå¦‚æœæ˜¯ä¸€ä¸ªä¸­å¤§å‹ä¼ä¸šå¹¶ä¸”å·²ç»ç”¨ä¸Š Istio åè¿˜æ˜¯æ›´æ¨èæ˜¯æœ‰ <code>Istio-gateway</code>ï¼Œä½¿ç”¨åŒä¸€ä¸ªæ§åˆ¶é¢å°±å¯ä»¥ç®¡ç†å†…å¤–ç½‘æµé‡ã€‚</p><h2 id="åˆ›å»º-Gateway"><a href="#åˆ›å»º-Gateway" class="headerlink" title="åˆ›å»º Gateway"></a>åˆ›å»º Gateway</h2><p>å¼€å§‹ä¹‹å‰é¦–å…ˆæ˜¯åˆ›å»ºä¸€ä¸ª <code>Istio-Gateway</code> çš„èµ„æºï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">Gateway</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">istio-ingress-gateway</span>  </span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span>  </span><br><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">servers:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span>  </span><br><span class="line">        <span class="attr">number:</span> <span class="number">80</span>  </span><br><span class="line">        <span class="attr">name:</span> <span class="string">http</span>  </span><br><span class="line">        <span class="attr">protocol:</span> <span class="string">HTTP</span>  </span><br><span class="line">      <span class="attr">hosts:</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;www.service1.io&#x27;</span>  </span><br><span class="line">  <span class="attr">selector:</span>  </span><br><span class="line">    <span class="attr">app:</span> <span class="string">istio-ingressgateway</span> <span class="comment">#ä¸ç°æœ‰çš„ gateway å…³è”  </span></span><br><span class="line">    <span class="attr">istio:</span> <span class="string">ingressgateway</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ <code>selector</code> é€‰æ‹©å™¨ä¸­åŒ¹é…çš„ label ä¸æˆ‘ä»¬å®‰è£… <code>Istio</code> æ—¶å€™è‡ªå¸¦çš„ <code>gateway</code> å…³è”å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ gateway çš„ label</span></span><br><span class="line">k get pod -n istio-system</span><br><span class="line">NAME                                    READY   STATUS</span><br><span class="line">istio-ingressgateway-649f75b6b9-klljw   1/1     Running</span><br><span class="line"></span><br><span class="line">k describe pod istio-ingressgateway-649f75b6b9-klljw -n istio-system |grep Labels</span><br><span class="line">Labels:           app=istio-ingressgateway</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/10/26/3JXneYvyqI4WTgt.png" alt="image.png"></p><blockquote><p>è¿™ä¸ª <code>Gateway</code> åœ¨æˆ‘ä»¬ç¬¬ä¸€æ¬¡å®‰è£… <code>Istio</code> çš„æ—¶å€™å°±ä¼šå®‰è£…è¿™ä¸ªç»„ä»¶ã€‚</p></blockquote><hr><p>è¿™ä¸ªé…ç½®çš„å«ä¹‰æ˜¯ç½‘å…³ä¼šä»£ç†é€šè¿‡ <code>www.service1.io</code> è¿™ä¸ªåŸŸåè®¿é—®çš„æ‰€æœ‰è¯·æ±‚ã€‚</p><p>ä¹‹åéœ€è¦ä½¿ç”¨åˆšæ‰çš„ gateway ä¸æˆ‘ä»¬çš„æœåŠ¡çš„ service è¿›è¡Œç»‘å®šï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨åˆ° <code>VirtualService</code>ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">k8s-combat-istio-http-vs</span>  </span><br><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">gateways:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="string">istio-ingress-gateway</span> <span class="comment"># ç»‘å®šåˆšæ‰åˆ›å»ºçš„ gateway åç§° </span></span><br><span class="line">  <span class="attr">hosts:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="string">www.service1.io</span></span><br><span class="line"><span class="attr">http:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">default</span>  </span><br><span class="line">  <span class="attr">route:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">destination:</span>  </span><br><span class="line">        <span class="attr">host:</span> <span class="string">k8s-combat-service-istio-mesh</span>  <span class="comment">#service åç§°</span></span><br><span class="line">        <span class="attr">port:</span>  </span><br><span class="line">          <span class="attr">number:</span> <span class="number">8081</span>  </span><br><span class="line">        <span class="attr">subset:</span> <span class="string">v1</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå’Œæˆ‘ä»¬ä¹‹å‰è®²åˆ°çš„ Mesh å†…éƒ¨æµé‡æ—¶æ‰€ä½¿ç”¨åˆ°çš„ <code>VirtualService</code> é…ç½®æ˜¯ä¸€æ ·çš„ã€‚</p><p>è¿™é‡Œçš„å«ä¹‰ä¹Ÿæ˜¯é€šè¿‡ <code>www.service1.io</code> ä»¥åŠ <code>istio-ingress-gateway</code> ç½‘å…³çš„æµé‡ä¼šè¿›å…¥è¿™ä¸ªè™šæ‹ŸæœåŠ¡ï¼Œä½†æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¿›å…¥ <code>subset: v1</code> è¿™ä¸ªåˆ†ç»„ã€‚</p><p>è¿™ä¸ªçš„åˆ†ç»„ä¿¡æ¯åœ¨ä¸Šä¸€èŠ‚å¯ä»¥æŸ¥è¯¢åˆ°ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">DestinationRule</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">k8s-combat-service-ds</span>  </span><br><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">host:</span> <span class="string">k8s-combat-service-istio-mesh</span>  </span><br><span class="line">  <span class="attr">subsets:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">v1</span>  </span><br><span class="line">      <span class="attr">labels:</span>  </span><br><span class="line">        <span class="attr">app:</span> <span class="string">k8s-combat-service-v1</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">v2</span>  </span><br><span class="line">      <span class="attr">labels:</span>  </span><br><span class="line">        <span class="attr">app:</span> <span class="string">k8s-combat-service-v2</span></span><br></pre></td></tr></table></figure><p>ä¹‹åæˆ‘ä»¬è®¿é—®è¿™ä¸ªåŸŸåå³å¯æ‹¿åˆ°å“åº”ï¼ŒåŒæ—¶æˆ‘ä»¬æ‰“å¼€ <code>k8s-combat-service-istio-mesh</code> service çš„ Pod æŸ¥çœ‹æ—¥å¿—ï¼Œä¼šå‘ç°æ‰€æœ‰çš„è¯·æ±‚éƒ½è¿›å…¥äº† v1, å¦‚æœä¸éœ€è¦è¿™ä¸ªé™åˆ¶æ¡ä»¶ï¼Œå°† <code>subset: v1</code> åˆ é™¤å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl  http://www.service1.io/ping</span><br></pre></td></tr></table></figure><blockquote><p>æœ¬åœ°éœ€è¦é…ç½®ä¸‹ host: <code>127.0.0.1 www.service1.io</code></p></blockquote><p><img src="https://s2.loli.net/2023/11/13/ksR9FbdWMEhlLBQ.png" alt="image.png"></p><p>è¿˜æœ‰ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦æ‹¿åˆ° <code>gateway</code> çš„å¤–éƒ¨IPï¼Œæ‰èƒ½å°† IP å’Œåˆšæ‰çš„åŸŸå<code>www.service1.io</code> è¿›è¡Œç»‘å®šï¼ˆhostï¼Œæˆ–è€…æ˜¯åŸŸåç®¡ç†å°ï¼‰ã€‚</p><p>å¦‚æœä½¿ç”¨çš„æ˜¯ <code>docker-desktop</code> è‡ªå¸¦çš„ <code>kubernetes</code> é›†ç¾¤æ—¶å€™ç›´æ¥ä½¿ç”¨ <code>127.0.0.1</code> å³å¯ï¼Œé»˜è®¤å°±ä¼šç»‘å®šä¸Šã€‚</p><p>å¦‚æœä½¿ç”¨çš„æ˜¯ <code>minikube</code> å®‰è£…çš„ï¼Œé‚£éœ€è¦ä½¿ç”¨ <code>minikube tunnel</code> æ‰‹åŠ¨ä¸º service ä¸º<code>LoadBalancer</code> ç±»å‹çš„ç»‘å®šä¸€ä¸ªæœ¬åœ° IPï¼Œå…·ä½“å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼š<br><a href="https://minikube.sigs.k8s.io/docs/tasks/loadbalancer">https://minikube.sigs.k8s.io/docs/tasks/loadbalancer</a></p><blockquote><p>å¦‚æœæ˜¯ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œäº‘æœåŠ¡å‚å•†ä¼šè‡ªåŠ¨ç»‘å®šä¸€ä¸ªå¤–ç½‘ IPã€‚</p></blockquote><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><img src="https://s2.loli.net/2023/11/14/4yBEDZOcsWKxLpg.png" alt="image.png"></p><p>è¿™ä¸ªçš„è®¿é—®è¯·æ±‚çš„æµç¨‹å’Œä¹‹å‰è®²åˆ°çš„ <code>kubernetes Ingress</code> æµç¨‹æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯ gateway æ˜¯é€šè¿‡ <code>VirtualService</code> æ¥è·¯ç”±çš„ serviceï¼ŒåŒæ—¶åœ¨è¿™ä¸ª <code>VirtualService</code> ä¸­å¯ä»¥è‡ªå®šä¹‰è®¸å¤šçš„è·¯ç”±è§„åˆ™ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœåŠ¡ç½‘æ ¼ <code>Istio</code> åŸºæœ¬ä¸Šè®²å®Œäº†ï¼Œåç»­è¿˜æœ‰å…³äº <code>Telemetry</code> ç›¸å…³çš„ <code>trace</code>ã€<code>log</code>ã€<code>metrics</code> ä¼šåœ¨è¿ç»´ç« èŠ‚æ›´æ–°ï¼Œä¹Ÿä¼šå’Œ Istio æœ‰æ‰€å…³è”ã€‚<br>æ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥æŒç»­å…³æ³¨ã€‚</p><p>æœ¬æ–‡çš„æ‰€æœ‰æºç åœ¨è¿™é‡Œå¯ä»¥è®¿é—®ï¼š<br><a href="https://github.com/crossoverJie/k8s-combat">https://github.com/crossoverJie/k8s-combat</a></p><p>#Blog #Istio </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨ä¸Šä¸€æœŸ &lt;a href=&quot;https://crossoverjie.top/2023/11/07/ob/k8s-Istio02/&quot;&gt;k8s-æœåŠ¡ç½‘æ ¼å®æˆ˜-é…ç½® Mesh&lt;/a&gt; ä¸­è®²è§£äº†å¦‚ä½•é…ç½®é›†ç¾¤å†…çš„ Mesh è¯·æ±‚ï¼ŒIstio åŒæ ·ä¹Ÿå¯ä»¥å¤„ç†é›†ç¾¤å¤–éƒ¨æµé‡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è§çš„ç½‘å…³ã€‚&lt;br&gt;&lt;img src=&quot;https://s2.loli.net/2023/11/14/TSCmnecrjHKfLzi.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="k8s" scheme="http://crossoverjie.top/categories/k8s/"/>
    
    
    <category term="Istio" scheme="http://crossoverjie.top/tags/Istio/"/>
    
  </entry>
  
</feed>
