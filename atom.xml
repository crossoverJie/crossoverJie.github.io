<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>crossoverJie&#39;s Blog</title>
  
  <subtitle>baller</subtitle>
  <link href="http://crossoverjie.top/atom.xml" rel="self"/>
  
  <link href="http://crossoverjie.top/"/>
  <updated>2023-09-18T14:57:45.664Z</updated>
  <id>http://crossoverjie.top/</id>
  
  <author>
    <name>crossoverJie</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Github commit ç­¾å+åˆå¹¶ Commit</title>
    <link href="http://crossoverjie.top/2023/09/18/ob/git-tips-rebase/"/>
    <id>http://crossoverjie.top/2023/09/18/ob/git-tips-rebase/</id>
    <published>2023-09-18T09:56:51.000Z</published>
    <updated>2023-09-18T14:57:45.664Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/09/18/gCjw9hZx4Y6cPSn.png" alt="Githubçš„ä¸€ä¸ªå¥‡æŠ€æ·«å·§.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰æ®µæ—¶é—´ç»™ <code>VictoriaLogs</code> æäº¤äº†ä¸€ä¸ª PRï¼š<br><a href="https://github.com/VictoriaMetrics/VictoriaMetrics/pull/4934">https://github.com/VictoriaMetrics/VictoriaMetrics/pull/4934</a></p><p>æœ¬æ¥ä¸€åˆ‡éƒ½å¾ˆé¡ºåˆ©ï¼Œåªç­‰åˆå¹¶äº†ï¼Œä½†åœ¨ä¸´é—¨ä¸€è„šçš„æ—¶å€™ç¤¾åŒºç»´æŠ¤äººå‘˜é—®æˆ‘å¯å¦ç»™ <code>git</code> <code>commit</code> åŠ ä¸Šç­¾åã€‚</p><blockquote><p>äºæ˜¯æˆ‘å°±é»˜é»˜çš„è°ƒè¯•åˆ°äº†å‡Œæ™¨å››ç‚¹ğŸ˜­</p></blockquote><p><img src="https://s2.loli.net/2023/09/18/VXhjU9ypuKP1ZWg.png" alt="image.png"></p><span id="more"></span><p>ä»¥å‰æˆ‘ä¹Ÿæ²¡æ€ä¹ˆæ³¨æ„è¿‡è¿™ä¸ªé€‰é¡¹ï¼Œç»è¿‡ <code>Google</code> åå‘ç° <code>Idea</code> åœ¨æäº¤çš„æ—¶å€™å¯ä»¥è‡ªè¡Œè®¾ç½®ã€‚</p><p><img src="https://s2.loli.net/2023/09/18/QdTetRSNG5c3KVr.png" alt="image.png"><br>å½“æˆ‘å‹¾é€‰äº†è¿™ä¸ªæäº¤æ–°çš„ä»£ç åï¼Œä¾ç„¶è¢«å‘ŠçŸ¥æ²¡æœ‰æ­£ç¡®çš„ç­¾åï¼Œè¿™æ—¶æˆ‘æ‰å‘ç°ç†è§£é”™è¯¯äº†ã€‚</p><h1 id="ä¸º-GitHub-çš„æäº¤ç­¾å"><a href="#ä¸º-GitHub-çš„æäº¤ç­¾å" class="headerlink" title="ä¸º GitHub çš„æäº¤ç­¾å"></a>ä¸º GitHub çš„æäº¤ç­¾å</h1><p>ç»“åˆè¿™ä½ç¤¾åŒºå¤§ä½¬ç»™çš„æ–‡æ¡£ï¼Œä»–æ‰€éœ€è¦çš„æ˜¯æ¯æ¬¡æäº¤çš„ä»£ç éƒ½æ˜¯æœ‰ç­¾åçš„ï¼Œç±»ä¼¼äºè¿™æ ·ï¼š<br><img src="https://s2.loli.net/2023/09/18/26vgVMZmNrPCkqo.png" alt="image.png"></p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦ <code>GitHub</code> ç°å® <code>Verified</code> è¿™ä¸ªæ ‡ç­¾ï¼Œé‚£å°±éœ€è¦å¯¹ <code>commit</code> æˆ–è€…æ˜¯æ‰“çš„ <code>tag</code> è¿›è¡Œç­¾åã€‚</p><p>è€Œç­¾åçš„æ–¹å¼æœ‰ä¸‰ç§ï¼š<code>GPG</code>, <code>SSH</code>, <code>S/MIME</code>ï¼Œè¿™é‡Œæˆ‘ä»¥ GPG ç­¾åä¸ºä¾‹ï¼Œæ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2023/09/18/HwDIlL94c51Uz3e.png" alt="image.png"></p><p>å…ˆåœ¨<a href="https://www.gnupg.org/download/">https://www.gnupg.org/download/</a>è¿™é‡Œä¸‹è½½å®‰è£… GPG çš„å‘½ä»¤è¡Œç¨‹åºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --full-generate-key</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ç”Ÿæˆ keyï¼Œä¹‹åä¼šæ ¹æ®æç¤ºå½•å…¥ä¸€äº›ä¿¡æ¯ï¼ŒåŒ…å«ä½ çš„ ID å’Œé‚®ç®±ï¼Œå»ºè®®éƒ½å’Œ GitHub çš„ ID é‚®ç®±ä¿æŒä¸€è‡´å³å¯ï¼Œç„¶åä¸€è·¯å›è½¦å®Œäº‹ã€‚</p><p>ä¹‹åå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹åˆšæ‰åˆ›å»ºçš„ Keyï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gpg --list-secret-keys --keyid-format=long</span><br><span class="line">------------------------------------</span><br><span class="line">sec   4096R/3AA5C34371567BD2 2016-03-10 [expires: 2017-03-10]</span><br><span class="line">uid                          Hubot &lt;hubot@example.com&gt;</span><br><span class="line">ssb   4096R/4BB6D45482678BE3 2016-03-10</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦å°† <code>3AA5C34371567BD2</code> è¿™ä¸ª Key çš„ ID å­—ç¬¦ä¸²å¤åˆ¶ï¼Œä¹‹åæ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg --armor --export 3AA5C34371567BD2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Prints the GPG key ID, <span class="keyword">in</span> ASCII armor format</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä¼šæ‰“å°å‡ºå…¬é’¥ï¼Œæˆ‘ä»¬å°†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">-----END PGP PUBLIC KEY BLOCK-----</span><br></pre></td></tr></table></figure><p>è¿™äº›æ•°æ®å¤åˆ¶åˆ° GitHub çš„ä¸ªäººè®¾ç½®é¡µé¢ï¼š<br><img src="https://s2.loli.net/2023/09/18/zvMgJcqAnRQjYxG.png" alt="image.png"></p><p>æ­¤æ—¶è¿˜æ²¡å®Œï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥æäº¤ä»£ç çš„ä¹Ÿä¸ä¼šæœ‰ <code>Verified</code> çš„æ ‡ç­¾ã€‚</p><p><img src="https://s2.loli.net/2023/09/18/eST5f1Vad4x8Ou7.png" alt="image.png"></p><p>æˆ‘ä»¬è¿˜éœ€è¦æ‰“å¼€ git çš„ config è®¾ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git config commit.gpgsign true</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…¨å±€æ‰“å¼€</span></span><br><span class="line">git config --global commit.gpgsign true</span><br><span class="line">git commit -S -m &quot;YOUR_COMMIT_MESSAGE&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>è¿™æ ·æäº¤çš„ Commit å°±ä¼šæ‰“ä¸ŠéªŒè¯çš„æ ‡ç­¾äº†ã€‚<br><img src="https://s2.loli.net/2023/09/18/HKcvrfMozC9YEnx.png" alt="image.png"></p><blockquote><p>-S çš„æ•ˆæœå’Œåœ¨ idea ä¸­é€‰ä¸­ Sign-off çš„æ•ˆæœä¸€æ ·ã€‚</p></blockquote><p>å®˜æ–¹æ–‡æ¡£ä¹Ÿæœ‰è¯¦ç»†çš„æ­¥éª¤ï¼š<br><a href="https://docs.github.com/en/authentication/managing-commit-signature-verification/about-commit-signature-verification">https://docs.github.com/en/authentication/managing-commit-signature-verification/about-commit-signature-verification</a></p><h1 id="Squash-åˆå¹¶æäº¤"><a href="#Squash-åˆå¹¶æäº¤" class="headerlink" title="Squash åˆå¹¶æäº¤"></a>Squash åˆå¹¶æäº¤</h1><p>ä¸è¿‡åœ¨æˆ‘è¿™ä¸ª <code>PR</code> çš„èƒŒæ™¯ä¸‹è¿˜æœ‰ä¸€ä¸ªæ­¥éª¤æ²¡æœ‰å®Œæˆï¼Œå°±æ˜¯æˆ‘ä¹‹å‰æäº¤çš„ <code>Commit</code> éƒ½æ²¡è¦éªŒè¯ï¼Œæˆ‘éœ€è¦å°†ä»–ä»¬éƒ½åˆå¹¶ä¸ºä¸€ä¸ªéªŒè¯çš„ Commit ç„¶ååœ¨å¼ºåˆ¶æ¨é€ä¸Šå»ï¼Œè¿™æ ·æ•´ä¸ª <code>git log</code> çœ‹èµ·æ¥æ‰è¶³å¤Ÿç®€æ´ã€‚</p><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼Œåªæœ‰ä¸€ä¸ª Commit å­˜åœ¨ã€‚<br><img src="https://s2.loli.net/2023/09/18/1OzjkDwhdWuJS8n.png"></p><p>è¿™æ—¶å€™å°±å¾—éœ€è¦ git rebase å‡ºé©¬äº†ã€‚</p><p><img src="https://s2.loli.net/2023/09/18/vaOPw3gQTtVSoxC.png" alt="image.png"><br>ä»¥åˆšæ‰æµ‹è¯•çš„è¿™ä¸¤ä¸ªæäº¤ä¸ºä¾‹ï¼Œæˆ‘éœ€è¦å°†ä»–ä»¬åˆå¹¶ä¸ºä¸€ä¸ªæäº¤ã€‚</p><p>æˆ‘ä»¬å…ˆä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i HEAD~N</span><br><span class="line">git rebase -i HEAD~2</span><br></pre></td></tr></table></figure><p>N å°±æ˜¯æˆ‘ä»¬éœ€è¦åˆå¹¶å‡ ä¸ªæäº¤ï¼Œåœ¨æˆ‘è¿™é‡Œå°±æ˜¯ 2.</p><p><img src="https://s2.loli.net/2023/09/18/PN6nUE3BVu48TWF.png" alt="image.png"><br>æˆ‘ä»¬éœ€è¦å°†é™¤äº†ç¬¬ä¸€ä¸ª commit ä¹‹å¤–çš„éƒ½ä¿®æ”¹ä¸º sï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢æ³¨é‡Šé‡Œçš„ <code>squash</code> çš„ç®€å†™ï¼ˆå‹ç¼©çš„æ„æ€ï¼‰ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ª vim çš„äº¤äº’ç¼–è¾‘æ¨¡å¼ï¼Œç¼–è¾‘å®Œæˆä¹‹åä¿å­˜é€€å‡ºã€‚</p><blockquote><p>ä¸ä¼šè¿˜æœ‰ç¨‹åºå‘˜ä¸çŸ¥é“å¦‚ä½•ä¿å­˜ vim é€€å‡ºå§ğŸ•ã€‚</p></blockquote><p>ä¿å­˜ååˆä¼šå¼¹å‡ºä¸€ä¸ªç¼–è¾‘é¡µé¢ï¼Œè®©æˆ‘ä»¬å¡«å†™è¿™æ¬¡å‹ç¼©ä¹‹åçš„æäº¤è®°å½•ï¼Œé»˜è®¤ä¼šå¸®æˆ‘ç”Ÿæˆå¥½ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥å…¨éƒ¨åˆ æ‰åé‡å†™ã€‚</p><p><img src="https://s2.loli.net/2023/09/18/YCx5ablcrBmsdiD.png" alt="image.png"></p><p>æˆ‘è¿™é‡Œå°±ç›´æ¥ä½¿ç”¨å®ƒç”Ÿæˆå¥½çš„å°±å¯ä»¥äº†ï¼Œä¾ç„¶è¿˜æ˜¯ä¿å­˜é€€å‡ºã€‚</p><p>æœ€åå†å¼ºè¡Œæ¨é€åˆ°æˆ‘æ‰€åœ¨çš„åˆ†æ”¯å³å¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin test-rebase -f</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªåˆ†æ”¯çš„æäº¤é¡µé¢ä¹Ÿåªä¼šçœ‹åˆ°åˆšæ‰å¼ºè¡Œæ¨é€çš„è®°å½•äº†ï¼Œåˆšæ‰çš„ä¸¤ä¸ªæäº¤å·²ç»åˆå¹¶ä¸ºè¿™ä¸€ä¸ªäº†ã€‚</p><p><img src="https://s2.loli.net/2023/09/18/ULO3kxgSYErPqle.png" alt="image.png"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å€Ÿç€è¿™ä¸ªæœºä¼šä¹Ÿäº†è§£äº† <code>rebase</code> çš„éªšæ“ä½œæŒºå¤šçš„ï¼Œä¸è¿‡æˆ‘å¹³æ—¶ç”¨çš„æœ€å¤šçš„è¿˜æ˜¯ <code>merge</code>ï¼Œè¿™ä¸ªå€’æ²¡æœ‰å¥½åä¹‹åˆ†ï¼Œåªè¦åŒç»„çš„å¼€å‘è€…éƒ½è¾¾æˆä¸€è‡´å³å¯ã€‚</p><p>#Blog #Github #Git</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/09/18/gCjw9hZx4Y6cPSn.png&quot; alt=&quot;Githubçš„ä¸€ä¸ªå¥‡æŠ€æ·«å·§.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´ç»™ &lt;code&gt;VictoriaLogs&lt;/code&gt; æäº¤äº†ä¸€ä¸ª PRï¼š&lt;br&gt;&lt;a href=&quot;https://github.com/VictoriaMetrics/VictoriaMetrics/pull/4934&quot;&gt;https://github.com/VictoriaMetrics/VictoriaMetrics/pull/4934&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ¥ä¸€åˆ‡éƒ½å¾ˆé¡ºåˆ©ï¼Œåªç­‰åˆå¹¶äº†ï¼Œä½†åœ¨ä¸´é—¨ä¸€è„šçš„æ—¶å€™ç¤¾åŒºç»´æŠ¤äººå‘˜é—®æˆ‘å¯å¦ç»™ &lt;code&gt;git&lt;/code&gt; &lt;code&gt;commit&lt;/code&gt; åŠ ä¸Šç­¾åã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;äºæ˜¯æˆ‘å°±é»˜é»˜çš„è°ƒè¯•åˆ°äº†å‡Œæ™¨å››ç‚¹ğŸ˜­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/09/18/VXhjU9ypuKP1ZWg.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="git" scheme="http://crossoverjie.top/categories/git/"/>
    
    
    <category term="rebase" scheme="http://crossoverjie.top/tags/rebase/"/>
    
  </entry>
  
  <entry>
    <title>k8så…¥é—¨åˆ°å®æˆ˜-ä½¿ç”¨Ingress</title>
    <link href="http://crossoverjie.top/2023/09/15/ob/k8s-Ingress/"/>
    <id>http://crossoverjie.top/2023/09/15/ob/k8s-Ingress/</id>
    <published>2023-09-15T09:13:37.000Z</published>
    <updated>2023-09-18T08:37:48.149Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/09/14/Pe7DWCIS2UMKHQ8.png" alt="ingress.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰ä¸¤ç« ä¸­æˆ‘ä»¬å°†åº”ç”¨<a href="https://crossoverjie.top/2023/08/31/ob/k8s-0-start/">éƒ¨ç½²</a>åˆ°äº† k8s ä¸­ï¼ŒåŒæ—¶ä¸åŒçš„æœåŠ¡ä¹‹é—´ä¹Ÿå¯ä»¥é€šè¿‡ <a href="https://crossoverjie.top/2023/09/05/ob/k8s-service/">service</a> è¿›è¡Œè°ƒç”¨ï¼Œç°åœ¨è¿˜æœ‰ä¸€ä¸ªæ­¥éª¤å°±æ˜¯å°†æˆ‘ä»¬çš„åº”ç”¨æš´éœ²åˆ°å…¬ç½‘ï¼Œå¹¶æä¾›åŸŸåçš„è®¿é—®ã€‚</p><p>è¿™ä¸€æ­¥ç±»ä¼¼äºæˆ‘ä»¬ä»¥å‰é…ç½® Nginx å’Œç»‘å®šåŸŸåï¼Œæä¾›è¿™ä¸ªèƒ½åŠ›çš„æœåŠ¡åœ¨ k8s ä¸­æˆä¸º Ingressã€‚</p><p>é€šè¿‡è¿™ä¸ªæè¿°å…¶å®ä¹Ÿèƒ½çœ‹å‡º Ingress æ˜¯åè¿ç»´çš„å·¥ä½œï¼Œä½†ä¹Ÿä¸å¦¨ç¢æˆ‘ä»¬ä½œä¸ºç ”å‘å»äº†è§£è¿™éƒ¨åˆ†çš„å†…å®¹ï¼›äº†è§£æ•´ä¸ªç³»ç»Ÿæ˜¯å¦‚ä½•è¿è½¬çš„ä¹Ÿæ˜¯ç ”å‘åº”è¯¥æŒæ¡çš„æŠ€èƒ½ã€‚</p><span id="more"></span><h1 id="å®‰è£…-Ingress-æ§åˆ¶å™¨"><a href="#å®‰è£…-Ingress-æ§åˆ¶å™¨" class="headerlink" title="å®‰è£… Ingress æ§åˆ¶å™¨"></a>å®‰è£… Ingress æ§åˆ¶å™¨</h1><p>åœ¨æ­£å¼ä½¿ç”¨ Ingress ä¹‹å‰éœ€è¦ç»™ k8s å®‰è£…ä¸€ä¸ª Ingress æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬è¿™é‡Œå®‰è£…å®˜æ–¹æä¾›çš„ Ingress-nginx æ§åˆ¶å™¨ã€‚</p><p>å½“ç„¶è¿˜æœ‰ç¤¾åŒºæˆ–è€…ä¼ä¸šæä¾›çš„å„ç§æ§åˆ¶å™¨ï¼š<br><img src="https://s2.loli.net/2023/09/14/i1ebXQNUjxPkLEZ.png" alt="image.png"></p><p>æœ‰ä¸¤ç§å®‰è£…æ–¹å¼: helm æˆ–è€…æ˜¯ç›´æ¥ apply ä¸€ä¸ªèµ„æºæ–‡ä»¶ã€‚</p><p>å…³äº <code>helm</code> æˆ‘ä»¬ä¼šåœ¨åé¢çš„ç« èŠ‚å•ç‹¬è®²è§£ã€‚</p><p>è¿™é‡Œå°±ç›´æ¥ä½¿ç”¨èµ„æºæ–‡ä»¶å®‰è£…å³å¯ï¼Œæˆ‘å·²ç»ä¸Šä¼ åˆ° GitHub å¯ä»¥åœ¨è¿™é‡Œè®¿é—®ï¼š<br><a href="https://github.com/crossoverJie/k8s-combat/blob/main/deployment/ingress-nginx.yaml">https://github.com/crossoverJie/k8s-combat/blob/main/deployment/ingress-nginx.yaml</a></p><p>å…¶å®è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ç›´æ¥ä»å®˜æ–¹æä¾›çš„å¤åˆ¶è¿‡æ¥çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªè·¯å¾„è¿›è¡Œå®‰è£…ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">kubectl</span> <span class="string">apply</span> <span class="string">-f</span> <span class="string">https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.2/deploy/static/provider/cloud/deploy.yaml</span></span><br></pre></td></tr></table></figure><blockquote><p>yaml æ–‡ä»¶çš„å†…å®¹æ˜¯ä¸€æ ·çš„ã€‚</p></blockquote><p>ä¸è¿‡è¦æ³¨æ„å®‰è£…ä¹‹åå¯èƒ½å®¹å™¨çŠ¶æ€ä¸€ç›´å¤„äº Pending çŠ¶æ€ï¼ŒæŸ¥çœ‹å®¹å™¨çš„äº‹ä»¶æ—¶ä¼šå‘ç°é•œåƒæ‹‰å–å¤±è´¥ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k describe pod ingress-nginx-controller-7cdfb9988c-lbcst -n ingress-nginx</span><br></pre></td></tr></table></figure><blockquote><p>describe æ˜¯ä¸€ä¸ªç”¨äºæŸ¥çœ‹ k8s å¯¹è±¡è¯¦ç»†ä¿¡æ¯çš„å‘½ä»¤ã€‚</p></blockquote><p>åœ¨åˆšæ‰é‚£ä»½ yaml æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªé•œåƒéœ€è¦æ‹‰å–ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåœ¨æœ¬åœ°æ‰‹åŠ¨æ‹‰å–é•œåƒï¼š<br><img src="https://s2.loli.net/2023/09/14/3IsRe2QWcmjTY41.png" alt="image.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull registry.k8s.io/ingress-nginx/controller:v1.8.2</span><br></pre></td></tr></table></figure><p>å¦‚æœä¾ç„¶æ— æ³•æ‹‰å–ï¼Œå¯ä»¥å°è¯•é…ç½®å‡ ä¸ªå›½å†…é•œåƒæºé•œåƒæ‹‰å–ï¼š</p><p><img src="https://s2.loli.net/2023/09/14/uTNDACSWdPp7BVt.png" alt="image.png"></p><blockquote><p>æˆ‘è¿™é‡Œä½¿ç”¨çš„ docker-desktop è‡ªå¸¦çš„ k8sï¼Œæ¨èè¯»è€…æœ‹å‹ä¹Ÿä½¿ç”¨è¿™ä¸ªå·¥å…·ã€‚</p></blockquote><h1 id="åˆ›å»º-Ingress"><a href="#åˆ›å»º-Ingress" class="headerlink" title="åˆ›å»º Ingress"></a>åˆ›å»º Ingress</h1><p>ä½¿ç”¨åˆšæ‰çš„ yaml å®‰è£…æˆåŠŸä¹‹åä¼šåœ¨ <code>ingress-nginx</code> å‘½åç©ºé—´ä¸‹åˆ›å»ºä¸€ä¸ª Podï¼Œé€šè¿‡ get å‘½ä»¤æŸ¥çœ‹çŠ¶æ€ä¸º Running å³ä¸ºå®‰è£…æˆåŠŸã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">k get pod -n ingress-nginx</span></span><br><span class="line">NAME                            READY   STATUS    RESTARTS      AGE</span><br><span class="line">ingress-nginx-controller-7cdf   1/1     Running   2 (35h ago)   3d</span><br></pre></td></tr></table></figure><blockquote><p>Namespace ä¹Ÿæ˜¯ k8s å†…ç½®çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºå¯¹èµ„æºè¿›è¡Œåˆ†ç»„ç®¡ç†ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥ä½¿ç”¨å®ƒæ¥åŒºåˆ†å„ä¸ªä¸åŒçš„ç¯å¢ƒï¼Œæ¯”å¦‚ dev&#x2F;test&#x2F;prod ç­‰ï¼Œä¸åŒå‘½åç©ºé—´ä¸‹çš„èµ„æºä¸ä¼šäº’ç›¸å¹²æ‰°ï¼Œä¸”ç›¸äº’ç‹¬ç«‹ã€‚</p></blockquote><p>ä¹‹åä¾¿å¯ä»¥åˆ›å»º Ingress èµ„æºäº†ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">k8s-combat-ingress</span>  </span><br><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">ingressClassName:</span> <span class="string">nginx</span>  </span><br><span class="line">  <span class="attr">rules:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">www.service1.io</span>  </span><br><span class="line">      <span class="attr">http:</span>  </span><br><span class="line">        <span class="attr">paths:</span>  </span><br><span class="line">          <span class="bullet">-</span> <span class="attr">backend:</span>  </span><br><span class="line">              <span class="attr">service:</span>  </span><br><span class="line">                <span class="attr">name:</span> <span class="string">k8s-combat-service</span>  </span><br><span class="line">                <span class="attr">port:</span>  </span><br><span class="line">                  <span class="attr">number:</span> <span class="number">8081</span>  </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span>  </span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">www.service2.io</span>  </span><br><span class="line">      <span class="attr">http:</span>  </span><br><span class="line">        <span class="attr">paths:</span>  </span><br><span class="line">          <span class="bullet">-</span> <span class="attr">backend:</span>  </span><br><span class="line">              <span class="attr">service:</span>  </span><br><span class="line">                <span class="attr">name:</span> <span class="string">k8s-combat-service-2</span>  </span><br><span class="line">                <span class="attr">port:</span>  </span><br><span class="line">                  <span class="attr">number:</span> <span class="number">8081</span>  </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span>  </span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br></pre></td></tr></table></figure><p>çœ‹è¿™ä¸ªå†…å®¹ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œåˆ›å»ºäº†ä¸€ä¸ª <code>Ingress</code> çš„å¯¹è±¡ï¼Œå…¶ä¸­çš„é‡ç‚¹å°±æ˜¯è¿™é‡Œçš„è§„åˆ™æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚</p><blockquote><p>åœ¨ k8s ä¸­ä»Šåè¿˜ä¼šæ¥è§¦åˆ°å„ç§ä¸åŒçš„ Kind</p></blockquote><p>è¿™é‡Œçš„ <code>ingressClassName: nginx</code>   ä¹Ÿæ˜¯åœ¨åˆšå¼€å§‹å®‰è£…çš„æ§åˆ¶å™¨é‡Œå®šä¹‰çš„åå­—ï¼Œç”±è¿™ä¸ªèµ„æºå®šä¹‰ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">IngressClass</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">labels:</span>  </span><br><span class="line">    <span class="attr">app.kubernetes.io/component:</span> <span class="string">controller</span>  </span><br><span class="line">    <span class="attr">app.kubernetes.io/instance:</span> <span class="string">ingress-nginx</span>  </span><br><span class="line">    <span class="attr">app.kubernetes.io/name:</span> <span class="string">ingress-nginx</span>  </span><br><span class="line">    <span class="attr">app.kubernetes.io/part-of:</span> <span class="string">ingress-nginx</span>  </span><br><span class="line">    <span class="attr">app.kubernetes.io/version:</span> <span class="number">1.8</span><span class="number">.2</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx</span></span><br></pre></td></tr></table></figure><p>å’±ä»¬è¿™ä¸ªè§„åˆ™å¾ˆç®€å•ï¼Œå°±æ˜¯å°†ä¸¤ä¸ªä¸åŒçš„åŸŸåè·¯ç”±åˆ°ä¸¤ä¸ªä¸åŒçš„ serviceã€‚</p><blockquote><p>è¿™é‡Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•åˆåˆ›å»ºäº†ä¸€ä¸ª <code>k8s-combat-service-2</code> çš„ serviceï¼Œå’Œ <code>k8s-combat-service</code> æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æ”¹äº†ä¸ªåå­—è€Œå·²ã€‚</p></blockquote><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>ä¹Ÿæ˜¯ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œæˆ‘åœ¨åº”ç”¨é•œåƒä¸­æ–°å¢äº†ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè¿”å›å½“å‰ Pod çš„ hostnameã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http.HandleFunc(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;  </span><br><span class="line">   name, _ := os.Hostname()  </span><br><span class="line">   fmt.Fprint(w, name)  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç”±äºæˆ‘å®é™…å¹¶æ²¡æœ‰ <code>www.service1.io/www.service2.io</code> è¿™ä¸¤ä¸ªåŸŸåï¼Œæ‰€ä»¥åªèƒ½åœ¨æœ¬åœ°é…ç½® host è¿›è¡Œæ¨¡æ‹Ÿã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10.0.0.37 www.service1.io</span><br><span class="line">10.0.0.37 www.service2.io</span><br></pre></td></tr></table></figure><blockquote><p>æˆ‘æµ‹è¯•æ‰€ä½¿ç”¨çš„ k8s éƒ¨ç½²åœ¨æˆ‘å®¶é‡Œä¸€å°é™åˆ¶çš„ Mac ä¸Šï¼Œæ‰€ä»¥è¿™é‡Œçš„ IP å®ƒçš„åœ°å€ã€‚</p></blockquote><p>å½“æˆ‘ä»¬åå¤è¯·æ±‚ä¸¤æ¬¡è¿™ä¸ªæ¥å£ï¼Œä¼šæ‹¿åˆ°ä¸¤ä¸ªä¸åŒçš„ hostnameï¼Œä¹Ÿå°±æ˜¯å°†æˆ‘ä»¬çš„è¯·æ±‚è½®è®­è´Ÿè½½åˆ°äº†è¿™ä¸¤ä¸ª service æ‰€ä»£ç†çš„ä¸¤ä¸ª Pod ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â¯ curl http://www.service1.io/</span><br><span class="line"><span class="meta prompt_">k8s-combat-service-79c5579587-b6nlj%</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">â¯ curl http://www.service1.io/</span></span><br><span class="line"><span class="meta prompt_">k8s-combat-service-79c5579587-bk7nw%</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">â¯ curl http://www.service2.io/</span></span><br><span class="line"><span class="meta prompt_">k8s-combat-service-2-7bbf56b4d9-dkj9b%</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">â¯ curl http://www.service2.io/</span></span><br><span class="line">k8s-combat-service-2-7bbf56b4d9-t5l4g</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ describe æŸ¥çœ‹æˆ‘ä»¬çš„ ingress å®šä¹‰ä»¥åŠè·¯ç”±è§„åˆ™ï¼š<br><img src="https://s2.loli.net/2023/09/14/pgZzVb1L4aQTMwn.png" alt="image.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">k describe ingress k8s-combat-ingress</span></span><br><span class="line">Name:             k8s-combat-ingress</span><br><span class="line">Labels:           &lt;none&gt;</span><br><span class="line">Namespace:        default</span><br><span class="line">Address:          localhost</span><br><span class="line">Ingress Class:    nginx</span><br><span class="line">Default backend:  &lt;default&gt;</span><br><span class="line">Rules:</span><br><span class="line">  Host             Path  Backends</span><br><span class="line">  ----             ----  --------</span><br><span class="line">  www.service1.io</span><br><span class="line">                   /   k8s-combat-service:8081 (10.1.0.65:8081,10.1.0.67:8081)</span><br><span class="line">  www.service2.io</span><br><span class="line">                   /   k8s-combat-service-2:8081 (10.1.0.63:8081,10.1.0.64:8081)</span><br><span class="line">Annotations:       &lt;none&gt;</span><br><span class="line">Events:            &lt;none&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬æ‰‹åŠ¨æ–°å¢ä¸€ä¸ªåŸŸåè§£æï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">10.0.0.37 www.service3.io</span><br><span class="line">â¯ curl http://www.service3.io/</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>ä¼šç›´æ¥ 404ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªåŸŸåçš„è§„åˆ™ã€‚</p><h1 id="è®¿é—®åŸç†"><a href="#è®¿é—®åŸç†" class="headerlink" title="è®¿é—®åŸç†"></a>è®¿é—®åŸç†</h1><p><img src="https://s2.loli.net/2023/09/14/9JTfp6GP24VmzAK.png" alt="image.png"><br>æ•´ä¸ªçš„è¯·æ±‚è·¯å¾„å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå…¶å®æˆ‘ä»¬çš„ Ingress æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª serviceï¼ˆæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥å¯åŠ¨å¤šä¸ªå‰¯æœ¬æ¥è¿›è¡Œè´Ÿè½½ï¼‰ï¼Œåªæ˜¯ä»–çš„ç±»å‹æ˜¯ <code>LoadBalancer</code>ï¼Œé€šå¸¸è¿™ç§ç±»å‹çš„ service ä¼šç”±äº‘å‚å•†ç»‘å®šä¸€ä¸ªå¤–éƒ¨ IPï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå¤–éƒ¨ IP è®¿é—® Ingress äº†ã€‚</p><blockquote><p>è€Œæˆ‘ä»¬åº”ç”¨çš„ service æ˜¯ ClusterIPï¼Œåªèƒ½åœ¨åº”ç”¨å†…éƒ¨è®¿é—®</p></blockquote><p><img src="https://s2.loli.net/2023/09/14/Bu67SlMLak1hirc.png" alt="image.png"></p><p>é€šè¿‡ service çš„ä¿¡æ¯ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ ingress çš„ service ç»‘å®šçš„å¤–éƒ¨ IP æ˜¯ <code>localhost</code>ï¼ˆæœ¬åœ°çš„åŸå› ï¼‰</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Ingress é€šå¸¸æ˜¯å……å½“ç½‘å…³çš„ä½œç”¨ï¼Œåç»­æˆ‘ä»¬åœ¨ä½¿ç”¨ Istio æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Istio æ‰€æä¾›çš„æ§åˆ¶å™¨æ¥æ›¿æ¢æ‰ Ingress-nginxï¼Œå¯ä»¥æ›´æ–¹ä¾¿çš„ç®¡ç†å†…å¤–ç½‘æµé‡ã€‚</p><p>æœ¬æ–‡çš„æ‰€æœ‰æºç åœ¨è¿™é‡Œå¯ä»¥è®¿é—®ï¼š<br><a href="https://github.com/crossoverJie/k8s-combat">https://github.com/crossoverJie/k8s-combat</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/09/14/Pe7DWCIS2UMKHQ8.png&quot; alt=&quot;ingress.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰ä¸¤ç« ä¸­æˆ‘ä»¬å°†åº”ç”¨&lt;a href=&quot;https://crossoverjie.top/2023/08/31/ob/k8s-0-start/&quot;&gt;éƒ¨ç½²&lt;/a&gt;åˆ°äº† k8s ä¸­ï¼ŒåŒæ—¶ä¸åŒçš„æœåŠ¡ä¹‹é—´ä¹Ÿå¯ä»¥é€šè¿‡ &lt;a href=&quot;https://crossoverjie.top/2023/09/05/ob/k8s-service/&quot;&gt;service&lt;/a&gt; è¿›è¡Œè°ƒç”¨ï¼Œç°åœ¨è¿˜æœ‰ä¸€ä¸ªæ­¥éª¤å°±æ˜¯å°†æˆ‘ä»¬çš„åº”ç”¨æš´éœ²åˆ°å…¬ç½‘ï¼Œå¹¶æä¾›åŸŸåçš„è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€æ­¥ç±»ä¼¼äºæˆ‘ä»¬ä»¥å‰é…ç½® Nginx å’Œç»‘å®šåŸŸåï¼Œæä¾›è¿™ä¸ªèƒ½åŠ›çš„æœåŠ¡åœ¨ k8s ä¸­æˆä¸º Ingressã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿™ä¸ªæè¿°å…¶å®ä¹Ÿèƒ½çœ‹å‡º Ingress æ˜¯åè¿ç»´çš„å·¥ä½œï¼Œä½†ä¹Ÿä¸å¦¨ç¢æˆ‘ä»¬ä½œä¸ºç ”å‘å»äº†è§£è¿™éƒ¨åˆ†çš„å†…å®¹ï¼›äº†è§£æ•´ä¸ªç³»ç»Ÿæ˜¯å¦‚ä½•è¿è½¬çš„ä¹Ÿæ˜¯ç ”å‘åº”è¯¥æŒæ¡çš„æŠ€èƒ½ã€‚&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Golang åŸºç¡€é¢è¯•é¢˜ 01</title>
    <link href="http://crossoverjie.top/2023/09/12/ob/Golang-interview-01/"/>
    <id>http://crossoverjie.top/2023/09/12/ob/Golang-interview-01/</id>
    <published>2023-09-12T12:58:03.000Z</published>
    <updated>2023-09-15T18:42:21.149Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/09/12/xJgnyReWs2mp7Pr.png" alt="Golang é¢è¯•é¢˜åˆé›†.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­åˆ†äº«äº† <a href="https://crossoverjie.top/2023/08/17/ob/k8s-question-01/">k8s</a> ç›¸å…³çš„é¢è¯•é¢˜ï¼Œæœ¬æ–‡æˆ‘ä»¬é‡ç‚¹æ¥è®¨è®ºå’Œ k8s å¯†åˆ‡ç›¸å…³çš„ Go è¯­è¨€é¢è¯•é¢˜ã€‚</p><p>è¿™å‡ å¹´éšç€äº‘åŸç”Ÿçš„å…´èµ·ï¼Œå¤§éƒ¨åˆ†åç«¯å¼€å‘è€…ï¼Œç‰¹åˆ«æ˜¯ Java å¼€å‘è€…éƒ½æˆ–å¤šæˆ–å°‘çš„æƒ³å­¦ä¹ ä¸€äº› Go ç›¸å…³çš„æŠ€èƒ½ï¼Œæ‰€ä»¥ä»Šå¤©åˆ†äº«çš„å†…å®¹æ¯”è¾ƒåˆçº§ï¼Œé€‚åˆ Go è¯­è¨€åˆå­¦è€…ã€‚</p><p><img src="https://s2.loli.net/2023/09/12/oheqNwJt3KvsgDM.png" alt="image.png"></p><p>æœ¬æ–‡å†…å®¹ä¾ç„¶æ¥è‡ªäºè¿™ä¸ªä»“åº“<br><a href="https://github.com/bregman-arie/devops-exercises">https://github.com/bregman-arie/devops-exercises</a></p><span id="more"></span><p>ä»¥ä¸‹æ˜¯å…·ä½“å†…å®¹ï¼š</p><blockquote><p>ï¼ˆï¼‰çš„å†…å®¹æ˜¯æˆ‘çš„è¡¥å……éƒ¨åˆ†ã€‚</p></blockquote><h1 id="Go-101"><a href="#Go-101" class="headerlink" title="Go 101"></a>Go 101</h1><h2 id="Go-è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹"><a href="#Go-è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹" class="headerlink" title="Go è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹"></a>Go è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹</h2><ul><li>Go æ˜¯ä¸€ç§å¼ºç±»å‹é™æ€è¯­è¨€ï¼Œå˜é‡çš„ç±»å‹å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™æŒ‡å®šï¼ˆä½†å¯ä»¥ä½¿ç”¨ç±»å‹æ¨å¯¼ï¼‰ï¼Œåœ¨è¿è¡Œæ—¶ä¸èƒ½ä¿®æ”¹å˜é‡ç±»å‹ï¼ˆä¸ <code>Python</code> è¿™ç±»åŠ¨æ€ç±»å‹è¯­è¨€ä¸åŒï¼‰ã€‚</li><li>è¶³å¤Ÿçš„ç®€å•ï¼Œé€šå¸¸ä¸€ä¸ªå‘¨æœ«å°±èƒ½å­¦ä¼š</li><li>ç¼–è¯‘é€Ÿåº¦å¤Ÿå¿«</li><li>å†…ç½®å¹¶å‘ï¼ˆç›¸å¯¹äº Java çš„å¹¶å‘æ¥è¯´éå¸¸ç®€å•ï¼‰</li><li>å†…ç½®åƒåœ¾æ”¶é›†</li><li>å¤šå¹³å°æ”¯æŒ</li><li>å¯ä»¥æ‰“åŒ…åˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰è¿è¡Œæ—¶éœ€è¦ä¾èµ–çš„åº“éƒ½ä¼šè¢«æ‰“åŒ…è¿›è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œéå¸¸é€‚åˆäºåˆ†å‘ã€‚</li></ul><h2 id="Go-æ˜¯ä¸€ç§ç¼–è¯‘å‹çš„é™æ€ç±»å‹è¯­è¨€ï¼Œæ­£ç¡®è¿˜æ˜¯é”™è¯¯"><a href="#Go-æ˜¯ä¸€ç§ç¼–è¯‘å‹çš„é™æ€ç±»å‹è¯­è¨€ï¼Œæ­£ç¡®è¿˜æ˜¯é”™è¯¯" class="headerlink" title="Go æ˜¯ä¸€ç§ç¼–è¯‘å‹çš„é™æ€ç±»å‹è¯­è¨€ï¼Œæ­£ç¡®è¿˜æ˜¯é”™è¯¯"></a>Go æ˜¯ä¸€ç§ç¼–è¯‘å‹çš„é™æ€ç±»å‹è¯­è¨€ï¼Œæ­£ç¡®è¿˜æ˜¯é”™è¯¯</h2><p>æ­£ç¡®âœ…</p><h2 id="ä¸ºä»€ä¹ˆæœ‰äº›å‡½æ•°æ˜¯ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„"><a href="#ä¸ºä»€ä¹ˆæœ‰äº›å‡½æ•°æ˜¯ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰äº›å‡½æ•°æ˜¯ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„"></a>ä¸ºä»€ä¹ˆæœ‰äº›å‡½æ•°æ˜¯ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„</h2><p>è¿™æ˜¯å› ä¸º Go è¯­è¨€ä¸­é¦–å­—æ¯å¤§å†™çš„å‡½æ•°å’Œå˜é‡æ˜¯å¯ä»¥å¯¼å‡ºçš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è¢«å…¶ä»–åŒ…æ‰€å¼•ç”¨ï¼›ç±»ä¼¼äº Java ä¸­çš„ <code>public</code> å’Œ <code>private</code> å…³é”®å­—ã€‚</p><h1 id="å˜é‡å’Œæ•°æ®ç±»å‹"><a href="#å˜é‡å’Œæ•°æ®ç±»å‹" class="headerlink" title="å˜é‡å’Œæ•°æ®ç±»å‹"></a>å˜é‡å’Œæ•°æ®ç±»å‹</h1><h2 id="ç®€æ´å’Œå¸¸è§„å£°æ˜å˜é‡æ–¹å¼"><a href="#ç®€æ´å’Œå¸¸è§„å£°æ˜å˜é‡æ–¹å¼" class="headerlink" title="ç®€æ´å’Œå¸¸è§„å£°æ˜å˜é‡æ–¹å¼"></a>ç®€æ´å’Œå¸¸è§„å£°æ˜å˜é‡æ–¹å¼</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  x := <span class="number">2</span> <span class="comment">// åªèƒ½åœ¨å‡½æ•°å†…ä½¿ç”¨ï¼Œè‡ªåŠ¨ç±»å‹æ¨å¯¼</span></span><br><span class="line">  <span class="keyword">var</span> y <span class="type">int</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">  fmt.Printf(<span class="string">&quot;x: %v. y: %v&quot;</span>, x, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ­£ç¡®âœ…è¿˜æ˜¯é”™è¯¯âŒ"><a href="#æ­£ç¡®âœ…è¿˜æ˜¯é”™è¯¯âŒ" class="headerlink" title="æ­£ç¡®âœ…è¿˜æ˜¯é”™è¯¯âŒ"></a>æ­£ç¡®âœ…è¿˜æ˜¯é”™è¯¯âŒ</h2><ul><li>å¯ä»¥é‡å¤å£°æ˜å˜é‡âŒï¼ˆå¼ºç±»å‹è¯­è¨€çš„ç‰¹æ€§ï¼‰</li><li>å˜é‡ä¸€æ—¦å£°æ˜ï¼Œå°±å¿…é¡»ä½¿ç”¨âœ…ï¼ˆé¿å…å£°æ˜æ— æ•ˆå˜é‡ï¼Œå¢å¼ºä»£ç å¯è¯»æ€§ï¼‰</li></ul><h2 id="ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> userName</span><br><span class="line">    userName = <span class="string">&quot;user&quot;</span></span><br><span class="line">    fmt.Println(userName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘é”™è¯¯ï¼Œå˜é‡ <code>userName</code> æ²¡æœ‰å£°æ˜ç±»å‹ï¼›ä¿®æ”¹ä¸ºè¿™æ ·æ˜¯å¯ä»¥çš„ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> userName <span class="type">string</span></span><br><span class="line">    userName = <span class="string">&quot;user&quot;</span></span><br><span class="line">    fmt.Println(userName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="var-x-int-2-and-x-2-è¿™ä¸¤ç§å£°æ˜å˜é‡çš„åŒºåˆ«"><a href="#var-x-int-2-and-x-2-è¿™ä¸¤ç§å£°æ˜å˜é‡çš„åŒºåˆ«" class="headerlink" title="var x int = 2Â andÂ x := 2 è¿™ä¸¤ç§å£°æ˜å˜é‡çš„åŒºåˆ«"></a><code>var x int = 2</code>Â andÂ <code>x := 2</code> è¿™ä¸¤ç§å£°æ˜å˜é‡çš„åŒºåˆ«</h2><p>ç»“æœä¸Šæ¥è¯´æ˜¯ç›¸ç­‰çš„ï¼Œä½† <code>x := 2</code>  åªèƒ½åœ¨å‡½æ•°ä½“ç±»å£°æ˜ã€‚</p><h2 id="ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯å£°æ˜ï¼Ÿ"><a href="#ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯å£°æ˜ï¼Ÿ" class="headerlink" title="ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯å£°æ˜ï¼Ÿ"></a>ä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯å£°æ˜ï¼Ÿ</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line">x := <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    x = <span class="number">3</span></span><br><span class="line">    fmt.Println(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘é”™è¯¯ï¼Œ<code>x := 2</code>  ä¸èƒ½åœ¨å‡½æ•°ä½“å¤–ä½¿ç”¨ï¼Œ <code>x = 3</code> æ²¡æœ‰æŒ‡å®šç±»å‹ï¼Œé™¤éä½¿ç”¨ <code>x := 3</code> è¿›è¡Œç±»å‹æ¨å¯¼ã€‚</p><h2 id="å¦‚ä½•ä½¿ç”¨å˜é‡å£°æ˜å—ï¼ˆè‡³å°‘ä¸‰ä¸ªå˜é‡ï¼‰"><a href="#å¦‚ä½•ä½¿ç”¨å˜é‡å£°æ˜å—ï¼ˆè‡³å°‘ä¸‰ä¸ªå˜é‡ï¼‰" class="headerlink" title="å¦‚ä½•ä½¿ç”¨å˜é‡å£°æ˜å—ï¼ˆè‡³å°‘ä¸‰ä¸ªå˜é‡ï¼‰"></a>å¦‚ä½•ä½¿ç”¨å˜é‡å£°æ˜å—ï¼ˆè‡³å°‘ä¸‰ä¸ªå˜é‡ï¼‰</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">  x <span class="type">bool</span>   = <span class="literal">false</span></span><br><span class="line">  y <span class="type">int</span>    = <span class="number">0</span></span><br><span class="line">  z <span class="type">string</span> = <span class="string">&quot;false&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;The type of x: %T. The value of x: %v\n&quot;</span>, x, x)</span><br><span class="line">  fmt.Printf(<span class="string">&quot;The type of y: %T. The value of y: %v\n&quot;</span>, y, y)</span><br><span class="line">  fmt.Printf(<span class="string">&quot;The type of z: %T. The value of z: %v\n&quot;</span>, y, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å˜é‡å—é…åˆ <code>go fmt</code> æ ¼å¼åŒ–ä¹‹åçš„ä»£ç å¯¹é½çš„éå¸¸å·¥æ•´ï¼Œå¼ºè¿«ç—‡çš„ç¦éŸ³ã€‚</p><p>Go çš„åŸºç¡€é¢è¯•é¢˜ä¹Ÿè›®å¤šçš„ï¼Œæˆ‘ä»¬å…ˆä»åŸºç¡€çš„å¼€å§‹ï¼Œä»Šååç»§ç»­æ›´æ–°ç›¸å…³é¢è¯•é¢˜ï¼Œéš¾åº¦ä¹Ÿä¼šé€æ¸æé«˜ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹è¯·æŒç»­å…³æ³¨ã€‚<br>#GO #é¢è¯• </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/09/12/xJgnyReWs2mp7Pr.png&quot; alt=&quot;Golang é¢è¯•é¢˜åˆé›†.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­åˆ†äº«äº† &lt;a href=&quot;https://crossoverjie.top/2023/08/17/ob/k8s-question-01/&quot;&gt;k8s&lt;/a&gt; ç›¸å…³çš„é¢è¯•é¢˜ï¼Œæœ¬æ–‡æˆ‘ä»¬é‡ç‚¹æ¥è®¨è®ºå’Œ k8s å¯†åˆ‡ç›¸å…³çš„ Go è¯­è¨€é¢è¯•é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å‡ å¹´éšç€äº‘åŸç”Ÿçš„å…´èµ·ï¼Œå¤§éƒ¨åˆ†åç«¯å¼€å‘è€…ï¼Œç‰¹åˆ«æ˜¯ Java å¼€å‘è€…éƒ½æˆ–å¤šæˆ–å°‘çš„æƒ³å­¦ä¹ ä¸€äº› Go ç›¸å…³çš„æŠ€èƒ½ï¼Œæ‰€ä»¥ä»Šå¤©åˆ†äº«çš„å†…å®¹æ¯”è¾ƒåˆçº§ï¼Œé€‚åˆ Go è¯­è¨€åˆå­¦è€…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/09/12/oheqNwJt3KvsgDM.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å†…å®¹ä¾ç„¶æ¥è‡ªäºè¿™ä¸ªä»“åº“&lt;br&gt;&lt;a href=&quot;https://github.com/bregman-arie/devops-exercises&quot;&gt;https://github.com/bregman-arie/devops-exercises&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Golang" scheme="http://crossoverjie.top/categories/Golang/"/>
    
    
    <category term="é¢è¯•" scheme="http://crossoverjie.top/tags/%E9%9D%A2%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>k8så…¥é—¨åˆ°å®æˆ˜--è·¨æœåŠ¡è°ƒç”¨</title>
    <link href="http://crossoverjie.top/2023/09/05/ob/k8s-service/"/>
    <id>http://crossoverjie.top/2023/09/05/ob/k8s-service/</id>
    <published>2023-09-05T13:13:28.000Z</published>
    <updated>2023-09-15T18:42:21.018Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/09/05/GbZ1vKQNHY32wzD.png" alt="service.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>åœ¨åšä¼ ç»Ÿä¸šåŠ¡å¼€å‘çš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬çš„æœåŠ¡æä¾›æ–¹æœ‰å¤šä¸ªå®ä¾‹æ—¶ï¼Œå¾€å¾€æˆ‘ä»¬éœ€è¦å°†å¯¹æ–¹çš„æœåŠ¡åˆ—è¡¨ä¿å­˜åœ¨æœ¬åœ°ï¼Œç„¶åé‡‡ç”¨ä¸€å®šçš„ç®—æ³•è¿›è¡Œè°ƒç”¨ï¼›å½“æœåŠ¡æä¾›æ–¹çš„åˆ—è¡¨å˜åŒ–æ—¶è¿˜å¾—åŠæ—¶é€šçŸ¥è°ƒç”¨æ–¹ã€‚</p><span id="more"></span><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">student:</span>  </span><br><span class="line">   <span class="attr">url:</span>     </span><br><span class="line">   <span class="bullet">-</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span><span class="string">:8081</span>     </span><br><span class="line">   <span class="bullet">-</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span><span class="string">:8081</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·è‡ªç„¶æ˜¯å¯¹åŒæ–¹éƒ½å¸¦æ¥ä¸å°‘çš„è´Ÿæ‹…ï¼Œæ‰€ä»¥åç»­æ¨å‡ºçš„æœåŠ¡è°ƒç”¨æ¡†æ¶éƒ½ä¼šæƒ³åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä»¥ <code>spring cloud</code> ä¸ºä¾‹ï¼š<br><img src="https://s2.loli.net/2023/09/06/IW1jaidQ25Xk9u4.png" alt="image.png"></p><p>æœåŠ¡æä¾›æ–¹ä¼šå‘ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±çš„æœåŠ¡ï¼ˆåç§°ã€IPç­‰ä¿¡æ¯ï¼‰ï¼Œå®¢æˆ·ç«¯æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™ä¼šå‘æœåŠ¡æ³¨å†Œä¸­å¿ƒè·å–ä¸€ä¸ªèŠ‚ç‚¹ä¿¡æ¯ï¼Œç„¶åå‘èµ·è°ƒç”¨ã€‚</p><p>ä½†å½“æˆ‘ä»¬åˆ‡æ¢åˆ° <code>k8s</code> åï¼Œè¿™äº›åŸºç¡€è®¾æ–½éƒ½äº¤ç»™äº† <code>k8s</code> å¤„ç†äº†ï¼Œæ‰€ä»¥ <code>k8s</code> è‡ªç„¶å¾—æœ‰ä¸€ä¸ªç»„ä»¶æ¥è§£å†³æœåŠ¡æ³¨å†Œå’Œè°ƒç”¨çš„é—®é¢˜ã€‚</p><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä»Šå¤©é‡ç‚¹ä»‹ç»çš„ <code>service</code>ã€‚</p><h1 id="service"><a href="#service" class="headerlink" title="service"></a>service</h1><p>åœ¨ä»‹ç» <code>service</code> ä¹‹å‰æˆ‘å…ˆè°ƒæ•´äº†æºç ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">   http.HandleFunc(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;  </span><br><span class="line">      name, _ := os.Hostname()  </span><br><span class="line">      log.Printf(<span class="string">&quot;%s ping&quot;</span>, name)  </span><br><span class="line">      fmt.Fprint(w, <span class="string">&quot;pong&quot;</span>)  </span><br><span class="line">   &#125;)  </span><br><span class="line">   http.HandleFunc(<span class="string">&quot;/service&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;  </span><br><span class="line">      resp, err := http.Get(<span class="string">&quot;http://k8s-combat-service:8081/ping&quot;</span>)  </span><br><span class="line">      <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;  </span><br><span class="line">         log.Println(err)  </span><br><span class="line">         fmt.Fprint(w, err)  </span><br><span class="line">         <span class="keyword">return</span>  </span><br><span class="line">      &#125;  </span><br><span class="line">      fmt.Fprint(w, resp.Status)  </span><br><span class="line">   &#125;)  </span><br><span class="line">  </span><br><span class="line">   http.ListenAndServe(<span class="string">&quot;:8081&quot;</span>, <span class="literal">nil</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å¢äº†ä¸€ä¸ª <code>/service</code> çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä¼šé€šè¿‡ service çš„æ–¹å¼è°ƒç”¨æœåŠ¡æä¾›è€…çš„æœåŠ¡ï¼Œç„¶åé‡æ–°æ‰“åŒ…ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make docker</span><br></pre></td></tr></table></figure><p>åŒæ—¶ä¹Ÿæ–°å¢äº†ä¸€ä¸ª <code>deployment-service.yaml</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">labels:</span>  </span><br><span class="line">    <span class="attr">app:</span> <span class="string">k8s-combat-service</span> <span class="comment"># é€šè¿‡æ ‡ç­¾é€‰æ‹©å…³è”  </span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">k8s-combat-service</span>  </span><br><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span>  </span><br><span class="line">  <span class="attr">selector:</span>  </span><br><span class="line">    <span class="attr">matchLabels:</span>  </span><br><span class="line">      <span class="attr">app:</span> <span class="string">k8s-combat-service</span>  </span><br><span class="line">  <span class="attr">template:</span>  </span><br><span class="line">    <span class="attr">metadata:</span>  </span><br><span class="line">      <span class="attr">labels:</span>  </span><br><span class="line">        <span class="attr">app:</span> <span class="string">k8s-combat-service</span>  </span><br><span class="line">    <span class="attr">spec:</span>  </span><br><span class="line">      <span class="attr">containers:</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">k8s-combat-service</span>  </span><br><span class="line">          <span class="attr">image:</span> <span class="string">crossoverjie/k8s-combat:v1</span>  </span><br><span class="line">          <span class="attr">imagePullPolicy:</span> <span class="string">Always</span>  </span><br><span class="line">          <span class="attr">resources:</span>  </span><br><span class="line">            <span class="attr">limits:</span>  </span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span>  </span><br><span class="line">              <span class="attr">memory:</span> <span class="string">100Mi</span>  </span><br><span class="line">            <span class="attr">requests:</span>  </span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;0.1&quot;</span>  </span><br><span class="line">              <span class="attr">memory:</span> <span class="string">10Mi</span>  </span><br><span class="line"><span class="meta">---  </span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">k8s-combat-service</span>  </span><br><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">selector:</span>  </span><br><span class="line">    <span class="attr">app:</span> <span class="string">k8s-combat-service</span> <span class="comment"># é€šè¿‡æ ‡ç­¾é€‰æ‹©å…³è”  </span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span>  </span><br><span class="line">  <span class="attr">ports:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">8081</span>        <span class="comment"># æœ¬ Service çš„ç«¯å£  </span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8081</span>  <span class="comment"># å®¹å™¨ç«¯å£  </span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">app</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç›¸åŒçš„é•œåƒéƒ¨ç½²ä¸€ä¸ªæ–°çš„ deploymentï¼Œåç§°ä¸º <code>k8s-combat-service</code>ï¼Œé‡ç‚¹æ˜¯æ–°å¢äº†ä¸€ä¸ª<code>kind: Service</code> çš„å¯¹è±¡ã€‚</p><p>è¿™ä¸ªå°±æ˜¯ç”¨äºå£°æ˜ <code>service</code> çš„ç»„ä»¶ï¼Œåœ¨è¿™ä¸ªç»„ä»¶ä¸­ä¹Ÿæ˜¯ä½¿ç”¨ <code>selector</code> æ ‡ç­¾å’Œ <code>deployment</code> è¿›è¡Œäº†å…³è”ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ª <code>service</code> ç”¨äºæœåŠ¡äºåç§°ç­‰äº <code>k8s-combat-service</code> çš„ <code>deployment</code>ã€‚</p><p>ä¸‹é¢çš„ä¸¤ä¸ªç«¯å£ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œä¸€ä¸ªæ˜¯ä»£ç†çš„ç«¯å£ï¼Œ å¦ä¸€ä¸ªæ˜¯  service è‡ªèº«æä¾›å‡ºå»çš„ç«¯å£ã€‚</p><p>è‡³äº <code>type: ClusterIP</code> æ˜¯ç”¨äºå£°æ˜ä¸åŒç±»å‹çš„ <code>service</code>ï¼Œé™¤æ­¤ä¹‹å¤–çš„ç±»å‹è¿˜æœ‰ï¼š</p><ul><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport"><code>NodePort</code></a></li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer"><code>LoadBalancer</code></a></li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname"><code>ExternalName</code></a><br>ç­‰ç±»å‹ï¼Œé»˜è®¤æ˜¯ <code>ClusterIP</code>ï¼Œç°åœ¨ä¸ç”¨çº ç»“è¿™å‡ ç§ç±»å‹çš„ä½œç”¨ï¼Œåç»­æˆ‘ä»¬åœ¨è®²åˆ° <code>Ingress</code> çš„æ—¶å€™ä¼šå…·ä½“ä»‹ç»ã€‚</li></ul><h2 id="è´Ÿè½½æµ‹è¯•"><a href="#è´Ÿè½½æµ‹è¯•" class="headerlink" title="è´Ÿè½½æµ‹è¯•"></a>è´Ÿè½½æµ‹è¯•</h2><p>æˆ‘ä»¬å…ˆåˆ†åˆ«å°†è¿™ä¸¤ä¸ª <code>deployment</code> éƒ¨ç½²å¥½ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">k apply -f deployment/deployment.yaml</span><br><span class="line">k apply -f deployment/deployment-service.yaml</span><br><span class="line"></span><br><span class="line">â¯ k get pod</span><br><span class="line">NAME                                  READY   STATUS    RESTARTS   AGE</span><br><span class="line">k8s-combat-7867bfb596-67p5m           1/1     Running   0          3h22m</span><br><span class="line">k8s-combat-service-5b77f59bf7-zpqwt   1/1     Running   0          3h22m</span><br></pre></td></tr></table></figure><p>ç”±äºæˆ‘æ–°å¢äº†ä¸€ä¸ª <code>/service</code> çš„æ¥å£ï¼Œç”¨äºåœ¨ <code>k8s-combat</code> ä¸­é€šè¿‡ <code>service</code> è°ƒç”¨ <code>k8s-combat-service</code> çš„æ¥å£ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp, err := http.Get(<span class="string">&quot;http://k8s-combat-service:8081/ping&quot;</span>)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>k8s-combat-service</code> æœåŠ¡çš„åŸŸåå°±æ˜¯ä»–çš„æœåŠ¡åç§°ã€‚</p><blockquote><p>å¦‚æœæ˜¯è·¨ namespace è°ƒç”¨æ—¶ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå®Œæ•´åç§°ï¼Œåœ¨åç»­çš„ç« èŠ‚ä¼šæ¼”ç¤ºã€‚</p></blockquote><p>æˆ‘ä»¬æ•´ä¸ªçš„è°ƒç”¨æµç¨‹å¦‚ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/09/06/i12pR3DjC6wnIXQ.png" alt="image.png"></p><p>ç›¸ä¿¡å¤§å®¶ä¹Ÿçœ‹å¾—å‡ºæ¥ç›¸å¯¹äº <code>spring cloud</code> è¿™ç±»å¾®æœåŠ¡æ¡†æ¶æä¾›çš„å®¢æˆ·ç«¯è´Ÿè½½æ–¹å¼ï¼Œ<code>service</code> æ˜¯ä¸€ç§æœåŠ¡ç«¯è´Ÿè½½ï¼Œæœ‰ç‚¹ç±»ä¼¼äº <code>Nginx</code> çš„åå‘ä»£ç†ã€‚</p><p>ä¸ºäº†æ›´ç›´è§‚çš„éªŒè¯è¿™ä¸ªæµç¨‹ï¼Œæ­¤æ—¶æˆ‘å°† <code>k8s-combat-service</code> çš„å‰¯æœ¬æ•°å¢åŠ åˆ° 2ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>åªéœ€è¦å†æ¬¡æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â¯ k apply -f deployment/deployment-service.yaml</span><br><span class="line">deployment.apps/k8s-combat-service configured</span><br><span class="line">service/k8s-combat-service unchanged</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/09/06/ZC8UrjEz6ia1Qgo.png" alt="image.png"></p><blockquote><p>ä¸ç®¡æˆ‘ä»¬å¯¹ <code>deployment</code> çš„åšäº†ä»€ä¹ˆå˜æ›´ï¼Œéƒ½åªéœ€è¦ <code>apply</code> è¿™ä¸ª <code>yaml</code>  æ–‡ä»¶å³å¯ï¼Œ k8s ä¼šè‡ªåŠ¨å°†å½“å‰çš„ <code>deployment</code> è°ƒæ•´ä¸ºæˆ‘ä»¬é¢„æœŸçš„çŠ¶æ€ï¼ˆæ¯”å¦‚è¿™é‡Œçš„å‰¯æœ¬æ•°é‡å¢åŠ ä¸º 2ï¼‰ï¼›è¿™ä¹Ÿå°±æ˜¯ <code>k8s</code> ä¸­å¸¸è¯´çš„<strong>å£°æ˜å¼ API</strong>ã€‚</p></blockquote><p>å¯ä»¥çœ‹åˆ°æ­¤æ—¶ <code>k8s-combat-service</code> çš„å‰¯æœ¬æ•°å·²ç»å˜ä¸ºä¸¤ä¸ªäº†ã€‚<br>å¦‚æœæˆ‘ä»¬æ­¤æ—¶æŸ¥çœ‹è¿™ä¸ª <code>service</code> çš„æè¿°æ—¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ k describe svc k8s-combat-service |grep Endpoints</span><br><span class="line">Endpoints:         192.168.130.133:8081,192.168.130.29:8081</span><br></pre></td></tr></table></figure><p>ä¼šå‘ç°å®ƒå·²ç»ä»£ç†äº†è¿™ä¸¤ä¸ª <code>Pod</code> çš„ IPã€‚</p><p><img src="https://s2.loli.net/2023/09/06/HbjyEcnaeCK6uMJ.png" alt="image.png"><br>æ­¤æ—¶æˆ‘è¿›å…¥äº† <code>k8s-combat-7867bfb596-67p5m</code> çš„å®¹å™¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">k exec -it k8s-combat-7867bfb596-67p5m bash</span><br><span class="line">curl http://127.0.0.1:8081/service</span><br></pre></td></tr></table></figure><p>å¹¶æ‰§è¡Œä¸¤æ¬¡ <code>/service</code> æ¥å£ï¼Œå‘ç°è¯·æ±‚ä¼šè½®è®­è¿›å…¥ <code>k8s-combat-service</code> çš„ä»£ç†çš„ IP ä¸­ã€‚</p><p>ç”±äº <code>k8s service</code> æ˜¯åŸºäº <code>TCP/UDP</code> çš„å››å±‚è´Ÿè½½ï¼Œæ‰€ä»¥åœ¨ <code>http1.1</code>  ä¸­æ˜¯å¯ä»¥åšåˆ°è¯·æ±‚çº§çš„è´Ÿè½½å‡è¡¡ï¼Œä½†å¦‚æœæ˜¯ç±»ä¼¼äº <code>gRPC</code> è¿™ç±»é•¿é“¾æ¥å°±æ— æ³•åšåˆ°è¯·æ±‚çº§çš„è´Ÿè½½å‡è¡¡ã€‚</p><p>æ¢å¥è¯è¯´ <code>service</code> åªæ”¯æŒè¿æ¥çº§åˆ«çš„è´Ÿè½½ã€‚</p><p>å¦‚æœè¦æ”¯æŒ <code>gRPC</code>ï¼Œå°±å¾—ä½¿ç”¨ Istio è¿™ç±»æœåŠ¡ç½‘æ ¼ï¼Œç›¸å…³å†…å®¹ä¼šåœ¨åç»­ç« èŠ‚è¯¦è§£ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ€»çš„æ¥è¯´ <code>k8s service</code> æä¾›äº†ç®€æ˜“çš„æœåŠ¡æ³¨å†Œå‘ç°å’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå½“æˆ‘ä»¬åªæä¾› http æœåŠ¡æ—¶æ˜¯å®Œå…¨å¤Ÿç”¨çš„ã€‚</p><p>ç›¸å…³çš„æºç å’Œ yaml èµ„æºæ–‡ä»¶éƒ½å­˜åœ¨è¿™é‡Œï¼š<br><a href="https://github.com/crossoverJie/k8s-combat">https://github.com/crossoverJie/k8s-combat</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/09/05/GbZ1vKQNHY32wzD.png&quot; alt=&quot;service.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;åœ¨åšä¼ ç»Ÿä¸šåŠ¡å¼€å‘çš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬çš„æœåŠ¡æä¾›æ–¹æœ‰å¤šä¸ªå®ä¾‹æ—¶ï¼Œå¾€å¾€æˆ‘ä»¬éœ€è¦å°†å¯¹æ–¹çš„æœåŠ¡åˆ—è¡¨ä¿å­˜åœ¨æœ¬åœ°ï¼Œç„¶åé‡‡ç”¨ä¸€å®šçš„ç®—æ³•è¿›è¡Œè°ƒç”¨ï¼›å½“æœåŠ¡æä¾›æ–¹çš„åˆ—è¡¨å˜åŒ–æ—¶è¿˜å¾—åŠæ—¶é€šçŸ¥è°ƒç”¨æ–¹ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="k8s" scheme="http://crossoverjie.top/categories/k8s/"/>
    
    
    <category term="Go" scheme="http://crossoverjie.top/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>k8s å…¥é—¨åˆ°å®æˆ˜--éƒ¨ç½²åº”ç”¨åˆ° k8s</title>
    <link href="http://crossoverjie.top/2023/08/31/ob/k8s-0-start/"/>
    <id>http://crossoverjie.top/2023/08/31/ob/k8s-0-start/</id>
    <published>2023-08-31T14:42:32.000Z</published>
    <updated>2023-09-15T18:42:21.018Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/09/04/ymUpcXZrxfNsT91.png" alt="k8s å…¥é—¨åˆ°å®æˆ˜ 01.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘è¿™è¿™æ®µæ—¶é—´æ›´æ–°äº†ä¸€äº› k8s ç›¸å…³çš„åšå®¢å’Œè§†é¢‘ï¼Œä¹Ÿæ”¶åˆ°äº†ä¸€äº›åé¦ˆï¼›å¤§æ¦‚åˆ†ä¸ºè¿™å‡ ç±»ï¼š</p><ul><li>å…¬å¸å·²ç»ç»å†è¿‡æœåŠ¡åŒ–æ”¹é€ äº†ï¼Œä½†è¿˜æœªæ¥è§¦è¿‡äº‘åŸç”Ÿã€‚</li><li>å…¬å¸éƒ¨åˆ†åº”ç”¨è¿›è¡Œäº†äº‘åŸç”Ÿæ”¹é€ ï¼Œä½†å¤§éƒ¨åˆ†å·¥ä½œæ˜¯ç”±åŸºç¡€æ¶æ„å’Œè¿ç»´éƒ¨é—¨æ¨åŠ¨çš„ï¼Œè‡ªå·±åªæ˜¯ä½œä¸ºå¼€å‘å¹¶ä¸äº†è§£å…¶ä¸­çš„ç»†èŠ‚ï¼Œç”šè‡³ k8s ä¹Ÿæ¥è§¦ä¸åˆ°ã€‚</li><li>è¿˜å¤„äºæ¯”è¾ƒä¼ ç»Ÿçš„ä»¥è™šæ‹Ÿæœºéƒ¨ç½²çš„ä¼ ç»Ÿè¿ç»´ä¸ºä¸»ã€‚</li></ul><p>å…¶ä¸­ä»¥ç¬¬äºŒç§å å¤§å¤šæ•°ï¼Œè™½ç„¶å…¬å¸è¿›è¡Œäº†äº‘åŸç”Ÿæ”¹é€ ï¼Œä½†ä¼¼ä¹å’Œçº¯ä¸šåŠ¡ç ”å‘åŒå­¦æ¥è¯´æ²¡æœ‰å¤ªå¤§å…³ç³»ï¼Œè‡ªå·±å·¥ä½œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚</p><p>æ°å¥½æˆ‘ä¹‹å‰æ­£å¥½ä»ä¸šåŠ¡ç ”å‘çš„è§’åº¦è½¬æ¢åˆ°äº†åŸºç¡€æ¶æ„éƒ¨é—¨ï¼Œä¸¤ä¸ªè§’è‰²æˆ‘éƒ½æ¥è§¦è¿‡ï¼Œä¹Ÿå¸®åŠ©è¿‡ä¸€äº›ä¸šåŠ¡ç ”å‘äº†è§£å…¬å¸çš„äº‘åŸç”Ÿæ¶æ„ï¼›</p><p>ä¸ºæ­¤æ‰€ä»¥æˆ‘æƒ³ç³»ç»Ÿæ€§çš„å¸¦å¤§å®¶ä»¥<strong>ç ”å‘</strong>çš„è§’åº¦å¯¹ k8s è¿›è¡Œå®è·µã€‚</p><p>å› ä¸º k8s éƒ¨åˆ†åŠŸèƒ½å…¶å®æ˜¯åè¿ç»´çš„ï¼Œå¯¹ç ”å‘æ¥è¯´ä¼˜å…ˆçº§å¹¶ä¸å¤ªé«˜ï¼›<br>æ‰€ä»¥æˆ‘ä¸å¤ªä¼šæ¶‰åŠä¸€äº› k8s è¿ç»´çš„çŸ¥è¯†ç‚¹ï¼Œæ¯”å¦‚å®‰è£…ã€ç»„ä»¶ç­‰æ¨¡å—ï¼›ä¸»è¦ä»¥æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¼šä½¿ç”¨åˆ°çš„ç»„ä»¶è®²èµ·ã€‚</p><span id="more"></span><h1 id="è®¡åˆ’"><a href="#è®¡åˆ’" class="headerlink" title="è®¡åˆ’"></a>è®¡åˆ’</h1><h2 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h2><ul><li>éƒ¨ç½²åº”ç”¨åˆ° k8s</li><li>è·¨æœåŠ¡è°ƒç”¨</li><li>é›†ç¾¤å¤–éƒ¨è®¿é—®</li></ul><h2 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h2><ul><li>å¦‚ä½•ä½¿ç”¨é…ç½®</li><li>æœåŠ¡ç½‘æ ¼å®æˆ˜</li></ul><h2 id="è¿ç»´ä½ çš„åº”ç”¨"><a href="#è¿ç»´ä½ çš„åº”ç”¨" class="headerlink" title="è¿ç»´ä½ çš„åº”ç”¨"></a>è¿ç»´ä½ çš„åº”ç”¨</h2><ul><li>åº”ç”¨æ¢é’ˆ</li><li>æ»šåŠ¨æ›´æ–°ä¸å›æ»š</li><li>ä¼˜é›…é‡‡é›†æ—¥å¿—</li><li>åº”ç”¨å¯è§‚æµ‹æ€§<ul><li>æŒ‡æ ‡å¯è§†åŒ–</li></ul></li></ul><h2 id="k8s-éƒ¨ç½²å¸¸è§ä¸­é—´ä»¶"><a href="#k8s-éƒ¨ç½²å¸¸è§ä¸­é—´ä»¶" class="headerlink" title="k8s éƒ¨ç½²å¸¸è§ä¸­é—´ä»¶"></a>k8s éƒ¨ç½²å¸¸è§ä¸­é—´ä»¶</h2><ul><li>helm ä¸€é”®éƒ¨ç½²</li><li>ç¼–å†™ Operator è‡ªåŠ¨åŒ–åº”ç”¨ç”Ÿå‘½å‘¨æœŸ</li></ul><p><img src="https://s2.loli.net/2023/09/02/BtYcF6jp8u3nzJs.png" alt="image.png"><br>è¿™é‡Œæˆ‘æ•´ç†äº†ä¸€ä¸‹ç›®å½•ï¼Œæ¯ä¸ªç« èŠ‚éƒ½æœ‰åšå®¢+è§†é¢‘é…åˆè§‚çœ‹ï¼Œå¤§å®¶å¯ä»¥æŒ‰ç…§å–œå¥½é€‰æ‹©ã€‚</p><p>å› ä¸ºè¿˜æ¶‰åŠåˆ°äº†è§†é¢‘ï¼Œæ‰€ä»¥åªèƒ½äº‰å–ä¸€å‘¨ä¸¤æ›´ï¼Œåœ¨ä¸¤ä¸ªæœˆå†…å…¨éƒ¨æ›´æ–°å®Œæ¯•ã€‚</p><p>æ ¹æ®æˆ‘è‡ªå·±çš„ç»éªŒï¼Œä»¥ä¸Šå†…å®¹éƒ½æŒæ¡çš„è¯å¯¹ k8s çš„æŒæ¡ä¼šæ›´è¿›ä¸€æ­¥ã€‚</p><h1 id="éƒ¨ç½²åº”ç”¨åˆ°-k8s"><a href="#éƒ¨ç½²åº”ç”¨åˆ°-k8s" class="headerlink" title="éƒ¨ç½²åº”ç”¨åˆ° k8s"></a>éƒ¨ç½²åº”ç”¨åˆ° k8s</h1><p>é¦–å…ˆä»ç¬¬ä¸€ç« ã€éƒ¨ç½²åº”ç”¨åˆ° k8sã€‘å¼€å§‹ï¼Œæˆ‘ä¼šç”¨ Go å†™ä¸€ä¸ªç®€å•çš„ Web åº”ç”¨ï¼Œç„¶åæ‰“åŒ…ä¸ºä¸€ä¸ª Docker é•œåƒï¼Œä¹‹åéƒ¨ç½²åˆ° k8s ä¸­ï¼Œå¹¶å®Œæˆå…¶ä¸­çš„æ¥å£è°ƒç”¨ã€‚</p><h2 id="ç¼–å†™åº”ç”¨"><a href="#ç¼–å†™åº”ç”¨" class="headerlink" title="ç¼–å†™åº”ç”¨"></a>ç¼–å†™åº”ç”¨</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;  </span><br><span class="line">   http.HandleFunc(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;  </span><br><span class="line">      log.Println(<span class="string">&quot;ping&quot;</span>)  </span><br><span class="line">      fmt.Fprint(w, <span class="string">&quot;pong&quot;</span>)  </span><br><span class="line">   &#125;)  </span><br><span class="line">  </span><br><span class="line">   http.ListenAndServe(<span class="string">&quot;:8081&quot;</span>, <span class="literal">nil</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> åº”ç”¨éå¸¸ç®€å•å°±æ˜¯æä¾›äº†ä¸€ä¸ª <code>ping</code>  æ¥å£ï¼Œç„¶åè¿”å›äº†ä¸€ä¸ª <code>pong</code>.</p><h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€é˜¶æ®µï¼šç¼–è¯‘ Go ç¨‹åº  </span></span><br><span class="line"><span class="keyword">FROM</span> golang:<span class="number">1.19</span> AS dependencies  </span><br><span class="line"><span class="keyword">ENV</span> GOPROXY=https://goproxy.cn,direct  </span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /go/src/app  </span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> go.mod .  </span></span><br><span class="line"><span class="comment">#COPY ../../go.sum .  </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> --mount=<span class="built_in">type</span>=ssh go mod download  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç¬¬äºŒé˜¶æ®µï¼šæ„å»ºå¯æ‰§è¡Œæ–‡ä»¶  </span></span><br><span class="line"><span class="keyword">FROM</span> golang:<span class="number">1.19</span> AS builder  </span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /go/src/app  </span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .  </span></span><br><span class="line"><span class="comment">#COPY --from=dependencies /go/pkg /go/pkg  </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> go build  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç¬¬ä¸‰é˜¶æ®µï¼šéƒ¨ç½²  </span></span><br><span class="line"><span class="keyword">FROM</span> debian:stable-slim  </span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y curl  </span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /go/src/app/k8s-combat /go/bin/k8s-combat  </span></span><br><span class="line"><span class="keyword">ENV</span> PATH=<span class="string">&quot;/go/bin:$&#123;PATH&#125;&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¯åŠ¨ Go ç¨‹åº  </span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;k8s-combat&quot;</span>]</span></span><br></pre></td></tr></table></figure><p> ä¹‹åç¼–å†™äº†ä¸€ä¸ª <code>dockerfile</code> ç”¨äºæ„å»º <code>docker</code> é•œåƒã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">docker:  </span></span><br><span class="line">   @echo <span class="string">&quot;Docker Build...&quot;</span>  </span><br><span class="line">   docker build . -t crossoverjie/k8s-combat:v1 &amp;&amp; docker image push crossoverjie/k8s-combat:v1</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>make docker</code>  ä¼šåœ¨æœ¬åœ°æ„å»ºé•œåƒå¹¶ä¸Šä¼ åˆ° <code>dockerhub</code></p><h2 id="ç¼–å†™-deployment"><a href="#ç¼–å†™-deployment" class="headerlink" title="ç¼–å†™ deployment"></a>ç¼–å†™ deployment</h2><p>ä¸‹ä¸€æ­¥ä¾¿æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­æœ€é‡è¦çš„ç¯èŠ‚äº†ï¼Œä¹Ÿæ˜¯å”¯ä¸€å’Œ k8s æ‰“äº¤é“çš„åœ°æ–¹ï¼Œé‚£å°±æ˜¯ç¼–å†™ deploymentã€‚</p><iframe src="//player.bilibili.com/player.html?aid=702346697&bvid=BV1Cm4y1n7yG&cid=1235124452&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>åœ¨ä¹‹å‰çš„è§†é¢‘ã€Šä¸€åˆ†é’Ÿäº†è§£ k8sã€‹ä¸­è®²è¿‡å¸¸è§çš„ç»„ä»¶ï¼š<br><img src="https://s2.loli.net/2023/09/04/hrOUSVsmP2KkNlC.png" alt="image.png"></p><p>å…¶ä¸­æˆ‘ä»¬æœ€å¸¸è§çš„å°±æ˜¯ deploymentï¼Œé€šå¸¸ç”¨äºéƒ¨ç½²æ— çŠ¶æ€åº”ç”¨ï¼›ç°åœ¨è¿˜ä¸å¤ªéœ€è¦äº†è§£å…¶ä»–çš„ç»„ä»¶ï¼Œå…ˆçœ‹çœ‹ deployment å¦‚ä½•ç¼–å†™ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">labels:</span>  </span><br><span class="line">    <span class="attr">app:</span> <span class="string">k8s-combat</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">k8s-combat</span>  </span><br><span class="line"><span class="attr">spec:</span>  </span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span>  </span><br><span class="line">  <span class="attr">selector:</span>  </span><br><span class="line">    <span class="attr">matchLabels:</span>  </span><br><span class="line">      <span class="attr">app:</span> <span class="string">k8s-combat</span>  </span><br><span class="line">  <span class="attr">template:</span>  </span><br><span class="line">    <span class="attr">metadata:</span>  </span><br><span class="line">      <span class="attr">labels:</span>  </span><br><span class="line">        <span class="attr">app:</span> <span class="string">k8s-combat</span>  </span><br><span class="line">    <span class="attr">spec:</span>  </span><br><span class="line">      <span class="attr">containers:</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">k8s-combat</span>  </span><br><span class="line">          <span class="attr">image:</span> <span class="string">crossoverjie/k8s-combat:v1</span>  </span><br><span class="line">          <span class="attr">imagePullPolicy:</span> <span class="string">Always</span>  </span><br><span class="line">          <span class="attr">resources:</span>  </span><br><span class="line">            <span class="attr">limits:</span>  </span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span>  </span><br><span class="line">              <span class="attr">memory:</span> <span class="string">300Mi</span>  </span><br><span class="line">            <span class="attr">requests:</span>  </span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;0.1&quot;</span>  </span><br><span class="line">              <span class="attr">memory:</span> <span class="string">30Mi</span></span><br></pre></td></tr></table></figure><p>å¼€å¤´ä¸¤è¡Œçš„ <code>apiVersion</code>  å’Œ <code>kind</code> å¯ä»¥æš‚æ—¶ä¸è¦å…³æ³¨ï¼Œå°±ç†è§£ä¸º deployment çš„å›ºå®šå†™æ³•å³å¯ã€‚</p><p>metadataï¼šé¡¾åæ€ä¹‰å°±æ˜¯å®šä¹‰å…ƒæ•°æ®çš„åœ°æ–¹ï¼Œå‘Šè¯‰ <code>Pod</code> æˆ‘ä»¬è¿™ä¸ª <code>deployment</code> å«ä»€ä¹ˆåå­—ï¼Œè¿™é‡Œå®šä¹‰ä¸ºï¼š<code>k8s-combat</code></p><p>ä¸­é—´çš„ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">labels:</span>  </span><br><span class="line">    <span class="attr">app:</span> <span class="string">k8s-combat</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œå°±æ˜¯ç»™è¿™ä¸ª <code>deployment</code> æ‰“ä¸Šæ ‡ç­¾ï¼Œé€šå¸¸æ˜¯å°†è¿™ä¸ªæ ‡ç­¾å’Œå…¶ä»–çš„ç»„ä»¶è¿›è¡Œå…³è”ä½¿ç”¨æ‰æœ‰æ„ä¹‰ï¼Œä¸ç„¶å°±åªæ˜¯ä¸€ä¸ªæ ‡ç­¾è€Œå·²ã€‚</p><blockquote><p>æ ‡ç­¾æ˜¯é”®å€¼å¯¹çš„æ ¼å¼ï¼Œkey, value éƒ½å¯ä»¥è‡ªå®šä¹‰ã€‚</p></blockquote><p>è€Œè¿™é‡Œçš„  <code>app: k8s-combat</code> ä¾¿æ˜¯å’Œä¸‹é¢çš„ spec ä¸‹çš„ selector é€‰æ‹©å™¨åŒ¹é…ï¼Œè¡¨æ˜éƒ½ä½¿ç”¨  <code>app: k8s-combat</code>  è¿›è¡Œå…³è”ã€‚</p><p>è€Œ template ä¸­æ‰€å®šä¹‰çš„æ ‡ç­¾ä¹Ÿæ˜¯ä¸ºäº†è®©é€‰æ‹©å™¨å’Œ template ä¸­çš„å®šä¹‰çš„ Pod è¿›è¡Œå…³è”ã€‚</p><blockquote><p>Pod æ˜¯ k8s ä¸­ç›¸åŒåŠŸèƒ½å®¹å™¨çš„åˆ†ç»„ï¼Œä¸€ä¸ª Pod å¯ä»¥ç»‘å®šå¤šä¸ªå®¹å™¨ï¼Œè¿™é‡Œå°±åªæœ‰æˆ‘ä»¬åº”ç”¨å®¹å™¨ä¸€ä¸ªäº†ï¼›åç»­åœ¨è®²åˆ° istio å’Œæ—¥å¿—é‡‡é›†æ—¶ä¾¿å¯ä»¥çœ‹åˆ°å…¶ä»–çš„å®¹å™¨ã€‚</p></blockquote><p>template ä¸­å®šä¹‰çš„å†…å®¹å°±å¾ˆå®¹æ˜“ç†è§£äº†ï¼ŒæŒ‡å®šäº†æˆ‘ä»¬çš„å®¹å™¨æ‹‰å–åœ°å€ï¼Œä»¥åŠæ‰€å ç”¨çš„èµ„æº(<code>cpu/ memory</code>)ã€‚</p><p><code>replicas: 1</code>ï¼šè¡¨ç¤ºåªéƒ¨ç½²ä¸€ä¸ªå‰¯æœ¬ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ„æ€ã€‚</p><h2 id="éƒ¨ç½²åº”ç”¨"><a href="#éƒ¨ç½²åº”ç”¨" class="headerlink" title="éƒ¨ç½²åº”ç”¨"></a>éƒ¨ç½²åº”ç”¨</h2><p>ä¹‹åæˆ‘ä»¬ä½¿ç”¨å‘½ä»¤:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f deployment/deployment.yaml</span><br></pre></td></tr></table></figure><blockquote><p>ç”Ÿäº§ç¯å¢ƒä¸­å¾€å¾€ä¼šä½¿ç”¨äº‘å‚å•†æ‰€æä¾›çš„ k8s ç¯å¢ƒï¼Œæˆ‘ä»¬æœ¬åœ°å¯ä»¥ä½¿ç”¨ <a href="https://minikube.sigs.k8s.io/docs/start/">https://minikube.sigs.k8s.io/docs/start/</a> minikube æ¥æ¨¡æ‹Ÿã€‚</p></blockquote><p>å°±ä¼šåº”ç”¨è¿™ä¸ª deployment åŒæ—¶å°†å®¹å™¨éƒ¨ç½²åˆ° k8s ä¸­ï¼Œä¹‹åä½¿ç”¨:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pod</span><br></pre></td></tr></table></figure><blockquote><p> åœ¨åå° k8s ä¼šæ ¹æ®æˆ‘ä»¬å¡«å†™çš„èµ„æºé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„èŠ‚ç‚¹ï¼Œå°†å½“å‰è¿™ä¸ª Pod éƒ¨ç½²è¿‡å»ã€‚</p></blockquote><p> å°±ä¼šåˆ—å‡ºæˆ‘ä»¬åˆšæ‰éƒ¨ç½²çš„ Pod:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â¯ kubectl get pod</span><br><span class="line">NAME                                READY   STATUS    RESTARTS   AGE</span><br><span class="line">k8s-combat-57f794c59b-7k58n         1/1     Running   0          17h</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl exec -it k8s-combat-57f794c59b-7k58n  bash</span><br></pre></td></tr></table></figure><p>å°±ä¼šè¿›å…¥æˆ‘ä»¬çš„å®¹å™¨ï¼Œè¿™ä¸ªå’Œä½¿ç”¨ docker ç±»ä¼¼ã€‚</p><p>ä¹‹åæ‰§è¡Œ curl å‘½ä»¤ä¾¿å¯ä»¥è®¿é—®æˆ‘ä»¬çš„æ¥å£äº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@k8s-combat-57f794c59b-7k58n:/# curl http://127.0.0.1:8081/ping</span><br><span class="line">pong</span><br><span class="line">root@k8s-combat-57f794c59b-7k58n:/#</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬å†å¼€ä¸€ä¸ªç»ˆç«¯æ‰§è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ kubectl logs -f k8s-combat-57f794c59b-7k58n</span><br><span class="line">2023/09/03 09:28:07 ping</span><br></pre></td></tr></table></figure><p>ä¾¿å¯ä»¥æ‰“å°å®¹å™¨ä¸­çš„æ—¥å¿—ï¼Œå½“ç„¶å‰ææ˜¯åº”ç”¨çš„æ—¥å¿—æ˜¯å†™å…¥åˆ°äº†æ ‡å‡†è¾“å‡ºä¸­ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä»¥ä¸Šå°±æ˜¯è¿™ä¸€ç« èŠ‚çš„ä¸»è¦å†…å®¹ï¼Œé‡ç‚¹å°±æ˜¯å°†æˆ‘ä»¬åº”ç”¨ç¨‹åºå‘˜æ‰“åŒ…ä¸º docker é•œåƒåä¸Šä¼ åˆ°é•œåƒä»“åº“ï¼Œå†é…ç½®å¥½ deployment ç”± k8s è¿›è¡Œè°ƒåº¦è¿è¡Œã€‚</p><p>ä¸‹ä¸€ç« ä¸»è¦ä¼šæ¶‰åŠæœåŠ¡å†…éƒ¨çš„è°ƒç”¨ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å…ˆå…³æ³¨èµ·æ¥ã€‚</p><p>ç›¸å…³çš„æºç å’Œ yaml èµ„æºæ–‡ä»¶éƒ½å­˜åœ¨è¿™é‡Œï¼š<br><a href="https://github.com/crossoverJie/k8s-combat">https://github.com/crossoverJie/k8s-combat</a></p><p>#Blog #K8s </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/09/04/ymUpcXZrxfNsT91.png&quot; alt=&quot;k8s å…¥é—¨åˆ°å®æˆ˜ 01.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;æœ€è¿‘è¿™è¿™æ®µæ—¶é—´æ›´æ–°äº†ä¸€äº› k8s ç›¸å…³çš„åšå®¢å’Œè§†é¢‘ï¼Œä¹Ÿæ”¶åˆ°äº†ä¸€äº›åé¦ˆï¼›å¤§æ¦‚åˆ†ä¸ºè¿™å‡ ç±»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…¬å¸å·²ç»ç»å†è¿‡æœåŠ¡åŒ–æ”¹é€ äº†ï¼Œä½†è¿˜æœªæ¥è§¦è¿‡äº‘åŸç”Ÿã€‚&lt;/li&gt;
&lt;li&gt;å…¬å¸éƒ¨åˆ†åº”ç”¨è¿›è¡Œäº†äº‘åŸç”Ÿæ”¹é€ ï¼Œä½†å¤§éƒ¨åˆ†å·¥ä½œæ˜¯ç”±åŸºç¡€æ¶æ„å’Œè¿ç»´éƒ¨é—¨æ¨åŠ¨çš„ï¼Œè‡ªå·±åªæ˜¯ä½œä¸ºå¼€å‘å¹¶ä¸äº†è§£å…¶ä¸­çš„ç»†èŠ‚ï¼Œç”šè‡³ k8s ä¹Ÿæ¥è§¦ä¸åˆ°ã€‚&lt;/li&gt;
&lt;li&gt;è¿˜å¤„äºæ¯”è¾ƒä¼ ç»Ÿçš„ä»¥è™šæ‹Ÿæœºéƒ¨ç½²çš„ä¼ ç»Ÿè¿ç»´ä¸ºä¸»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä¸­ä»¥ç¬¬äºŒç§å å¤§å¤šæ•°ï¼Œè™½ç„¶å…¬å¸è¿›è¡Œäº†äº‘åŸç”Ÿæ”¹é€ ï¼Œä½†ä¼¼ä¹å’Œçº¯ä¸šåŠ¡ç ”å‘åŒå­¦æ¥è¯´æ²¡æœ‰å¤ªå¤§å…³ç³»ï¼Œè‡ªå·±å·¥ä½œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æ°å¥½æˆ‘ä¹‹å‰æ­£å¥½ä»ä¸šåŠ¡ç ”å‘çš„è§’åº¦è½¬æ¢åˆ°äº†åŸºç¡€æ¶æ„éƒ¨é—¨ï¼Œä¸¤ä¸ªè§’è‰²æˆ‘éƒ½æ¥è§¦è¿‡ï¼Œä¹Ÿå¸®åŠ©è¿‡ä¸€äº›ä¸šåŠ¡ç ”å‘äº†è§£å…¬å¸çš„äº‘åŸç”Ÿæ¶æ„ï¼›&lt;/p&gt;
&lt;p&gt;ä¸ºæ­¤æ‰€ä»¥æˆ‘æƒ³ç³»ç»Ÿæ€§çš„å¸¦å¤§å®¶ä»¥&lt;strong&gt;ç ”å‘&lt;/strong&gt;çš„è§’åº¦å¯¹ k8s è¿›è¡Œå®è·µã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º k8s éƒ¨åˆ†åŠŸèƒ½å…¶å®æ˜¯åè¿ç»´çš„ï¼Œå¯¹ç ”å‘æ¥è¯´ä¼˜å…ˆçº§å¹¶ä¸å¤ªé«˜ï¼›&lt;br&gt;æ‰€ä»¥æˆ‘ä¸å¤ªä¼šæ¶‰åŠä¸€äº› k8s è¿ç»´çš„çŸ¥è¯†ç‚¹ï¼Œæ¯”å¦‚å®‰è£…ã€ç»„ä»¶ç­‰æ¨¡å—ï¼›ä¸»è¦ä»¥æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¼šä½¿ç”¨åˆ°çš„ç»„ä»¶è®²èµ·ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="k8s" scheme="http://crossoverjie.top/categories/k8s/"/>
    
    
    <category term="Go" scheme="http://crossoverjie.top/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ SQL çš„æ–¹å¼æŸ¥è¯¢æ¶ˆæ¯é˜Ÿåˆ—æ•°æ®ä»¥åŠè¸©å‘æŒ‡å—</title>
    <link href="http://crossoverjie.top/2023/08/30/ob/Pulsar-SQL/"/>
    <id>http://crossoverjie.top/2023/08/30/ob/Pulsar-SQL/</id>
    <published>2023-08-30T01:31:53.000Z</published>
    <updated>2023-09-15T18:42:21.017Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/08/30/3iz9yqfuSCn18xk.png" alt="Pulsar-sql.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>ä¸ºäº†è®©ä¸šåŠ¡å›¢é˜Ÿå¯ä»¥æ›´å¥½çš„è·Ÿè¸ªè‡ªå·±æ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹çŠ¶æ€ï¼Œéœ€è¦ä¸€ä¸ªç±»ä¼¼äºè¡¨æ ¼è§†å›¾çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œç”¨æˆ·å¯ä»¥ç›´è§‚çš„çœ‹åˆ°å‘é€çš„æ¶ˆæ¯ï¼›åŒæ—¶ç‚¹å‡»è¯¦æƒ…åä¹Ÿèƒ½æŸ¥åˆ°æ¶ˆæ¯çš„æ•´ä¸ªè½¨è¿¹ã€‚</p><blockquote><p> æ¶ˆæ¯åˆ—è¡¨<br><img src="https://s2.loli.net/2023/08/02/l9uvSnqAOxfPer7.png" alt="20230802234405.png"></p></blockquote><span id="more"></span><blockquote><p>ç‚¹å‡»è¯¦æƒ…åæŸ¥çœ‹è½¨è¿¹<br><img src="https://s2.loli.net/2023/08/02/H7pjinzQ5EWR2tF.png" alt="20230802234058.png"></p></blockquote><h1 id="åŸç†ä»‹ç»"><a href="#åŸç†ä»‹ç»" class="headerlink" title="åŸç†ä»‹ç»"></a>åŸç†ä»‹ç»</h1><p>ç”±äº <code>Pulsar</code> å¹¶æ²¡æœ‰å…³ç³»å‹æ•°æ®åº“ä¸­è¡¨çš„æ¦‚å¿µï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨ <code>Bookkeeper</code> ä¸­ï¼Œä¸ºäº†æ¨¡æ‹Ÿä½¿ç”¨ SQL æŸ¥è¯¢çš„æ•ˆæœ Pulsar æä¾›äº† <code>Presto</code> (ç°åœ¨å·²ç»æ›´åä¸º <code>Trino</code>)çš„æ’ä»¶ã€‚</p><blockquote><p>Trino æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ SQL æŸ¥è¯¢å¼•æ“ï¼Œå®ƒä¹Ÿæä¾›äº†æ’ä»¶èƒ½åŠ›ï¼Œå¦‚æœæˆ‘ä»¬æƒ³é€šè¿‡ SQL ä»è‡ªå®šä¹‰æ•°æ®æºæŸ¥è¯¢æ•°æ®æ—¶ï¼ŒåŸºäºå®ƒçš„ SPI ç¼–å†™ä¸€ä¸ªæ’ä»¶æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚</p></blockquote><p>è¿™æ ·ä¾¿å¯ä»¥ç±»ä¼¼äºæŸ¥è¯¢æ•°æ®åº“ä¸€æ ·æŸ¥è¯¢ <code>Pulsar</code> æ•°æ®ï¼š<br><img src="https://s2.loli.net/2023/08/30/1YEtorbwaZAXylL.png" alt="image.png"></p><hr><p><img src="https://s2.loli.net/2023/08/30/u6gc3YxvH94ZDPG.png" alt="image.png"><br>Pulsar æ’ä»¶çš„è¿è¡Œæµç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š</p><ul><li>å¯åŠ¨çš„æ—¶å€™é€šè¿‡ <code>Pulsar-Admin</code> æ¥å£è·å–ä¸€äº›å…ƒæ•°æ®ï¼Œæ¯”å¦‚ Schemeï¼Œtopic åˆ†åŒºä¿¡æ¯ç­‰ã€‚</li><li>ç„¶åä¼šåˆ›å»ºä¸€ä¸ªåªè¯»çš„ Bookkeeper å®¢æˆ·ç«¯ï¼Œç”¨äºè·å–æ•°æ®ã€‚</li><li>ä¹‹åæ ¹æ® SQL æ¡ä»¶è¿‡æ»¤æ•°æ®å³å¯ã€‚</li></ul><p>ç›¸å…³ä»£ç ï¼š<br><img src="https://s2.loli.net/2023/08/30/vr7ED6BYgOsoqxz.png" alt="image.png"><br><img src="https://s2.loli.net/2023/08/30/Np2XD7T9cJAwxQC.png" alt="image.png"></p><h1 id="ä½¿ç”¨-Pulsar-SQL"><a href="#ä½¿ç”¨-Pulsar-SQL" class="headerlink" title="ä½¿ç”¨ Pulsar-SQL"></a>ä½¿ç”¨ Pulsar-SQL</h1><p><img src="https://s2.loli.net/2023/08/30/UBqocsjFvC2yXEe.png" alt="image.png"></p><p>ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œå®˜æ–¹æä¾›äº†ä¸¤ä¸ªå‘½ä»¤ï¼š</p><ul><li>sql-worker: ä¼šå¯åŠ¨ä¸€ä¸ª trino æœåŠ¡ç«¯åŒæ—¶è¿è¡Œäº† Pulsar æ’ä»¶</li><li>sql: å°±æ˜¯ä¸€ä¸ª SQL å‘½ä»¤è¡Œç»ˆç«¯ã€‚</li></ul><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>è‡ªå·±åœ¨æœ¬åœ°è¿è¡Œçš„æ—¶å€™è‡ªç„¶æ˜¯æ²¡é—®é¢˜ï¼Œå¯æ˜¯ä¸€æ—¦æƒ³åœ¨ç”Ÿäº§è¿è¡Œï¼ŒåŒæ—¶å¦‚æœä½ çš„ <code>Pulsar</code> é›†ç¾¤æ˜¯è¿è¡Œå† <code>k8s</code> ç¯å¢ƒä¸­æ—¶å°±ä¼šç¢°åˆ°ä¸€äº›é—®é¢˜ã€‚</p><h3 id="æ— æ³•ä½¿ç”¨ç°æœ‰-Trino-é›†ç¾¤"><a href="#æ— æ³•ä½¿ç”¨ç°æœ‰-Trino-é›†ç¾¤" class="headerlink" title="æ— æ³•ä½¿ç”¨ç°æœ‰ Trino é›†ç¾¤"></a>æ— æ³•ä½¿ç”¨ç°æœ‰ Trino é›†ç¾¤</h3><p>é¦–å…ˆç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚æœç”Ÿäº§ç¯å¢ƒå·²ç»æœ‰äº†ä¸€ä¸ª <code>Trino</code> é›†ç¾¤æƒ³è¦å¤ç”¨çš„æ—¶å€™å°±ä¼šç¢°åˆ°é—®é¢˜ï¼Œå¸¸è§„æµç¨‹æ˜¯å°† <code>Pulsar</code> çš„æ’ä»¶å¤åˆ¶åˆ° <code>Trino</code> çš„ <code>Plugin</code> ç›®å½•ï¼Œç„¶åé‡å¯ <code>Trino</code> åå°±èƒ½ä½¿ç”¨è¯¥æ’ä»¶ã€‚</p><p>å½“ç„¶ç¤¾åŒºä¹Ÿæ˜¯æ”¯æŒè¿™ä¹ˆåšçš„ï¼š<br><img src="https://s2.loli.net/2023/08/30/RqtIvwy5HNsr27M.png" alt="image.png"><br>ä½†æ˜¯å½“æˆ‘å°† Pulsar-plugin å¤åˆ¶åˆ° Trino ä¸­è¿è¡Œçš„æ—¶å€™å´å¤±è´¥äº†ï¼Œæ•´ä½“çš„æµç¨‹å¯ä»¥å‚è€ƒè¿™ä¸ª issueï¼š<br><a href="https://github.com/apache/pulsar/discussions/20941">https://github.com/apache/pulsar/discussions/20941</a></p><p>ç®€å•æ¥è¯´ <code>Trino</code> çš„å®˜æ–¹é•œåƒå’Œ <code>pulsar-plugin</code> å¹¶ä¸èƒ½å…¼å®¹ï¼Œè¿™ä¸ªé—®é¢˜ç›´æ¥å½±å“åˆ°æˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å®ƒã€‚</p><p>ä½†æ˜¯æ‰‹åŠ¨ç¼–è¯‘å‡ºæ¥çš„ <code>Trino</code> æœåŠ¡å’Œæ’ä»¶æ˜¯å…¼å®¹çš„ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œã€‚</p><p><img src="https://s2.loli.net/2023/08/30/MswBlVXi12DICr9.png" alt="image.png"></p><p>å› æ­¤æˆ‘åªèƒ½åœ¨æœ¬åœ°ç¼–è¯‘å‡º Trino æœåŠ¡ç«¯å’Œ <code>pulsar-plugin</code> ç„¶åæ‰“åŒ…æˆä¸€ä¸ªé•œåƒæ¥è¿è¡Œäº†ï¼Œå½“ç„¶è¿™æ ·çš„åå¤„å°±æ˜¯æ— æ³•åˆ©ç”¨åˆ°æˆ‘ä»¬ç°æœ‰çš„ <code>Trino</code> é›†ç¾¤ï¼Œåˆå¾—é‡æ–°éƒ¨ç½²ä¸€ä¸ªäº†ã€‚</p><p><img src="https://s2.loli.net/2023/08/30/vG83bleTf1EcCPp.png" alt="image.png"></p><p>æµç¨‹ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼š</p><ul><li>é¦–å…ˆæ˜¯æœ¬åœ°ç¼–è¯‘ <code>Pulsar-SQL</code> æ¨¡å—</li><li>å°†ç”Ÿæˆç‰©å¤åˆ¶åˆ°å½“å‰ç›®å½•</li><li>æ‰§è¡Œ <code>make docker</code> æ‰“å‡º docker é•œåƒå¹¶ä¸Šä¼ åˆ°ç§æœ</li><li>å†æ‰§è¡Œ <code>kubectl</code> å°† trino éƒ¨ç½²åˆ° <code>k8s</code> ç¯å¢ƒä¸­</li></ul><p>æ•´ä¸ªæµç¨‹åšä¸‹æ¥åŠ ä¸Šå’Œç¤¾åŒºçš„æ²Ÿé€šï¼Œæ›´åŠ ç¡®å®šè¿™ä¸ªåŠŸèƒ½åº”è¯¥æ˜¯å¾ˆå°‘æœ‰äººåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„ï¼Œæ¯•ç«Ÿç¬¬ä¸€ä¸ªå‘å°±å¾ˆéº»çƒ¦ï¼Œæ›´åˆ«æåç»­çš„é—®é¢˜äº†ğŸ˜‚ã€‚</p><h3 id="Presto-æ’ä»¶ä¸æ”¯æŒ-AuthToken"><a href="#Presto-æ’ä»¶ä¸æ”¯æŒ-AuthToken" class="headerlink" title="Presto æ’ä»¶ä¸æ”¯æŒ AuthToken"></a>Presto æ’ä»¶ä¸æ”¯æŒ AuthToken</h3><p>ç¬¬äºŒä¸ªé—®é¢˜ä¹Ÿæ˜¯ä¸ªæ·±å‘ï¼Œå½“æˆ‘æŠŠ Trino éƒ¨ç½²å¥½æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ç›´æ¥æŠ›äº†ä¸€ä¸ªè°ƒç”¨ <code>pulsar-admin</code>  æ¥å£è¿æ¥è¶…æ—¶çš„å¼‚å¸¸ã€‚</p><p>ç»“æœæ’æŸ¥äº†åŠå¤©å‘ç°åŸæ¥æ˜¯ <code>pulsar-plugin</code> é‡Œæ²¡æœ‰æä¾› <code>JWT</code> çš„éªŒè¯æ–¹å¼ï¼Œè€Œæˆ‘ä»¬çš„ Pulsar é›†ç¾¤æ°å¥½æ˜¯æ‰“å¼€äº† <code>JWT</code> éªŒè¯çš„ã€‚</p><p>ä¸ºæ­¤æˆ‘åªèƒ½å…ˆåœ¨æœ¬åœ°ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæäº¤äº† PRï¼Œé¢„è®¡ä¼šåœ¨ä¸‹ä¸€ä¸ªå¤§ç‰ˆæœ¬åˆå¹¶å§ï¼š<br><a href="https://github.com/apache/pulsar/pull/20860">https://github.com/apache/pulsar/pull/20860</a></p><h3 id="æ–°åˆ›å»ºçš„-topic-æŸ¥è¯¢å¤±è´¥"><a href="#æ–°åˆ›å»ºçš„-topic-æŸ¥è¯¢å¤±è´¥" class="headerlink" title="æ–°åˆ›å»ºçš„ topic æŸ¥è¯¢å¤±è´¥"></a>æ–°åˆ›å»ºçš„ topic æŸ¥è¯¢å¤±è´¥</h3><p>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯å½“æŸ¥è¯¢ä¸€ä¸ªæ–°åˆ›å»ºçš„ topic æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šç›´æ¥ blockï¼Œç›¸å…³çš„å¤ç°æµç¨‹åœ¨è¿™é‡Œï¼š<br><a href="https://github.com/apache/pulsar/issues/20910">https://github.com/apache/pulsar/issues/20910</a></p><p><img src="https://s2.loli.net/2023/08/30/nYestcQqRax1NVv.png" alt="image.png"></p><p>è¿™ä¸ªé—®é¢˜è¿˜å¥½ï¼Œä¸æ˜¯å¾ˆè‡´å‘½ï¼Œæ˜¯æˆ‘åœ¨æœ¬åœ°æµ‹è¯•çš„æ—¶å€™æ— æ„é—´å‘ç°çš„ã€‚</p><p>æœ¬åœ°æˆ‘å·²ç»ä¿®å¤äº†ï¼Œåé¢ä¹Ÿæäº¤äº†ä¸€ä¸ª PRï¼Œç›®å‰è¿˜åœ¨è®¨è®ºä¸­ï¼š<br><a href="https://github.com/apache/pulsar/pull/20911">https://github.com/apache/pulsar/pull/20911</a></p><h3 id="æŸ¥è¯¢æ¶ˆæ¯ä¼šä¸¢å¤±æœ€åä¸€æ¡"><a href="#æŸ¥è¯¢æ¶ˆæ¯ä¼šä¸¢å¤±æœ€åä¸€æ¡" class="headerlink" title="æŸ¥è¯¢æ¶ˆæ¯ä¼šä¸¢å¤±æœ€åä¸€æ¡"></a>æŸ¥è¯¢æ¶ˆæ¯ä¼šä¸¢å¤±æœ€åä¸€æ¡</h3><p>è¿™ä¸ªé—®é¢˜ä¹Ÿä¸æ˜¯å¾ˆä¸¥é‡ï¼Œæ•°æ®é‡å°‘çš„æ—¶å€™ä¼šå‘ç°ï¼Œå°±æ˜¯åœ¨æŒ‡å®šäº†æ¶ˆæ¯å‘é€æ—¶é—´çš„æŸ¥è¯¢æ¡ä»¶æ—¶ï¼Œæœ€åä¸€æ¡æ¶ˆæ¯ä¼šè¢«è¿‡æ»¤æ‰ï¼Œç›¸å…³ issue åœ¨è¿™é‡Œï¼š<br><a href="https://github.com/apache/pulsar/issues/20919">https://github.com/apache/pulsar/issues/20919</a><br><img src="https://s2.loli.net/2023/08/30/MPamvyduxrTZRkY.png" alt="image.png"><br>è¿™ä¸ªæˆ‘åªæ˜¯å®šä½åˆ°äº†åŸå› ï¼Œä½†ä¸å¤ªæ¸…æ¥š ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåš(-1)ï¼Œå½±å“ä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼Œå°±æ”¾åœ¨è¿™é‡Œæç½®äº†ã€‚</p><h3 id="Schema-ä¸å…¼å®¹"><a href="#Schema-ä¸å…¼å®¹" class="headerlink" title="Schema ä¸å…¼å®¹"></a>Schema ä¸å…¼å®¹</h3><p>æœ€åå‘ç°çš„ä¸€ä¸ªé—®é¢˜æ˜¯æˆ‘ä»¬çº¿ä¸ŠæŸäº› topic æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ä¼šæŠ›å‡º <code>Not a record: &quot;string&quot;</code>çš„å¼‚å¸¸ï¼Œä½†åªæ˜¯éƒ¨åˆ† topicï¼Œä¹Ÿæ’æŸ¥äº†å¾ˆä¹…ï¼Œæ•´ä¸ªæºç ä¸­æ²¡æœ‰ä»»ä½•ä¸€ä¸ªåœ°æ–¹æœ‰è¿™ä¸ªå¼‚å¸¸ã€‚</p><p><a href="!%5B%5D(https://s2.loli.net/2023/08/30/UBl6OPGzASnfqT2.png)">https://github.com/apache/pulsar/issues/20945</a></p><p><img src="https://s2.loli.net/2023/08/30/UBl6OPGzASnfqT2.png" alt="image.png"></p><p>æ ¹æœ¬åŸå› æ˜¯ç”Ÿäº§è€…ç”Ÿæˆçš„ schema æœ‰é—®é¢˜ï¼Œç±»å‹å·²ç»æ˜¯ JSON äº†ï¼Œä½†æ˜¯ schema å´æ˜¯ stringï¼Œè¿™æ ·å¯¼è‡´ <code>pulsar-plugin</code>  åœ¨ååºåˆ—åŒ– schema çš„æ—¶å€™æŠ›å‡ºäº†å¼‚å¸¸ï¼Œç”±äºæ˜¯ pb ååºåˆ—åŒ–æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ‰€ä»¥æºç ä¸­éƒ½æœç´¢ä¸åˆ°ã€‚</p><blockquote><p>æ²¡æœ‰é—®é¢˜çš„ topic ä½¿ç”¨äº†æ­£ç¡®çš„ schema</p></blockquote><p>åç»­æˆ‘ä¹Ÿåœ¨æœ¬åœ°ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ï¼Œå½“æŠ›å‡ºå¼‚å¸¸åå°±å°† schema é™çº§ä¸ºåŸºæœ¬ç±»å‹è¿›è¡Œè§£æã€‚<br><img src="https://s2.loli.net/2023/08/30/XZfWG2EYHpj5QJb.png" alt="image.png"></p><p>ä¸è¿‡æœ¬è´¨é—®é¢˜è¿˜æ˜¯å®¢æˆ·ç«¯ä½¿ç”¨æœ‰è¯¯ï¼Œå¦‚æœå¯¹ <code>schema</code> ç†è§£ä¸å‡†ç¡®çš„è¯è¿˜æ˜¯å»ºè®®ä½¿ç”¨ <code>byte[]</code> å§ï¼Œè¿™æ ·è‡³å°‘å…¼å®¹æ€§ä¸ä¼šæœ‰é—®é¢˜ã€‚<br>ç›¸å…³ PRï¼š<br><a href="https://github.com/apache/pulsar/pull/20955">https://github.com/apache/pulsar/pull/20955</a></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><code>Pulsar-SQL</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œåªæ˜¯æˆ‘ä»¬ä½¿ç”¨è¿‡ç¨‹ä¸­ç¡®å®å‘ç°äº†ä¸€äº›é—®é¢˜ï¼Œå¤§éƒ¨åˆ†éƒ½å·²ç»ä¿®å¤äº†ï¼›<br>å¸Œæœ›å¯¹åç»­ä½¿ç”¨è¯¥åŠŸèƒ½çš„æœ‹å‹æœ‰æ‰€å¸®åŠ©ã€‚<br>#Pulsar </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/08/30/3iz9yqfuSCn18xk.png&quot; alt=&quot;Pulsar-sql.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;ä¸ºäº†è®©ä¸šåŠ¡å›¢é˜Ÿå¯ä»¥æ›´å¥½çš„è·Ÿè¸ªè‡ªå·±æ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹çŠ¶æ€ï¼Œéœ€è¦ä¸€ä¸ªç±»ä¼¼äºè¡¨æ ¼è§†å›¾çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œç”¨æˆ·å¯ä»¥ç›´è§‚çš„çœ‹åˆ°å‘é€çš„æ¶ˆæ¯ï¼›åŒæ—¶ç‚¹å‡»è¯¦æƒ…åä¹Ÿèƒ½æŸ¥åˆ°æ¶ˆæ¯çš„æ•´ä¸ªè½¨è¿¹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; æ¶ˆæ¯åˆ—è¡¨&lt;br&gt;&lt;img src=&quot;https://s2.loli.net/2023/08/02/l9uvSnqAOxfPer7.png&quot; alt=&quot;20230802234405.png&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/categories/Pulsar/"/>
    
    
    <category term="SQL" scheme="http://crossoverjie.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>VictoriaLogsï¼šä¸€æ¬¾è¶…ä½å ç”¨çš„ ElasticSearch æ›¿ä»£æ–¹æ¡ˆ</title>
    <link href="http://crossoverjie.top/2023/08/23/ob/VictoriaLogs-Intro/"/>
    <id>http://crossoverjie.top/2023/08/23/ob/VictoriaLogs-Intro/</id>
    <published>2023-08-23T07:46:25.000Z</published>
    <updated>2023-09-15T18:42:21.017Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/08/23/t5soejn8vw1aZil.png" alt="image.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰æ®µæ—¶é—´æˆ‘ä»¬æƒ³å®ç° <code>Pulsar</code> æ¶ˆæ¯çš„è¿½è¸ªæµç¨‹ï¼Œè¿½è¸ªå®ç°çš„æ•ˆæœå›¾å¦‚ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/08/02/H7pjinzQ5EWR2tF.png" alt="image.png"></p><p>å®ç°å…¶å®æ¯”è¾ƒç®€å•ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯å¦‚ä½•å­˜å‚¨æ¶ˆæ¯ã€‚</p><blockquote><p>æ¶ˆæ¯çš„è¯»å–æˆ‘ä»¬æ˜¯é€šè¿‡ Pulsar è‡ªå¸¦çš„ BrokerInterceptor å®ç°çš„ï¼Œå¯¹è¿™ä¸ªæ„Ÿå…´è¶£çš„æœ‹å‹åé¢ä¼šå•ç‹¬åšä¸€ä¸ªåˆ†äº«ã€‚</p></blockquote><span id="more"></span><p>æ ¹æ®è¿™é‡Œçš„æ˜¾ç¤ºå†…å®¹æˆ‘ä»¬å¤§æ¦‚éœ€è¦å­˜å‚¨è¿™äº›ä¿¡æ¯ï¼š</p><ul><li>å®¢æˆ·ç«¯åœ°å€</li><li>æ¶ˆæ¯å‘å¸ƒæ—¶é—´</li><li>åˆ†å‘æ¶ˆè´¹è€…ã€è®¢é˜…è€…åç§°</li><li>ACK æ¶ˆè´¹è€…ã€è®¢é˜…è€…åç§°</li><li>æ¶ˆæ¯ ID<br>æœ€ç»ˆæ‹äº†ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/08/23/MWbVcu6dm1NfaAB.png" alt="image.png"></li></ul><p>éƒ½ä»¥ä¸¤ä¸ª <code>consumer</code> è®¡ç®—ï¼š<br>ä¸€æ¡æ¶ˆæ¯å ç”¨å†…å­˜ï¼š<code>140+ 535*2 + 536*2 =2282byte</code><br>å­˜å‚¨ä¸‰å¤©ï¼š<code>TPS * 86400 * 3</code>&#x3D;<code>TPS*259200</code> æ¡<br>æ€»å­˜å‚¨ï¼š<br><code>2282*TPS*259200â‰ˆ ç™¾GB</code></p><p>æ ¹æ®æˆ‘ä»¬çš„ <code>TPS</code> è®¡ç®—ï¼Œä¸‰å¤©çš„å¤§æ¦‚ä¼šä½¿ç”¨åˆ° ä¸Šç™¾ G çš„å­˜å‚¨ï¼Œè¿™æ ·é¦–å…ˆå°±æ’é™¤äº† <code>Redis</code> è¿™ç§å†…å­˜å‹æ•°æ®åº“ã€‚</p><p>åŒæ ·çš„æ¢æˆ <code>MySQL</code> å­˜å‚¨ä¹Ÿä¸åˆ’ç®—ï¼Œå› ä¸ºå…¶å®è¿™äº›æ•°æ®å¹¶ä¸ç®—é‚£ä¹ˆé‡è¦ã€‚</p><p>åšäº†å‡ ä¸ªæŠ€æœ¯é€‰å‹éƒ½ä¸å¤ªæ»¡æ„ï¼Œä¸æ˜¯èµ„æºå¼€é”€å¤ªå¤§å°±æ˜¯æ²¡æœ‰ç›¸å…³çš„è¿ç»´ç»éªŒã€‚</p><p>åé¢åœ¨é¢†å¯¼çš„æé†’ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ <code>VictoriaMetrics</code> å¼€æºäº†ä¸€ä¸ª <code>VictoriaLogs</code>ï¼Œè™½ç„¶å½“æ—¶çš„ç‰ˆæœ¬è¿˜æ˜¯ <code>0.1.0</code>ï¼Œä½¿ç”¨è¿‡ä»–ä»¬å®¶ Metrics çš„åº”è¯¥éƒ½ä¼šæ¯”è¾ƒä¿¡ä»»ä»–ä»¬çš„æŠ€æœ¯èƒ½åŠ›ï¼Œæ‰€ä»¥å°±è°ƒç ”äº†ä¸€ä¸‹ã€‚</p><p>å…·ä½“çš„ä¿¡æ¯å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<br><a href="https://docs.victoriametrics.com/VictoriaLogs/">https://docs.victoriametrics.com/VictoriaLogs/</a></p><p><img src="https://s2.loli.net/2023/08/23/8LDNOGEC6Aslvzn.png" alt="image.png"></p><p>ç®€å•æ¥è¯´å°±æ˜¯å®ƒä¹Ÿæ˜¯ä¸€ä¸ªæ—¥å¿—å­˜å‚¨æ•°æ®åº“ï¼Œå¹¶ä¸”æœ‰ç€æä½çš„èµ„æºå æœ‰ç‡ï¼Œç›¸å¯¹äº <code>ElasticSearch</code> æ¥è¯´å†…å­˜ã€ç£ç›˜ã€CPU éƒ½æ˜¯å‡ åå€çš„ä¸‹é™ç‡ã€‚</p><p><img src="https://s2.loli.net/2023/08/23/U9v1HCgRDtLsdif.png" alt="image.png"></p><p>é€šè¿‡å®˜æ–¹çš„å‹æµ‹å¯¹æ¯”å›¾ä¼šå‘ç°ç¡®å®åœ¨å„æ–¹é¢å¯¹ ES éƒ½æ˜¯ç¢¾å‹ã€‚<br><img src="https://s2.loli.net/2023/08/23/3Epxdzie8q5tVmY.png" alt="image.png"></p><p>å®˜æ–¹å®£ä¼ çš„ç¬¬ä¸€ååº”æ˜¯ä¸èƒ½å…¨ä¿¡ï¼Œäºæ˜¯æˆ‘è‡ªå·±å‹æµ‹äº†ä¸€ä¸‹ï¼Œæœç„¶ CPU å†…å­˜ ç£ç›˜çš„å ç”¨éƒ½æ˜¯æä½çš„ã€‚</p><blockquote><p> åŒæ—¶ä¹Ÿå‘ç°è¿ç»´éƒ¨ç½²ç¡®å®ç®€å•ï¼Œç›´æ¥ä¸€ä¸ª helm install å°±æå®šï¼Œå°±æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸ä¼šä¾èµ–ç¬¬äºŒä¸ªç»„ä»¶ã€‚</p></blockquote><p>æŒ‰ç…§åˆšæ‰åŒæ ·çš„æ•°æ®å­˜å‚¨ä¸‰å¤©ï¼Œåªéœ€è¦ä¸åˆ° 6G çš„ç£ç›˜ç©ºé—´ï¼Œæˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒå·²ç»å¹³ç¨³è¿è¡Œä¸€æ®µæ—¶é—´äº†ã€‚<br><img src="https://s2.loli.net/2023/08/23/kzrxA89EeNnQ7Ro.png" alt="image.png"><br>å› ä¸ºæˆ‘ä»¬æ˜¯æ‰¹é‡å†™å…¥æ•°æ®çš„ï¼Œæ‰€ä»¥åœ¨æœ€é«˜å³° 20K çš„ <code>TPS</code> ä¸‹ <code>CPU</code> ä½¿ç”¨ä¸åˆ° 0.1 æ ¸ï¼Œå†…å­˜ä½¿ç”¨æœ€é«˜ <code>120M</code>ï¼Œè¿™ç‚¹ç¡®å®æ˜¯å¯¹ ES ç¢¾å‹äº†ã€‚</p><p><img src="https://s2.loli.net/2023/08/23/wn2BduNX63PyYV9.png" alt="image.png"><br>ç£ç›˜å ç”¨ä¹Ÿæ˜¯éå¸¸å°‘ã€‚</p><p>è¿™äº›æœ‰ç‚¹å¾—å½’åŠŸäºå®ƒæœ‰äº›çš„å‹ç¼©ã€ç¼–è§£ç ç®—æ³•ï¼Œä»¥åŠ <code>Golang</code>  å¸¦æ¥çš„ç›¸å¯¹äº <code>Java</code> çš„æä½èµ„æºå ç”¨ã€‚</p><h1 id="è¿˜å­˜åœ¨çš„é—®é¢˜"><a href="#è¿˜å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="è¿˜å­˜åœ¨çš„é—®é¢˜"></a>è¿˜å­˜åœ¨çš„é—®é¢˜</h1><p>å¦‚æœä¸€åˆ‡éƒ½è¿™ä¹ˆå®Œç¾çš„è¯é‚£ <code>VictoriaLogs</code>  ç¡®å®ä¹Ÿå¤ªå˜æ€äº†ï¼Œ è‡ªç„¶ä»–ä¹Ÿæœ‰ä¸€äº›ä¸å¤ªå®Œç¾çš„åœ°æ–¹ã€‚</p><h2 id="åˆ†è¯åŠŸèƒ½æœ‰é™"><a href="#åˆ†è¯åŠŸèƒ½æœ‰é™" class="headerlink" title="åˆ†è¯åŠŸèƒ½æœ‰é™"></a>åˆ†è¯åŠŸèƒ½æœ‰é™</h2><p>é¦–å…ˆç¬¬ä¸€ä¸ªæ˜¯åˆ†è¯åŠŸèƒ½æœ‰é™ï¼Œåªèƒ½åšç®€å•çš„æœç´¢ï¼Œæ— æ³•åšåˆ°ç±»ä¼¼äº ES çš„å„ç§åˆ†è¯ï¼Œæ’ä»¶å½“ç„¶ä¹Ÿåˆ«æƒ³äº†ã€‚</p><h2 id="ä¸æ”¯æŒé›†ç¾¤"><a href="#ä¸æ”¯æŒé›†ç¾¤" class="headerlink" title="ä¸æ”¯æŒé›†ç¾¤"></a>ä¸æ”¯æŒé›†ç¾¤</h2><p>å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œä¹Ÿå°±æ˜¯æ— æ³•æ¨ªå‘æ‰©å±•äº†ï¼›ä¸è¿‡å¹¸å¥½ä»–çš„çš„å•æœºæ€§èƒ½å·²ç»éå¸¸å¼ºäº†ã€‚</p><p>è¿™ä¹Ÿæ˜¯ç›®å‰é˜¶æ®µéƒ¨ç½²ç®€å•çš„åŸå› ã€‚</p><h2 id="è¿‡æœŸæ—¶é—´æ— æ³•æ··ç”¨"><a href="#è¿‡æœŸæ—¶é—´æ— æ³•æ··ç”¨" class="headerlink" title="è¿‡æœŸæ—¶é—´æ— æ³•æ··ç”¨"></a>è¿‡æœŸæ—¶é—´æ— æ³•æ··ç”¨</h2><p><code>VictoriaLogs</code> æ”¯æŒä¸ºæ•°æ®é…ç½®è¿‡æœŸæ—¶é—´è‡ªåŠ¨åˆ é™¤ï¼Œæœ‰ç‚¹ç±»ä¼¼äº Redisï¼Œå®ƒä¼šåœ¨åå°å¯åŠ¨ä¸€ä¸ªåç¨‹å®šæœŸåˆ¤æ–­æ•°æ®æ˜¯å¦è¿‡æœŸï¼Œä½†åªèƒ½å¯¹æ‰€æœ‰æ•°æ®ç»Ÿä¸€è®¾ç½®ã€‚</p><p>æ¯”å¦‚æˆ‘æƒ³åœ¨ <code>VictoriaLogs</code> ä¸­å­˜æ”¾ä¸¤ç§ä¸åŒç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶ä»–ä»¬çš„è¿‡æœŸåˆ é™¤æ—¶é—´ä¹Ÿä¸ç›¸åŒï¼›æ¯”å¦‚ä¸€ä¸ªæ˜¯ä¸‰å¤©åˆ é™¤ï¼Œä¸€ä¸ªæ˜¯ä¸‰æœˆååˆ é™¤ã€‚</p><p>è¿™æ ·çš„éœ€æ±‚ç›®å‰æ˜¯æ— æ³•å®ç°çš„ï¼Œåªèƒ½éƒ¨ç½²ä¸¤ä¸ª <code>VictoriaLogs</code>.</p><h2 id="é»˜è®¤æ— æ³•æŸ¥è¯¢æ‰€æœ‰å­—æ®µ"><a href="#é»˜è®¤æ— æ³•æŸ¥è¯¢æ‰€æœ‰å­—æ®µ" class="headerlink" title="é»˜è®¤æ— æ³•æŸ¥è¯¢æ‰€æœ‰å­—æ®µ"></a>é»˜è®¤æ— æ³•æŸ¥è¯¢æ‰€æœ‰å­—æ®µ</h2><p><img src="https://s2.loli.net/2023/08/24/2Wk6VUXQoEYvZJ1.png" alt="image.png"></p><p>ç”±äº <code>VictoriaLogs</code>  å¯ä»¥å­˜å‚¨éç»“æ„åŒ–æ•°æ®ï¼Œé»˜è®¤æƒ…å†µä¸‹åªèƒ½æŸ¥è¯¢å†…ç½®çš„ä¸‰ä¸ªå­—æ®µï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å­—æ®µç›®å‰æ²¡æ³•è‡ªåŠ¨æŸ¥è¯¢ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šã€‚</p><p>è¿™ä¸ªå€’ä¸æ˜¯è‡´å‘½é—®é¢˜ï¼Œåªæ˜¯ä½¿ç”¨èµ·æ¥ç¨å¾®éº»çƒ¦ä¸€äº›ï¼›ç¤¾åŒºä¹Ÿæœ‰ä¸€äº›åé¦ˆï¼Œç›¸ä¿¡ä¸ä¹…å°±ä¼šä¼˜åŒ–è¯¥åŠŸèƒ½ã€‚<br><img src="https://s2.loli.net/2023/08/24/XYxz8tTDmw6arf9.png" alt="image.png"><br><img src="https://s2.loli.net/2023/08/24/pgQCPsLvXfMc7nF.png" alt="image.png"></p><ul><li><a href="https://github.com/VictoriaMetrics/VictoriaMetrics/issues/4780">https://github.com/VictoriaMetrics/VictoriaMetrics/issues/4780</a></li><li><a href="https://github.com/VictoriaMetrics/VictoriaMetrics/issues/4513">https://github.com/VictoriaMetrics/VictoriaMetrics/issues/4513</a></li></ul><h2 id="æ²¡æœ‰å®˜æ–¹-SDK"><a href="#æ²¡æœ‰å®˜æ–¹-SDK" class="headerlink" title="æ²¡æœ‰å®˜æ–¹ SDK"></a>æ²¡æœ‰å®˜æ–¹ SDK</h2><p><img src="https://s2.loli.net/2023/08/24/bXPKRIy7Ojf1elE.png" alt="image.png"></p><p>è¿™ä¹Ÿæ˜¯ä¸ªæœ‰äº†æ›´å¥½çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç›®å‰åªèƒ½æ ¹æ® REST API è‡ªå·±ç¼–å†™ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å½“å‰æˆ‘ä»¬åªç”¨æ¥å­˜å‚¨ <code>Pulsar</code> é“¾è·¯è¿½è¸ªæ•°æ®ï¼Œç›®å‰çœ‹æ¥éå¸¸ç¨³å®šï¼Œå„æ–¹é¢èµ„æºå ç”¨æå°‘ï¼›æ‰€ä»¥åç»­æˆ‘ä»¬ä¼šé™†ç»­è®²ä¸€äº›æ—¥å¿—ç±»å‹çš„æ•°æ®è¿ç§»è¿‡æ¥ï¼Œæ¯”å¦‚å®¡è®¡æ—¥å¿—å•¥çš„ã€‚</p><p>ä¹‹åå†é€æ­¥å®Œå–„åŠŸèƒ½åï¼Œç”šè‡³å¯ä»¥å°†æ‰€æœ‰åº”ç”¨å­˜æ”¾åœ¨ <code>ElasticSeach</code> ä¸­çš„æ—¥å¿—ä¹Ÿè¿ç§»è¿‡æ¥ï¼Œè¿™æ ·ç¡®å®èƒ½çœä¸‹ä¸å°‘èµ„æºã€‚</p><p>æ€»å¾—æ¥è¯´ <code>VictoriaLogs</code>  èµ„æºå ç”¨æå°‘ï¼Œå¦‚æœåªæ˜¯æ‹¿æ¥å­˜å‚¨æ—¥å¿—ç›¸å…³çš„æ•°æ®ï¼Œæ²¡æœ‰å¾ˆå¼ºçš„åˆ†è¯éœ€æ±‚é‚£å®ƒå°†éå¸¸åˆé€‚ã€‚</p><p>æˆªæ­¢åˆ°ç›®å‰æœ€æ–°ç‰ˆä¹Ÿæ‰ <code>0.3.0</code> è¿˜æœ‰å¾ˆå¤§çš„è¿›æ­¥ç©ºé—´ï¼Œæœ‰ç±»ä¼¼éœ€æ±‚çš„å¯ä»¥æŒç»­å…³æ³¨ã€‚<br>#Blog #Vlogs #CloudNative </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/08/23/t5soejn8vw1aZil.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´æˆ‘ä»¬æƒ³å®ç° &lt;code&gt;Pulsar&lt;/code&gt; æ¶ˆæ¯çš„è¿½è¸ªæµç¨‹ï¼Œè¿½è¸ªå®ç°çš„æ•ˆæœå›¾å¦‚ä¸‹ï¼š&lt;br&gt;&lt;img src=&quot;https://s2.loli.net/2023/08/02/H7pjinzQ5EWR2tF.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;å®ç°å…¶å®æ¯”è¾ƒç®€å•ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯å¦‚ä½•å­˜å‚¨æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¶ˆæ¯çš„è¯»å–æˆ‘ä»¬æ˜¯é€šè¿‡ Pulsar è‡ªå¸¦çš„ BrokerInterceptor å®ç°çš„ï¼Œå¯¹è¿™ä¸ªæ„Ÿå…´è¶£çš„æœ‹å‹åé¢ä¼šå•ç‹¬åšä¸€ä¸ªåˆ†äº«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="VictoriaLogs" scheme="http://crossoverjie.top/categories/VictoriaLogs/"/>
    
    
    <category term="CloudNative" scheme="http://crossoverjie.top/tags/CloudNative/"/>
    
  </entry>
  
  <entry>
    <title>k8s å¸¸è§é¢è¯•é¢˜ 01</title>
    <link href="http://crossoverjie.top/2023/08/17/ob/k8s-question-01/"/>
    <id>http://crossoverjie.top/2023/08/17/ob/k8s-question-01/</id>
    <published>2023-08-17T14:33:43.000Z</published>
    <updated>2023-09-15T18:42:21.018Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/08/17/hnWciw54ml6oPdg.jpg"></p><p>å‰æ®µæ—¶é—´åœ¨è¿™ä¸ªè§†é¢‘ä¸­åˆ†äº«äº† <a href="https://github.com/bregman-arie/devops-exercises">https://github.com/bregman-arie/devops-exercises</a> è¿™ä¸ªçŸ¥è¯†ä»“åº“ã€‚</p><iframe src="//player.bilibili.com/player.html?aid=532004472&bvid=BV1Wu411n7U7&cid=1227759877&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>è¿™æ¬¡ç»§ç»­åˆ†äº«é‡Œé¢çš„å†…å®¹ï¼Œæœ¬æ¬¡ä¸»è¦ä»¥ k8s ç›¸å…³çš„é—®é¢˜ä¸ºä¸»ã€‚</p><span id="more"></span><h2 id="k8s-æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä¼ä¸šé€‰æ‹©ä½¿ç”¨å®ƒ"><a href="#k8s-æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä¼ä¸šé€‰æ‹©ä½¿ç”¨å®ƒ" class="headerlink" title="k8s æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä¼ä¸šé€‰æ‹©ä½¿ç”¨å®ƒ"></a>k8s æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä¼ä¸šé€‰æ‹©ä½¿ç”¨å®ƒ</h2><p>k8s æ˜¯ä¸€ä¸ªå¼€æºåº”ç”¨ï¼Œç»™ç”¨æˆ·æä¾›äº†ç®¡ç†ã€éƒ¨ç½²ã€æ‰©å±•å®¹å™¨çš„èƒ½åŠ›ï¼Œä»¥ä¸‹å‡ ä¸ªä¾‹å­æ›´å®¹æ˜“ç†è§£ï¼š</p><ul><li>ä½ å¯ä»¥å°†å®¹å™¨è¿è¡Œåœ¨ä¸åŒçš„æœºå™¨æˆ–èŠ‚ç‚¹ä¸­ï¼Œå¹¶ä¸”å¯ä»¥å°†ä¸€äº›å˜åŒ–åŒæ­¥ç»™è¿™äº›å®¹å™¨ï¼Œç®€å•æ¥è¯´æˆ‘ä»¬åªéœ€è¦ç¼–å†™ <code>yaml</code> æ–‡ä»¶ï¼Œå‘Šè¯‰ <code>k8s</code> æˆ‘çš„é¢„æœŸæ˜¯ä»€ä¹ˆï¼Œå…¶ä¸­åŒæ­¥å˜åŒ–çš„è¿‡ç¨‹å…¨éƒ¨éƒ½äº¤ç»™ k8s å»å®Œæˆã€‚<blockquote><p>å…¶å®å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å£°æ˜å¼ API</p></blockquote></li><li>ç¬¬äºŒä¸ªç‰¹ç‚¹åˆšæ‰å·²ç»æåˆ°äº†ï¼Œå®ƒå¯ä»¥å¸®æˆ‘ä»¬ä¸€é”®ç®¡ç†å¤šä¸ªå®¹å™¨ï¼ŒåŒæ­¥æ‰€æœ‰çš„å˜æ›´ã€‚</li><li>å¯ä»¥æ ¹æ®å½“å‰çš„è´Ÿè½½è°ƒæ•´åº”ç”¨çš„å‰¯æœ¬æ•°ï¼Œè´Ÿè½½é«˜å°±æ–°åˆ›å»ºå‡ ä¸ªåº”ç”¨å®ä¾‹ï¼Œä½å°±é™ä½å‡ ä¸ªï¼Œè¿™ä¸ªå¯ä»¥æ‰‹åŠ¨æˆ–è‡ªåŠ¨å®Œæˆã€‚</li></ul><h2 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨-k8s"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨-k8s" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨ k8s"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨ k8s</h2><ul><li>å¦‚æœä¸»è¦è¿˜æ˜¯ä½¿ç”¨ç‰©ç†æœºè¿™ç§ä½çº§åˆ«çš„åŸºç¡€è®¾æ–½çš„è¯ï¼Œä¸å¤ªå»ºè®®ä½¿ç”¨ <code>k8s</code>ï¼Œè¿™ç§æƒ…å†µé€šå¸¸æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„ä¸šåŠ¡ï¼Œæ²¡æœ‰å¿…è¦ä½¿ç”¨ <code>k8s</code>ã€‚</li><li>ç¬¬äºŒç§æƒ…å†µæ˜¯å¦‚æœæ˜¯å°å›¢é˜Ÿï¼Œæˆ–è€…å®¹å™¨è§„æ¨¡è¾ƒå°æ—¶ä¹Ÿä¸å»ºè®®ä½¿ç”¨ï¼Œé™¤éä½ æƒ³ä½¿ç”¨ k8s çš„æ»šåŠ¨å‘å¸ƒå’Œè‡ªæ‰©å®¹èƒ½åŠ›ï¼Œ<blockquote><p>ä¸è¿‡è¿™äº›åŠŸèƒ½è¿ç»´è‡ªå·±å†™å·¥å…·ä¹Ÿèƒ½å®ç°ã€‚</p></blockquote></li></ul><h2 id="k8s-æœ‰å“ªäº›ç‰¹æ€§"><a href="#k8s-æœ‰å“ªäº›ç‰¹æ€§" class="headerlink" title="k8s æœ‰å“ªäº›ç‰¹æ€§"></a>k8s æœ‰å“ªäº›ç‰¹æ€§</h2><ul><li>æ˜¯è‡ªæˆ‘ä¿®å¤ï¼Œ<code>k8s</code> å¯¹å®¹å™¨æœ‰ç€å¥åº·æ£€æµ‹ï¼Œæ¯”å¦‚ä½¿ç”¨å¯åŠ¨æ¢é’ˆã€å­˜æ´»æ¢é’ˆç­‰ï¼Œæˆ–è€…æ˜¯å®¹å™¨ <code>OOM</code> åä¹Ÿä¼šé‡å¯åº”ç”¨å°è¯•ä¿®å¤ã€‚</li><li>è‡ªå¸¦è´Ÿè½½å‡è¡¡ï¼Œä½¿ç”¨ <code>service</code> å¯ä»¥å°†æµé‡è‡ªåŠ¨è´Ÿè½½åˆ°åç»­ Pod ä¸­ï¼Œå¦‚æœ Pod æä¾›çš„æ˜¯ http æœåŠ¡è¿™ä¸ªå¤Ÿç”¨äº†ï¼Œä½†å¦‚æœæ˜¯ grpc è¿™æ ·çš„é•¿é“¾æ¥ï¼Œå°±éœ€è¦ä½¿ç”¨ istio è¿™ç±»æœåŠ¡ç½‘æ ¼ï¼Œä»–å¯ä»¥è¯†åˆ«å‡ºåè®®ç±»å‹ï¼Œä»è€Œåšåˆ°è¯·æ±‚çº§åˆ«çš„è´Ÿè½½å‡è¡¡ã€‚</li><li><code>Operator</code> è‡ªåŠ¨è¿ç»´èƒ½åŠ›ï¼šk8s å¯ä»¥æ ¹æ®åº”ç”¨çš„è¿è¡Œæƒ…å†µè‡ªåŠ¨è°ƒæ•´å½“å‰é›†ç¾¤çš„ Pod æ•°é‡ã€å­˜å‚¨ç­‰ï¼Œæ‹¿ <code>Pulsar</code> ä¸¾ä¾‹ï¼Œå½“æµé‡æ¿€å¢åè‡ªåŠ¨æ–°å¢ <code>broker</code>ï¼Œç£ç›˜ä¸è¶³æ—¶è‡ªåŠ¨æ‰©å®¹ç­‰ã€‚</li><li>æ»šåŠ¨æ›´æ–°èƒ½åŠ›ï¼šå½“æˆ‘ä»¬å‘ç‰ˆæˆ–è€…æ˜¯å›æ»šç‰ˆæœ¬çš„æ—¶å€™ï¼Œk8s ä¼šç­‰å¾…æ–°çš„å®¹å™¨å¯åŠ¨ä¹‹åæ‰ä¼šå°†æµé‡åˆ‡å›æ¥ï¼ŒåŒæ—¶é€æ­¥åœæ­¢è€çš„å®ä¾‹ã€‚</li><li>æ°´å¹³æ‰©å±•èƒ½åŠ›ï¼šå¯ä»¥çµæ´»çš„æ–°å¢æˆ–è€…æ˜¯å‡å°‘å‰¯æœ¬çš„æ•°é‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªåŠ¨æ§åˆ¶ã€‚</li><li>æ•°æ®åŠ å¯†ï¼šä½¿ç”¨ <code>secret</code> å¯ä»¥ä¿å­˜ä¸€äº›æ•æ„Ÿçš„é…ç½®æˆ–è€…æ–‡ä»¶ã€‚</li></ul><h2 id="k8s-æœ‰ç€å“ªäº›å¯¹è±¡"><a href="#k8s-æœ‰ç€å“ªäº›å¯¹è±¡" class="headerlink" title="k8s æœ‰ç€å“ªäº›å¯¹è±¡"></a>k8s æœ‰ç€å“ªäº›å¯¹è±¡</h2><p>è¿™ä¸ªå°±æ˜¯è€ƒå¯Ÿæˆ‘ä»¬å¯¹ <code>k8s</code> æ˜¯å¦æ˜¯ç†Ÿæ‚‰äº†ï¼Œå¸¸ç”¨çš„æœ‰ï¼š</p><ul><li>Pod</li><li>Service</li><li>ReplicationController</li><li>DaemonSet</li><li>namespace</li><li>ConfigMap<br>è¿™ä¸ªå…¶å®çŸ¥é“æ²¡æœ‰å¤ªå¤šä½œç”¨ï¼Œä¸»è¦è¿˜æ˜¯å¾—çŸ¥é“åœ¨ä¸åŒåœºæ™¯å¦‚ä½•ä½¿ç”¨ä¸åŒçš„ç»„ä»¶ã€‚</li></ul><h2 id="å“ªäº›å­—æ®µæ˜¯å¿…é¡»çš„"><a href="#å“ªäº›å­—æ®µæ˜¯å¿…é¡»çš„" class="headerlink" title="å“ªäº›å­—æ®µæ˜¯å¿…é¡»çš„"></a>å“ªäº›å­—æ®µæ˜¯å¿…é¡»çš„</h2><p>è¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿè§‰å¾—æ„ä¹‰ä¸å¤§ï¼Œåªè¦å†™è¿‡ <code>yaml</code> å°±ä¼šçŸ¥é“äº†ï¼Œ<code>metadata, kind, apiVersion</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  </span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>  </span><br><span class="line"><span class="attr">metadata:</span>  </span><br><span class="line">  <span class="attr">labels:</span>  </span><br><span class="line">    <span class="attr">app:</span> <span class="string">app</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app</span></span><br></pre></td></tr></table></figure><h2 id="kubectl-æ˜¯ä»€ä¹ˆ"><a href="#kubectl-æ˜¯ä»€ä¹ˆ" class="headerlink" title="kubectl æ˜¯ä»€ä¹ˆ"></a>kubectl æ˜¯ä»€ä¹ˆ</h2><p>å…¶å®å°±æ˜¯ä¸€ä¸ª k8s çš„ å‘½ä»¤è¡Œå®¢æˆ·ç«¯ã€‚</p><h2 id="å½“ä½ éƒ¨ç½²åº”ç”¨çš„æ—¶å€™å“ªäº›å¯¹è±¡ç”¨çš„æ¯”è¾ƒå¤š"><a href="#å½“ä½ éƒ¨ç½²åº”ç”¨çš„æ—¶å€™å“ªäº›å¯¹è±¡ç”¨çš„æ¯”è¾ƒå¤š" class="headerlink" title="å½“ä½ éƒ¨ç½²åº”ç”¨çš„æ—¶å€™å“ªäº›å¯¹è±¡ç”¨çš„æ¯”è¾ƒå¤š"></a>å½“ä½ éƒ¨ç½²åº”ç”¨çš„æ—¶å€™å“ªäº›å¯¹è±¡ç”¨çš„æ¯”è¾ƒå¤š</h2><ul><li>ç¬¬ä¸€ä¸ªè‚¯å®šæ˜¯ <code>deployment</code>ï¼Œè¿™åº”è¯¥æ˜¯æœ€å¸¸è§çš„éƒ¨ç½²æ–¹å¼ã€‚</li><li><code>service</code>: å¯ä»¥å°†æµé‡è´Ÿè½½åˆ° Pod ä¸­ã€‚</li><li><code>Ingress</code>: å¦‚æœéœ€è¦ä»é›†ç¾¤å¤–è®¿é—® Pod å°±å¾—éœ€è¦ <code>Ingress</code> ç„¶å é…åˆåŸŸåè®¿é—®ã€‚</li></ul><h2 id="ä¸ºä»€ä¹ˆæ²¡æœ‰-k-get-containers-è¿™ä¸ªå‘½ä»¤"><a href="#ä¸ºä»€ä¹ˆæ²¡æœ‰-k-get-containers-è¿™ä¸ªå‘½ä»¤" class="headerlink" title="ä¸ºä»€ä¹ˆæ²¡æœ‰ k get containers è¿™ä¸ªå‘½ä»¤"></a>ä¸ºä»€ä¹ˆæ²¡æœ‰ <code>k get containers</code> è¿™ä¸ªå‘½ä»¤</h2><p>è¿™ä¸ªé—®é¢˜ä¸»è¦æ˜¯çœ‹å¯¹ <code>Pod</code> çš„ç†è§£ï¼Œå› ä¸ºåœ¨ <code>k8s</code> ä¸­ <code>Pod</code> å°±æ˜¯æœ€å°çš„å•ä½äº†ï¼Œå¦‚æœæƒ³è¦è®¿é—®å®¹å™¨å¯ä»¥åœ¨ Pod ä¸­è®¿é—®ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åŠ ä¸Š <code>-c</code> å‚æ•°è¿›å…¥å…·ä½“çš„å®¹å™¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl exec -it app -c istio-proxy</span><br></pre></td></tr></table></figure><h2 id="ä½ è®¤ä¸ºä½¿ç”¨ä½¿ç”¨-k8s-çš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆ"><a href="#ä½ è®¤ä¸ºä½¿ç”¨ä½¿ç”¨-k8s-çš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆ" class="headerlink" title="ä½ è®¤ä¸ºä½¿ç”¨ä½¿ç”¨ k8s çš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆ"></a>ä½ è®¤ä¸ºä½¿ç”¨ä½¿ç”¨ k8s çš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆ</h2><p>è¿™ä¸ªä¸»è¦æ˜¯çœ‹æ—¥å¸¸ä½¿ç”¨æ—¶æœ‰æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå‘äº†ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªå°±æ˜¯è¦éªŒè¯ <code>yaml</code> å†…å®¹æ˜¯å¦æ­£ç¡®ï¼Œè¿™ä¸ªç¡®å®å¾ˆé‡è¦ï¼Œä¸€æ—¦æ‰§è¡Œé”™äº†åæœå¾ˆä¸¥é‡ï¼Œæ¯”å¦‚ä½¿ç”¨ helm çš„æ—¶å€™æœ€å¥½å²‚å®¹ <code>dry-run</code> å’Œ <code>debug</code>ï¼Œå…ˆçœ‹çœ‹ç”Ÿæˆçš„ <code>yaml</code> æ˜¯å¦æ˜¯é¢„æœŸæƒ³è¦çš„ã€‚<blockquote><p>helm upgrade app â€“dry-run â€“debug</p></blockquote></li><li>ç¬¬äºŒä¸ªé™åˆ¶èµ„æºçš„ä½¿ç”¨ï¼Œæ¯”å¦‚ CPU å’Œ å†…å­˜ï¼Œè¿™ä¸ªä¹Ÿå¾ˆé‡è¦ï¼Œå¦‚æœä¸è®¾ç½®ä¸€æ—¦åº”ç”¨å‡ºç° bug å¯èƒ½å¯¼è‡´æ•´ä¸ª k8s é›†ç¾¤éƒ½å—åˆ°å½±å“ã€‚</li><li>ä¸º Podï¼Œdeployment æŒ‡å®šæ ‡ç­¾ï¼Œç”¨äºåˆ†ç»„ã€‚</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># èµ„æºé™åˆ¶</span></span><br><span class="line"><span class="attr">resources:</span>  </span><br><span class="line">  <span class="attr">limits:</span>  </span><br><span class="line">    <span class="attr">cpu:</span> <span class="string">200m</span>  </span><br><span class="line">    <span class="attr">memory:</span> <span class="string">200Mi</span>  </span><br><span class="line">  <span class="attr">requests:</span>  </span><br><span class="line">    <span class="attr">cpu:</span> <span class="string">100m</span>  </span><br><span class="line">    <span class="attr">memory:</span> <span class="string">100Mi</span></span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒæ¥æºï¼š<a href="https://github.com/bregman-arie/devops-exercises/blob/master/topics/kubernetes/README.md#kubernetes-101">https://github.com/bregman-arie/devops-exercises/blob/master/topics/kubernetes/README.md#kubernetes-101</a></p></blockquote><p>åç»­éƒ¨åˆ†å†…å®¹ä¹Ÿæœ‰å‡ºè§†é¢‘ç‰ˆï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶å…³æ³¨æˆ‘çš„ B ç«™æˆ–è€…æ˜¯è§†é¢‘å·ï¼š<br><img src="https://s2.loli.net/2023/08/17/joO3wpCAEMtY2yW.jpg" alt="image.png"><br><img src="https://s2.loli.net/2023/08/17/2gcNDC4M3x91Sbh.jpg" alt="image.png"></p><p>#Blog #K8s </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/08/17/hnWciw54ml6oPdg.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;å‰æ®µæ—¶é—´åœ¨è¿™ä¸ªè§†é¢‘ä¸­åˆ†äº«äº† &lt;a href=&quot;https://github.com/bregman-arie/devops-exercises&quot;&gt;https://github.com/bregman-arie/devops-exercises&lt;/a&gt; è¿™ä¸ªçŸ¥è¯†ä»“åº“ã€‚&lt;/p&gt;
&lt;iframe src=&quot;//player.bilibili.com/player.html?aid=532004472&amp;bvid=BV1Wu411n7U7&amp;cid=1227759877&amp;page=1&quot; scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;&gt; &lt;/iframe&gt;

&lt;p&gt;è¿™æ¬¡ç»§ç»­åˆ†äº«é‡Œé¢çš„å†…å®¹ï¼Œæœ¬æ¬¡ä¸»è¦ä»¥ k8s ç›¸å…³çš„é—®é¢˜ä¸ºä¸»ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Interview" scheme="http://crossoverjie.top/categories/Interview/"/>
    
    
    <category term="k8s" scheme="http://crossoverjie.top/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>æ–°æ‰‹å¦‚ä½•å¿«é€Ÿå‚ä¸å¼€æºé¡¹ç›®</title>
    <link href="http://crossoverjie.top/2023/08/05/ob/novice-contribute-open-source/"/>
    <id>http://crossoverjie.top/2023/08/05/ob/novice-contribute-open-source/</id>
    <published>2023-08-05T05:37:58.000Z</published>
    <updated>2023-09-15T18:42:21.019Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/08/05/5mXrStCDVHNxF7f.png" alt="image.png"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¼€æºè¿™ä»¶äº‹æƒ…åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸä¸€ç›´æ˜¯ä¸€ä¸ªé«˜é¢‘è¯é¢˜ï¼Œæˆ‘ä»¬å·¥ä½œä¸­ä¸ç®¡æ˜¯ä½¿ç”¨åˆ°çš„å·¥å…·è¿˜æ˜¯ç¬¬ä¸‰æ–¹åº“éƒ½ç¦»ä¸å¼€å¼€æºçš„æ”¯æŒã€‚</p><p>è¿‘æœŸç”±äºå·¥ä½œçš„åŸå› ï¼Œæˆ‘éœ€è¦ç»å¸¸å’Œ <code>Apache Pulsar</code> ç¤¾åŒºæ²Ÿé€šï¼ŒåŒæ—¶ä¹Ÿä¼šå°†æ—¥å¸¸ç¢°åˆ°çš„é—®é¢˜åé¦ˆç»™ç¤¾åŒºï¼ŒåŒ…æ‹¬ä¸€äº› <code>bug</code> ï¼Œä¸€äº›æˆ‘èƒ½ä¿®çš„ä¹Ÿæ˜¯é¡ºå¸¦å°±æäº†ä¸€äº› <code>PR</code>ã€‚</p><span id="more"></span><p>ä¹‹å‰æˆ–å¤šæˆ–å°‘æˆ‘ä¹Ÿå‚ä¸è¿‡å…¶ä»–çš„å¼€æºç¤¾åŒºï¼Œä½†å’Œç°åœ¨çš„è¿˜æ˜¯æœ‰äº›è®¸çš„ä¸åŒï¼š</p><ul><li>ä»¥å‰æˆ‘æ›´å¤šçš„æ˜¯ä¸ªäººå¼€æºé¡¹ç›®ï¼Œå¶å°”ä¹Ÿä¼šæœ‰å…¶ä»–å¼€å‘è€…å‘æˆ‘çš„ä»“åº“è´¡çŒ®ä»£ç ã€‚</li><li>ä¹Ÿå‚ä¸è¿‡å…¶ä»–ä¸ªäººä½œè€…æˆ–è€…æ˜¯ç¤¾åŒºæ€§è´¨çš„é¡¹ç›®ï¼Œä½†æµç¨‹ä¸Šæ²¡æœ‰é‚£ä¹ˆæ­£è§„æˆ–è€…æ˜¯<code>æ ‡å‡†</code>ã€‚</li></ul><p>ç®€å•æ¥è¯´å°±æ˜¯ä»¥å‰å°±æ˜¯å°æ‰“å°é—¹ï¼Œ<code>Pulsar</code> æ¯•ç«Ÿæ˜¯ <code>Apache</code> ç¤¾åŒºçš„é¡¶çº§é¡¹ç›®ï¼Œå‚ä¸çš„æ•´ä¸ªæµç¨‹è¦æ±‚ä¹Ÿä¼šæ¯”è¾ƒå¤æ‚ï¼Œå½“ç„¶å­¦åˆ°çš„çŸ¥è¯†ä¹Ÿä¼šæ›´å¤šã€‚</p><p><img src="https://s2.loli.net/2023/08/05/uSRKlvh8q4sTpWj.png" alt="image.png"></p><p><img src="https://s2.loli.net/2023/08/05/DJm145yigIhEvwe.png" alt="image.png"><br>è¿™åŠå¹´æ—¶é—´å¤§å¤§å°å°æäº†åå‡ ä¸ª PR ï¼Œä¹Ÿé€æ¸æ‹æ¸…æ¥šäº†ä¸€äº›ä¸Šæ‰‹çš„æ–¹æ³•å’Œå¥—è·¯ï¼Œæ‰€ä»¥å¦‚æœä½ ä¹Ÿæƒ³å‚ä¸å¼€æºï¼Œä½†è‹¦äºä¸çŸ¥é“å¦‚ä½•å…¥é—¨ï¼Œçœ‹å®Œåå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p><h1 id="ä¸ºä»€ä¹ˆå‚ä¸å¼€æº"><a href="#ä¸ºä»€ä¹ˆå‚ä¸å¼€æº" class="headerlink" title="ä¸ºä»€ä¹ˆå‚ä¸å¼€æº"></a>ä¸ºä»€ä¹ˆå‚ä¸å¼€æº</h1><p>é¦–å…ˆè¿˜æ˜¯æ¥èŠèŠå‚ä¸å¼€æºçš„å¥½å¤„ï¼Œäº†è§£ä¹‹åä¹Ÿè®¸ä¼šè®©ä½ æœ‰è·¯è½¬ç²‰ã€‚</p><p>é¦–å…ˆæœ€æ˜æ˜¾çš„ä¸€ç‚¹å°±æ˜¯è®©ä½ å¯¹è´¡çŒ®çš„è¿™ä¸ªé¡¹ç›®æ›´åŠ æ·±å…¥çš„äº†è§£ï¼Œæˆ‘ä»¬å¸¸å¸¸éƒ½åœ¨é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°å¯¹ XX æ¡†æ¶çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼Œå“ªæ€•ä½ åœ¨ç®€å†é‡Œå†™çš„å¤©èŠ±ä¹±å ä¹Ÿæ²¡æœ‰æ˜¯è¿™ä¸ªé¡¹ç›®  <code>Contributor</code> æ›´å…·æœ‰è¯´æœåŠ›ã€‚</p><p>å…¶æ¬¡æ˜¯æ²Ÿé€šäº¤æµèƒ½åŠ›ä¹Ÿä¼šå¾—åˆ°é”»ç‚¼ï¼Œå¼€æºç¤¾åŒºå¾€å¾€éƒ½æ˜¯ä»¥ <code>github issue/PR</code>ï¼Œæˆ–è€…æ˜¯ <code>Mailing List</code> çš„æ–¹å¼æ²Ÿé€šäº¤æµï¼Œè¿™æ ·çš„æ²Ÿé€šæ–¹å¼å’Œæˆ‘ä»¬å¸¸ç”¨çš„å¾®ä¿¡ã€QQ è¿™ç±»åŠæ—¶é€šè®¯å·¥å…·æœ‰ç€æœ¬è´¨çš„åŒºåˆ«ã€‚</p><p>å¾€å¾€éœ€è¦æˆ‘ä»¬æœ‰äº†å†·é™çš„æ€è€ƒåŠ ä¸Šæ¸…æ™°çš„æè¿°æ‰ä¼šå°†è‡ªå·±çš„è§‚ç‚¹å‘å¸ƒå‡ºå»ï¼Œè¿™æ ·ä¸è‡ªè§‰çš„å°±ä¼šå…»æˆè‡ªå·±çš„æ€»ç»“èƒ½åŠ›ï¼Œè¿™ä¸ªèƒ½åŠ›å¯¹äº<code>å†…å®¹åˆ›æ„å†…å®¹å·¥ä½œè€…</code>æ¥è¯´éå¸¸é‡è¦ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæ›´æ˜æ˜¾çš„å¥½å¤„å°±æ˜¯å¯¹ä¸ªäººçš„èƒ½åŠ›èƒŒä¹¦ï¼Œå¤§å®¶å¸¸è¯´çš„ <code>show me the code</code>ï¼Œè€Œ <code>GitHub</code> å°±æ˜¯æœ€å¥½çš„æ–¹å¼ã€‚</p><p>å½“ä½ æ˜¯æŸä¸ªçŸ¥åå¼€æºé¡¹ç›®çš„ <code>Contributor</code> ç”šè‡³æ˜¯ <code>Committer/PMC</code> å°±å·²ç»è¶³å¤Ÿè¯æ˜è‡ªå·±çš„èƒ½åŠ›äº†ã€‚</p><h1 id="å¦‚ä½•å‚ä¸"><a href="#å¦‚ä½•å‚ä¸" class="headerlink" title="å¦‚ä½•å‚ä¸"></a>å¦‚ä½•å‚ä¸</h1><p>å¦‚ä½•å‚ä¸å‘¢ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œä¸å¤–ä¹æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼ˆç”±æ˜“åˆ°éš¾ï¼‰ï¼š</p><ul><li>ä¸€äº› <code>typo</code> ç±»çš„ä¿®å¤ã€‚</li><li>å›ç­”ç¤¾åŒºä¸­ç”¨æˆ·çš„é—®é¢˜ã€‚</li><li>ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ° <code>bug</code>ï¼Œç›´æ¥åé¦ˆï¼Œæœ‰å…´è¶£çš„è¯æœ€å¥½æ˜¯è‡ªå·±èƒ½ä¿®å¤ã€‚</li><li>ä¿®å¤ç°æœ‰ <code>issue</code> åˆ—è¡¨ä¸­æœªè§£å†³çš„ <code>bug</code>ã€‚</li><li>è½¯ä»¶ä¸å…·å¤‡è‡ªå·±éœ€è¦çš„åŠŸèƒ½æ—¶æäº¤ <code>feature</code> ææ¡ˆå¹¶å®ç°ã€‚</li></ul><p>ä¸ç®¡æ˜¯å“ªç§æ–¹å¼æˆ‘çš„å»ºè®®æ˜¯åœ¨å‡†å¤‡è´¡çŒ®ä¹‹å‰éƒ½åº”è¯¥å…ˆçœ‹çœ‹å®˜æ–¹æä¾›çš„è´¡çŒ®æŒ‡å—ï¼Œé€šå¸¸åœ¨å®˜ç½‘å°±èƒ½æŸ¥çœ‹ã€‚</p><blockquote><p>å³ä¾¿æ˜¯æœ€ç®€å•çš„ä¿®å¤ typoï¼Œå› ä¸ºè¶Šæ˜¯ä¸“ä¸šçš„é¡¹ç›®æ¯ä¸ª PR çš„åˆå¹¶éƒ½æ˜¯ä¸¥è°¨çš„ï¼Œæå‰äº†è§£åå¯ä»¥é¿å…çŠ¯ä¸€äº›åŸºæœ¬é”™è¯¯ä»è€Œå½±å“ç§¯ææ€§ã€‚</p></blockquote><p>è¿™é‡Œæˆ‘ä»¥ <code>Pulsar</code> ä¸ºä¾‹ï¼š<br><img src="https://s2.loli.net/2023/08/05/8TGyjSXChsaoPc6.png" alt="image.png"><br>å®˜ç½‘æœ‰ç€è¯¦ç»†çš„è´¡çŒ®æŒ‡å—ï¼ŒåŒ…æ‹¬ç¯å¢ƒæ­å»ºã€ä»£ç çº¦å®šã€<code>PR/git commit</code> è¯­ä¹‰ç­‰å„ç§è§„èŒƒã€‚</p><p>è¿™é‡Œæˆ‘é‡ç‚¹å¼ºè°ƒ PR çš„è¯­ä¹‰ï¼Œä¸€ä¸ªå¥½çš„ PR è§„èŒƒæ›´å®¹æ˜“å¼•èµ·ç¤¾åŒºæˆå‘˜çš„æ³¨æ„ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ¯ä¸€æ¬¡æäº¤éƒ½éœ€è¦ <code>Committer</code> çš„åŒæ„æ‰èƒ½åˆå¹¶ã€‚</p><p><img src="https://s2.loli.net/2023/08/05/gfbEBjc4dXVLPtw.png" alt="image.png"><br>è¿˜æ˜¯ä»¥ <code>Pulsar</code> ä¸ºä¾‹ï¼Œåœ¨æäº¤ PR å‰ä¸€å®šå¾—å…ˆçœ‹çœ‹è¿™é‡Œçš„è§„èŒƒè¦æ±‚ï¼Œä¸ç„¶å¾ˆå¯èƒ½ç¬¬ä¸€æ­¥å°±ä¼šåƒç˜ªã€‚</p><h2 id="å¯èƒ½é‡åˆ°çš„é—®é¢˜"><a href="#å¯èƒ½é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å¯èƒ½é‡åˆ°çš„é—®é¢˜"></a>å¯èƒ½é‡åˆ°çš„é—®é¢˜</h2><p>ä¸‹é¢è®²è®²è´¡çŒ®è¿‡ç¨‹ä¸­å¯èƒ½ä¼šç¢°åˆ°çš„é—®é¢˜ã€‚</p><p>åœ¨ä¸Šé¢è®²åˆ°çš„éš¾åº¦æ’åºä¸­å°†ä¿®å¤ä¸ªäºº issue æ’åœ¨äº†å…¶ä»– issue ä¹‹å‰äº†ï¼Œè¿™æ˜¯å› ä¸ºå¾€å¾€å¯¹è‡ªå·±æäº¤çš„ bug æ›´ç†Ÿæ‚‰ï¼Œè€Œç¤¾åŒºå…¶ä»–äººåé¦ˆçš„é—®é¢˜å¤§æ¦‚ç‡ä¼šè¢«è€æ‰‹è®¤é¢†ã€‚</p><p>åŠ ä¸Šè‡ªå·±ä¹Ÿä¸ç†Ÿæ‚‰ï¼Œå¯èƒ½åœ¨è‡ªå·±ç ”ç©¶å¤ç°çš„è¿‡ç¨‹ä¸­å°±æŠŠè‡ªå·±åŠé€€äº†ã€‚</p><h3 id="è®¤é¢†-issue"><a href="#è®¤é¢†-issue" class="headerlink" title="è®¤é¢† issue"></a>è®¤é¢† issue</h3><p>è¿™é‡Œè¿˜æœ‰ä¸ªå°æŠ€å·§ï¼Œå½“æˆ‘ä»¬å‡†å¤‡ä¿®å¤ä¸€ä¸ªä¸æ˜¯è‡ªå·±æäº¤çš„ issue æ—¶ï¼Œæœ€å¥½æ˜¯åœ¨è¯„è®ºåŒºè®© <code>Committer</code> å°†è¿™ä¸ªä»»åŠ¡åˆ†é…ç»™ä½ ï¼Œè¿™æ ·ç¤¾åŒºæˆå‘˜å°±ä¸ä¼šåšé‡å¤å·¥ä½œäº†ã€‚</p><p><img src="https://s2.loli.net/2023/08/05/KBh1HRd8EyziuQP.png" alt="image.png"><br>ç±»ä¼¼äºè¿™æ ·ã€‚</p><p>åŒæ—¶æˆ‘ä»¬åœ¨æŸ¥æ‰¾å¯ä»¥ä¿®å¤çš„ <code>issue</code> æ—¶ä¹Ÿè¦æ³¨æ„è¿™ä¸ª issue æœ‰æ²¡æœ‰è¢«è®¤é¢†ä»¥åŠæ˜¯å¦æœ‰ PR å…³è”ã€‚</p><p><img src="https://s2.loli.net/2023/08/05/pOPybK7lmX1v8oU.png" alt="image.png"></p><p>æœ‰æ—¶å€™ <code>issue</code> å¹¶æ²¡æœ‰è¢«æŒ‡å®šä½†ä¹Ÿæœ‰ç›¸å…³ <code>PR</code> åœ¨å¤„ç†è¯¥é—®é¢˜äº†ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥è¿‡æ»¤æ‰è¿™ä¸ª <code>issue</code>ã€‚</p><h3 id="help-want"><a href="#help-want" class="headerlink" title="help want"></a>help want</h3><p><img src="https://s2.loli.net/2023/08/05/QMwDlTWd3iFPU7c.png" alt="image.png"><br>ä¹Ÿå¯ä»¥æ‰¾æ‰¾å¸¦æœ‰  <code>help want</code> æ ‡ç­¾çš„ <code>issue</code>ï¼Œè¿™ç±»é—®é¢˜å¾€å¾€ä¼šç›¸å¯¹ç®€å•ï¼Œä¿®å¤èµ·æ¥ä¹Ÿæ›´å®¹æ˜“ã€‚</p><h3 id="ç¤¾åŒºåé¦ˆè¾ƒæ…¢"><a href="#ç¤¾åŒºåé¦ˆè¾ƒæ…¢" class="headerlink" title="ç¤¾åŒºåé¦ˆè¾ƒæ…¢"></a>ç¤¾åŒºåé¦ˆè¾ƒæ…¢</h3><p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„é—®é¢˜æ˜¯è‡ªå·±æäº¤çš„ issue æˆ–è€…æ˜¯ PR è¿Ÿè¿Ÿæ²¡æœ‰äººå¤„ç†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ª issue å¯¹åº”çš„ä»£ç æœ€è¿‘ä¸»è¦æ˜¯å“ªäº›äººåœ¨ç»´æŠ¤ï¼Œè¿™ä¸ªåœ¨ IDE ä¸­é…åˆ <code>GitToolBox</code> æ’ä»¶å°±å¾ˆå®¹æ˜“çœ‹å‡ºæ¥ã€‚</p><p><img src="https://s2.loli.net/2023/08/05/ojErZnigXbqFvam.png" alt="image.png"><br>åé¢çš„ ID å¾€å¾€æ˜¯ <code>PR</code> å·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ª <code>PR</code> æ‰¾åˆ°å¯¹åº”çš„ä½œè€…ï¼Œç„¶åå°è¯•åœ¨ <code>issue</code> è¯„è®ºåŒºè‰¾ç‰¹å¯¹æ–¹ã€‚</p><p>å¦‚æœä¾ç„¶æ²¡æœ‰å›å¤ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™å¼€å‘ç»„å‘é€é‚®ä»¶ã€‚<br><img src="https://s2.loli.net/2023/08/05/SuT5Fb4wG2BnrV1.png" alt="image.png"><br>å¦‚æœè¿˜æ˜¯æ²¡æœ‰å›å¤ï¼Œæ¯”å¦‚æˆ‘è¿™ä¸ªğŸ˜‚</p><p>é‚£ä¹Ÿè¿˜æœ‰ä¸€ä¸ªåŠæ³•ï¼Œå°±æ˜¯å°è¯•åœ¨ç¤¾äº¤åª’ä½“ï¼ˆGitHub é¦–é¡µã€æŠ€æœ¯ç¾¤ï¼‰ä¸Šæ‰¾åˆ° Committer çš„å¾®ä¿¡ï¼Œç›´æ¥ç§èŠçš„æ–¹å¼è®©å¯¹æ–¹å¸®å¿™æ¨è¿›ã€‚<br><img src="https://s2.loli.net/2023/08/05/J8r6lBbhMgziFGv.png" alt="image.png"></p><p>å½“ç„¶ä¹Ÿæœ‰ä¸€äº›é¡¹ç›®é•¿æœŸæ²¡æœ‰ç»´æŠ¤äº†ï¼Œè¿™ç§ PR è¦åšå¥½å¿ƒé‡Œå‡†å¤‡ï¼Œå¾ˆæœ‰å¯èƒ½å¯¹æ–¹ä¸ä¼šç†ä½ ï¼›è¿™ç‚¹åœ¨å›½å†…æŸä¸ªä¼ä¸šçš„å¼€æºé¡¹ç›®ä¸­æ¯”è¾ƒå¸¸è§ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ€»çš„æ¥è¯´æƒ³è¦åšå¥½å¼€æºå¾—æœ‰è€å¿ƒå’Œé•¿æœŸåšæŒï¼ŒåŒæ—¶ç»™è‡ªå·±å¸¦æ¥çš„å¥½å¤„ä¹Ÿæ˜¯ç‰©è¶…æ‰€å€¼çš„ï¼Œ<code>Apache</code> è¿™ç±»ä¸“ä¸šçš„ç¤¾åŒºæˆ‘ä¹Ÿæ‰å‚ä¸äº†åŠå¹´ï¼Œåç»­ä¹Ÿä¼šé•¿æœŸåšæŒä¸‹å»ï¼Œä¹Ÿå¸Œæœ›å“ªå¤©å¯ä»¥ç§¯ç´¯åˆ°æˆä¸º <code>Committer</code> åå†å’Œå¤§å®¶åˆ†äº«ã€‚</p><p>#Pulsar #OpenSource</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/08/05/5mXrStCDVHNxF7f.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å¼€æºè¿™ä»¶äº‹æƒ…åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸä¸€ç›´æ˜¯ä¸€ä¸ªé«˜é¢‘è¯é¢˜ï¼Œæˆ‘ä»¬å·¥ä½œä¸­ä¸ç®¡æ˜¯ä½¿ç”¨åˆ°çš„å·¥å…·è¿˜æ˜¯ç¬¬ä¸‰æ–¹åº“éƒ½ç¦»ä¸å¼€å¼€æºçš„æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;è¿‘æœŸç”±äºå·¥ä½œçš„åŸå› ï¼Œæˆ‘éœ€è¦ç»å¸¸å’Œ &lt;code&gt;Apache Pulsar&lt;/code&gt; ç¤¾åŒºæ²Ÿé€šï¼ŒåŒæ—¶ä¹Ÿä¼šå°†æ—¥å¸¸ç¢°åˆ°çš„é—®é¢˜åé¦ˆç»™ç¤¾åŒºï¼ŒåŒ…æ‹¬ä¸€äº› &lt;code&gt;bug&lt;/code&gt; ï¼Œä¸€äº›æˆ‘èƒ½ä¿®çš„ä¹Ÿæ˜¯é¡ºå¸¦å°±æäº†ä¸€äº› &lt;code&gt;PR&lt;/code&gt;ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="OpenSource" scheme="http://crossoverjie.top/categories/OpenSource/"/>
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/tags/Pulsar/"/>
    
  </entry>
  
  <entry>
    <title>ä» Pulsar Client çš„åŸç†åˆ°å®ƒçš„ç›‘æ§é¢æ¿</title>
    <link href="http://crossoverjie.top/2023/08/03/ob/Pulsar-Client/"/>
    <id>http://crossoverjie.top/2023/08/03/ob/Pulsar-Client/</id>
    <published>2023-08-03T03:47:52.000Z</published>
    <updated>2023-09-15T18:42:21.017Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/08/02/GipDPSlbycQxqFd.png" alt="image.png"></p><p>#Blog #Pulsar </p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰æ®µæ—¶é—´ä¸šåŠ¡å›¢é˜Ÿå¶å°”ä¼šç¢°åˆ°ä¸€äº› Pulsar ä½¿ç”¨çš„é—®é¢˜ï¼Œæ¯”å¦‚æ¶ˆæ¯é˜»å¡ä¸æ¶ˆè´¹äº†ã€ç”Ÿäº§è€…æ¶ˆæ¯å‘é€ç¼“æ…¢ç­‰å„ç§é—®é¢˜ã€‚</p><p>è™½ç„¶æˆ‘ä»¬æœ‰ä¸ªç›‘æ§é¡µé¢å¯ä»¥æ ¹æ® topic ç»´åº¦æŸ¥çœ‹ä»–çš„å‘é€çŠ¶æ€ï¼Œæ¯”å¦‚é€Ÿç‡ã€æµé‡ã€æ¶ˆè´¹çŠ¶æ€ç­‰ä¿¡æ¯ã€‚</p><span id="more"></span><p><img src="https://s2.loli.net/2023/08/02/UNZVawH4QYSu3Ko.png" alt="image.png"></p><p>ä½†ä¹Ÿæœ‰å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>æ— æ³•åœ¨åº”ç”¨ç»´åº¦æŸ¥çœ‹ä»–æ‰€ä¾èµ–çš„æ‰€æœ‰  topic çš„å„ç§çŠ¶æ€ã€‚</li><li>ç›‘æ§çš„ä¿¡æ¯è¿˜ä¸å¤Ÿï¼Œæ¯”å¦‚å‘é€&#x2F;æ¶ˆè´¹å»¶è¿Ÿã€å‘é€&#x2F;æ¶ˆè´¹å¤±è´¥ç­‰æ•°æ®ã€‚</li></ul><p>æ€»ä¹‹å°±æ˜¯ç¼ºå°‘ä¸€ä¸ªå…¨å±€çš„ç›‘æ§è§†è§’ï¼Œé€šè¿‡è¿™äº›æŒ‡æ ‡å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ†æå‡ºå½“æ—¶çš„è¿è¡Œæƒ…å†µã€‚</p><p>åŸºäºè¿™ä¸ªéœ€æ±‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„æŠ˜è…¾ï¼Œç°åœ¨å·²ç»ä¸Šçº¿ä½¿ç”¨å‡ ä¸ªæœˆï¼Œç›®å‰æ¯”è¾ƒç¨³å®šï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/08/02/byv4RDZnruSjo9h.png" alt="image.png"><br><img src="https://s2.loli.net/2023/08/02/TtufOpwHB86PFhK.png" alt="image.png"><br><img src="https://s2.loli.net/2023/08/02/d21IaNzbFQpnrkA.png" alt="image.png"></p><p>ç°åœ¨å°±å¯ä»¥åœ¨æ¯ä¸ªåº”ç”¨çš„ç›‘æ§é¢æ¿é‡Œçœ‹åˆ°è‡ªå·±ä½¿ç”¨äº†å“ªäº› topicï¼Œåˆ†åˆ«çš„ç”Ÿäº§æ¶ˆè´¹æƒ…å†µå¦‚ä½•ã€‚</p><h1 id="æ ¸å¿ƒæµç¨‹"><a href="#æ ¸å¿ƒæµç¨‹" class="headerlink" title="æ ¸å¿ƒæµç¨‹"></a>æ ¸å¿ƒæµç¨‹</h1><p>è¦å®ç°è¿™äº›åŠŸèƒ½å°±å¾—åœ¨åº”ç”¨çš„ <code>metrics</code> ä¸­åŠ å…¥ç›¸å…³çš„ç›‘æ§ä¿¡æ¯ï¼Œä½†å®˜æ–¹çš„ Java client æ˜¯æ²¡æœ‰æš´éœ²å‡ºè¿™äº›æŒ‡æ ‡çš„ã€‚</p><p><img src="https://s2.loli.net/2023/08/02/DlfkQo1Lmt8J7Iq.png" alt="image.png"></p><blockquote><p>ä½† pulsar-client-go æ˜¯è‡ªå¸¦äº†è¿™äº›æŒ‡æ ‡çš„</p></blockquote><p>ç”±äº <code>SDK</code> ä¸æ”¯æŒæ‰€ä»¥åªèƒ½è‡ªå·±æƒ³åŠæ³•å®ç°äº†ï¼Œä¸ºæ­¤å…¶å®æœ‰ä¸¤ç§å®ç°æ–¹æ¡ˆï¼š</p><ul><li>é­”æ”¹ <code>Java client</code>ï¼Œåœ¨éœ€è¦ç›‘æ§çš„åœ°æ–¹æ‰‹åŠ¨åŸ‹ç‚¹æŒ‡æ ‡ã€‚</li><li>ç”±äºæˆ‘ä»¬ä½¿ç”¨äº† <code>SkyWalking</code>ï¼Œæ‰€ä»¥å¯ä»¥ç¼–å†™æ’ä»¶ï¼Œä»¥ <code>agent</code> çš„æ–¹å¼è·å–æ•°æ®ã€åŸ‹ç‚¹æŒ‡æ ‡ã€‚</li></ul><p>ä¸è¿‡ç¬¬ä¸€ç§æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸€äº›é—®é¢˜ï¼š</p><ul><li>éœ€è¦è‡ªå·±ç»´æŠ¤ä¸€ä¸ªä»£ç åˆ†æ”¯ï¼Œè¿˜éœ€è¦å®šæœŸå’Œå®˜æ–¹ä¿æŒä¸€è‡´ï¼Œéš¾å…ä¼šå‡ºç°ä»£ç å†²çªã€‚</li><li>éœ€è¦æ¨åŠ¨ä¸šåŠ¡æ–¹è¿›è¡Œä¾èµ–å‡çº§ï¼Œçº¿ä¸Šæœ‰ç€å‡ ç™¾ä¸ªåº”ç”¨ï¼Œæ¨åŠ¨èµ·æ¥æ—¶é—´å¤ªæ…¢ã€‚</li></ul><p>ç¬¬äºŒç§æ–¹æ¡ˆçš„å¥½å¤„å°±ä¸è¨€è€Œå–»äº†ï¼š</p><ul><li>å‡çº§æ— æ„ŸçŸ¥ï¼Œåªéœ€è¦åœ¨æˆ‘ä»¬çš„åŸºç¡€é•œåƒä¸­åŠ ä¸Šæ’ä»¶å³å¯ã€‚</li><li>Java client çš„ç‰ˆæœ¬ä¹Ÿæ›´å®¹æ˜“ç»Ÿä¸€ã€‚</li></ul><h2 id="Client-åŸç†"><a href="#Client-åŸç†" class="headerlink" title="Client åŸç†"></a>Client åŸç†</h2><p>ä½†å…¶å®ä¸ç®¡æ˜¯å“ªç§æ–¹æ¡ˆæˆ‘ä»¬éƒ½å¾—ç†Ÿæ‚‰ Java Client çš„å®ç°åŸç†ï¼Œæ‰èƒ½çŸ¥é“å“ªäº›æ•°æ®æ˜¯æˆ‘ä»¬éœ€è¦é‡ç‚¹å…³æ³¨çš„ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„å®šä½é—®é¢˜ã€‚</p><p><img src="https://s2.loli.net/2023/08/02/vweWVR8fkJgrSMI.png" alt="image.png"><br><img src="https://s2.loli.net/2023/08/02/S2DNUb768rJRMLm.png" alt="image.png"><br><img src="https://s2.loli.net/2023/08/02/8Byvq4LXtACoIg5.png" alt="image.png"></p><blockquote><p>æœ¬æ–‡é‡ç‚¹ä¸åœ¨äºæ­¤ï¼Œå…·ä½“ä»£ç å°±ä¸ä»”ç»†åˆ†æäº†ã€‚</p></blockquote><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ç›‘æ§æ¶ˆè´¹æ˜¯å¦å­˜åœ¨é˜»å¡çš„æƒ…å†µï¼Œè¿™å‡ ä¸ªå†…éƒ¨é˜Ÿåˆ—æ˜¯éœ€è¦é‡ç‚¹ç›‘æ§çš„ï¼Œä¸€æ—¦ä»–ä»¬å‡ºç°å †ç§¯ï¼Œé‚£å°±ä¼šå‡ºç°æ¶ˆè´¹é˜»å¡ã€‚</p><p>å…¶å®è¿™äº›æ•°æ®éƒ½å¯ä»¥é€šè¿‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.apache.pulsar.client.api.ProducerStats</span><br><span class="line">org.apache.pulsar.client.api.ConsumerStats</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªæ¥å£è·å–åˆ°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å¤§éƒ¨åˆ†æŒ‡æ ‡ï¼Œåªæ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°æ’æ›²ã€‚</p><p>é‚£å°±æ˜¯åœ¨è·å–æ¶ˆè´¹è€…é˜Ÿåˆ—å¤§å°çš„æ—¶å€™ï¼Œè·å–åˆ°çš„æ•°æ®ä¸€ç›´ä¸ºç©ºã€‚</p><p>æœ€ç»ˆç»è¿‡æºç æ’æŸ¥ï¼ŒåŸæ¥æ˜¯æˆ‘ä»¬å¤§é‡ä½¿ç”¨çš„ <code>messageListener</code> åœ¨è·å–é˜Ÿåˆ—å¤§å°æ—¶æœ‰ bugï¼Œå¯¼è‡´è·å–åˆ°çš„æ•°æ®ä¸€ç›´éƒ½ä¸º 0.</p><p>ç›¸å…³çš„ issue å’Œ PR å¯ä»¥åœ¨è¿™ä¸¤ä¸ªé“¾æ¥æŸ¥çœ‹ï¼Œé—®é¢˜åŸå› å’Œä¿®å¤è¿‡ç¨‹éƒ½æœ‰å…·ä½“æè¿°ï¼š<br><a href="https://github.com/apache/pulsar/issues/20076">https://github.com/apache/pulsar/issues/20076</a><br><a href="https://github.com/apache/pulsar/pull/20245">https://github.com/apache/pulsar/pull/20245</a></p><blockquote><p>ä½†è¿™ä¸ªä¿®å¤å¾—åœ¨æ–°ç‰ˆæœ¬æ‰èƒ½ä½¿ç”¨ï¼Œå°±å¯¼è‡´æˆ‘ä»¬ç°åœ¨çš„ç›‘æ§é¡µé¢ä¸€ç›´æ˜¾ç¤ºä¸ºç©ºã€‚</p></blockquote><h1 id="å¼€å‘-SkyWalking-æ’ä»¶"><a href="#å¼€å‘-SkyWalking-æ’ä»¶" class="headerlink" title="å¼€å‘ SkyWalking æ’ä»¶"></a>å¼€å‘ SkyWalking æ’ä»¶</h1><p>ç„¶åå°±æ˜¯å¼€å‘ä¸€ä¸ª <code>SkyWalking</code> çš„æ’ä»¶äº†ï¼Œå…¶å®ç›´æ¥ä½¿ç”¨ SW å¼€å‘æ’ä»¶æ˜¯ä¸Šæ‰‹ <code>Java-Agent</code> æ¯”è¾ƒå¿«çš„æ–¹å¼ã€‚</p><p><code>SW</code> çš„ SDK å°è£…äº†è®¸å¤š <code>agent</code> åŸç”Ÿæ¥å£ï¼Œä½¿å¾—å¼€å‘èµ·æ¥éå¸¸å®¹æ˜“ï¼›å½“ç„¶ç¼ºç‚¹ä¹Ÿæœ‰ï¼Œå°±æ˜¯å¾—é›†æˆæ•´ä¸ª <code>SW</code> çš„ <code>agent</code>ã€‚</p><p>è¿™é‡Œæˆ‘ç®€å•ä»‹ç»ä¸‹è¿™ä¸ªæ’ä»¶çš„è¿è¡Œæµç¨‹ï¼š<br><img src="https://s2.loli.net/2023/08/02/tW8QSqdU1yZf25A.png" alt="image.png"></p><ul><li>åœ¨åˆ›å»ºå’Œåˆ é™¤ consumer çš„æ—¶å€™ç»´æŠ¤ consumerPool</li><li>å¯åŠ¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå®šæœŸä»è¿™äº› consumer ä¸­è·å–æŒ‡æ ‡æ•°æ®ã€‚<br><img src="https://s2.loli.net/2023/08/02/ndhi3yH7CzS9FLA.png" alt="image.png"><br><img src="https://s2.loli.net/2023/08/02/WtZNTClh8Y3wj1F.png" alt="image.png"></li></ul><blockquote><p>å½“æ¶ˆè´¹å¤šåˆ†åŒº topic æ—¶ï¼Œä¸ºäº†èƒ½å”¯ä¸€æ ‡å¿—ä¸€ä¸ª consumerï¼Œæ‰€ä»¥ç»™æ¯ä¸ªæ¶ˆè´¹è€…éƒ½åŠ äº†ä¸€ä¸ª hashcode çš„ labelã€‚</p></blockquote><p>å› ä¸ºæˆ‘ä»¬æ‰€æœ‰çš„ Java æŠ€æœ¯æ ˆéƒ½æ˜¯ä½¿ç”¨çš„ <code>Prometheus</code> çš„åŒ…æ¥ç”Ÿæˆ <code>metrics</code> ï¼Œæ‰€ä»¥è¯¥æ’ä»¶ä¹Ÿæ˜¯ä½¿ç”¨è¯¥åŒ…ç”Ÿæˆçš„æ•°æ®ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.prometheus<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>simpleclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸ºäº†å…¼å®¹ä¸€äº›ç‰¹æ®Š Java åº”ç”¨æ²¡æœ‰è¯¥åŒ…æ—¶ä¼šå¯åŠ¨æŠ¥é”™ï¼Œæ‰€ä»¥åœ¨åˆå§‹åŒ–æ’ä»¶çš„æ—¶å€™éœ€è¦æ£€æµ‹å½“å‰ <code>classpath</code> ä¸‹æ˜¯å¦å­˜åœ¨è¯¥ä¾èµ–ã€‚</p><p><img src="https://s2.loli.net/2023/08/02/IBwdhH9b1tc8aoE.png" alt="image.png"></p><p>è¿™äº›åŠŸèƒ½ SW å·²ç»å°è£…å¥½äº†ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´ä¹Ÿæ˜¯å¼€ç®±å³ç”¨ã€‚</p><blockquote><p>å…¶å® SW æ’ä»¶è‡ªå·±ä¹Ÿæ˜¯æ”¯æŒ metrics çš„ï¼Œç”±äºæˆ‘ä»¬åªæ˜¯ä½¿ç”¨äº†å®ƒçš„ trace åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™é‡Œå°±æ²¡æœ‰ä½¿ç”¨å®ƒçš„ APIã€‚</p></blockquote><p>å…³äºå¼€å‘ä¸€ä¸ª SW æ’ä»¶çš„æµç¨‹ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£æˆ–è€…æ˜¯ä¸€äº›ç°æˆçš„æ’ä»¶æºç ã€‚<br><a href="https://skywalking.apache.org/docs/skywalking-java/next/en/setup/service-agent/java-agent/java-plugin-development-guide/">https://skywalking.apache.org/docs/skywalking-java/next/en/setup/service-agent/java-agent/java-plugin-development-guide/</a></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ‰äº†è¿™ä¸ªç›‘æ§é¢æ¿åï¼Œå¯¹äº Pulsar å®¢æˆ·ç«¯å†…éƒ¨çš„ä¸€äº›è¿è¡Œæƒ…å†µå°±ä¸å†æ˜¯é»‘ç›’äº†ï¼Œè¿˜å¯ä»¥åŸºäºæ­¤åšä¸€äº›æŠ¥è­¦ï¼Œæ¯”å¦‚æ¶ˆè´¹å †ç§¯ã€å‘é€å»¶è¿Ÿè¿‡å¤§ç­‰ã€‚</p><p>å½“ç„¶ä»…ä»…åªæœ‰è¿™ä¸ªé¢æ¿ä¾ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œåç»­æˆ‘ä»¬åˆå¼€å‘äº†å¯ä»¥é€šè¿‡ <code>messageId</code> æŸ¥è¯¢å®ƒçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ä¿¡æ¯</li><li>æ¶ˆæ¯ç”Ÿäº§æ—¶é—´</li><li>æ¨é€æ—¶é—´</li><li>ack æ—¶é—´ç­‰</li></ul><p><img src="https://s2.loli.net/2023/08/02/H7pjinzQ5EWR2tF.png" alt="image.png"></p><p>åŒæ—¶å€ŸåŠ©ä¸ Pulsar-SQL çš„èƒ½åŠ›ï¼Œè¿˜èƒ½ä»¥åˆ—è¡¨çš„å½¢å¼å±•ç¤ºå½“å‰ topic çš„æ¶ˆæ¯åˆ—è¡¨ã€‚<br><img src="https://s2.loli.net/2023/08/02/l9uvSnqAOxfPer7.png" alt="image.png"><br>å½“ç„¶åœ¨å®ç°è¿™ä¸¤ä¸ªåŠŸèƒ½çš„åŒæ—¶ä¹Ÿè¸©äº†ä¸å°‘å‘ï¼Œæäº†å‡ ä¸ª PR ï¼Œåé¢åœ¨æŠ½æ—¶é—´åšå…·ä½“çš„åˆ†äº«ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/08/02/GipDPSlbycQxqFd.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;#Blog #Pulsar &lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´ä¸šåŠ¡å›¢é˜Ÿå¶å°”ä¼šç¢°åˆ°ä¸€äº› Pulsar ä½¿ç”¨çš„é—®é¢˜ï¼Œæ¯”å¦‚æ¶ˆæ¯é˜»å¡ä¸æ¶ˆè´¹äº†ã€ç”Ÿäº§è€…æ¶ˆæ¯å‘é€ç¼“æ…¢ç­‰å„ç§é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶æˆ‘ä»¬æœ‰ä¸ªç›‘æ§é¡µé¢å¯ä»¥æ ¹æ® topic ç»´åº¦æŸ¥çœ‹ä»–çš„å‘é€çŠ¶æ€ï¼Œæ¯”å¦‚é€Ÿç‡ã€æµé‡ã€æ¶ˆè´¹çŠ¶æ€ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/categories/Pulsar/"/>
    
    
    <category term="Metrics" scheme="http://crossoverjie.top/tags/Metrics/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ ChatGPT ç¢°åˆ°çš„å‘</title>
    <link href="http://crossoverjie.top/2023/07/18/ob/ChatGPT-hole/"/>
    <id>http://crossoverjie.top/2023/07/18/ob/ChatGPT-hole/</id>
    <published>2023-07-18T03:47:52.000Z</published>
    <updated>2023-09-15T18:42:21.016Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/07/14/YtqXVJmfNokCwyE.png"></p><p>æœ€è¿‘åœ¨ä½¿ç”¨ ChatGPT çš„æ—¶å€™ç¢°åˆ°ä¸€ä¸ªå°å‘ï¼Œå› ä¸ºæŸäº›ç‰¹æ®Šæƒ…å†µæˆ‘éœ€è¦ä½¿ç”¨ <code>syslog</code> å‘ <code>logbeat</code> ä¸­å‘é€æ—¥å¿—ã€‚</p><p>ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤è€çš„åè®®ï¼Œç¡®å®ä¹Ÿæ²¡æ¥è§¦è¿‡ï¼Œæ‰€ä»¥å°±æƒ³ç€è®© ChatGPT å¸®æˆ‘ç”Ÿæˆä¸ªä¾‹å­ã€‚</p><span id="more"></span><p>åŸæœ¬æˆ‘å·²ç»åœ¨  Go  ä¸­å°†è¿™ä¸ªæµç¨‹è·‘é€šï¼Œæ‰€ä»¥å…¶å®åªéœ€è¦å°†ä»£ç è½¬æ¢ä¸º Java å°±å¯ä»¥äº†ï¼Œè¿™ä¸ªæˆ‘è¿˜æ˜¯å¾ˆä¿¡ä»» <code>ChatGPT</code> çš„ï¼›</p><blockquote><p>ç°åœ¨æˆ‘æŒºå¤šç»“æ„åŒ–æ•°æ®çš„è½¬æ¢éƒ½äº¤ç»™äº† ChatGPTï¼Œçœå»äº†ä¸å°‘å°å·¥å…·ã€‚</p></blockquote><p>äºæ˜¯ä¾¿æœ‰äº†è¿™æ®µå¯¹è¯ï¼š<br><img src="https://s2.loli.net/2023/07/17/6MHlRKOtZ2rJocd.png" alt="image.png"><br><img src="https://s2.loli.net/2023/07/17/SzCGBuiN6AvR7Zo.png" alt="image.png"><br>çœ‹èµ·æ¥æŒºæ­£å¸¸çš„ï¼Œæˆ‘é‚£è¿‡æ¥æ”¹æ”¹ç¡®å®ä¹Ÿèƒ½ç”¨ã€‚</p><hr><p>ç›´åˆ°å¿«ä¸Šçº¿çš„æ—¶å€™ï¼Œæˆ‘å‘ç°ä¸€äº›å…ƒä¿¡æ¯ä¸¢å¤±äº†ï¼Œæ¯”å¦‚æ—¥å¿—ç”Ÿäº§è€…çš„ <code>hostname, PID</code> ç­‰ï¼Œç„¶è€Œè¿™ä¸ªä¿¡æ¯åœ¨ Go å´æ²¡æœ‰ä¸¢å¤±ã€‚</p><p>äºæ˜¯æˆ‘åå¤è°ƒè¯•äº†ä¹‹å‰ç”Ÿæˆçš„ä»£ç ï¼Œä¾ç„¶æ²¡æœ‰æ‰¾åˆ°é—®é¢˜ã€‚</p><p>æ²¡åŠæ³•ï¼Œå°±åªæœ‰å»ç¿»ç¿» Go æºç ï¼Œæƒ³çœ‹çœ‹æœ€ç»ˆå‘å‡ºå»çš„æ•°æ®é•¿ä»€ä¹ˆæ ·å­ï¼Œæœ€åçœ‹åˆ°è¿™æ ·å‡ è¡Œä»£ç ï¼š<br><img src="https://s2.loli.net/2023/07/17/kJnoR4stKwYvCg8.png"><br><img src="https://s2.loli.net/2023/07/17/tOHvgx2ZzyrAEh9.png" alt="image.png"></p><p>è¿™æ ·ä¸€çœ‹å°±å¾ˆæ¸…æ™°äº†ï¼Œåªæ˜¯æŒ‰ç…§ <code>&lt;%d&gt;%s %s %s[%d]: %s%s</code> çš„æ ¼å¼å°†ç”Ÿæˆçš„å­—ç¬¦ä¸²é€šè¿‡ç½‘ç»œå‘é€å‡ºå»ã€‚</p><p>æ—¢ç„¶è¿™æ · Java ä»£ç ä¹Ÿå¾ˆå¥½å†™äº†:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(hostname,port);</span><br><span class="line">socket.setKeepAlive(<span class="literal">true</span>);</span><br><span class="line"><span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line"><span class="type">PrintWriter</span> <span class="variable">pw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(os, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">format</span> <span class="operator">=</span> String.format(<span class="string">&quot;&lt;%d&gt;%s %s %s[%d]: %s%s&quot;</span>, <span class="number">6</span> , rfc3164DateFormat.format(<span class="keyword">new</span> <span class="title class_">Date</span>()), <span class="string">&quot;test&quot;</span>, <span class="string">&quot;test&quot;</span>, <span class="number">0</span>, message, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">pw.println(format);</span><br></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•æ•°æ®ç»ˆäºå¯¹äº†ã€‚</p><p>ä¹‹åæˆ‘å°±åœ¨æƒ³è¿™ä¹ˆç®€å•çš„ä¸€ä¸ªé—®é¢˜ Google ä¸Šä¸å¯èƒ½æ²¡æœ‰å§ï¼Œäºæ˜¯ç›´æ¥æœç´¢äº† <code>Java syslog</code> å…³é”®å­—ï¼Œç»“æœç›´æ¥å°±æœ‰ä¸€ä¸ªç°æˆçš„åº“ã€‚<br><img src="https://s2.loli.net/2023/07/17/Fm6XBnOdxQ9PAKY.png"></p><p><img src="https://s2.loli.net/2023/07/17/c7PCjmZnboReQtp.png"></p><p>è€Œä¸”å®ç°ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚</p><p>æˆ‘ç›¸ä¿¡åº”è¯¥æœ‰ä¸å°‘æœ‹å‹ä¹Ÿæœ‰è¢« ChatGPT ä¸€æœ¬æ­£ç»çš„èƒ¡è¯´å…«é“è¯¯å¯¼è¿‡ï¼Œè‡³å°‘åœ¨å½“å‰çš„ç¯å¢ƒä¸‹ä¸€äº›ç®€å•çš„ä¸œè¥¿æˆ‘è¿˜æ˜¯å†³å®šä¼˜å…ˆ <code>Google</code>ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/07/14/YtqXVJmfNokCwyE.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åœ¨ä½¿ç”¨ ChatGPT çš„æ—¶å€™ç¢°åˆ°ä¸€ä¸ªå°å‘ï¼Œå› ä¸ºæŸäº›ç‰¹æ®Šæƒ…å†µæˆ‘éœ€è¦ä½¿ç”¨ &lt;code&gt;syslog&lt;/code&gt; å‘ &lt;code&gt;logbeat&lt;/code&gt; ä¸­å‘é€æ—¥å¿—ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤è€çš„åè®®ï¼Œç¡®å®ä¹Ÿæ²¡æ¥è§¦è¿‡ï¼Œæ‰€ä»¥å°±æƒ³ç€è®© ChatGPT å¸®æˆ‘ç”Ÿæˆä¸ªä¾‹å­ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ChatGPT" scheme="http://crossoverjie.top/categories/ChatGPT/"/>
    
    
    <category term="Go" scheme="http://crossoverjie.top/tags/Go/"/>
    
    <category term="Syslog" scheme="http://crossoverjie.top/tags/Syslog/"/>
    
  </entry>
  
  <entry>
    <title>Grafana å˜é‡è½¬ä¹‰å¤„ç†</title>
    <link href="http://crossoverjie.top/2023/06/26/k8s/grafana-variable/"/>
    <id>http://crossoverjie.top/2023/06/26/k8s/grafana-variable/</id>
    <published>2023-06-26T00:08:08.000Z</published>
    <updated>2023-09-15T18:42:21.015Z</updated>
    
    <content type="html"><![CDATA[<p>Grafana æ˜¯ä¸€æ¬¾å¼ºå¤§çš„å¯è§†åŒ–å·¥å…·ï¼Œä¸æ­¢æ˜¯ç”¨äº Prometheus åšæ•°æ®æºï¼Œè¿˜å¯ä»¥é›†æˆæ•°æ®åº“ã€æ—¥å¿—ç­‰ä½œä¸ºæ•°æ®æºæ•´ä½“ä½¿ç”¨ã€‚</p><p>æœ€è¿‘æˆ‘åœ¨é…ç½®ä¸€ä¸ªç›‘æ§é¢æ¿ï¼Œå…¶ä¸­çš„æ•°æ®ç”± Prometheus å’Œ MySQL ç»„æˆï¼›ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªæŒ‡æ ‡çš„æŸ¥è¯¢æ¡ä»¶æ˜¯ä»æ•°æ®åº“ä¸­æ¥çš„ã€‚</p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pulsar_subscription_back_log_no_delayed&#123;topic=~&quot;$topic&quot;,subscription=~&quot;$subscription&quot;&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ topic æ•°æ®æ˜¯ä»  MySQL ä¸­æ¥çš„ï¼Œå…¶å®å°±æ˜¯åœ¨ Grafana å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œä»æ•°æ®åº“è¿”å›äº†ä¸€ä¸ªåˆ—è¡¨ã€‚</p><p><img src="https://s2.loli.net/2023/06/25/OE37acurFIQjVNH.png"></p><p>å› ä¸ºæˆ‘ä»¬çš„æŸ¥è¯¢æ¡ä»¶æ˜¯ <code>topic=~&quot;$topic&quot;</code>æ˜¯æ­£åˆ™åŒ¹é…ï¼Œæ‰€ä»¥ç†è®ºä¸Šåº”è¯¥æŠŠæ‰€æœ‰çš„ <code>topic</code> å…³è”çš„æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥ã€‚</p><p><img src="https://s2.loli.net/2023/06/25/WMetKBAvg24hzZk.png"></p><p>ä½†å®é™…æƒ…å†µæ˜¯ä»»ä½•æ•°æ®éƒ½æŸ¥ä¸åˆ°ã€‚</p><p>æŸ¥çœ‹å‘å‡ºå»çš„åŸå§‹è¯·æ±‚åæ‰å‘ç°é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼š</p><p><img src="https://s2.loli.net/2023/06/25/AUXs9lnHoYMQjhO.png"></p><p>åŸæ¥æ˜¯é€‰æ‹©æ‰€æœ‰ topic å grafana ä¼š~~~~è‡ªåŠ¨å¯¹å‚æ•°è½¬ä¹‰ï¼Œè¿™ä¸ªæˆ‘æŸ¥äº†å¥½å¤šèµ„æ–™åŒ…æ‹¬å’¨è¯¢ ChatGPT éƒ½æ²¡æœ‰å¾—åˆ°è§£å†³ã€‚</p><p>ç»è¿‡å¤šæ¬¡æµ‹è¯•ï¼Œå‘ç°åªè¦å¼€å¯å¤šé€‰ grafana å°±ä¼šè‡ªåŠ¨è½¬ä¹‰ã€‚<br><img src="https://s2.loli.net/2023/06/25/ao51AysPEeiTQNr.png"></p><p>æœ€åæˆ‘åªèƒ½æƒ³åˆ°ä¸€ä¸ªä¸éœ€è¦ç”Ÿæˆå¤šè¡Œè®°å½•çš„åŠæ³•ï¼šå°†æ‰€æœ‰æ•°æ®åˆå¹¶æˆä¸€æ¡è®°å½•ã€‚</p><p><img src="https://s2.loli.net/2023/06/25/o7Xaf3NKD1rystn.png"></p><p>è¿™æ ·çš„è¯å°±åªä¼šç”Ÿæˆä¸€æ¡æ•°æ®ï¼Œå…¶ä¸­åŒ…å«äº†æ‰€æœ‰çš„ topicï¼Œä¹Ÿå°±é¿å…äº†è¢«è½¬ä¹‰ã€‚</p><blockquote><p>SQL ä¸­çš„ CONCAT å‡½æ•°å…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆä½¿ç”¨ï¼Œè¿˜æ˜¯ ChatGPT å‘Šè¯‰æˆ‘çš„ã€‚</p></blockquote><p><img src="https://s2.loli.net/2023/06/25/InPYWyiqAL1xRfK.png"></p><p>æœ€åä¾¿èƒ½å®Œç¾çš„æŸ¥è¯¢å‡ºæ•°æ®äº†ã€‚</p><p>æœ‰ç¢°åˆ°ç±»ä¼¼é—®é¢˜çš„æœ‹å‹å¯ä»¥å°è¯•è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä¼°è®¡ç”¨åˆ°è¿™ä¸ªåœºæ™¯çš„å¹¶ä¸å¤šï¼Œä¸ç„¶ ChatGPT ä¹Ÿä¸ä¼šä¸çŸ¥é“ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Grafana æ˜¯ä¸€æ¬¾å¼ºå¤§çš„å¯è§†åŒ–å·¥å…·ï¼Œä¸æ­¢æ˜¯ç”¨äº Prometheus åšæ•°æ®æºï¼Œè¿˜å¯ä»¥é›†æˆæ•°æ®åº“ã€æ—¥å¿—ç­‰ä½œä¸ºæ•°æ®æºæ•´ä½“ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æˆ‘åœ¨é…ç½®ä¸€ä¸ªç›‘æ§é¢æ¿ï¼Œå…¶ä¸­çš„æ•°æ®ç”± Prometheus å’Œ MySQL ç»„æˆï¼›ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªæŒ‡æ ‡çš„æŸ¥è¯¢æ¡ä»¶æ˜¯ä»æ•°æ®åº“ä¸­æ¥çš„ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="cloudnative" scheme="http://crossoverjie.top/categories/cloudnative/"/>
    
    
    <category term="Grafana" scheme="http://crossoverjie.top/tags/Grafana/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨è¿™ä¸ªå¤§ç¯å¢ƒä¸‹æˆ‘æ˜¯å¦‚ä½•æ‰¾å·¥ä½œçš„</title>
    <link href="http://crossoverjie.top/2023/06/20/personal/find-job-experience/"/>
    <id>http://crossoverjie.top/2023/06/20/personal/find-job-experience/</id>
    <published>2023-06-19T17:10:12.000Z</published>
    <updated>2023-09-15T18:42:20.879Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/06/19/SQP9LxtXNhGwyev.png"><br>è›®ä¹…æ²¡æ›´æ–°äº†ï¼Œæœ¬æ¬¡æˆ‘æƒ³èŠèŠæ‰¾å·¥ä½œçš„äº‹æƒ…ï¼Œç›¸ä¿¡å¤§å®¶éƒ½èƒ½æ„Ÿå—åˆ°ä»å»å¹´å¼€å§‹åˆ°ç°åœ¨å¸‚åœºæ˜¯ä¸€å¤©æ¯”ä¸€å¤©å·®ï¼Œç‰¹åˆ«æ˜¯åœ¨æˆ‘ä»¬äº’è”ç½‘ IT è¡Œä¸šã€‚<br>å·²ç»è¿‡äº† 18 å¹´ä¹‹å‰çš„é«˜é€Ÿå‘å±•çš„çº¢åˆ©æœŸï¼Œèƒ½åšçš„äº’è”ç½‘åº”ç”¨å‡ ä¹å·²ç»è¢«å„å¤§å…¬å¸åšäº†ä¸ªéï¼Œç°åœ¨å·²ç»è¿›å…¥ç¨³å®šçš„å­˜é‡å¸‚åœºï¼Œæ‰€ä»¥åœ¨è¿™æ ·çš„å¤§èƒŒæ™¯ä¸‹å†åŠ ä¸Šå…¨ä¸–ç•ŒèŒƒå›´å†…çš„ç»æµä¸æ™¯æ°”æˆ‘æƒ³æ¯ä¸ªäººéƒ½èƒ½æ„Ÿå—åˆ°å¯’æ„ã€‚</p><p>æˆ‘è¿˜è®°å¾—å¤§çº¦åœ¨ 20 å¹´çš„æ—¶å€™çœ‹åˆ°ç½‘ä¸Šç»å¸¸è¯´çš„ä¸€å¥è¯ï¼šä»Šå¹´å°†æ˜¯æœªæ¥åå¹´æœ€å¥½çš„ä¸€å¹´ã€‚</p><p>ç”±äºå½“æ—¶æˆ‘æ‰€åœ¨çš„å…¬å¸ä¸šåŠ¡å‘å±•è¿˜æ¯”è¾ƒé¡ºåˆ©ï¼Œä¸æ¯«æ²¡æœ‰å±æœºæ„è¯†ï¼Œå¯¹è¿™ç§è¨€è®ºæ€»æ˜¯å—¤ä¹‹ä»¥é¼»ï¼Œç›´åˆ°å»å¹´å›½åº†èŠ‚é™„è¿‘ã€‚</p><span id="more"></span><p>è™½ç„¶æˆ‘ä»¬åšçš„æ˜¯æµ·å¤–ä¸šåŠ¡ï¼Œä½†æ˜¯å½“æ—¶å—åˆ°å„æ–¹é¢çš„åŸå› å…¬å¸çš„ä¸šåŠ¡ä¹Ÿæé€Ÿæ”¶ç¼©ï¼ˆè¢«æ”¶è´­ï¼Œèµ„æœ¬ä¸çœ‹å¥½ï¼‰ï¼Œæ‰€ä»¥å…¬å¸ä¸å¾—ä¸è¿›è¡Œè£å‘˜ï¼›<br>å…¶å®åˆ°æˆ‘è¿™é‡Œçš„æ—¶å€™å‰é¢å·²ç»å¤§æ¦‚æœ‰ 2ï½3 æ³¢çš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬æ˜¯æœ€åä¸€æ³¢ï¼Œå‡ ä¹ç­‰äºæ˜¯å…¨å†›è¦†æ²¡ï¼Œåªç•™ä¸‹å°‘æ•°çš„äººç»´æŠ¤ç°æœ‰ç³»ç»Ÿã€‚</p><p>è¿™å®¶å…¬å¸ä¹Ÿæ˜¯æˆ‘å·¥ä½œè¿™ä¹ˆå¤šå¹´æ¥å°‘æ•°èƒ½æ„Ÿå—åˆ°äººæƒ…å‘³çš„å…¬å¸ï¼Œè™½æœ‰ä¸èˆï¼Œä½†ç°å®çš„æ®‹é…·å¹¶ä¸æ˜¯ç”±æˆ‘ä»¬ä¸ªäººæ‰€å†³å®šçš„ã€‚</p><p>ä¹‹åä¾¿å¼€å§‹æ¼«é•¿çš„æ‰¾å·¥ä½œä¹‹æ—…ï¼Œåˆ°ç°åœ¨ä¹Ÿå·²ç»å…¥èŒåŠå¹´å¤šäº†ï¼›æœ€è¿‘çœ‹åˆ°èº«è¾¹æœ‹å‹ä»¥åŠç½‘ä¸Šçš„ä¸€äº›ä¿¡æ¯ï¼Œå¾€å¾€æ˜¯åæ¶ˆæ¯å¤šäºå¥½æ¶ˆæ¯ã€‚</p><p>å¸‚åœºç»å†åŠå¹´å¤šçš„æ—¶é—´ï¼Œè£å‘˜çš„å…¬å¸åè€Œå¢å¤šï¼Œå²—ä½ä¹Ÿè¶Šæ¥è¶Šå°‘ï¼Œæ‰€ä»¥åˆ°ç°åœ¨ä¸ç®¡æ˜¯åœ¨èŒè¿˜æ˜¯ç¦»èŒçš„æœ‹å‹æˆ–å¤šæˆ–å°‘éƒ½æœ‰æ‰€ç„¦è™‘ï¼Œæˆ‘ä¹Ÿè§‰å¾—æœ‰å¿…è¦åˆ†äº«ä¸€ä¸‹æˆ‘çš„ç»å†ã€‚</p><h1 id="æˆ‘çš„é¢„æœŸç›®æ ‡"><a href="#æˆ‘çš„é¢„æœŸç›®æ ‡" class="headerlink" title="æˆ‘çš„é¢„æœŸç›®æ ‡"></a>æˆ‘çš„é¢„æœŸç›®æ ‡</h1><p>ä¸‹é¢é‡ç‚¹èŠèŠæ‰¾å·¥ä½œçš„äº‹æƒ…ï¼›å…¶å®åˆšå¼€å§‹å¾—çŸ¥è¦æ‰¾å·¥ä½œçš„æ—¶å€™æˆ‘å¹¶ä¸æ˜¯ç‰¹åˆ«æ…Œï¼Œå› ä¸ºå½“æ—¶æ‰‹ä¸Šæœ‰éƒ¨åˆ†ç§¯è“„åŠ ä¸Šå…¬å¸æœ‰ N+1 çš„èµ”å¿ï¼ŒåŒæ—¶å»å¹´ 10 æœˆä»½çš„æ—¶å€™å²—ä½ç›¸å¯¹äºç°åœ¨è¿˜æ˜¯è¦å¤šä¸€äº›ã€‚</p><p>æ‰€ä»¥æˆ‘å½“æ—¶çš„ç›®æ ‡æ˜¯èŠ±ä¸€ä¸ªæœˆçš„æ—¶é—´æ‰¾ä¸€ä¸ªæˆ‘è§‰å¾—é è°±çš„å·¥ä½œï¼Œè‡³å°‘èƒ½é•¿æœŸç¨³å®šçš„å·¥ä½œ 3 å¹´ä»¥ä¸Šã€‚</p><p>å·¥ä½œæ€§è´¨å¯ä»¥æ˜¯çº¯ç ”å‘æˆ–è€…æ˜¯åç®¡ç†å²—éƒ½å¯ä»¥ï¼Œç»“åˆæˆ‘ä¸ªäººçš„å…´è¶£çº¯ç ”å‘å²—çš„è¯æˆ‘å¸Œæœ›æ˜¯å¯ä»¥åšçº¯æŠ€æœ¯æ€§è´¨çš„å·¥ä½œï¼Œç›¸ä¿¡å¤§éƒ¨åˆ†åšä¸šåŠ¡ç ”å‘çš„æœ‹å‹éƒ½å¸Œæœ›èƒ½åšä¸€äº›çœ‹ä¼¼â€œé«˜å¤§ä¸Šâ€çš„å†…å®¹ã€‚<br>è¿™ä¸€ç‚¹æˆ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œæ‰€ä»¥ä¸­é—´ä»¶å°±å’Œäº‘ç›¸å…³çš„å†…å®¹å°±æ˜¯æˆ‘çš„ç›®æ ‡ã€‚</p><p>ä¸è¿‡è¿™ç‚¹åœ¨é‡åº†è¿™ä¸ªå¤§æ´¼åœ°ä¸­å¾ˆéš¾æ‰¾åˆ°å¯¹å£å·¥ä½œï¼Œæ‰€ä»¥æˆ‘çš„ç¬¬äºŒç›®æ ‡æ˜¯æŠ€æœ¯ leaderï¼Œæˆ–è€…è¯´æ˜¯æ ¸å¿ƒä¸»ç¨‹ä¹‹ç±»çš„ï¼Œæ¯•ç«Ÿè€ƒè™‘åˆ° 3 å¹´åæˆ‘ä¹Ÿ 30+ äº†ï¼Œå¦‚æœèƒ½å†ç§¯ç´¯å‡ å¹´çš„ç®¡ç†ç»éªŒåç»­çš„è·¯ä¼šæ›´å¥½èµ°ä¸€äº›ã€‚</p><p>å½“ç„¶è¿˜æœ‰ç¬¬ä¸‰ä¸ªé€‰é¡¹å°±æ˜¯è¿œç¨‹ï¼Œä¸è¿‡è¿œç¨‹çš„å²—ä½æ›´å°‘ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å’Œ web3ï¼ŒåŒºå—é“¾ç›¸å…³çš„å·¥ä½œï¼›æˆ‘å¯¹è¿™å—ä¸€ç›´æ¯”è¾ƒè°¨æ…æ‰€ä»¥ä¹Ÿæ²¡æ·±å…¥äº†è§£ã€‚</p><h1 id="æ‰¾å·¥ä½œæµæ°´è´¦"><a href="#æ‰¾å·¥ä½œæµæ°´è´¦" class="headerlink" title="æ‰¾å·¥ä½œæµæ°´è´¦"></a>æ‰¾å·¥ä½œæµæ°´è´¦</h1><p>å› ä¸ºæˆ‘ä»å…¥èŒè¿™å®¶å…¬å¸åˆ°ç°åœ¨å…¶å®è¿˜æ²¡å‡ºæ¥é¢è¯•è¿‡ï¼Œä¹Ÿä¸å¤ªçŸ¥é“å¸‚åœºè¡Œæƒ…ï¼Œæ‰€ä»¥æˆ‘çš„æƒ³æ³•æ˜¯å…ˆæ‰¾å‡ å®¶è‡ªå·±ä¸æ˜¯éå»ä¸å¯çš„å…¬å¸ç»ƒç»ƒæ‰‹ã€‚</p><blockquote><p>æœ‰ä¸€ä¸ªæˆ‘ä¸ªäººçš„åå¥½å¿˜è®°è®²åˆ°ï¼Œå› ä¸ºæœ€è¿‘çš„ä¸€æ®µæ—¶é—´å†™ Go ä¼šå¤šä¸€äº›ï¼Œæ‰€ä»¥æˆ‘ä¼˜å…ˆçœ‹çš„æ˜¯ Go ç›¸å…³çš„å²—ä½ã€‚</p></blockquote><h2 id="ç¬¬ä¸€å®¶"><a href="#ç¬¬ä¸€å®¶" class="headerlink" title="ç¬¬ä¸€å®¶"></a>ç¬¬ä¸€å®¶</h2><p>é¦–å…ˆç¬¬ä¸€å®¶æ˜¯ä¸€ä¸ª ToB æ•™è‚²è¡Œä¸šçš„å…¬å¸ï¼Œå¤§æ¦‚çš„èƒŒæ™¯æ˜¯åœ¨é‡åº†æ–°æˆç«‹çš„ç ”å‘ä¸­å¿ƒï¼ŒæŠ€æœ¯æ ˆä¹Ÿæ˜¯ Goï¼›</p><p>æˆ‘ç°åœ¨è¿˜è®°å¾—æœ€åä¸€è½®æˆ‘é—®ç ”å‘è´Ÿè´£äººå½“åˆä¸ºå•¥é€‰ Goï¼Œä»–çš„å›ç­”æ˜¯ï¼š</p><blockquote><p>Java é‚£ç§è‡ƒè‚¿çš„è¯­è¨€æˆ‘ä»¬é¦–å…ˆå°±ä¸è€ƒè™‘ï¼ŒPHP ä¹Ÿæ—¥è½è¥¿å±±ï¼Œæœªæ¥ä¸€å®šä¼šæ˜¯ Go çš„å¤©ä¸‹ã€‚</p></blockquote><p>ç”±äºæ˜¯æ–°æˆç«‹çš„å›¢é˜Ÿï¼Œå¯¹æ–¹å‘ç°æˆ‘ä¹‹å‰æœ‰ç®¡ç†ç›¸å…³çš„ç»éªŒï¼ŒåŠ ä¸Šé¢è¯•å°è±¡ï¼Œæ‰€ä»¥æ˜¯æœŸæœ›æˆ‘è¿‡å»èƒ½åšé‡åº†ç ”å‘ Leaderã€‚</p><p>ä¸ºæ­¤è¿˜ç‰¹åœ°å¸®æˆ‘ç”³è¯·äº†è–ªèµ„è°ƒæ•´ï¼Œå› ä¸ºæˆ‘ä¹‹å‰å¹²è¿‡ ToB ä¸šåŠ¡ï¼Œæ‰€ä»¥æˆ‘å¤§æ¦‚æ¸…æ¥šå…¶ä¸­çš„æµç¨‹ï¼Œè¿™ç§ç¡®å®å¾—é¢†å¯¼ç‰¹æ‰¹ï¼Œæ‰€ä»¥æœ€åè™½ç„¶æ²¡æˆä½†ä¾ç„¶å¾ˆæ„Ÿè°¢å½“æ—¶çš„ HR å¸®æˆ‘å»æ²Ÿé€šã€‚</p><h2 id="ç¬¬äºŒå®¶"><a href="#ç¬¬äºŒå®¶" class="headerlink" title="ç¬¬äºŒå®¶"></a>ç¬¬äºŒå®¶</h2><p>ç¬¬äºŒå®¶ä¸»è¦æ˜¯åå¹´è½»äººçš„ C ç«¯äº§å“ï¼ŒæŠ€æœ¯æ ˆä¹Ÿæ˜¯ Goï¼›ç»™æˆ‘å°è±¡æ¯”è¾ƒæ·±çš„æ˜¯ï¼Œå»åˆ°å…¬å¸æ€ä¹ˆæŒ‰ç”µæ¢¯éƒ½ä¸çŸ¥é“ğŸ¤£</p><blockquote><p>ä»–ä»¬åŠå…¬å®¤åœ¨æˆ‘ä»¬è¿™é‡Œçš„ CBDï¼Œæˆ‘é•¿æœŸåœ¨æ”¿åºœèµåŠ©çš„äº§ä¸šå›­é‡Œå·¥ä½œç¡®å®å—åˆ°äº†å°å°çš„éœ‡æ’¼ï¼ŒåŠå…¬ç¯å¢ƒæ¯”è¾ƒå¥½ã€‚</p></blockquote><p>å½“ç„¶é¢è¯•è¿‡ç¨‹ç»™æˆ‘ç•™ä¸‹çš„å°è±¡ä¾ç„¶éå¸¸æ·±åˆ»ï¼Œæˆ‘ç°åœ¨ä¾ç„¶è®°å¾—æˆ‘åä¸‹åé¢è¯•å®˜ä¹Ÿå°±æ˜¯ CTO ç»™æˆ‘è¯´çš„ç¬¬ä¸€å¥è¯ï¼š</p><blockquote><p>æˆ‘çœ‹è¿‡ä½ çš„ç®€å†åå°±å†³å®šä»Šå¤©å’±ä»¬ä¸èŠæŠ€æœ¯è¯é¢˜äº†ï¼Œç›´æ¥èŠèŠå…¬å¸å±‚é¢å’Œä¸šåŠ¡ä¸Šæ˜¯å¦æ„Ÿå…´è¶£ï¼Œä»¥åŠè§£ç­”æˆ‘çš„ç–‘è™‘ï¼Œå› ä¸ºæˆ‘å·²ç»çœ‹è¿‡ä½ å†™çš„å¾ˆå¤šåšå®¢å’Œ GitHubï¼ŒæŠ€æœ¯èƒ½åŠ›æ–¹é¢æ¯”è¾ƒæ”¾å¿ƒã€‚</p></blockquote><p>ä¹‹åå°±æ˜¯å¸¸è§„æµç¨‹ï¼ŒèŠèŠå…¬å¸æƒ…å†µä¸ªäººæ„æ„¿ç­‰ã€‚</p><p>æœ€åæˆ‘ä¹Ÿé—®äº†ä¸ºä»€ä¹ˆé€‰ Goï¼Œè¿™ä½ CTO ç»™æˆ‘çš„å›ç­”å’Œä¸Šä¸€å®¶å·®ä¸å¤šğŸ˜‚</p><p>è™½ç„¶æœ€ç»ˆä¹Ÿæ²¡èƒ½å»æˆï¼Œä½†ä¹Ÿéå¸¸æ„Ÿè°¢è¿™ä½ CTOï¼Œä»–æ˜¯æˆ‘ç¢°åˆ°ä¸ºæ•°ä¸å¤šä¼šåœ¨é¢è¯•å‰è®¤çœŸçœ‹ä½ çš„ç®€å†ï¼Œåšå®¢å’Œ GitHub éƒ½ä¼šçœŸçš„ç‚¹è¿›å»ä»”ç»†é˜…è¯»ğŸ‘ğŸ¼ã€‚</p><blockquote><p>å…¶å®è¿™ä¸¤å®¶æˆ‘éƒ½æ²¡æ€ä¹ˆè®²æŠ€æœ¯ç»†èŠ‚ï¼Œå› ä¸ºç¡®å®æ²¡æ€ä¹ˆèŠè¿™éƒ¨åˆ†å†…å®¹ï¼›è¿™æ—¶å°±çªå‡ºç»´æŠ¤è‡ªå·±çš„æŠ€æœ¯åšå®¢å’Œ GitHub çš„ä¼˜åŠ¿äº†ï¼ŒæŠ€æœ¯åšå®¢æˆ‘ä» 16 å¹´åˆ°ç°åœ¨å†™äº†å¤§çº¦ 170 ç¯‡ï¼ŒGitHub ä¸Šå¼€æºè¿‡ä¸€äº›é«˜ star é¡¹ç›®ï¼Œä¹Ÿå‚ä¸è¿‡ä¸€äº›å¼€æºé¡¹ç›®ï¼Œè¿™äº›éƒ½æ˜¯æ²¡æœ‰å¤§å‚ç»å†çš„èƒŒä¹¦ï¼Œå¯¹æ‹›è˜è€…æ¥è¯´ä¹Ÿæ˜¯èŠ‚çº¦ä»–çš„æ—¶é—´ã€‚</p></blockquote><p><img src="https://s2.loli.net/2023/06/19/Hixaf5ZLTrS6EoR.png"><br><img src="https://s2.loli.net/2023/06/19/wRELfbKx5TYkB7z.png"></p><p>å½“ç„¶æœ‰å¥½å¤„è‡ªç„¶ä¹Ÿæœ‰â€œåå¤„â€ï¼Œè¿™ä¸ªåç»­ä¼šè®²åˆ°ã€‚</p><h2 id="ç¬¬ä¸‰å®¶"><a href="#ç¬¬ä¸‰å®¶" class="headerlink" title="ç¬¬ä¸‰å®¶"></a>ç¬¬ä¸‰å®¶</h2><p>ç¬¬ä¸‰å®¶æ˜¯æ‰¾æœ‹å‹æ¨èçš„ï¼Œåœ¨ä¸šç•Œç®—æ˜¯çŸ¥åçš„äº‘åŸç”ŸæœåŠ¡æä¾›å•†ï¼Œä¸»è¦åš ToB ä¸šåŠ¡ï¼›å› ä¸ºä¸»è¦æ˜¯å›´ç»•ç€ k8s ç¤¾åŒºç”Ÿæ€åšç ”å‘ï¼Œæ‰€ä»¥å°±æ˜¯çº¯æŠ€æœ¯çš„å·¥ä½œï¼Œé¢è¯•çš„æ—¶å€™ä¹Ÿä¼šé—®ä¸€äº›æŠ€æœ¯ç»†èŠ‚ã€‚</p><blockquote><p>æˆ‘è¿˜è®°å¾—æœ‰ä¸€è½® leader é¢ï¼Œä»–è¯´ä½ å…¥èŒåå·¥ä½œå†…å®¹å’Œä¹‹å‰å®Œå…¨ä¸åŒï¼Œç”šè‡³æ•°æ®åº“éƒ½ä¸éœ€è¦å®‰è£…äº†ã€‚</p></blockquote><p>æ•´ä½“å¤§æ¦‚ 5ã€6 è½®ï¼Œåé¢ä¸¤è½®éƒ½æ˜¯ BOSS é¢ï¼Œå‡ ä¹æ²¡æœ‰é—®æŠ€æœ¯é—®é¢˜ï¼Œä¸»è¦æ˜¯èŠèŠæˆ‘çš„ä¸ªäººé¡¹ç›®ã€‚</p><p>æˆ‘å¤§æ¦‚è®°å¾—ä¸€äº›æŠ€æœ¯é—®é¢˜ï¼š</p><ul><li>k8s ç›¸å…³çš„ä¸€äº›ç»„ä»¶ã€Operator</li><li>Go ç›¸å…³çš„æ”¾å°„ã€æ¥å£ã€å¦‚ä½•åŠ¨æ€ä¿®æ”¹ç±»å®ç°ç­‰ç­‰ã€‚</li><li>Java ç›¸å…³å°±æ˜¯ä¸€äº›å¸¸è§„çš„ï¼Œä¸»è¦æ˜¯ä¸€äº›å¸¸ç”¨ç‰¹æ€§å’Œ Go åšæ¯”è¾ƒï¼Œçœ‹çœ‹å¯¹è¿™ä¸¤é—¨è¯­è¨€çš„ç†è§£ã€‚</li></ul><p>å…¶å®è¿™å®¶å…¬å¸æ˜¯æ¯”è¾ƒå¸å¼•æˆ‘çš„ï¼Œå‡ ä¹å°±æ˜¯å›´ç»•ç€å¼€æºç¤¾åŒºåšç ”å‘ï¼Œå·¥ä½œä¸­å¤§éƒ¨åˆ†æ—¶é—´ä¹Ÿæ˜¯åœ¨åšå¼€æºé¡¹ç›®ï¼Œæ‰€ä»¥å¯ä»¥è¯´æ˜¯æŠŠæˆ‘ä¹‹å‰çš„ä¸šä½™çˆ±å¥½å’Œå·¥ä½œç»“åˆèµ·æ¥äº†ã€‚</p><p>åœ¨è´¡çŒ®å¼€æºç¤¾åŒºçš„åŒæ—¶è¿˜èƒ½æ”¶åˆ°å…¬å¸çš„ç°é‡‘å¥–åŠ±ï¼Œä¸å¯è°“æ˜¯åŒèµ¢ã€‚</p><p>å¯¹æˆ‘ä¸å¤ªå‹å¥½çš„æ˜¯å·¥ä½œåœ°åœ¨æˆéƒ½ï¼Œå…¥èŒåå¾—æˆæ¸ä¸¤åœ°è·‘ï¼›è€Œä¸”åœ¨æœ€ç»ˆå‘ offer çš„å‰ä¸¤å°æ—¶ï¼Œå…¬å¸çªç„¶åœæ­¢ HC äº†ï¼Œè¿™ç‚¹ç¡®å®æ²¡æƒ³åˆ°ï¼Œæ‰€ä»¥é˜´å·®é˜³é”™çš„æˆ‘ä¹Ÿæ²¡æœ‰å»æˆã€‚</p><h2 id="ç¬¬å››å®¶"><a href="#ç¬¬å››å®¶" class="headerlink" title="ç¬¬å››å®¶"></a>ç¬¬å››å®¶</h2><p>ç¬¬å››å®¶ä¹Ÿå°±æ˜¯æˆ‘ç°åœ¨å…¥èŒçš„å…¬å¸ï¼Œå½“æ—¶æ˜¯æˆ‘åœ¨æ‹›è˜ç½‘ç«™ä¸Šçœ‹åˆ°çš„å”¯ä¸€ä¸€å®¶åšä¸­é—´ä»¶çš„å²—ä½ï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„æ€åº¦æˆ‘å°±æŠ•äº†ã€‚<br>é¢è¯•è¿‡ç¨‹ä¹Ÿæ¯”è¾ƒé¡ºåˆ©ï¼Œä¸€è½®åŒäº‹é¢ï¼Œä¸€è½® Leader é¢ã€‚</p><p>æŠ€æœ¯ä¸Šä¹Ÿæ²¡æœ‰èŠå¤ªå¤šï¼Œåæ¥æˆ‘è‡ªå·±çŒœæµ‹å¤§æ¦‚ç‡ä¹Ÿå’Œæˆ‘çš„åšå®¢å’Œ Github æœ‰å…³ã€‚</p><hr><p>å½“ç„¶æ•´ä¸ªè¿‡ç¨‹ä¹Ÿæœ‰ä¸å¤ªå‹å¥½çš„ç»å†ï¼Œæ¯”å¦‚æœ‰ä¸€å®¶æˆéƒ½çš„â€œçŸ¥åâ€æ—…æ¸¸å…¬å¸ï¼›é¢è¯•çš„æ—¶å€™é‚£ä¸ªé¢è¯•å®˜ç»™æˆ‘çš„æ„Ÿè§‰æ˜¯å‹æ ¹æ²¡æœ‰çœ‹æˆ‘çš„ç®€å†ï¼Œæ‰€æœ‰çš„é—®é¢˜éƒ½æ˜¯åœ¨è¯»ä»–çš„ç¨¿å­ï¼Œæ ¹æœ¬æ²¡æœ‰ä¸Šä¸‹æ–‡è”ç³»ã€‚</p><p>è¿˜æœ‰ä¸€å®¶æ›´ç¦»è°±ï¼Œç›´æ¥åœ¨æ‹›è˜è½¯ä»¶ä¸Šå‘äº†ä¸€ä¸ªåŠ å¯†ç›¸å…³çš„ç®—æ³•ï¼Œè®©æˆ‘è§£é‡Šä¸‹ï¼›å› ä¸ºå½“æ—¶æˆ‘åœ¨å¤–è¾¹é€›è¡—ï¼Œæ‰€ä»¥æ²¡æœ‰æ³¨æ„åˆ°æ¶ˆæ¯ï¼›åæ¥åŠ ä¸Šå¾®ä¿¡åè¯´æˆ‘ä¸ºä»€ä¹ˆæ²¡æœ‰å›å¤ï¼Œç„¶åæ•´ä¸ªé¢è¯•å°±åœ¨å¾®ä¿¡ä¸Šæ‰“å­—è¿›è¡Œã€‚</p><p>å…¶ä¸­é—®äº†ä¸€ä¸ªå¾ˆå…·ä½“çš„é—®é¢˜ï¼Œæˆ‘è®°å¾—å¥½åƒæ˜¯ MD5 çš„å…·ä½“å®ç°ï¼Œè¯´å®è¯æˆ‘ä¸çŸ¥é“ï¼Œä»å­—é‡Œè¡Œé—´æˆ‘æ„Ÿè§‰å¯¹æ–¹çš„æ€åº¦å¹¶ä¸å‹å¥½ï¼Œä¹Ÿå°±æ²¡æœ‰å¿…è¦å†èŠä¸‹å»ï¼›æœ€åç»™æˆ‘è¯´ä¹‹æ‰€ä»¥é—®è¿™äº›ï¼Œæ˜¯å› ä¸ºçœ‹äº†æˆ‘çš„åšå®¢åè§‰å¾—æˆ‘æŠ€æœ¯å®åŠ›ä¸é”™ï¼Œæ‰€ä»¥å¯¹æˆ‘æœŸå¾…è¾ƒé«˜ï¼›æˆ‘åªèƒ½æ˜¯åœ°é“è€äººçœ‹æ‰‹æœºã€‚</p><p>æœ€ç»ˆçœ‹æ¥å…«è‚¡æ–‡ç¡®å®æ˜¯ç»•ä¸å¼€çš„ï¼Œæˆ‘ä¹ŸèŠ±äº†å‡ å¤©æ—¶é—´æ•´ç†äº† Java å’Œ Go çš„ç›¸å…³èµ„æ–™ï¼›ä¸è¿‡æˆ‘è§‰å¾—ä¹Ÿæœ‰åº”å¯¹çš„æ–¹æ³•ã€‚</p><p>é¦–å…ˆå¾—çœ‹ä½ é¢è¯•çš„å²—ä½ï¼Œå¦‚æœæ˜¯å¸¸è§çš„ä¸šåŠ¡ç ”å‘ï¼Œä»æ‹›è˜çš„ JD æè¿°å…¶å®æ˜¯å¯ä»¥çœ‹å‡ºæ¥çš„ï¼Œæ¯”å¦‚æœ‰æåˆ°ä»€ä¹ˆ Java å¹¶å‘ã€é”ã€Springç­‰ç­‰ï¼Œå¤§æ¦‚ç‡æ˜¯è¦é—®å…«è‚¡çš„ï¼›è¿™ä¸ªæ²¡åŠæ³•ï¼Œåˆ«äººéƒ½åœ¨èƒŒä½ ä¸èƒŒå°±è½åä¸€æˆªäº†ã€‚</p><p>ä¹‹åæˆ‘å»ºè®®è‡ªå·±å¹³æ—¶åœ¨åšå®¢é‡Œå¤šè®°å½•å…«è‚¡ç›¸å…³çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨ç®€å†ä¸Šç€é‡æ ‡æ˜åšå®¢çš„åœ°å€ï¼Œå°½é‡è®©é¢è¯•å®˜å…ˆçœ‹åˆ°ï¼›è¿™æ ·å…ˆå‘åˆ¶äººï¼Œä½ æƒ³é—®çš„æˆ‘å·²ç»æ€»ç»“å¥½äº†ğŸ˜‚ã€‚</p><p>ä½†è¿™ä¸ªçš„å‰ææ˜¯è¦è‡ªå·±é•¿æœŸè®°å½•ï¼Œä¸èƒ½ç­‰åˆ°é¢è¯•çš„æ—¶å€™æ‰æƒ³èµ·å»æ›´æ–°ï¼Œé•¿æœŸç»´æŠ¤ä¹Ÿèƒ½åŠ æ·±è‡ªå·±çš„å°è±¡ï¼ŒæŒ‰ç…§ â€œè‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿â€ è¿›è¡Œå¤ä¹ ã€‚</p><h2 id="é€‰æ‹©"><a href="#é€‰æ‹©" class="headerlink" title="é€‰æ‹©"></a>é€‰æ‹©</h2><p><img src="https://s2.loli.net/2023/06/19/haAR4PYjzFGlde2.png"><br>è¿™æ˜¯æˆ‘å½“æ—¶è®°å½•çš„é¢è¯•æƒ…å†µï¼Œæœ€ç»ˆæ ¹æ®å–œå¥½ç¨‹åº¦é€‰æ‹©äº†ç°åœ¨è¿™å®¶å…¬å¸ã€‚</p><p>ä¸è¿‡ä¹Ÿæœ‰ä¸€ç‚¹æˆ‘ç°åœ¨è§‰å¾—ä½†æ˜¯è€ƒè™‘æ¼äº†ï¼Œé‚£å°±æ˜¯è¡Œä¸šå‰æ™¯ã€‚</p><p>ç°åœ¨çš„ C ç«¯ä¸šåŠ¡çœŸçš„ä¸å¥½åšï¼Œç›¸å¯¹å¥½åšçš„æ˜¯ä¸€äº› B ç«¯ï¼Œå›æ¬¾å‘¨æœŸé•¿ï¼ŒåŒæ—¶ä¸å¤ªåƒç°é‡‘æµï¼›è¿™æ ·çš„ä¸šåŠ¡ç›¸å¯¹æ¥è¯´æ´»çš„ä¼šä¹…ä¸€äº›ï¼Œæˆ‘ç°åœ¨æ‰€åœ¨çš„å…¬å¸å°±æ˜¯çº¯åš C ç«¯ï¼Œåœ¨æˆ‘çœ‹æ¥ä¹Ÿæ²¡æœ‰å½¢æˆè‡ªå·±çš„æŠ¤åŸæ²³ï¼Œåªè¦æœ‰äººæ„¿æ„ç ¸é’±éšæ—¶å¯ä»¥æŠŠä½ å¹²ä¸‹å»ã€‚</p><p>åŠ ä¸Šç°åœ¨çš„èµ„æœ¬ä¹Ÿä¸æ•¢éšæ„æŠ•é’±ï¼Œå…¬å¸å“ªå¤©ä¸æŒ£é’±çš„è¯é¦–å…ˆå°±æ˜¯è€ƒè™‘ç¼©å‡äº§ç ”çš„æˆæœ¬ï¼Œæ‰€ä»¥è£å‘˜æŒ‡ä¸å®šå°±ä¼šåœ¨å“ªä¸€å¤©åˆ°æ¥ã€‚</p><p>ç°åœ¨åº†å¹¸çš„æ˜¯å…¥èŒç°åœ¨è¿™å®¶å…¬å¸ä¹Ÿæ²¡æœ‰é€‰é”™ï¼Œè‡³å°‘çŸ­æœŸå†…çœ‹æ¥ä¸ä¼šå†è£å‘˜ï¼ŒåŒæ—¶æˆ‘åšçš„äº‹æƒ…ä¹Ÿæ˜¯æ¯”è¾ƒæ„Ÿå…´è¶£çš„ï¼›å’Œç¬¬ä¸‰å®¶æœ‰äº›è®¸ç±»ä¼¼ï¼Œåªæ˜¯åšå¾—æ˜¯å†…éƒ¨çš„åŸºç¡€æ¶æ„ï¼Œä¹Ÿéœ€è¦ç»å¸¸å’Œå¼€æºç¤¾åŒºäº¤æµã€‚</p><h1 id="é¢å¯¹è£å‘˜èƒ½åšçš„äº‹æƒ…"><a href="#é¢å¯¹è£å‘˜èƒ½åšçš„äº‹æƒ…" class="headerlink" title="é¢å¯¹è£å‘˜èƒ½åšçš„äº‹æƒ…"></a>é¢å¯¹è£å‘˜èƒ½åšçš„äº‹æƒ…</h1><p>è¯´åˆ°è£å‘˜ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡ç¢°ä¸Šï¼Œåªèƒ½åˆ†äº«ä¸ºæ•°ä¸å¤šçš„ç»éªŒã€‚</p><h2 id="é¿å…è£å‘˜"><a href="#é¿å…è£å‘˜" class="headerlink" title="é¿å…è£å‘˜"></a>é¿å…è£å‘˜</h2><p>å½“ç„¶ç¬¬ä¸€æ¡æ˜¯å°½é‡é¿å…è¿›å…¥è£å‘˜åå•ï¼Œè¿™ä¸ªæˆ‘æœ€è¿‘åœ¨æ’­å®¢ <a href="https://www.xiaoyuzhoufm.com/episode/647d43b41672628240e2187d">ä½œä¸ºæ›¾ç»çš„è€æ¿ï¼Œæˆ‘ä»¬çœ¼ä¸­çš„è£å‘˜å’Œé‚£äº›å»ºè®®</a> è®²åˆ°åœ¨å½“ä¸‹çš„å¸‚åœºæƒ…å†µä¸‹å“ªäº›äººæ›´å®¹æ˜“è¿›å…¥è£å‘˜åå•ï¼š</p><ul><li>å¹´çºªå¤§çš„ï¼Œè¿™ç±»æ”¶å…¥ä¸ä½ï¼ŒåŒæ—¶æ”¶ç›Šä¹Ÿæ²¡å¹´è½»äººé«˜ï¼Œç¡®å®æ›´å®¹æ˜“è¿›å…¥åå•ã€‚</li><li>æœªå©šå¥³æ€§ï¼Œè¿™ç‚¹ç¡®å®æœ‰ç‚¹æ”¿æ²»ä¸æ­£ç¡®ï¼Œä½†ç¡®å®å°±æ˜¯ç°åœ¨çš„äº‹å®ï¼Œè¿™ä¸ªéœ€è¦æ•´ä¸ªç¤¾ä¼šï¼Œæ”¿åºœæ¥ä¸€èµ·è§£å†³ã€‚</li><li>åšäº‹æœ¬æœ¬åˆ†åˆ†ï¼Œæ²¡æœ‰è´¡çŒ®ä¹Ÿæ²¡å‡ºå•¥äº‹æ•…ã€‚</li><li>è¾¹ç¼˜ä¸šåŠ¡ï¼Œä¹Ÿå®¹æ˜“è¢«ä¼˜åŒ–ç¼©å‡æˆæœ¬ã€‚</li></ul><p>é‚£å¦‚ä½•é¿å…è£å‘˜å‘¢ï¼Œå½“ç„¶é¦–å…ˆå°½é‡åˆ«å’Œä»¥ä¸Šç‰¹å¾é‡åˆï¼Œä¸€äº›å®¢è§‚æƒ…å†µé¿å…ä¸äº†ï¼Œä½†æˆ‘ä»¬å¯ä»¥åœ¨ç¬¬ä¸‰ç‚¹ä¸Šä¸»åŠ¨â€œå·â€ä¸€ä¸‹ï¼Œå½“ç„¶è¿™ä¸ªçš„å‰ææ˜¯ä½ è¿˜æƒ³åœ¨è¿™å®¶å…¬å¸å¹²ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯æå‰å‘å…¬å¸å‘ŠçŸ¥é™è–ªï¼Œè¿™ç‚¹å¯èƒ½å¾ˆå¤šäººä¸ç†è§£ï¼Œå› ä¸ºæˆ‘ä»¬å¤§éƒ¨åˆ†äººçš„æ”¶å…¥éƒ½æ˜¯éšç€è·³æ§½è¶Šæ¥è¶Šé«˜çš„ï¼›ä½†è¿™äº›å¥½å¤„æ˜¯å¦æ˜¯å—åˆ°å‰äº›å¹´äº’è”ç½‘è¿‡äºçƒ­é—¨çš„å½±å“å‘¢ï¼Ÿ</p><p>å½“ç„¶ä¸ªäººå¾…é‡æ˜¯ç”±å¸‚åœºå†³å®šçš„ï¼Œç°åœ¨äº’è”ç½‘ä¸å¯å¦è®¤çš„é™æ¸©äº†ï¼Œå¦‚æœä½ è§‰å¾—å„æ–¹é¢å‘†åœ¨è¿™å®¶å…¬å¸éƒ½æ¯”å‡ºå»å†æ‰¾ä¸€ä¸ªæ›´å¥½ï¼Œé‚£è¿™ä¹Ÿä¸å¤±ä¸ºä¸€ä¸ªæ–¹æ³•ï¼›é™¤éä½ æœ‰ä¿¡å¿ƒèƒ½æ‰¾åˆ°ä¸€ä¸ªæ›´å¥½çš„ï¼Œé‚£å°±å¦è¯´äº†ã€‚</p><h1 id="æœªæ¥è®¡åˆ’"><a href="#æœªæ¥è®¡åˆ’" class="headerlink" title="æœªæ¥è®¡åˆ’"></a>æœªæ¥è®¡åˆ’</h1><p>æˆ‘è§‰å¾—åªè¦ä¸€å®¶å…¬å¸åªè¦æœ‰è£å‘˜çš„é£å£°ä¼ å‡ºæ¥åï¼Œå³ä¾¿æ˜¯æ²¡è¢«è£ï¼Œä½ ä¹Ÿä¼šå¤„äºç„¦è™‘ä¹‹ä¸­ï¼›è¦æƒ³é¿å…è¿™ç§ç„¦è™‘ç¡®å®ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦æœ‰ç¨³å®šçš„è¢«åŠ¨æ”¶å…¥é‚£å°±æ— æ‰€è°“äº†ã€‚</p><p>è¿™ä¸ªç¡®å®ä¹Ÿæ˜¯è¯´èµ·æ¥è½»æ¾åšèµ·æ¥éš¾ï¼Œæˆ‘æœ€è¿‘ä¹Ÿä¸€ç›´åœ¨æ€è€ƒèƒ½ä¸èƒ½åœ¨å·¥ä½œä¹‹ä½™åšä¸€äº›å°çš„ side projectï¼Œè¿™è¯é¢˜å°±å¤§äº†ï¼Œåªæ˜¯æˆ‘è§‰å¾—æˆ‘ä»¬ç¨‹åºå‘˜å…ˆå¤©å°±æœ‰è‡ªå·±åšä¸€ä¸ªäº§å“çš„æœºä¼šå’Œèƒ½åŠ›ï¼Œä¸å…¶æŠŠç”Ÿæ€å¤§æƒç»™åˆ«äººï¼Œä¸å¦‚æ¡åœ¨è‡ªå·±æ‰‹é‡Œã€‚</p><p>å½“ç„¶è¿™é‡Œå¾—æé†’ä¸‹ï¼Œåœ¨å›½å†…çš„ä¼ä¸šï¼Œå¤§éƒ¨åˆ†è€æ¿éƒ½è®¤ä¸ºç­¾äº†åˆåŒä½ çš„ 24 å°æ—¶éƒ½æ˜¯ä»–çš„ï¼Œæ‰€ä»¥è¿™äº›ä¸šåŠ¡é¡¹ç›®æœ€å¥½æ˜¯ä¿æŒä½è°ƒï¼ŒåŒæ—¶ä¸èƒ½å½±å“åˆ°æœ¬èŒå·¥ä½œã€‚</p><blockquote><p>æ¬¢è¿å…³æ³¨ä½œè€…å…¬ä¼—å·äºæˆ‘äº¤æµğŸ¤—ã€‚</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/06/19/SQP9LxtXNhGwyev.png&quot;&gt;&lt;br&gt;è›®ä¹…æ²¡æ›´æ–°äº†ï¼Œæœ¬æ¬¡æˆ‘æƒ³èŠèŠæ‰¾å·¥ä½œçš„äº‹æƒ…ï¼Œç›¸ä¿¡å¤§å®¶éƒ½èƒ½æ„Ÿå—åˆ°ä»å»å¹´å¼€å§‹åˆ°ç°åœ¨å¸‚åœºæ˜¯ä¸€å¤©æ¯”ä¸€å¤©å·®ï¼Œç‰¹åˆ«æ˜¯åœ¨æˆ‘ä»¬äº’è”ç½‘ IT è¡Œä¸šã€‚&lt;br&gt;å·²ç»è¿‡äº† 18 å¹´ä¹‹å‰çš„é«˜é€Ÿå‘å±•çš„çº¢åˆ©æœŸï¼Œèƒ½åšçš„äº’è”ç½‘åº”ç”¨å‡ ä¹å·²ç»è¢«å„å¤§å…¬å¸åšäº†ä¸ªéï¼Œç°åœ¨å·²ç»è¿›å…¥ç¨³å®šçš„å­˜é‡å¸‚åœºï¼Œæ‰€ä»¥åœ¨è¿™æ ·çš„å¤§èƒŒæ™¯ä¸‹å†åŠ ä¸Šå…¨ä¸–ç•ŒèŒƒå›´å†…çš„ç»æµä¸æ™¯æ°”æˆ‘æƒ³æ¯ä¸ªäººéƒ½èƒ½æ„Ÿå—åˆ°å¯’æ„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¿˜è®°å¾—å¤§çº¦åœ¨ 20 å¹´çš„æ—¶å€™çœ‹åˆ°ç½‘ä¸Šç»å¸¸è¯´çš„ä¸€å¥è¯ï¼šä»Šå¹´å°†æ˜¯æœªæ¥åå¹´æœ€å¥½çš„ä¸€å¹´ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºå½“æ—¶æˆ‘æ‰€åœ¨çš„å…¬å¸ä¸šåŠ¡å‘å±•è¿˜æ¯”è¾ƒé¡ºåˆ©ï¼Œä¸æ¯«æ²¡æœ‰å±æœºæ„è¯†ï¼Œå¯¹è¿™ç§è¨€è®ºæ€»æ˜¯å—¤ä¹‹ä»¥é¼»ï¼Œç›´åˆ°å»å¹´å›½åº†èŠ‚é™„è¿‘ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Interview" scheme="http://crossoverjie.top/categories/Interview/"/>
    
    <category term="Person" scheme="http://crossoverjie.top/categories/Interview/Person/"/>
    
    
  </entry>
  
  <entry>
    <title>äº‘åŸç”ŸèƒŒæ™¯ä¸‹å¦‚ä½•é…ç½® JVM å†…å­˜</title>
    <link href="http://crossoverjie.top/2023/05/15/k8s/cloudnative-java/"/>
    <id>http://crossoverjie.top/2023/05/15/k8s/cloudnative-java/</id>
    <published>2023-05-15T00:08:08.000Z</published>
    <updated>2023-09-15T18:42:20.739Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/05/12/IAxSF3oZ1j8GHbi.png" alt="image.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰æ®µæ—¶é—´ä¸šåŠ¡ç ”å‘åé¦ˆè¯´æ˜¯ä»–çš„åº”ç”¨å†…å­˜ä½¿ç”¨ç‡å¾ˆé«˜ï¼Œå¯¼è‡´é¢‘ç¹çš„é‡å¯ï¼Œè®©æˆ‘æ’æŸ¥ä¸‹æ˜¯æ€ä¹ˆå›äº‹ï¼›</p><p>åœ¨è¿™ä¹‹å‰æˆ‘ä¹Ÿæ²¡æ€ä¹ˆåœ¨æ„è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¥½è¿™æ¬¡æ’æŸ¥åˆ†æçš„è¿‡ç¨‹åšä¸€ä¸ªè®°å½•ã€‚</p><span id="more"></span><p>é¦–å…ˆæˆ‘æŸ¥çœ‹äº†ç›‘æ§é¢æ¿é‡Œçš„ Pod ç›‘æ§ï¼š<br><img src="https://s2.loli.net/2023/05/14/wyYu8SI7eGprqmQ.png" alt="WeChatWorkScreenshot_ac6f8d80-bdb4-469e-af1a-b2199c9ee288.png"></p><p>å‘ç°ç¡®å®æ˜¯å¿«æ»¡äº†ï¼Œè€Œæ­¤æ—¶å»æŸ¥çœ‹åº”ç”¨çš„ JVM å ç”¨æƒ…å†µå´åªæœ‰30%å·¦å³ï¼›è¯´æ˜å¹¶ä¸æ˜¯åº”ç”¨å†…å­˜æ»¡äº†å¯¼è‡´ JVM çš„ OOMï¼Œè€Œæ˜¯ Pod çš„å†…å­˜æ»¡äº†ï¼Œå¯¼è‡´ Pod çš„å†…å­˜æº¢å‡ºï¼Œä»è€Œè¢« k8s æ€æ‰äº†ã€‚</p><p>è€Œ <code>k8s</code> ä¸ºäº†ç»´æŒåº”ç”¨çš„å‰¯æœ¬æ•°é‡å°±å¾—é‡å¯ä¸€ä¸ª Podï¼Œæ‰€ä»¥çœ‹èµ·æ¥å°±æ˜¯åº”ç”¨è¿è¡Œä¸€æ®µæ—¶é—´åå°±è¢«é‡å¯ã€‚</p><hr><p><img src="https://s2.loli.net/2023/05/14/Lhkjys1TEQUKV86.png" alt="WeChatWorkScreenshot_6213e2f8-c429-4d33-acdd-e639275dd92b.png"><br>è€Œè¿™ä¸ªåº”ç”¨é…ç½®çš„æ˜¯ JVM 8Gï¼Œå®¹å™¨ç”³è¯·çš„å†…å­˜æ˜¯16Gï¼Œæ‰€ä»¥ Pod çš„å†…å­˜å ç”¨çœ‹èµ·æ¥ä¹Ÿå°± 50% å·¦å³ã€‚</p><h1 id="å®¹å™¨çš„åŸç†"><a href="#å®¹å™¨çš„åŸç†" class="headerlink" title="å®¹å™¨çš„åŸç†"></a>å®¹å™¨çš„åŸç†</h1><p>åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰è¿˜æ˜¯å…ˆç®€å•äº†è§£ä¸‹å®¹å™¨çš„è¿è¡ŒåŸç†ï¼Œå› ä¸ºåœ¨ k8s ä¸­æ‰€æœ‰çš„åº”ç”¨éƒ½æ˜¯è¿è¡Œåœ¨å®¹å™¨ä¸­çš„ï¼Œè€Œå®¹å™¨æœ¬è´¨ä¸Šä¹Ÿæ˜¯è¿è¡Œåœ¨å®¿ä¸»æœºä¸Šçš„ä¸€ä¸ªä¸ªè¿›ç¨‹è€Œå·²ã€‚</p><p>ä½†æˆ‘ä»¬ä½¿ç”¨ Docker çš„æ—¶å€™ä¼šæ„Ÿè§‰æ¯ä¸ªå®¹å™¨å¯åŠ¨çš„åº”ç”¨ä¹‹é—´äº’ä¸å¹²æ‰°ï¼Œä»æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œã€CPUã€å†…å­˜è¿™äº›éƒ½èƒ½å®Œå…¨éš”ç¦»å¼€æ¥ï¼Œå°±åƒä¸¤ä¸ªè¿è¡Œåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸­çš„åº”ç”¨ã€‚</p><p>å…¶å®è¿™ä¸€ç‚¹ä¹Ÿä¸æ˜¯å•¥é»‘ç§‘æŠ€ï¼ŒLinux æ—©å°±æ”¯æŒ 2.6.x çš„ç‰ˆæœ¬å°±å·²ç»æ”¯æŒ <code>namespace</code> éš”ç¦»äº†ï¼Œä½¿ç”¨ <code>namespace</code> å¯ä»¥å°†ä¸¤ä¸ªè¿›ç¨‹å®Œå…¨éš”ç¦»ã€‚</p><p>ä»…ä»…å°†èµ„æºéš”ç¦»è¿˜ä¸å¤Ÿï¼Œè¿˜éœ€è¦é™åˆ¶å¯¹èµ„æºçš„ä½¿ç”¨ï¼Œæ¯”å¦‚ CPUã€å†…å­˜ã€ç£ç›˜ã€å¸¦å®½è¿™äº›ä¹Ÿå¾—åšé™åˆ¶ï¼›è¿™ç‚¹ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>cgroups</code> è¿›è¡Œé…ç½®ã€‚</p><p>å®ƒå¯ä»¥é™åˆ¶æŸä¸ªè¿›ç¨‹çš„èµ„æºï¼Œæ¯”å¦‚å®¿ä¸»æœºæ˜¯ 4 æ ¸ CPUï¼Œ8G å†…å­˜ï¼Œä¸ºäº†ä¿æŠ¤å…¶ä»–å®¹å™¨ï¼Œå¿…é¡»ç»™è¿™ä¸ªå®¹å™¨é…ç½®ä½¿ç”¨ä¸Šé™ï¼š1æ ¸ CPUï¼Œ2Gå†…å­˜ã€‚</p><p><img src="https://s2.loli.net/2023/05/14/dzcHK6G8VZQuFC5.png" alt="image.png"></p><p>è¿™å¼ å›¾å°±å¾ˆæ¸…æ™°çš„è¡¨ç¤ºäº† <code>namespace</code>  å’Œ <code>cgroups</code> åœ¨å®¹å™¨æŠ€æœ¯ä¸­çš„ä½œç”¨ï¼Œç®€å•æ¥è¯´å°±æ˜¯ï¼š</p><ul><li>namespace è´Ÿè´£éš”ç¦»</li><li>cgroups è´Ÿè´£é™åˆ¶</li></ul><p>åœ¨ k8s ä¸­ä¹Ÿæœ‰å¯¹åº”çš„æç°ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">resources:</span></span><br><span class="line">  <span class="attr">requests:</span></span><br><span class="line">    <span class="attr">memory:</span> <span class="string">1024Mi</span></span><br><span class="line">    <span class="attr">cpu:</span> <span class="number">0.1</span></span><br><span class="line">  <span class="attr">limits:</span></span><br><span class="line">    <span class="attr">memory:</span> <span class="string">1024Mi</span></span><br><span class="line">    <span class="attr">cpu:</span> <span class="number">4</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªèµ„æºæ¸…å•è¡¨ç¤ºè¯¥åº”ç”¨è‡³å°‘éœ€è¦ä¸ºä¸€ä¸ªå®¹å™¨åˆ†é…ä¸€ä¸ª 0.1 æ ¸å’Œ 1024M çš„èµ„æºï¼ŒCPU çš„æœ€é«˜ä¸Šé™ä¸º 4 ä¸ªæ ¸å¿ƒã€‚</p><h1 id="ä¸åŒçš„OOM"><a href="#ä¸åŒçš„OOM" class="headerlink" title="ä¸åŒçš„OOM"></a>ä¸åŒçš„OOM</h1><p>å›åˆ°æœ¬æ¬¡çš„é—®é¢˜ï¼Œå¯ä»¥ç¡®è®¤æ˜¯å®¹å™¨å‘ç”Ÿäº† OOM ä»è€Œå¯¼è‡´è¢« k8s é‡å¯ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬é…ç½® limits çš„ä½œç”¨ã€‚</p><blockquote><p>k8s å†…å­˜æº¢å‡ºå¯¼è‡´å®¹å™¨é€€å‡ºä¼šå‡ºç° exit code 137 çš„ä¸€ä¸ª event æ—¥å¿—ã€‚</p></blockquote><p>å› ä¸ºè¯¥åº”ç”¨çš„ JVM å†…å­˜é…ç½®å’Œå®¹å™¨çš„é…ç½®å¤§å°æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯8GBï¼Œä½† Java åº”ç”¨è¿˜æœ‰ä¸€äº›é JVM ç®¡ç†çš„å†…å­˜ï¼Œæ¯”å¦‚å †å¤–å†…å­˜ä¹‹ç±»çš„ï¼Œè¿™æ ·å¾ˆå®¹æ˜“å°±å¯¼è‡´å®¹å™¨å†…å­˜å¤§å°è¶…è¿‡äº†é™åˆ¶çš„ 8G äº†ï¼Œä¹Ÿå°±å¯¼è‡´äº†å®¹å™¨å†…å­˜æº¢å‡ºã€‚</p><h1 id="äº‘åŸç”ŸèƒŒæ™¯çš„ä¼˜åŒ–"><a href="#äº‘åŸç”ŸèƒŒæ™¯çš„ä¼˜åŒ–" class="headerlink" title="äº‘åŸç”ŸèƒŒæ™¯çš„ä¼˜åŒ–"></a>äº‘åŸç”ŸèƒŒæ™¯çš„ä¼˜åŒ–</h1><p>å› ä¸ºè¿™ä¸ªåº”ç”¨æœ¬èº«ä½¿ç”¨çš„å†…å­˜ä¸å¤šï¼Œæ‰€ä»¥å»ºè®®å°†å †å†…å­˜é™åˆ¶åˆ° 4GBï¼Œè¿™æ ·å°±é¿å…äº†å®¹å™¨å†…å­˜è¶…é™ï¼Œä»è€Œè§£å†³äº†é—®é¢˜ã€‚</p><p>å½“ç„¶ä¹‹åæˆ‘ä»¬ä¹Ÿä¼šåœ¨åº”ç”¨é…ç½®æ é‡ŒåŠ ä¸Šå»ºè®®ï¼šæ¨è JVM çš„é…ç½®å°äºå®¹å™¨é™åˆ¶çš„ 2&#x2F;3ï¼Œé¢„ç•™ä¸€äº›å†…å­˜ã€‚</p><p>å…¶å®æœ¬è´¨ä¸Šè¿˜æ˜¯å¼€å‘æ¨¡å¼æ²¡æœ‰è½¬å˜è¿‡æ¥ï¼Œä»¥ä¼ ç»Ÿçš„ Java åº”ç”¨å¼€å‘æ¨¡å¼ç”šè‡³éƒ½ä¸ä¼šå»äº†è§£å®¹å™¨çš„å†…å­˜å¤§å°ï¼Œå› ä¸ºä»¥å‰å¤§å®¶çš„åº”ç”¨éƒ½æ˜¯éƒ¨ç½²åœ¨ä¸€ä¸ªå†…å­˜è¾ƒå¤§çš„è™šæ‹Ÿæœºä¸Šï¼Œæ‰€ä»¥æ„ŸçŸ¥ä¸åˆ°å®¹å™¨å†…å­˜çš„é™åˆ¶ã€‚</p><p>ä»è€Œè¯¯ä»¥ä¸ºå°†ä¸¤è€…ç”»äº†ç­‰å·ï¼Œè¿™ä¸€ç‚¹å¯èƒ½åœ¨ Java åº”ç”¨ä¸­å°¤ä¸ºæ˜æ˜¾ï¼Œæ¯•ç«Ÿå¤šäº†ä¸€ä¸ª JVMï¼›ç”šè‡³åœ¨è€ç‰ˆæœ¬çš„ JDK ä¸­å¦‚æœæ²¡æœ‰è®¾ç½®å †å†…å­˜å¤§å°ï¼Œæ— æ³•æ„ŸçŸ¥åˆ°å®¹å™¨çš„å†…å­˜é™åˆ¶ï¼Œä»è€Œè‡ªåŠ¨ç”Ÿæˆçš„ Xmx å¤§äºäº†å®¹å™¨çš„å†…å­˜å¤§å°ï¼Œä»¥è‡´äº OOMã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/05/12/IAxSF3oZ1j8GHbi.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´ä¸šåŠ¡ç ”å‘åé¦ˆè¯´æ˜¯ä»–çš„åº”ç”¨å†…å­˜ä½¿ç”¨ç‡å¾ˆé«˜ï¼Œå¯¼è‡´é¢‘ç¹çš„é‡å¯ï¼Œè®©æˆ‘æ’æŸ¥ä¸‹æ˜¯æ€ä¹ˆå›äº‹ï¼›&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¹‹å‰æˆ‘ä¹Ÿæ²¡æ€ä¹ˆåœ¨æ„è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¥½è¿™æ¬¡æ’æŸ¥åˆ†æçš„è¿‡ç¨‹åšä¸€ä¸ªè®°å½•ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="cloudnative" scheme="http://crossoverjie.top/categories/cloudnative/"/>
    
    
    <category term="Java" scheme="http://crossoverjie.top/tags/Java/"/>
    
    <category term="JVM" scheme="http://crossoverjie.top/tags/JVM/"/>
    
    <category term="K8s" scheme="http://crossoverjie.top/tags/K8s/"/>
    
  </entry>
  
  <entry>
    <title>ä»æºç å½»åº•ç†è§£ Prometheus/VictoriaMetrics ä¸­çš„ relabel_configs/metric_relabel_configs é…ç½®</title>
    <link href="http://crossoverjie.top/2023/03/13/metrics/relabel_configs_%20metric_relabel_configs/"/>
    <id>http://crossoverjie.top/2023/03/13/metrics/relabel_configs_%20metric_relabel_configs/</id>
    <published>2023-03-13T00:08:08.000Z</published>
    <updated>2023-03-12T10:44:16.552Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/03/11/Xxp5yNTH1ASBk3Z.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘æ¥æ‰‹ç»´æŠ¤äº†å…¬å¸çš„æŒ‡æ ‡ç›‘æ§ç³»ç»Ÿï¼Œä¹‹åè¸©åˆ°å‘å°±æ²¡ç«™èµ·æ¥è¿‡ã€‚ã€‚<br><img src="https://s2.loli.net/2023/03/11/UwBJ28ZafziRsQS.png"></p><span id="more"></span><p>æœ¬æ¬¡é—®é¢˜çš„èµ·å› æ˜¯æˆ‘ä»¬é…ç½®äº†ä¸€äº›æŒ‡æ ‡çš„åˆ é™¤ç­–ç•¥æ²¡æœ‰ç”Ÿæ•ˆï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">action:</span> <span class="string">drop_metrics</span></span><br><span class="line">  <span class="attr">regex:</span> <span class="string">&quot;^envoy_.*|^url\_\_\_\_.*|istio_request_bytes_sum&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸è¿™ä¸¤ä¸ªå®¹æ˜“å¼•èµ·è¯¯è§£çš„é…ç½®<code>relabel_configs/metric_relabel_configs</code>æœ‰å…³ã€‚</p><p>ä»–ä»¬éƒ½æ˜¯å¯¹æŠ“å–çš„æ•°æ®è¿›è¡Œé‡å‘½åã€è¿‡æ»¤ã€æ–°å¢ã€åˆ é™¤ç­‰æ“ä½œï¼Œä½†åº”ç”¨åœºæ™¯å´å®Œå…¨ä¸åŒã€‚</p><blockquote><p>æˆ‘ä»¬ä½¿ç”¨äº† VictoriaMetrics æ›¿æ¢äº† Prometheusï¼ŒVM å®Œå…¨å…¼å®¹ Prometheus ï¼Œæ‰€ä»¥æœ¬æ–‡ä¹Ÿå¯¹ Prometheus åŒæ ·é€‚ç”¨ã€‚</p></blockquote><h1 id="ç†è§£é”™è¯¯1"><a href="#ç†è§£é”™è¯¯1" class="headerlink" title="ç†è§£é”™è¯¯1"></a>ç†è§£é”™è¯¯1</h1><p><img src="https://s2.loli.net/2023/03/12/9oYRlCGTZaNuc5j.png" alt="image.png"><br>ä½†è¿™é‡Œå…¶å®æ˜¯æœ‰ä¸€ä¸ªé”™è¯¯ç†è§£çš„ï¼Œæˆ‘æ˜¯é€šè¿‡ VM çš„æœåŠ¡å‘ç°é¡µé¢çš„æŒ‡æ ‡å“åº”é¡µé¢æŸ¥è¯¢æŒ‡æ ‡çš„ï¼Œæ‰“å¼€ä¹‹åç¡®å®èƒ½æœåˆ°éœ€è¦è¢«åˆ é™¤çš„ç›¸å…³æŒ‡æ ‡ã€‚</p><p>ä½†å…¶å®å³ä¾¿æ˜¯çœŸçš„åˆ é™¤äº†æ•°æ®è¿™ä¸ªé¡µé¢ä¹Ÿä¼šæœ‰æ•°æ®å­˜åœ¨ï¼Œåˆ é™¤çš„æ•°æ®åªæ˜¯ä¸ä¼šå†™å…¥ VM çš„æ—¶åºæ•°æ®åº“ä¸­ã€‚</p><blockquote><p>è¿™ä¸€ç‚¹æ˜¯åœ¨åç»­æŸ¥æºç æ—¶æ‰å‘ç°ï¼›åé¢æˆ‘é…ç½®å¯¹äº†ä¾ç„¶åœ¨è¿™é‡ŒæŸ¥çœ‹æ•°æ®ï¼Œå‘ç°è¿˜æ˜¯æ²¡æœ‰åˆ é™¤ï¼Œè¿™ä¸ªé”™è¯¯ç†è§£æµªè´¹äº†ä¸å°‘æ—¶é—´ğŸ˜‚ã€‚</p></blockquote><h1 id="ç†è§£é”™è¯¯2"><a href="#ç†è§£é”™è¯¯2" class="headerlink" title="ç†è§£é”™è¯¯2"></a>ç†è§£é”™è¯¯2</h1><p>ä¸ºäº†è§£å†³é—®é¢˜ï¼Œé€šè¿‡ <code>drop metrics</code> è¿™ç±»å…³é”®å­—åœ¨ VM çš„å®˜æ–¹æ–‡æ¡£ä¸­æŸ¥è¯¢ï¼Œæœ€ç»ˆæ‰¾åˆ°ä¸€ç¯‡æ–‡ç« ã€‚<br><a href="https://www.robustperception.io/dropping-metrics-at-scrape-time-with-prometheus/">https://www.robustperception.io/dropping-metrics-at-scrape-time-with-prometheus/</a><br><img src="https://s2.loli.net/2023/03/12/oRQKnf7u6j3Ulq5.png"></p><p>æŒ‰ç…§è¿™é‡Œçš„ä»‹ç»ï¼Œå°†åˆ é™¤çš„é…ç½®åŠ å…¥åˆ° <code>metric_relabel_configs</code> é…ç½®ä¸‹ï¼Œç»è¿‡æµ‹è¯•ç¡®å®æœ‰æ•ˆã€‚</p><p>ä¸è¿‡ä¸ºå•¥å°†åŒæ ·çš„é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">relabel_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">drop_metrics</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">&quot;^envoy_.*|^url\_\_\_\_.*|istio_request_bytes_sum&quot;</span></span><br></pre></td></tr></table></figure><p>åŠ å…¥åˆ° <code>relabel_configs</code> æœªèƒ½ç”Ÿæ•ˆå‘¢ï¼Ÿ</p><p>ä¼°è®¡ç¡®å®å®¹æ˜“ä»¤äººè¯¯å¯¼ï¼Œåœ¨æ–‡æ¡£ä¸­ä¹Ÿæ‰¾åˆ°äº†ç›¸å…³çš„è§£é‡Šï¼š<br><a href="https://www.robustperception.io/relabel_configs-vs-metric_relabel_configs/">https://www.robustperception.io/relabel_configs-vs-metric_relabel_configs&#x2F;</a><br><img src="https://s2.loli.net/2023/03/12/xyaqKjkf85YZzeA.png"><br>è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯è¡¨è¾¾å‡ ä¸ªé‡ç‚¹ï¼š</p><ul><li><code>relabel_configs</code> ç”¨äºé…ç½®å“ªä¸ªç›®æ ‡éœ€è¦è¢«æŠ“å–ï¼Œå‘ç”Ÿåœ¨æŒ‡æ ‡æŠ“å–ä¹‹å‰ã€‚</li><li><code>metric_relabel_configs</code> å‘ç”Ÿåœ¨æŒ‡æ ‡æŠ“å–ä¹‹åï¼Œå†™å…¥å­˜å‚¨ä¹‹å‰ã€‚</li><li>å¦‚æœå…¶ä¸­ä¸€ä¸ªæ²¡ç”Ÿæ•ˆï¼Œå°±æ¢ä¸€ä¸ªï¼ˆè¿™å¥è¯å¾ˆå®¹æ˜“è®©äººçŠ¯è¿·ç³Šï¼‰</li></ul><p>ä½†è¯´å®è¯å½“æ—¶æˆ‘çœ‹åˆ°è¿™é‡Œè¿˜æ˜¯ä¸€è„¸æ‡µï¼Œä¸ºäº†å½»åº•äº†è§£ä¸¤åˆ™çš„åŒºåˆ«è¿˜æ˜¯çœ‹æºç æ¥çš„ç›´æ¥ã€‚</p><h2 id="é˜…è¯»æºç ç†è§£æœ¬è´¨åŸå› "><a href="#é˜…è¯»æºç ç†è§£æœ¬è´¨åŸå› " class="headerlink" title="é˜…è¯»æºç ç†è§£æœ¬è´¨åŸå› "></a>é˜…è¯»æºç ç†è§£æœ¬è´¨åŸå› </h2><h3 id="metric-relabel-configs"><a href="#metric-relabel-configs" class="headerlink" title="metric_relabel_configs"></a>metric_relabel_configs</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">metric_relabel_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">drop_metrics</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">&quot;^envoy_.*|^url\_\_\_\_.*|istio_request_bytes_sum&quot;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹ä¸‹<code>metric_relabel_configs</code>é…ç½®ç”Ÿæ•ˆçš„åŸå› ã€‚</p><p><img src="https://s2.loli.net/2023/03/12/dWA4a3kzGPIxFEX.png"></p><p><code>metric_relabel_configs</code> é…ç½®çš„æ•´ä½“æµç¨‹å¦‚ä¸Šå›¾ï¼š</p><ul><li>å¯åŠ¨ VM æ—¶åŠ è½½é…ç½®åˆ°å†…å­˜</li><li>æ ¹æ®é…ç½®çš„æŠ“å–é—´éš”æ—¶é—´(<code>scrape_interval</code>)æŠ“å–æ•°æ®ï¼Œæ‹¿åˆ°çš„æ¯ä¸€æ¡æ•°æ®éƒ½éœ€è¦é€šè¿‡ <code>metric_relabel_configs</code> çš„åº”ç”¨ã€‚</li><li>é’ˆå¯¹äºè¿™é‡Œçš„ <code>drop_metrics</code> æ¥è¯´ï¼Œå°±æ˜¯åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤æ‰æ‰€æœ‰çš„ <code>Label</code>ã€‚</li><li>å¦‚æœå¯ä»¥åŒ¹é…åˆ é™¤ï¼Œé‚£å°±ä¸ä¼šå†™å…¥å­˜å‚¨ã€‚</li></ul><p>å…¶ä¸­çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/03/12/ZlIKFDbhLVpx8Om.png"></p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œæºç é‡Œåˆ¤æ–­çš„ <code>action</code> æ˜¯ <code>drop</code>ï¼Œè€Œæˆ‘ä»¬é…ç½®çš„æ˜¯ <code>drop_metrics</code>ï¼Œå…¶å® <code>drop_metrics</code> ä¹Ÿæ˜¯ drop çš„ä¸€ä¸ªå°è£…è€Œå·²ã€‚</p><p><img src="https://s2.loli.net/2023/03/12/2kQ9rSBsJ3IuAwm.png"><br>åœ¨è§£æé…ç½®çš„æ—¶å€™ä¼šè¿›è¡Œè½¬æ¢ã€‚</p><p>ä¸è¿™ä¸ªå†™æ³•æ˜¯ç­‰ä»·çš„ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">source_labels:</span> [ <span class="string">__name__</span> ]</span><br><span class="line">  <span class="attr">regex:</span> <span class="string">&quot;^envoy_.*|^url\_\_\_\_.*|istio_request_bytes_sum&quot;</span></span><br><span class="line">  <span class="attr">action:</span> <span class="string">drop</span></span><br></pre></td></tr></table></figure><h3 id="relabel-configs"><a href="#relabel-configs" class="headerlink" title="relabel_configs"></a>relabel_configs</h3><p>ç„¶åæ¥çœ‹çœ‹ <code>relabel_configs</code> æ²¡æœ‰æŒ‰ç…§é¢„æœŸç”Ÿæ•ˆçš„åŸå› ã€‚</p><p><img src="https://s2.loli.net/2023/03/12/itlzeXC8DNhpQf4.png"></p><p>å…¶å®æ ¸å¿ƒçš„åº”ç”¨é…ç½®å°±æ˜¯åŒä¸€ä»½ä»£ç ï¼Œåªæ˜¯è§¦å‘ç‚¹ä¸ä¸€æ ·ã€‚</p><p><code>relabel_configs</code> æ˜¯åœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™æ ¹æ®æˆ‘ä»¬é…ç½®çš„æŠ“å–ç›®æ ‡çš„æ•°æ®å½“åšæ•°æ®æºï¼Œæ‰€ä»¥è¿™é‡Œçš„ <code>action: drop</code> åˆ é™¤çš„æ˜¯æŠ“å–ç›®æ ‡ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„æŠ“å–æ•°æ®ã€‚<br><img src="https://s2.loli.net/2023/03/12/qXbwjh5e3uRds4z.png"></p><p>è€Œä¸”å®ƒçš„ç›®çš„æ˜¯åœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œç”¨äºç”ŸæˆæŠ“å–ç›®æ ‡çš„ä»»åŠ¡ï¼Œ<strong>åªä¼šè¿è¡Œä¸€æ¬¡</strong>ã€‚</p><p>å‡è®¾æˆ‘è¿™é‡Œæ”¹å†™ä¸ºï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">relabel_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">source_labels:</span> [ <span class="string">__address__</span> ]</span><br><span class="line">      <span class="attr">regex:</span> <span class="string">&#x27;192.xx.xx.xx:443&#x27;</span></span><br><span class="line">      <span class="attr">action:</span> <span class="string">drop</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/12/SfJnMP547ltQohW.png"><br>é‚£ä¹ˆæˆ‘è¿™ä¸ªæŠ“å–ä»»åŠ¡å°±ä¼šè¢«åˆ é™¤æ‰ï¼Œè€Œä¸æ˜¯åˆ é™¤è¿™ä¸ªæŒ‡æ ‡äº†ã€‚</p><p>å› æ­¤ä¹‹å‰æˆ‘åœ¨è¿™é‡Œé…ç½®çš„æ˜¯ä¸€äº›ä¸šåŠ¡æŒ‡æ ‡ <code>regex: &quot;^envoy_.*|^url\_\_\_\_.*|istio_request_bytes_sum&quot;</code>ï¼Œåœ¨æ‰€æœ‰å…ƒæ•°æ®é‡Œè‡ªç„¶æ˜¯æ²¡æœ‰ä»»ä½•ä¸€ä¸ªå¯ä»¥åŒ¹é…äº†ï¼Œæ‰€ä»¥ä¹Ÿå°±æ— äº‹å‘ç”Ÿã€‚</p><blockquote><p>å…ƒæ•°æ®éƒ½æ˜¯ä»¥ <code>__</code> å¼€å¤´ã€‚</p></blockquote><hr><p>å…¶å® VM ä¹Ÿæœ‰æä¾›ä¸€ä¸ª Debug é¡µé¢ç”¨äºè°ƒè¯• <code>relabel_configs</code>ï¼Œä½†å¦‚æœçŸ¥é“æ€ä¹ˆç”¨è¿™ä¸ªè°ƒè¯•é¡µé¢å…¶å®ä¹Ÿç†è§£äº†ä»–çš„è¿è¡ŒåŸç†ğŸ˜‚<br><img src="https://s2.loli.net/2023/03/12/q8KAwpOsBMIEXT3.png"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><a href="https://www.robustperception.io/relabelling-can-discard-targets-timeseries-and-alerts/">https://www.robustperception.io/relabelling-can-discard-targets-timeseries-and-alerts/</a> </p><p><img src="https://s2.loli.net/2023/03/12/lJsntMyoCruRYi7.png"><br>åé¢æˆ‘æŸ¥åˆ°è¿™ç¯‡æ–‡ç« ä¹Ÿæœ‰ç›¸å…³è§£é‡Šï¼Œç†è§£äº†ä¸¤è€…çš„åŒºåˆ«åå†çœ‹è¿™é‡Œçš„åˆ†æä¼šæ›´åŠ å®¹æ˜“ç†è§£ã€‚</p><p>æ€»çš„æ¥è¯´ï¼š</p><ul><li><code>relabel_configs</code> ç”¨äºå¯¹æŠ“å–ç›®æ ‡å…ƒæ•°æ®çš„å¢åˆ æ”¹ï¼›å¦‚æœåˆ é™¤åè¿åç»­çš„æŠ“å–ä»»åŠ¡ä¹Ÿä¼šè¢«å–æ¶ˆã€‚</li><li><code>metric_relabel_configs</code> ç”¨äºå¯¹æŠ“å–åˆ°çš„æ•°æ®å¢åˆ æ”¹ï¼Œå¯¹äºä¸éœ€è¦çš„ä¸šåŠ¡æŒ‡æ ‡å¯ä»¥åœ¨è¿™é‡Œé…ç½®ã€‚</li></ul><p>ä¹Ÿå°±æ˜¯å‰æ–‡è®²åˆ°çš„ <code>relabel_configs</code> åº”ç”¨äºæŒ‡æ ‡æŠ“å–å‰ï¼Œ<code>metric_relabel_configs</code> åº”ç”¨äºæŒ‡æ ‡æŠ“å–åã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/03/11/Xxp5yNTH1ASBk3Z.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;æœ€è¿‘æ¥æ‰‹ç»´æŠ¤äº†å…¬å¸çš„æŒ‡æ ‡ç›‘æ§ç³»ç»Ÿï¼Œä¹‹åè¸©åˆ°å‘å°±æ²¡ç«™èµ·æ¥è¿‡ã€‚ã€‚&lt;br&gt;&lt;img src=&quot;https://s2.loli.net/2023/03/11/UwBJ28ZafziRsQS.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="metrics" scheme="http://crossoverjie.top/categories/metrics/"/>
    
    
    <category term="K8s" scheme="http://crossoverjie.top/tags/K8s/"/>
    
    <category term="Prometheus" scheme="http://crossoverjie.top/tags/Prometheus/"/>
    
    <category term="VictoriaMetrics" scheme="http://crossoverjie.top/tags/VictoriaMetrics/"/>
    
  </entry>
  
  <entry>
    <title>é€šè¿‡ Pulsar æºç å½»åº•è§£å†³é‡å¤æ¶ˆè´¹é—®é¢˜</title>
    <link href="http://crossoverjie.top/2023/02/27/pulsar/pulsar-repeat-consume/"/>
    <id>http://crossoverjie.top/2023/02/27/pulsar/pulsar-repeat-consume/</id>
    <published>2023-02-27T00:08:08.000Z</published>
    <updated>2023-02-26T13:42:52.831Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/02/26/Oz94bQasM2Einok.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘çœŸæ˜¯å’Œ <code>Pulsar</code> æ ä¸Šäº†ï¼Œä¸šåŠ¡å›¢é˜Ÿåé¦ˆè¯´æ˜¯çº¿ä¸Šæœ‰ä¸ªåº”ç”¨æ¶ˆæ¯é‡å¤æ¶ˆè´¹ã€‚</p><p><img src="https://s2.loli.net/2023/02/26/c2eZuTPUvrlB1YF.png"></p><p>è€Œä¸”åœ¨æµ‹è¯•ç¯å¢ƒæ˜¯å¯ä»¥ç¨³å®šå¤ç°çš„ï¼Œæ ¹æ®ç»éªŒæ¥çœ‹ä¸€èˆ¬èƒ½ç¨³å®šå¤ç°çš„éƒ½æ¯”è¾ƒå¥½è§£å†³ã€‚</p><span id="more"></span><h1 id="å®šä½é—®é¢˜"><a href="#å®šä½é—®é¢˜" class="headerlink" title="å®šä½é—®é¢˜"></a>å®šä½é—®é¢˜</h1><p>æ¥ç€ä¾¿æ˜¯å®šä½é—®é¢˜äº†ï¼Œæ ¹æ®ä¹‹å‰çš„ç»éªŒè®©ä¸šåŠ¡æŒ‰ç…§è¿™å‡ ç§æƒ…å†µå…ˆæ’æŸ¥ä¸€ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/02/26/IrvxGDQuaSt7AOE.png"></p><p>é€šè¿‡æ’æŸ¥ï¼š1,2å¯ä»¥æ’é™¤äº†ã€‚</p><ol><li>æ²¡æœ‰ç›¸å…³æ—¥å¿—</li><li>å­˜åœ¨å¼‚å¸¸ï¼Œä½†æœ€å¤–å±‚ä¹Ÿæ•è·äº†ï¼Œæ‰€ä»¥ä¸ç®¡æœ‰æ— å¼‚å¸¸éƒ½ä¼š ACKã€‚</li></ol><p>ç¬¬ä¸‰ä¸ªä¹Ÿåœ¨æ¶ˆè´¹çš„å…¥å£å’Œæäº¤æ¶ˆæ¯å‡ºè®¡ç®—äº†æ—¶é—´ï¼Œæœ€ç»ˆå‘ç°éƒ½æ˜¯åœ¨2så·¦å³ ACK çš„ã€‚</p><p>ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> client.newConsumer()</span><br><span class="line">        .subscriptionType(SubscriptionType.Shared)</span><br><span class="line">        .enableRetry(<span class="literal">true</span>)</span><br><span class="line">        .topic(topic)</span><br><span class="line">        .ackTimeout(<span class="number">30</span>, TimeUnit.SECONDS)</span><br><span class="line">        .subscriptionName(<span class="string">&quot;my-sub&quot;</span>)</span><br><span class="line">        .messageListener(<span class="keyword">new</span> <span class="title class_">MessageListener</span>&lt;<span class="type">byte</span>[]&gt;() &#123;</span><br><span class="line">            <span class="meta">@SneakyThrows</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">received</span><span class="params">(Consumer&lt;<span class="type">byte</span>[]&gt; consumer, Message&lt;<span class="type">byte</span>[]&gt; msg)</span> &#123;</span><br><span class="line">                log.info(<span class="string">&quot;msg_id&#123;&#125;&quot;</span>,msg.getMessageId().toString());</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">2</span>);</span><br><span class="line">                consumer.acknowledge(msg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .subscribe();</span><br></pre></td></tr></table></figure><p>é‚£è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œå› ä¸ºä»£ç é‡Œé…ç½®çš„ ackTimeout æ˜¯ 30sï¼Œç†è®ºä¸Šæ¥è¯´æ˜¯ä¸ä¼šå­˜åœ¨è¶…æ—¶å¯¼è‡´æ¶ˆæ¯é‡å‘çš„ã€‚</p><p>ä¸ºäº†æ’é™¤æ˜¯å¦æ˜¯è¶…æ—¶å¼•èµ·çš„ï¼Œç›´æ¥å°†ä¸šåŠ¡ä»£ç æ³¨é‡Šæ‰äº†ï¼Œç­‰äºæ˜¯æ¶ˆæ¯æ”¶åˆ°åç«‹å³å°± ACKï¼Œç»è¿‡æµ‹è¯•å‘ç°è¿™æ ·ç¡®å®å°±æ²¡æœ‰é‡å¤æ¶ˆè´¹äº†ã€‚</p><p>ä¸ºäº†å†æ¬¡ç¡®è®¤æ˜¯ä¸æ˜¯å’Œ ackTimeout æœ‰å…³ï¼Œç›´æ¥å°† <code>.ackTimeout(30, TimeUnit.SECONDS)</code> æ³¨é‡Šæ‰åæµ‹è¯•ï¼Œå‘ç°ä¹Ÿæ²¡æœ‰é‡å¤æ¶ˆè´¹äº†ã€‚</p><h1 id="ç¡®è®¤åŸå› "><a href="#ç¡®è®¤åŸå› " class="headerlink" title="ç¡®è®¤åŸå› "></a>ç¡®è®¤åŸå› </h1><p>æ—¢ç„¶å¦‚æ­¤é‚£ä¸€å®šæ˜¯å’Œè¿™ä¸ªé…ç½®æœ‰å…³äº†ï¼Œä½†çœ‹ä»£ç ç¡®å®æ²¡æœ‰è¶…æ—¶ï¼Œä¸ºäº†å®šä½å…·ä½“åŸå› åªæœ‰å»çœ‹ client çš„æºç äº†ã€‚</p><p>è¿™é‡Œç®€å•æ¢³ç†ä¸‹æ¶ˆæ¯çš„æ¶ˆè´¹çš„æµç¨‹ï¼š</p><ol><li>æ ¹æ® <code>.receiverQueueSize(1000)</code> çš„é…ç½®ï¼Œé»˜è®¤æƒ…å†µä¸‹ broker ä¼šç›´æ¥ç»™å®¢æˆ·ç«¯æ¨é€ 1000 æ¡æ¶ˆæ¯ã€‚</li><li>å®¢æˆ·ç«¯å°†è¿™ 1000 æ¡æ¶ˆæ¯ä¿å­˜åˆ°å†…éƒ¨é˜Ÿåˆ—ä¸­ã€‚</li><li>å¦‚æœä½¿ç”¨åŒæ­¥æ¶ˆè´¹ <code>receive()</code> æ—¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å» <code>take</code> è¿™ä¸ªå†…éƒ¨é˜Ÿåˆ—ã€‚</li><li>å¦‚æœæ˜¯ä½¿ç”¨çš„æ˜¯ <code>messageListener</code> å¼‚æ­¥æ¶ˆè´¹å¹¶é…ç½® <code>ackTimeout</code>ï¼Œæ¯å½“ä»é˜Ÿåˆ—é‡Œè·å¾—ä¸€æ¡æ¶ˆæ¯åä¾¿ä¼šæŠŠè¿™æ¡æ¶ˆæ¯åŠ å…¥ <code>UnAckedMessageTracker</code> å†…éƒ¨çš„ä¸€ä¸ªæ—¶é—´è½®ä¸­ï¼Œå®šæ—¶æ£€æµ‹é¡¶éƒ¨æ˜¯å¦å­˜åœ¨æ¶ˆæ¯ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¼šè§¦å‘é‡æ–°æŠ•é€’ã€‚<br>4.1 åŠ å…¥æ—¶é—´è½®åï¼Œ<code>å¼‚æ­¥</code>è°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„äº‹ä»¶ï¼Œè¿™ä¸ªå¼‚æ­¥æ“ä½œæ˜¯æäº¤åˆ°ä¸€ä¸ªæ— ç•Œé˜Ÿåˆ—ä¸­ç”±å•ä¸ªçº¿ç¨‹ä¾æ¬¡æ’é˜Ÿæ‰§è¡Œï¼ˆè¿™ç‚¹æ˜¯è¿™æ¬¡é—®é¢˜çš„å…³é”®ï¼‰</li><li>ä¸šåŠ¡ ACK çš„æ—¶å€™ä¼šä»æ—¶é—´è½®ä¸­åˆ é™¤æ¶ˆæ¯ï¼Œæ‰€ä»¥å¦‚æœæ¶ˆæ¯ ACK çš„è¶³å¤Ÿå¿«ï¼Œåœ¨ç¬¬å››æ­¥å°±ä¸ä¼šè·å–åˆ°æ¶ˆæ¯è¿›è¡Œé‡æ–°æŠ•é€’ã€‚</li></ol><p><img src="https://s2.loli.net/2023/02/26/2PuOadlU6oRqHVN.png"></p><p>æ•´ä½“æµç¨‹å¦‚ä¸Šå›¾ï¼Œä»£ç ç»†èŠ‚å¦‚ä¸‹å›¾ï¼š<br><img src="https://s2.loli.net/2023/02/26/jMOqBUe912cdEWg.png"></p><p>æ‰€ä»¥é—®é¢˜çš„æ ¹æœ¬åŸå› å°±æ˜¯å†™å…¥æ—¶é—´è½®ï¼ˆ<code>UnAckedMessageTracker</code>ï¼‰å¼€å§‹å€’è®¡æ—¶çš„çº¿ç¨‹å’Œå›è°ƒä¸šåŠ¡é€»è¾‘çš„ä¸æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ã€‚</p><p>å¦‚æœä¸šåŠ¡æ‰§è¡Œè€—æ—¶ï¼Œç­‰åˆ°æ¶ˆæ¯ä»é‚£ä¸ªå•çº¿ç¨‹çš„æ— ç•Œé˜Ÿåˆ—ä¸­å–å‡ºæ¥çš„æ—¶å€™å¾ˆæœ‰å¯èƒ½å·²ç»è¿‡äº† ackTimeou çš„æ—¶é—´ï¼Œä»è€Œå¯¼è‡´äº†è¶…æ—¶é‡å‘ã€‚</p><p>ä¹Ÿå°±æ˜¯ç”¨æˆ·æ‰€ç†è§£çš„ <code>ackTimeout</code> å‘¨æœŸï¼ˆåº”è¯¥è¿›å…¥å›è°ƒæ—¶å€™å¼€å§‹è®¡æ—¶ï¼‰å’Œ SDK å®ç°çš„ä¸ä¸€è‡´é€ æˆçš„ã€‚</p><p>ä¹‹åæˆ‘å†æ¬¡ç¡®è®¤åŒæ ·çš„ä»£ç æ¢ä¸ºåŒæ­¥æ¶ˆè´¹æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä¸ä¼šå¯¼è‡´é‡å¤æ¶ˆè´¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="type">Message</span> <span class="variable">msg</span> <span class="operator">=</span> consumer.receive();</span><br><span class="line">            log.info(</span><br><span class="line">                    <span class="string">&quot;consumer Message received: &quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(msg.getData()) + msg.getMessageId().toString());</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">2</span>);</span><br><span class="line">            consumer.acknowledge(msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä»£ç åå‘ç°åŒæ­¥ä»£ç çš„è·å–æ¶ˆæ¯å’ŒåŠ å…¥ <code>UnAckedMessageTracker</code> æ—¶é—´è½®æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±ä¸ä¼šå‡ºç°è¶…æ—¶çš„é—®é¢˜ã€‚<br><img src="https://s2.loli.net/2023/02/26/AUiDgXYO7QvINTF.png"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ‰€ä»¥å…¶å® æ˜¯<code>messageListener</code> å¼‚æ­¥æ¶ˆè´¹çš„ ackTimeout çš„è¯­ä¹‰æ˜¯æœ‰é—®é¢˜çš„ï¼Œéœ€è¦å°†åŠ å…¥ <code>UnAckedMessageTracker</code> å¤„ç§»åŠ¨åˆ°å›è°ƒå‡½æ•°ä¸­åŒæ­¥è°ƒç”¨ã€‚</p><p>æˆ‘æŸ¥çœ‹äº†æœ€æ–°çš„ <code>2.11.x</code> ç‰ˆæœ¬çš„ä»£ç ä¾ç„¶æ²¡æœ‰ä¿®å¤ï¼Œæ­£å‡†å¤‡æä¸ª PR åˆ‡æ¢åˆ° master æ—¶æ‰å‘ç°å·²ç»æœ‰ç›¸å…³çš„ PR äº†ï¼Œåªæ˜¯è¿˜æ²¡æœ‰å‘ç‰ˆã€‚</p><p>ä¿®å¤çš„èƒŒæ™¯å’Œæ€è·¯ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œå…·ä½“å‚è€ƒï¼š</p><p><a href="https://github.com/apache/pulsar/pull/18911">https://github.com/apache/pulsar/pull/18911</a></p><p>å…¶å®ä¸šåŠ¡ä¸­å¹¶ä¸æ¨èä½¿ç”¨ ackTimeout è¿™ä¸ªé…ç½®äº†ï¼Œä¸å¥½é¢„ä¼°æ—¶é—´ä»è€Œå¯¼è‡´è¶…æ—¶ï¼Œè€Œä¸”æˆ‘ç›¸ä¿¡å¤§éƒ¨åˆ†ä¸šåŠ¡é…ç½®å¥½ <code>ackTImeout</code> åç›´åˆ°åç»­å‡ºé—®é¢˜çš„æ—¶å€™æ‰æƒ³èµ·æ¥è¦æ”¹ã€‚<br>æ‰€ä»¥å¹²è„†ä¸€å¼€å§‹å°±ä¸è¦ä½¿ç”¨ã€‚</p><p>åœ¨ go ç‰ˆæœ¬çš„ SDK ä¸­ç›´æ¥åºŸå¼ƒæ‰äº†è¿™ä¸ªå‚æ•°ï¼Œæ¨èä½¿ç”¨ nack API æ›¿æ¢ã€‚</p><p><img src="https://s2.loli.net/2023/02/26/kQaZAcJi6WjNDXq.png"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/02/26/Oz94bQasM2Einok.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;æœ€è¿‘çœŸæ˜¯å’Œ &lt;code&gt;Pulsar&lt;/code&gt; æ ä¸Šäº†ï¼Œä¸šåŠ¡å›¢é˜Ÿåé¦ˆè¯´æ˜¯çº¿ä¸Šæœ‰ä¸ªåº”ç”¨æ¶ˆæ¯é‡å¤æ¶ˆè´¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/02/26/c2eZuTPUvrlB1YF.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;è€Œä¸”åœ¨æµ‹è¯•ç¯å¢ƒæ˜¯å¯ä»¥ç¨³å®šå¤ç°çš„ï¼Œæ ¹æ®ç»éªŒæ¥çœ‹ä¸€èˆ¬èƒ½ç¨³å®šå¤ç°çš„éƒ½æ¯”è¾ƒå¥½è§£å†³ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/categories/Pulsar/"/>
    
    
    <category term="Consumer" scheme="http://crossoverjie.top/tags/Consumer/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€ä¸ªè¯¡å¼‚çš„ Pulsar InterruptedException å¼‚å¸¸</title>
    <link href="http://crossoverjie.top/2023/02/23/pulsar/pulsar-interrupted/"/>
    <id>http://crossoverjie.top/2023/02/23/pulsar/pulsar-interrupted/</id>
    <published>2023-02-23T00:08:08.000Z</published>
    <updated>2023-02-22T17:11:31.775Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/02/22/mQaCJMopS1WAjVN.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p><img src="https://s2.loli.net/2023/02/22/Lw3UbtiJ1GKyg6x.png"><br>ä»Šå¤©æ”¶åˆ°ä¸šåŠ¡å›¢é˜Ÿåé¦ˆçº¿ä¸Šæœ‰ä¸ªåº”ç”¨å¾€ Pulsar ä¸­å‘é€æ¶ˆæ¯å¤±è´¥äº†ï¼Œç»è¿‡æ—¥å¿—æŸ¥çœ‹å¾—çŸ¥æ˜¯å‘é€æ¶ˆæ¯æ—¶å€™æŠ›å‡ºäº† <code>java.lang.InterruptedException</code> å¼‚å¸¸ã€‚</p><p>å’Œä¸šåŠ¡æ²Ÿé€šåå¾—çŸ¥æ˜¯åœ¨ä¸€ä¸ª <code>gRPC</code> æ¥å£ä¸­è§¦å‘çš„æ¶ˆæ¯å‘é€ï¼Œå¤§çº¦æŒç»­äº†åŠä¸ªå°æ—¶çš„å¼‚å¸¸åä¾¿æ¢å¤æ­£å¸¸äº†ï¼Œè¿™æ˜¯æ•´ä¸ªé—®é¢˜çš„èƒŒæ™¯ã€‚</p><span id="more"></span><h1 id="å‰ç½®æ’æŸ¥"><a href="#å‰ç½®æ’æŸ¥" class="headerlink" title="å‰ç½®æ’æŸ¥"></a>å‰ç½®æ’æŸ¥</h1><p>æ‹¿åˆ°è¯¥é—®é¢˜åé¦–å…ˆæ’æŸ¥ä¸‹æ˜¯å¦æ˜¯å…±æ€§é—®é¢˜ï¼ŒæŸ¥çœ‹äº†å…¶ä»–çš„åº”ç”¨æ²¡æœ‰å‘ç°ç±»ä¼¼çš„å¼‚å¸¸ï¼›åŒæ—¶ä¹ŸæŸ¥çœ‹äº† Pulsar broker çš„ç›‘æ§å¤§ç›˜ï¼Œåœ¨è¿™ä¸ªæ—¶é—´æ®µä¾ç„¶æ²¡æœ‰æ³¢åŠ¨å’Œå¼‚å¸¸ï¼›</p><p>è¿™æ ·å¯ä»¥åˆæ­¥æ’é™¤æ˜¯ Pulsar æœåŠ¡ç«¯çš„é—®é¢˜ã€‚</p><p>æ¥ç€ä¾¿æ˜¯æŸ¥çœ‹åº”ç”¨é‚£æ®µæ—¶é—´çš„è´Ÿè½½æƒ…å†µï¼Œä»åº”ç”¨ QPS åˆ° JVM çš„å„ä¸ªå†…å­˜æƒ…å†µä¾ç„¶æ²¡å‘ç°æœ‰ä»€ä¹ˆæ˜æ˜¾çš„å˜åŒ–ã€‚</p><h1 id="Pulsar-æºç æ’æŸ¥"><a href="#Pulsar-æºç æ’æŸ¥" class="headerlink" title="Pulsar æºç æ’æŸ¥"></a>Pulsar æºç æ’æŸ¥</h1><p>æ—¢ç„¶çœ‹èµ·æ¥åº”ç”¨æœ¬èº«å’Œ Pulsar broker éƒ½æ²¡æœ‰é—®é¢˜çš„è¯é‚£å°±åªèƒ½ä»å¼‚å¸¸æœ¬èº«æ¥æ’æŸ¥äº†ã€‚</p><p>é¦–å…ˆç¬¬ä¸€æ­¥è¦å¾—çŸ¥å…·ä½“ä½¿ç”¨çš„æ˜¯ <code>Pulsar-client</code> æ˜¯ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Œå› ä¸ºä¸šåŠ¡ä½¿ç”¨çš„æ˜¯å†…éƒ¨åŸºäºå®˜æ–¹ SDK å°è£… <code>springboot starter</code> æ‰€ä»¥ç¬¬ä¸€æ­¥è¿˜å¾—æ’æŸ¥è¿™ä¸ª <code>starter</code> æ˜¯å¦æœ‰å½±å“ã€‚</p><p>é€šè¿‡æŸ¥çœ‹æºç åŸºæœ¬æ’é™¤äº† <code>starter</code> çš„å«Œç–‘ï¼Œé‡Œé¢åªæ˜¯ç®€å•çš„å°è£…äº† <code>SDK</code> çš„åŠŸèƒ½è€Œå·²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">org.apache.pulsar.client.api.PulsarClientException: java.util.concurrent.ExecutionException: org.apache.pulsar.client.api.PulsarClientException: java.lang.InterruptedException at org.apache.pulsar.client.api.PulsarClientException.unwrap(PulsarClientException.java:<span class="number">1027</span>) at org.apache.pulsar.client.impl.TypedMessageBuilderImpl.send(TypedMessageBuilderImpl.java:<span class="number">91</span>) at </span><br><span class="line">java.base/java.lang.Thread.run(Thread.java:<span class="number">834</span>) Caused by: java.util.concurrent.ExecutionException: org.apache.pulsar.client.api.PulsarClientException: java.lang.InterruptedException at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:<span class="number">395</span>) </span><br><span class="line">at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:<span class="number">1999</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.TypedMessageBuilderImpl.send(TypedMessageBuilderImpl.java:<span class="number">89</span>) ... <span class="number">49</span> common frames omitted Caused by: org.apache.pulsar.client.api.PulsarClientException: java.lang.InterruptedException </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.canEnqueueRequest(ProducerImpl.java:<span class="number">775</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.sendAsync$original$BWm7PPlZ(ProducerImpl.java:<span class="number">393</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.sendAsync$original$BWm7PPlZ$accessor$i7NYMN6i(ProducerImpl.java) </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl$auxiliary$EfuVvJLT.call(Unknown Source) </span><br><span class="line">at org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstMethodsInter.intercept(InstMethodsInter.java:<span class="number">86</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.sendAsync(ProducerImpl.java) </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.internalSendAsync(ProducerImpl.java:<span class="number">292</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.internalSendWithTxnAsync(ProducerImpl.java:<span class="number">363</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.PartitionedProducerImpl.internalSendWithTxnAsync(PartitionedProducerImpl.java:<span class="number">191</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.PartitionedProducerImpl.internalSendAsync(PartitionedProducerImpl.java:<span class="number">167</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.TypedMessageBuilderImpl.sendAsync(TypedMessageBuilderImpl.java:<span class="number">103</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.TypedMessageBuilderImpl.send(TypedMessageBuilderImpl.java:<span class="number">82</span>) ... <span class="number">49</span> common frames omitted Caused by: java.lang.InterruptedException: <span class="literal">null</span></span><br><span class="line">at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:<span class="number">1343</span>) </span><br><span class="line">at java.base/java.util.concurrent.Semaphore.acquire(Semaphore.java:<span class="number">318</span>) </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.canEnqueueRequest(ProducerImpl.java:<span class="number">758</span>)</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä¾¿åªèƒ½æ˜¯åˆ†æå †æ ˆäº†ï¼Œå› ä¸º Pulsar-client çš„éƒ¨åˆ†å®ç°æºç æ˜¯æ²¡æœ‰ç›´æ¥æ‰“åŒ…åˆ°ä¾èµ–ä¸­çš„ï¼Œåç¼–è¯‘çš„è¯è®¸å¤šä»£ç è¡Œæ•°å¯¹ä¸ä¸Šï¼Œæ‰€ä»¥éœ€è¦å°†å®˜æ–¹çš„æºç æ‹‰åˆ°æœ¬åœ°ï¼Œåˆ‡æ¢åˆ°å¯¹äºçš„åˆ†æ”¯è¿›è¡ŒæŸ¥çœ‹ã€‚</p><blockquote><p>è¿™ä¸€æ­¥ç¨å¾®æœ‰ç‚¹éº»çƒ¦ï¼Œé¦–å…ˆæ˜¯ä»£ç åº“è¿˜æŒºå¤§çš„ï¼ŒåŠ ä¸Šä¹‹å‰å¦‚æœæ²¡æœ‰å‡†å¤‡å¥½ Pulsar çš„å¼€å‘ç¯å¢ƒçš„è¯ä¼°è®¡ä¼šåŠé€€ä¸€éƒ¨åˆ†äººï¼›ä½†å…¶å®å¤§éƒ¨åˆ†é—®é¢˜éƒ½æ˜¯ç½‘ç»œé€ æˆçš„ï¼Œåªè¦é…ç½®ä¸€äº› Maven é•œåƒå¤šè¯•å‡ æ¬¡æ€»ä¼šç¼–è¯‘æˆåŠŸã€‚</p></blockquote><p>æˆ‘è¿™é‡Œç›´æ¥å°†åˆ†æ”¯åˆ‡æ¢åˆ° <code>branch-2.8</code>ã€‚</p><p>ä»å †æ ˆçš„é¡¶éƒ¨å¼€å§‹æ’æŸ¥ <code>TypedMessageBuilderImpl.java:91</code>ï¼š<br><img src="https://s2.loli.net/2023/02/23/Q53Vm1Fkau9Yn2c.png"><br>çœ‹èµ·æ¥æ˜¯å†…éƒ¨å¼‚æ­¥å‘é€æ¶ˆæ¯çš„æ—¶å€™æŠ›äº†å¼‚å¸¸ã€‚</p><p>æ¥ç€å¾€ä¸‹çœ‹åˆ°è¿™é‡Œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.InterruptedException </span><br><span class="line">at org.apache.pulsar.client.impl.ProducerImpl.canEnqueueRequest(ProducerImpl.java:<span class="number">775</span>) at</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/02/23/LdJspv5CfaRm3EW.png"><br>çœ‹èµ·æ¥æ˜¯è¿™é‡Œæ²¡é”™ï¼Œä½†æ˜¯ä»£ç è¡Œæ•°æ˜æ˜¾ä¸å¯¹ï¼›å› ä¸º 2.8 è¿™ä¸ªåˆ†æ”¯ä¹Ÿæ˜¯ä¿®å¤è¿‡å‡ ä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥ä¸­é—´æœ‰ä¿®æ”¹å¯¼è‡´ä»£ç è¡Œæ•°ä¸æœ€æ–°ä»£ç å¯¹ä¸ä¸Šä¹Ÿæ­£å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">semaphore.get().acquire();</span><br></pre></td></tr></table></figure><p>ä¸è¿‡åˆæ­¥æ¥çœ‹åº”è¯¥æ˜¯è¿™è¡Œä»£ç æŠ›å‡ºçš„çº¿ç¨‹ç»ˆç«¯å¼‚å¸¸ï¼Œè¿™é‡Œçœ‹èµ·æ¥åªæœ‰ä»–æœ€æœ‰å¯èƒ½äº†ã€‚</p><p><img src="https://s2.loli.net/2023/02/23/V3mFAuRKzgWnN5T.png"><br>ä¸ºäº†ç¡®è®¤æ˜¯å¦æ˜¯çœŸçš„æ˜¯è¿™è¡Œä»£ç ï¼Œè¿™ä¸ªæ–‡ä»¶å†å¾€å‰ç¿»äº†å‡ ä¸ªç‰ˆæœ¬æœ€ç»ˆç¡®è®¤äº†å°±æ˜¯è¿™è¡Œä»£ç æ²¡é”™äº†ã€‚</p><p>æˆ‘ä»¬ç‚¹å¼€<code>java.util.concurrent.Semaphore#acquire()</code>çš„æºç ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;has its interrupted status set on entry to this method; or</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;is &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125; while waiting</span></span><br><span class="line"><span class="comment"> * for a permit,</span></span><br><span class="line"><span class="comment"> * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment"> * then &#123;<span class="doctag">@link</span> InterruptedException&#125; is thrown and the current thread&#x27;s</span></span><br><span class="line"><span class="comment"> * interrupted status is cleared.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> InterruptedException if the current thread is interrupted</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">acquire</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    sync.acquireSharedInterruptibly(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">acquireSharedInterruptibly</span><span class="params">(<span class="type">int</span> arg)</span></span><br><span class="line">    <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="keyword">if</span> (Thread.interrupted() ||</span><br><span class="line">        (tryAcquireShared(arg) &lt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">         acquire(<span class="literal">null</span>, arg, <span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="number">0L</span>) &lt; <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InterruptedException</span>();</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><p>é€šè¿‡æºç ä¼šå‘ç° <code>acquire()</code> å‡½æ•°ç¡®å®ä¼šå“åº”ä¸­æ–­ï¼Œä¸€æ—¦æ£€æµ‹åˆ°å½“å‰çº¿ç¨‹è¢«ä¸­æ–­åä¾¿ä¼šæŠ›å‡º <code>InterruptedException</code> å¼‚å¸¸ã€‚</p><h1 id="å®šä½é—®é¢˜"><a href="#å®šä½é—®é¢˜" class="headerlink" title="å®šä½é—®é¢˜"></a>å®šä½é—®é¢˜</h1><p>æ‰€ä»¥é—®é¢˜çš„åŸå› åŸºæœ¬ç¡®å®šäº†ï¼Œå°±æ˜¯åœ¨ Pulsar çš„å‘é€æ¶ˆæ¯çº¿ç¨‹è¢«ä¸­æ–­äº†å¯¼è‡´çš„ï¼Œä½†ä¸ºå•¥ä¼šè¢«ä¸­æ–­è¿˜éœ€è¦ç»§ç»­æ’æŸ¥ã€‚</p><p>æˆ‘ä»¬çŸ¥é“çº¿ç¨‹ä¸­æ–­æ˜¯éœ€è¦è°ƒç”¨ <code>Thread.currentThread().interrupt();</code> APIçš„ï¼Œé¦–å…ˆçŒœæµ‹æ˜¯å¦ Pulsar å®¢æˆ·ç«¯å†…éƒ¨æœ‰ä¸ªçº¿ç¨‹ä¸­æ–­äº†è¿™ä¸ªå‘é€çº¿ç¨‹ã€‚</p><p>äºæ˜¯æˆ‘åœ¨ <code>pulsar-client</code> è¿™ä¸ªæ¨¡å—ä¸­æœç´¢äº†ç›¸å…³ä»£ç ï¼š<br><img src="https://s2.loli.net/2023/02/23/w6USaRvMqAIjCfm.png"><br>æ’é™¤æ‰å’Œ producer ä¸ç›¸å…³çš„åœ°æ–¹ï¼Œå…¶ä½™æ‰€æœ‰ä¸­æ–­çº¿ç¨‹çš„ä»£ç éƒ½æ˜¯åœ¨æœ‰äº†è¯¥å¼‚å¸¸ä¹‹åç»§ç»­ä¼ é€’è€Œå·²ï¼›æ‰€ä»¥åˆæ­¥æ¥çœ‹ pulsar-client å†…éƒ¨æ²¡æœ‰ä¸»åŠ¨ä¸­æ–­çš„æ“ä½œã€‚</p><p>æ—¢ç„¶ Pulsar è‡ªå·±æ²¡æœ‰åšï¼Œé‚£å°±åªå¯èƒ½æ˜¯ä¸šåŠ¡åšçš„äº†ï¼Ÿ</p><p>äºæ˜¯æˆ‘åœ¨ä¸šåŠ¡ä»£ç ä¸­æœç´¢äº†ä¸€ä¸‹ï¼š<br><img src="https://s2.loli.net/2023/02/23/lVzJPf9ZWBGmuti.png"></p><p>æœç„¶åœ¨ä¸šåŠ¡ä»£ç ä¸­æœåˆ°äº†å”¯ä¸€ä¸€å¤„ä¸­æ–­çš„åœ°æ–¹ï¼Œè€Œä¸”é€šè¿‡è°ƒç”¨å…³ç³»å¾—çŸ¥è¿™æ®µä»£ç æ˜¯åœ¨æ¶ˆæ¯å‘é€å‰æ‰§è¡Œçš„ï¼Œå¹¶ä¸”å’Œ Pulsar å‘é€å‡½æ•°å¤„äºåŒä¸€çº¿ç¨‹ã€‚</p><p>å¤§æ¦‚çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">    List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).stream().map(e -&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        TimeUnit.MILLISECONDS.sleep(<span class="number">10</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(ex);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">    ).collect(Collectors.toList()).forEach(f -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">integer</span> <span class="operator">=</span> f.get();</span><br><span class="line">            log.info(<span class="string">&quot;====&quot;</span> + integer);</span><br><span class="line">            <span class="keyword">if</span> (integer==<span class="number">3</span>)&#123;</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">10</span>);</span><br><span class="line">                Thread.currentThread().interrupt();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExecutionException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="type">MessageId</span> <span class="variable">send</span> <span class="operator">=</span> producer.newMessage().value(msg.getBytes()).send();</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿™æ®µä»£ç å¯ä»¥å®Œå…¨å¤ç°åŒæ ·çš„å †æ ˆã€‚</p><p>å¹¸å¥½ä¸­æ–­è¿™é‡Œè¿˜æ‰“å¾—æœ‰æ—¥å¿—ï¼š</p><p><img src="https://s2.loli.net/2023/02/23/nHE4WcfaKD8iqSb.png"><br><img src="https://s2.loli.net/2023/02/23/4df5ehMBwj9DyQV.png"></p><p>é€šè¿‡æ—¥å¿—æœç´¢å‘ç°å¼‚å¸¸çš„æ—¶é—´å’Œè¿™ä¸ªä¸­æ–­çš„æ—¥å¿—æ—¶é—´ç‚¹å®Œå…¨é‡åˆï¼Œè¿™æ ·ä¹Ÿå°±çŸ¥é“æ ¹æœ¬åŸå› äº†ã€‚</p><p>å› ä¸ºä¸šåŠ¡çº¿ç¨‹å’Œæ¶ˆæ¯å‘é€çº¿ç¨‹æ˜¯åŒä¸€ä¸ªï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ä¼šæ‰§è¡Œ <code>Thread.currentThread().interrupt();</code>ï¼Œå…¶å®å•çº¯æ‰§è¡Œè¿™è¡Œå‡½æ•°å¹¶ä¸ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œåªè¦æ²¡æœ‰å»å“åº”è¿™ä¸ªä¸­æ–­ï¼Œä¹Ÿå°±æ˜¯ <code>Semaphore</code> æºç ä¸­çš„åˆ¤æ–­äº†çº¿ç¨‹ä¸­æ–­çš„æ ‡è®°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">acquireSharedInterruptibly</span><span class="params">(<span class="type">int</span> arg)</span></span><br><span class="line">    <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="keyword">if</span> (Thread.interrupted() ||</span><br><span class="line">        (tryAcquireShared(arg) &lt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">         acquire(<span class="literal">null</span>, arg, <span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="number">0L</span>) &lt; <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InterruptedException</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ°å¥½è¿™é‡Œä¸šåŠ¡ä¸­æ–­åè‡ªå·±å¹¶æ²¡æœ‰å»åˆ¤æ–­è¿™ä¸ªæ ‡è®°ï¼Œå¯¼è‡´ Pulsar å†…éƒ¨å»åˆ¤æ–­äº†ï¼Œæœ€ç»ˆæŠ›å‡ºäº†è¿™ä¸ªå¼‚å¸¸ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ‰€ä»¥å½’æ ¹ç»“åº•è¿˜æ˜¯è¿™é‡Œçš„ä»£ç ä¸åˆç†å¯¼è‡´çš„ï¼Œé¦–å…ˆæ˜¯è‡ªå·±ä¸­æ–­äº†çº¿ç¨‹ä½†ä¹Ÿæ²¡ä½¿ç”¨ï¼Œä»è€Œå¯¼è‡´æœ‰è¢«å…¶ä»–åŸºç¡€åº“ä½¿ç”¨çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¼šé€ æˆäº†ä¸€äº›ä¸å¯é¢„çŸ¥çš„åæœã€‚</p><p>å†ä¸€ä¸ªæ˜¯ä¸å»ºè®®åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨ <code>Thread.currentThread().interrupt();</code> è¿™ç±»ä»£ç ï¼Œç¬¬ä¸€çœ¼æ ¹æœ¬ä¸çŸ¥é“æ˜¯è¦å¹²å•¥ï¼Œä¹Ÿä¸æ˜“ç»´æŠ¤ã€‚</p><p>å…¶å®æœ¬è´¨ä¸Šçº¿ç¨‹ä¸­æ–­ä¹Ÿæ˜¯çº¿ç¨‹é—´é€šä¿¡çš„ä¸€ç§æ‰‹æ®µï¼Œæœ‰è¿™ç±»éœ€æ±‚å®Œå…¨å¯ä»¥æ¢ä¸ºå†…ç½®çš„ <code>BlockQueue</code> è¿™ç±»å‡½æ•°æ¥å®ç°ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/02/22/mQaCJMopS1WAjVN.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/02/22/Lw3UbtiJ1GKyg6x.png&quot;&gt;&lt;br&gt;ä»Šå¤©æ”¶åˆ°ä¸šåŠ¡å›¢é˜Ÿåé¦ˆçº¿ä¸Šæœ‰ä¸ªåº”ç”¨å¾€ Pulsar ä¸­å‘é€æ¶ˆæ¯å¤±è´¥äº†ï¼Œç»è¿‡æ—¥å¿—æŸ¥çœ‹å¾—çŸ¥æ˜¯å‘é€æ¶ˆæ¯æ—¶å€™æŠ›å‡ºäº† &lt;code&gt;java.lang.InterruptedException&lt;/code&gt; å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;å’Œä¸šåŠ¡æ²Ÿé€šåå¾—çŸ¥æ˜¯åœ¨ä¸€ä¸ª &lt;code&gt;gRPC&lt;/code&gt; æ¥å£ä¸­è§¦å‘çš„æ¶ˆæ¯å‘é€ï¼Œå¤§çº¦æŒç»­äº†åŠä¸ªå°æ—¶çš„å¼‚å¸¸åä¾¿æ¢å¤æ­£å¸¸äº†ï¼Œè¿™æ˜¯æ•´ä¸ªé—®é¢˜çš„èƒŒæ™¯ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/categories/Pulsar/"/>
    
    
    <category term="InterruptedException" scheme="http://crossoverjie.top/tags/InterruptedException/"/>
    
  </entry>
  
  <entry>
    <title>Istio å‡çº§åè¸©çš„å‘</title>
    <link href="http://crossoverjie.top/2023/02/20/istio/istio1.12-upgrade-fix/"/>
    <id>http://crossoverjie.top/2023/02/20/istio/istio1.12-upgrade-fix/</id>
    <published>2023-02-20T00:08:08.000Z</published>
    <updated>2023-02-19T13:42:29.744Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/02/19/FwgABGdDrhR4a3j.png"></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰æ®µæ—¶é—´æˆ‘ä»¬å°† istio ç‰ˆæœ¬å‡çº§åˆ° 1.12 åå¯¼è‡´ç°æœ‰çš„åº”ç”¨ç›‘æ§æœ‰éƒ¨åˆ†æ•°æ®ä¸¢å¤±ï¼ˆé¡µé¢ä¸Šæ˜¾ç¤ºä¸å‡ºæ¥ï¼‰ã€‚</p><ul><li>ä¸€ä¸ªæ˜¯åº”ç”¨åŸºç¡€ä¿¡æ¯ä¸¢å¤±ã€‚</li><li>å†ä¸€ä¸ªæ˜¯åº”ç”¨ JVM æ•°æ®ä¸¢å¤±ã€‚</li><li>æ¥å£ç»´åº¦çš„ç›‘æ§æ•°æ®ä¸¢å¤±ã€‚</li></ul><span id="more"></span><p><img src="https://s2.loli.net/2023/02/19/6eSAIF1Jcjhrp4x.png"></p><hr><p><img src="https://s2.loli.net/2023/02/19/Lyr4cSxVmutjJU6.png"></p><hr><p><img src="https://s2.loli.net/2023/02/19/aPzD9t7L1mGqiJR.png"></p><hr><h2 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h2><h3 id="åŸºç¡€ä¿¡æ¯"><a href="#åŸºç¡€ä¿¡æ¯" class="headerlink" title="åŸºç¡€ä¿¡æ¯"></a>åŸºç¡€ä¿¡æ¯</h3><p>é¦–å…ˆæ˜¯ç¬¬ä¸€ä¸ªåŸºç¡€ä¿¡æ¯ä¸¢å¤±çš„é—®é¢˜ï¼Œé¡µé¢ä¸Šå…¶å®æ˜¾ç¤ºçš„æ˜¯æˆ‘ä»¬çš„ä¸€ä¸ªèšåˆæŒ‡æ ‡<code>istio_requests_total:source:rate1m</code>ã€‚</p><blockquote><p>èšåˆåå¯ä»¥å°†å¤šä¸ªæŒ‡æ ‡åˆå¹¶ä¸ºä¸€ä¸ªï¼Œå‡å°‘ç³»ç»Ÿå‹åŠ›</p></blockquote><p>å…·ä½“å¯ä»¥å‚è€ƒ Istio çš„æœ€ä½³å®è·µ <a href="https://istio.io/latest/docs/ops/best-practices/observability/#workload-level-aggregation-via-recording-rules">Observability Best Practices</a> æœ‰è¯¦ç»†è¯´æ˜ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">groups:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">interval:</span> <span class="string">30s</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">istio.service.source.istio_requests_total</span></span><br><span class="line">      <span class="attr">rules:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">expr:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            sum(irate(istio_requests_total&#123;reporter=&quot;source&quot;&#125;[1m]))</span></span><br><span class="line"><span class="string">            by (</span></span><br><span class="line"><span class="string">              destination_app,</span></span><br><span class="line"><span class="string">              source_workload_namespace,</span></span><br><span class="line"><span class="string">              response_code,</span></span><br><span class="line"><span class="string">              source_app</span></span><br><span class="line"><span class="string">            )</span></span><br><span class="line"><span class="string"></span>          <span class="attr">record:</span> <span class="string">istio_requests_total:source:rate1m</span></span><br></pre></td></tr></table></figure><p>æœ¬è´¨ä¸Šæ˜¯é€šè¿‡ä»¥ä¸Šå››ä¸ªç»´åº¦è¿›è¡Œç»Ÿè®¡ <code>istio_requests_total</code>ï¼›ä½†åœ¨å‡çº§ä¹‹åæŸ¥çœ‹åŸå§‹æ•°æ®å‘ç°ä¸¢å¤±äº† <code>destination_app, source_app</code> è¿™ä¸¤ä¸ª tagã€‚</p><p>è‡³äºä¸ºå•¥ä¸¢å¤±ï¼ŒæŸ¥äº†è®¸ä¹…ï¼Œæœ€ååœ¨å‡çº§åçš„èµ„æºæ–‡ä»¶ <code>stats-filter-1.12.yaml</code> ä¸­æ‰¾åˆ°äº†ç­”æ¡ˆ:<br><img src="https://s2.loli.net/2023/02/19/B7a6sH9CYznVGUI.png"><br>å‡çº§åæ–°å¢äº† <code>tags_to_remove</code> æ ‡è®°ï¼Œå°†æˆ‘ä»¬æ‰€éœ€è¦çš„ä¸¤ä¸ª tag ç›´æ¥åˆ æ‰äº†ã€‚</p><p>åç»­åœ¨å½“å‰ namespace ä¸‹é‡æ–°å»ºä¸€ä¸ª <code>EnvoyFilter</code> èµ„æºè¦†ç›–æ‰é»˜è®¤çš„ä¾¿èƒ½æ¢å¤è¿™ä¸¤ä¸ª tagï¼Œä¿®å¤åç›‘æ§é¡µé¢ä¹Ÿæ˜¾ç¤ºæ­£å¸¸äº†ã€‚</p><blockquote><p>EnvoyFilter æ˜¯å®æ—¶ç”Ÿæ•ˆçš„ï¼Œå¹¶ä¸éœ€è¦é‡å»ºåº”ç”¨ Podã€‚</p></blockquote><h3 id="JVM-ç›‘æ§"><a href="#JVM-ç›‘æ§" class="headerlink" title="JVM ç›‘æ§"></a>JVM ç›‘æ§</h3><p><code>JVM</code> æ•°æ®ä¸¢å¤±çš„è¿™ä¸ªåº”ç”¨ï¼Œç›´æ¥è¿›å…¥ <code>Pod</code> æŸ¥çœ‹æš´éœ²å‡ºçš„ <code>metric</code>ï¼Œå‘ç°æ•°æ®éƒ½æœ‰ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jvm_memory_pool_bytes_used&#123;pool=&quot;Code Cache&quot;,&#125; 1.32126784E8</span><br><span class="line">jvm_memory_pool_bytes_used&#123;pool=&quot;Metaspace&quot;,&#125; 2.74250552E8</span><br><span class="line">jvm_memory_pool_bytes_used&#123;pool=&quot;Compressed Class Space&quot;,&#125; 3.1766024E7</span><br><span class="line">jvm_memory_pool_bytes_used&#123;pool=&quot;G1 Eden Space&quot;,&#125; 1.409286144E9</span><br><span class="line">jvm_memory_pool_bytes_used&#123;pool=&quot;G1 Survivor Space&quot;,&#125; 2.01326592E8</span><br><span class="line">jvm_memory_pool_bytes_used&#123;pool=&quot;G1 Old Gen&quot;,&#125; 2.583691248E9</span><br></pre></td></tr></table></figure><p>è¯´æ˜ä¸æ˜¯æ•°æ®æºçš„é—®é¢˜ï¼Œé‚£å°±å¯èƒ½æ˜¯æ•°æ®é‡‡é›†èŠ‚ç‚¹çš„é—®é¢˜äº†ã€‚</p><p>è¿›å…¥<code>VictoriaMetrics</code> çš„ <code>target</code> é¡µé¢å‘ç°åº”ç”¨ç¡®å®å·²ç»ä¸‹çº¿ï¼ŒåŸæ¥æ˜¯é‡‡é›†çš„ç«¯å£ä¸é€šå¯¼è‡´çš„ã€‚</p><blockquote><p>æˆ‘ä»¬ä½¿ç”¨ VictoriaMetrics ä»£æ›¿äº† Prometheusã€‚</p></blockquote><p><img src="https://s2.loli.net/2023/02/19/Hhj6LutlvUsycES.png"></p><p>è€Œè¿™ä¸ªç«¯å£ 15020 ä¹‹å‰å¹¶æœªä½¿ç”¨ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å¦å¤–ä¸€ä¸ªè‡ªå®šä¹‰ç«¯å£å’Œç«¯ç‚¹æ¥é‡‡é›†æ•°æ®ã€‚</p><p>ç»è¿‡æŸ¥é˜…å‘ç° 15020 æ˜¯ istio é»˜è®¤çš„ç«¯å£ï¼š<br><img src="https://s2.loli.net/2023/02/19/LjOewSXl5IVPv6q.png"></p><p>åŸæ¥åœ¨é»˜è®¤æƒ…å†µä¸‹ Istio ä¼šä¸ºæ‰€æœ‰çš„æ•°æ®é¢ Pod åŠ ä¸Šï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">prometheus.io/path:</span> <span class="string">/stats/prometheus</span></span><br><span class="line">    <span class="attr">prometheus.io/port:</span> <span class="string">&quot;15020&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ³¨è§£ç”¨äºé‡‡é›†æ•°æ®ï¼Œç”±äºæˆ‘ä»¬æ˜¯è‡ªå®šä¹‰çš„ç«¯ç‚¹ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹é»˜è®¤è¡Œä¸ºï¼š<br><img src="https://s2.loli.net/2023/02/19/R7v8rG6f2XixlBU.png"></p><p>åœ¨æ§åˆ¶é¢å°† <code>--set meshConfig.enablePrometheusMerge=false</code> è®¾ç½®ä¸º falseï¼Œå…¶å®å®˜æ–¹æ–‡æ¡£å·²ç»è¯´æ˜ï¼Œå¦‚æœä¸æ˜¯ä½¿ç”¨çš„æ ‡å‡† <code>prometheus.io</code> æ³¨è§£ï¼Œéœ€è¦å°†è¿™ä¸ªè®¾ç½®ä¸º falseã€‚</p><blockquote><p>ä¿®æ”¹åéœ€è¦é‡å»ºåº”ç”¨ Pod æ–¹èƒ½ç”Ÿæ•ˆã€‚</p></blockquote><p>æœ‰äº† url è¿™ä¸ª tag åï¼Œæ¥å£ç›‘æ§é¡µä¹Ÿæ¢å¤äº†æ­£å¸¸ã€‚</p><h3 id="æ¥å£ç»´åº¦"><a href="#æ¥å£ç»´åº¦" class="headerlink" title="æ¥å£ç»´åº¦"></a>æ¥å£ç»´åº¦</h3><p>æ¥å£ç»´åº¦çš„æ•°æ®ä¸¢å¤±å’ŒåŸºæœ¬æ•°æ®ä¸¢å¤±çš„åŸå› ç±»ä¼¼ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯åŸå§‹æ•°æ®ä¸­ç¼ºå°‘äº† url è¿™ä¸ª tagï¼Œå› ä¸ºæˆ‘ä»¬æ‰€èšåˆçš„æŒ‡æ ‡ä½¿ç”¨äº† urlï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">interval:</span> <span class="string">30s</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">istio.service.source.url.istio_requests_total</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">expr:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        sum(irate(istio_requests_total&#123;reporter=&quot;source&quot;&#125;[1m]))</span></span><br><span class="line"><span class="string">        by (</span></span><br><span class="line"><span class="string">          destination_app,</span></span><br><span class="line"><span class="string">          source_workload_namespace,</span></span><br><span class="line"><span class="string">          response_code,</span></span><br><span class="line"><span class="string">          source_app,</span></span><br><span class="line"><span class="string">          url</span></span><br><span class="line"><span class="string">        )</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå‚è€ƒäº† <a href="https://istio.io/latest/docs/reference/config/proxy_extensions/stats/#MetricConfig">MetricConfig</a> è‡ªå®šä¹‰äº† URL çš„tag.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;dimensions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;request.url_path&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/02/19/tERXzV3TI1oe7bJ.png"><br>ä½†è¿™ä¹Ÿæœ‰ä¸ªå¤§å‰æï¼Œå½“æˆ‘ä»¬ tag çš„æŒ‡æ ‡æ²¡æœ‰åœ¨é»˜è®¤ tag åˆ—è¡¨ä¸­æ—¶ï¼Œéœ€è¦åœ¨ Deployment æˆ–è€…æ˜¯ Istio æ§åˆ¶é¢ä¸­å…¨å±€åŠ å…¥æˆ‘ä»¬è‡ªå®šä¹‰çš„ tag å£°æ˜ã€‚</p><p>æ¯”å¦‚è¿™é‡Œæ–°å¢äº† url çš„ tagï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨æ§åˆ¶é¢ä¸­åŠ å…¥ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">meshConfig:</span></span><br><span class="line">  <span class="attr">defaultConfig:</span></span><br><span class="line">    <span class="attr">extraStatTags:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">url</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹äº†æ§åˆ¶é¢åéœ€è¦é‡æ–°æ„å»º Pod åæ‰ä¼šç”Ÿæ•ˆã€‚</p></blockquote><h2 id="EnvoyFilterçš„é—®é¢˜"><a href="#EnvoyFilterçš„é—®é¢˜" class="headerlink" title="EnvoyFilterçš„é—®é¢˜"></a>EnvoyFilterçš„é—®é¢˜</h2><p>æŸ¥çœ‹<a href="https://istio.io/latest/docs/reference/config/proxy_extensions/stats/#MetricConfig">MetricConfig</a>çš„é…ç½®åå‘ç°æ˜¯å¯ä»¥ç›´æ¥å»æ‰æŒ‡æ ‡ä»¥åŠå»æ‰æŒ‡æ ‡ä¸­çš„ tag ï¼Œè¿™ä¸ªå¾ˆæœ‰ç”¨ï¼Œèƒ½å¤Ÿå¤§å¤§å‡ä½æŒ‡æ ‡é‡‡é›†ç³»ç»Ÿ <code>VictoriaMetrics</code> çš„ç³»ç»Ÿè´Ÿè½½ã€‚</p><p>äºæ˜¯å‚è€ƒäº†å®˜æ–¹çš„ç¤ºä¾‹ï¼Œå»æ‰äº†ä¸€äº› tagï¼ŒåŒæ—¶è¿˜å»æ‰äº†æŒ‡æ ‡ï¼š<code>istio_request_messages_total</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">      <span class="attr">&quot;tags_to_remove&quot;:</span> [</span><br><span class="line">        <span class="string">&quot;source_principal&quot;</span>,</span><br><span class="line">        <span class="string">&quot;source_version&quot;</span>,</span><br><span class="line">        <span class="string">&quot;destination_principal&quot;</span>,</span><br><span class="line">        <span class="string">&quot;destination_version&quot;</span>,</span><br><span class="line">        <span class="string">&quot;source_workload&quot;</span>,</span><br><span class="line">        <span class="string">&quot;source_cluster&quot;</span>,</span><br><span class="line">      ]</span><br><span class="line">&#125;<span class="string">,</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;name&quot;:</span> <span class="string">&quot;istio_request_messages_total&quot;</span>,</span><br><span class="line"><span class="attr">&quot;drop&quot;:</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œäºæ˜¯æ¢æˆäº†åœ¨ <code>v1.12</code> ä¸­æ–°å¢çš„ <code>Telemetry API</code>ã€‚</p><h1 id="ä½¿ç”¨-Telemetry-API"><a href="#ä½¿ç”¨-Telemetry-API" class="headerlink" title="ä½¿ç”¨ Telemetry API"></a>ä½¿ç”¨ Telemetry API</h1><p><img src="https://s2.loli.net/2023/02/19/bN4LiwQZm7rJHXW.png"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">telemetry.istio.io/v1alpha1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Telemetry</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mesh-istio-test</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">istio-test</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="comment"># no selector specified, applies to all workloads</span></span><br><span class="line">  <span class="attr">metrics:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">overrides:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">match:</span></span><br><span class="line">            <span class="attr">metric:</span> <span class="string">GRPC_REQUEST_MESSAGES</span></span><br><span class="line">            <span class="attr">mode:</span> <span class="string">CLIENT_AND_SERVER</span></span><br><span class="line">          <span class="attr">disabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å‚è€ƒäº†å®˜æ–¹æ–‡æ¡£åå‘ç°ä¾ç„¶ä¸èƒ½ç”Ÿæ•ˆï¼Œ<code>GRPC_REQUEST_MESSAGES</code> æ‰€å¯¹åº”çš„ <code>istio_request_messages_total</code> æŒ‡æ ‡ä¾ç„¶å­˜åœ¨ã€‚</p><p>æ¥ç€åœ¨æˆ‘é¢†å¯¼æŸ¥çœ‹ <code>Istio</code> æºç ä»¥åŠç›¸å…³ <a href="https://github.com/istio/istio/issues/37645">issue</a> åå‘ç° <code>Telemetry API</code> å’Œ <code>EnvoyFilter</code> æ˜¯ä¸èƒ½åŒæ—¶å­˜åœ¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šä¼˜å…ˆä½¿ç”¨ <code>EnvoyFilter</code>ï¼›è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¹‹å‰é…ç½®æ²¡æœ‰ç”Ÿæ•ˆçš„åŸå› ã€‚<br><img src="https://s2.loli.net/2023/02/19/M3uevVscNk5XOTd.png"></p><blockquote><p>ååˆå§‹åŒ– EnvoyFilter</p></blockquote><p><img src="https://s2.loli.net/2023/02/19/sbkrBdRwULSo9Yg.png"><br>æ­£å¦‚è¿™ä¸ª issue ä¸­æ‰€è¯´ï¼Œéœ€è¦åˆ æ‰ç°åœ¨æ‰€æœ‰çš„ EnvoyFilterï¼›åˆ é™¤åæœç„¶å°±ç”Ÿæ•ˆäº†ã€‚</p><p>æ–°çš„ <code>Telemetry API</code> ä¸ä½†è¯­ä¹‰æ›´åŠ æ¸…æ™°ï¼ŒåŠŸèƒ½ä¹Ÿä¸€æ ·æ²¡å°‘ï¼Œå€ŸåŠ©ä»–æˆ‘ä»¬ä¾ç„¶å¯ä»¥è‡ªå®šä¹‰ã€åˆ é™¤æŒ‡æ ‡ã€tag ç­‰ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">telemetry.istio.io/v1alpha1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Telemetry</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mesh-istio-telemetry-test</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">metrics:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">overrides:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">match:</span></span><br><span class="line">            <span class="attr">metric:</span> <span class="string">GRPC_RESPONSE_MESSAGES</span></span><br><span class="line">            <span class="attr">mode:</span> <span class="string">CLIENT_AND_SERVER</span></span><br><span class="line">          <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">tagOverrides:</span></span><br><span class="line">            <span class="attr">url:</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">&quot;request.url_path&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">match:</span></span><br><span class="line">            <span class="attr">metric:</span> <span class="string">ALL_METRICS</span></span><br><span class="line">          <span class="attr">tagOverrides:</span></span><br><span class="line">            <span class="attr">source_workload:</span></span><br><span class="line">              <span class="attr">operation:</span> <span class="string">REMOVE</span></span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ä»¥ä¸Šé…ç½®ä¾¿å¯ä»¥åˆ é™¤æ‰ <code>GRPC_RESPONSE_MESSAGES</code> æŒ‡æ ‡ï¼Œæ–°å¢ä¸€ä¸ª url çš„æŒ‡æ ‡ï¼ŒåŒæ—¶åœ¨æ‰€æœ‰æŒ‡æ ‡ä¸­åˆ é™¤äº† <code>source_workload</code> è¿™ä¸ª tagã€‚</p><p>å€ŸåŠ©äºè¿™ä¸€ä¸ªå£°æ˜æ–‡ä»¶ä¾¿èƒ½æ»¡è¶³æˆ‘ä»¬å¤šä¸ªéœ€æ±‚ã€‚</p><h2 id="è£å‰ªæŒ‡æ ‡"><a href="#è£å‰ªæŒ‡æ ‡" class="headerlink" title="è£å‰ªæŒ‡æ ‡"></a>è£å‰ªæŒ‡æ ‡</h2><p>åç»­æ ¹æ®æˆ‘ä»¬å®é™…éœ€æ±‚å€ŸåŠ©äº <code>Telemetry API</code> è£å‰ªæ‰äº†è®¸å¤šæŒ‡æ ‡å’Œ tagï¼Œä½¿å¾—æŒ‡æ ‡ç³»ç»Ÿè´Ÿè½½ä¸‹é™äº†ä¸€åŠå·¦å³ã€‚<br><img src="https://s2.loli.net/2023/02/19/rLqd3lUTgOK9RbS.png"><br>æ•ˆæœç›¸å½“æ˜æ˜¾ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ¬¡å®šä½ä¿®å¤ <code>Istio</code> å‡çº§åå¸¦æ¥çš„æŒ‡æ ‡ç³»ç»Ÿé—®é¢˜æ”¶è·å·¨å¤§ï¼Œä¹‹å‰å¯¹ Istio ä¸€ç›´åªåœç•™åœ¨ç†è®ºé˜¶æ®µï¼ŒåªçŸ¥é“ä»–å¯ä»¥å®ç°ä¼ ç»Ÿå¾®æœåŠ¡ä¸­å¯¹æ¥å£ç²’åº¦çš„æ§åˆ¶ï¼Œå®Œç¾å¼¥è¡¥äº† <code>k8s</code> åªæœ‰æœåŠ¡å±‚çº§çš„ç²—ç²’åº¦æ§åˆ¶ï¼›</p><p>è¿™ä¸¤å‘¨ä¸‹æ¥å¯¹ä¸€ä¸ªç°ä»£äº‘åŸç”Ÿç›‘æ§ç³»ç»Ÿä¹Ÿæœ‰äº†ç³»ç»Ÿçš„è®¤è¯†ï¼Œä» <code>App-&gt;Pod-&gt;sidecar-&gt;VictoriaMetrics(Prometheus)-&gt;Grafana</code> è¿™ä¸€å¥—æµç¨‹ä¸­æ¯ä¸ªç¯èŠ‚éƒ½å¯èƒ½ä¼šå‡ºé”™ï¼›</p><p>æ‰€ä»¥å­¦æ— æ­¢å¢ƒå§ï¼Œå¹¸å¥½å€ŸåŠ©å…¬å¸ä¸šåŠ¡åœºæ™¯åç»­è¿˜æœ‰æ›´å¤šæœºä¼šå‚ä¸å®è·µã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/02/19/FwgABGdDrhR4a3j.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´æˆ‘ä»¬å°† istio ç‰ˆæœ¬å‡çº§åˆ° 1.12 åå¯¼è‡´ç°æœ‰çš„åº”ç”¨ç›‘æ§æœ‰éƒ¨åˆ†æ•°æ®ä¸¢å¤±ï¼ˆé¡µé¢ä¸Šæ˜¾ç¤ºä¸å‡ºæ¥ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªæ˜¯åº”ç”¨åŸºç¡€ä¿¡æ¯ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;å†ä¸€ä¸ªæ˜¯åº”ç”¨ JVM æ•°æ®ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;æ¥å£ç»´åº¦çš„ç›‘æ§æ•°æ®ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="Istio" scheme="http://crossoverjie.top/categories/Istio/"/>
    
    
    <category term="K8s" scheme="http://crossoverjie.top/tags/K8s/"/>
    
    <category term="äº‘åŸç”Ÿ" scheme="http://crossoverjie.top/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/"/>
    
  </entry>
  
  <entry>
    <title>Pulsarè´Ÿè½½å‡è¡¡åŸç†åŠä¼˜åŒ–</title>
    <link href="http://crossoverjie.top/2023/02/07/pulsar/pulsar-load-banance/"/>
    <id>http://crossoverjie.top/2023/02/07/pulsar/pulsar-load-banance/</id>
    <published>2023-02-07T00:12:26.000Z</published>
    <updated>2023-02-07T01:38:09.189Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/02/04/d4NqxaoulEXnr5s.png"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‰æ®µæ—¶é—´æˆ‘ä»¬åœ¨å‡çº§ Pulsar ç‰ˆæœ¬çš„æ—¶å€™å‘ç°å‡çº§åæœ€åä¸€ä¸ªèŠ‚ç‚¹å§‹ç»ˆæ²¡æœ‰æµé‡ã€‚<br><img src="https://s2.loli.net/2023/02/07/ZwQ7sfVhuzb4tyv.jpg"></p><blockquote><p>è™½ç„¶å¯¹ä¸šåŠ¡ä½¿ç”¨æ²¡æœ‰ä»»ä½•å½±å“ï¼Œä½†è´Ÿè½½ä¸å‡ä¼šå¯¼è‡´èµ„æºçš„æµªè´¹ã€‚</p></blockquote><p>å’ŒåŒäº‹æ²Ÿé€šåå¾—çŸ¥ä¹‹å‰çš„å‡çº§ä¹Ÿä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œæœ€ç»ˆè¿˜æ˜¯äººå·¥è°ƒç”¨ Pulsar çš„ <code>admin API</code> å®Œæˆçš„è´Ÿè½½å‡è¡¡ã€‚</p><p>è¿™ä¸ªé—®é¢˜æˆ‘å°è¯•åœ¨ Google å’Œ Pulsar ç¤¾åŒºéƒ½æ²¡æœ‰æ‰¾åˆ°ç±»ä¼¼çš„ï¼Œä¸çŸ¥é“æ˜¯å¤§å®¶éƒ½æ²¡ç¢°åˆ°è¿˜æ˜¯å¾ˆå°‘å‡çº§é›†ç¾¤ã€‚</p><blockquote><p>æˆ‘ä¹‹å‰æ‰€åœ¨çš„å…¬å¸å°±æ˜¯ä¸€ä¸ªç‰ˆæœ¬èµ°åˆ°é»‘ğŸ˜‚</p></blockquote><span id="more"></span><h1 id="Pulsar-è´Ÿè½½å‡è¡¡åŸç†"><a href="#Pulsar-è´Ÿè½½å‡è¡¡åŸç†" class="headerlink" title="Pulsar è´Ÿè½½å‡è¡¡åŸç†"></a>Pulsar è´Ÿè½½å‡è¡¡åŸç†</h1><p>å½“ä¸€ä¸ªé›†ç¾¤å¯ä»¥æ°´å¹³æ‰©å±•åè´Ÿè½½å‡è¡¡å°±æ˜¾å¾—éå¸¸é‡è¦ï¼Œæ ¹æœ¬ç›®çš„æ˜¯ä¸ºäº†è®©æ¯ä¸ªæä¾›æœåŠ¡çš„èŠ‚ç‚¹éƒ½èƒ½å‡åŒ€çš„å¤„ç†è¯·æ±‚ï¼Œä¸ç„¶æ‰©å®¹å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚</p><p>åœ¨åˆ†æè¿™ä¸ªé—®é¢˜çš„åŸå› ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹ Pulsar è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹æ¡ˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Enable load balancer</span><br><span class="line">loadBalancerEnabled=true</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ª broker çš„è¿™ä¸ªé…ç½®æ¥æ§åˆ¶è´Ÿè½½å‡è¡¡å™¨çš„å¼€å…³ï¼Œé»˜è®¤æ˜¯æ‰“å¼€ã€‚</p><p>ä½†å…·ä½“ä½¿ç”¨å“ªä¸ªå®ç°ç±»æ¥ä½œä¸ºè´Ÿè½½å‡è¡¡å™¨ä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Name of load manager to use</span><br><span class="line">loadManagerClassName=org.apache.pulsar.broker.loadbalance.impl.ModularLoadManagerImpl</span><br></pre></td></tr></table></figure><p>é»˜è®¤ä½¿ç”¨çš„æ˜¯ <code>ModularLoadManagerImpl</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> LoadManager <span class="title function_">create</span><span class="params">(<span class="keyword">final</span> PulsarService pulsar)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">ServiceConfiguration</span> <span class="variable">conf</span> <span class="operator">=</span> pulsar.getConfiguration();</span><br><span class="line">        <span class="comment">// Assume there is a constructor with one argument of PulsarService.</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">loadManagerInstance</span> <span class="operator">=</span> Reflections.createInstance(conf.getLoadManagerClassName(),</span><br><span class="line">                Thread.currentThread().getContextClassLoader());</span><br><span class="line">        <span class="keyword">if</span> (loadManagerInstance <span class="keyword">instanceof</span> LoadManager) &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">LoadManager</span> <span class="variable">casted</span> <span class="operator">=</span> (LoadManager) loadManagerInstance;</span><br><span class="line">            casted.initialize(pulsar);</span><br><span class="line">            <span class="keyword">return</span> casted;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (loadManagerInstance <span class="keyword">instanceof</span> ModularLoadManager) &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">LoadManager</span> <span class="variable">casted</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModularLoadManagerWrapper</span>((ModularLoadManager) loadManagerInstance);</span><br><span class="line">            casted.initialize(pulsar);</span><br><span class="line">            <span class="keyword">return</span> casted;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        LOG.warn(<span class="string">&quot;Error when trying to create load manager: &quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// If we failed to create a load manager, default to SimpleLoadManagerImpl.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SimpleLoadManagerImpl</span>(pulsar);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ <code>broker</code> å¯åŠ¨æ—¶ä¼šä»é…ç½®æ–‡ä»¶ä¸­è¯»å–é…ç½®è¿›è¡ŒåŠ è½½ï¼Œå¦‚æœåŠ è½½å¤±è´¥ä¼šä½¿ç”¨ <code>SimpleLoadManagerImpl</code> ä½œä¸ºå…œåº•ç­–ç•¥ã€‚</p><p>å½“ broker æ˜¯ä¸€ä¸ªé›†ç¾¤æ—¶ï¼Œåªæœ‰ leader èŠ‚ç‚¹çš„ broker æ‰ä¼šæ‰§è¡Œè´Ÿè½½å‡è¡¡å™¨çš„é€»è¾‘ã€‚</p><blockquote><p>Leader é€‰ä¸¾æ˜¯é€šè¿‡ Zookeeper å®ç°çš„ã€‚</p></blockquote><p>é»˜ç„¶æƒ…å†µä¸‹æˆä¸º Leader èŠ‚ç‚¹çš„ broker ä¼šæ¯åˆ†é’Ÿè¯»å–å„ä¸ª broker çš„æ•°æ®æ¥åˆ¤æ–­æ˜¯å¦æœ‰èŠ‚ç‚¹è´Ÿè½½è¿‡é«˜éœ€è¦åšé‡å¹³è¡¡ã€‚</p><p>è€Œæ˜¯å¦é‡å¹³è¡¡çš„åˆ¤æ–­ä¾æ®æ˜¯ç”± <code>org.apache.pulsar.broker.loadbalance.LoadSheddingStrategy</code> æ¥å£æä¾›çš„ï¼Œå®ƒå…¶å®åªæœ‰ä¸€ä¸ªå‡½æ•°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">LoadSheddingStrategy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Recommend that all of the returned bundles be unloaded.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> A map from all selected bundles to the brokers on which they reside.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Multimap&lt;String, String&gt; <span class="title function_">findBundlesForUnloading</span><span class="params">(LoadData loadData, ServiceConfiguration conf)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æ‰€æœ‰ broker çš„è´Ÿè½½ä¿¡æ¯è®¡ç®—å‡ºä¸€ä¸ªéœ€è¦è¢« unload çš„ broker ä»¥åŠ bundleã€‚</p><p>è¿™é‡Œè§£é‡Šä¸‹ unload å’Œ bundle çš„æ¦‚å¿µï¼š</p><ul><li><code>bundle</code> æ˜¯ä¸€æ‰¹ <code>topic</code> çš„æŠ½è±¡ï¼Œå°† <code>bundle</code> å’Œ <code>broker</code> è¿›è¡Œå…³è”åå®¢æˆ·ç«¯æ‰èƒ½çŸ¥é“åº”å½“è¿æ¥å“ªä¸ª brokerï¼›è€Œä¸æ˜¯ç›´æ¥å°† topic ä¸ <code>broker</code> ç»‘å®šï¼Œè¿™æ ·æ‰èƒ½å®ç°æµ·é‡ topic çš„ç®¡ç†ã€‚</li><li>unload åˆ™æ˜¯å°†å·²ç»ä¸ broker ç»‘å®šçš„ bundle æ‰‹åŠ¨è§£ç»‘ï¼Œä»è€Œè§¦å‘è´Ÿè½½å‡è¡¡å™¨é€‰æ‹©ä¸€å°åˆé€‚çš„ broker é‡æ–°è¿›è¡Œç»‘å®šï¼›é€šå¸¸æ˜¯æ•´ä¸ªé›†ç¾¤è´Ÿè½½ä¸å‡çš„æ—¶å€™è§¦å‘ã€‚</li></ul><h2 id="ThresholdShedder-åŸç†"><a href="#ThresholdShedder-åŸç†" class="headerlink" title="ThresholdShedder åŸç†"></a>ThresholdShedder åŸç†</h2><p><code>LoadSheddingStrategy</code> æ¥å£ç›®å‰æœ‰ä¸‰ä¸ªå®ç°ï¼Œè¿™é‡Œä»¥å®˜æ–¹é»˜è®¤çš„ <code>ThresholdShedder</code> ä¸ºä¾‹ï¼š<br><img src="https://s2.loli.net/2023/02/07/9xqNPs31RtHOC2u.jpg"></p><p>å®ƒçš„å®ç°ç®—æ³•æ˜¯æ ¹æ®å¸¦å®½ã€å†…å­˜ã€æµé‡ç­‰å„ä¸ªæŒ‡æ ‡çš„æƒé‡ç®—å‡ºæ¯ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½å€¼ï¼Œä¹‹åä¸ºæ•´ä¸ªé›†ç¾¤è®¡ç®—å‡ºä¸€ä¸ªå¹³å‡è´Ÿè½½å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># é˜ˆå€¼</span><br><span class="line">loadBalancerBrokerThresholdShedderPercentage=10</span><br></pre></td></tr></table></figure><p>å½“é›†ç¾¤ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹çš„è´Ÿè½½å€¼è¶…è¿‡å¹³å‡è´Ÿè½½å€¼è¾¾åˆ°ä¸€å®šç¨‹åº¦ï¼ˆå¯é…ç½®çš„é˜ˆå€¼ï¼‰æ—¶ï¼Œå°±ä¼šè§¦å‘ unloadï¼Œä»¥ä¸Šå›¾ä¸ºä¾‹å°±ä¼šå°†æœ€å·¦è¾¹èŠ‚ç‚¹ä¸­çº¢è‰²éƒ¨åˆ†çš„ bundle å¸è½½æ‰ï¼Œç„¶åå†é‡æ–°è®¡ç®—ä¸€ä¸ªåˆé€‚çš„ broker è¿›è¡Œç»‘å®šã€‚</p><blockquote><p>é˜ˆå€¼å­˜åœ¨çš„ç›®çš„æ˜¯ä¸ºäº†é¿å…é¢‘ç¹çš„ unloadï¼Œä»è€Œå½±å“å®¢æˆ·ç«¯çš„è¿æ¥ã€‚</p></blockquote><h2 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h2><p>å½“æŸäº› topic çš„æµé‡çªç„¶çˆ†å¢çš„æ—¶å€™è¿™ç§è´Ÿè½½ç­–ç•¥ç¡®å®å¯ä»¥å¤„ç†çš„å¾ˆå¥½ï¼Œä½†åœ¨æˆ‘ä»¬é›†ç¾¤å‡çº§çš„æƒ…å†µå°±ä¸ä¸€å®šäº†ã€‚</p><p>å‡è®¾æˆ‘è¿™é‡Œæœ‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼š</p><ul><li>broker0</li><li>broker1</li><li>broker2</li></ul><p><img src="https://s2.loli.net/2023/02/07/9fpusPqY8BmkGdl.png"><br>é›†ç¾¤å‡çº§æ—¶ä¼šä» <code>broker2-&gt;0</code> è¿›è¡Œé•œåƒæ›¿æ¢é‡å¯ï¼Œå‡è®¾åœ¨å‡çº§å‰æ¯ä¸ª broker çš„è´Ÿè½½å€¼éƒ½æ˜¯ 10ã€‚</p><ul><li>é‡å¯ broker2 æ—¶ï¼Œå®ƒæ‰€ç»‘å®šçš„ bundle è¢« broker0&#x2F;1 æ¥ç®¡ã€‚</li><li>å‡çº§ broker1 æ—¶ï¼Œå®ƒæ‰€ç»‘å®šçš„ bundle åˆè¢« broker0&#x2F;2 æ¥ç®¡ã€‚</li><li>æœ€åå‡çº§ broker0, å®ƒæ‰€ç»‘å®šçš„ bundle ä¼šè¢«broker1&#x2F;2 æ¥ç®¡ã€‚</li></ul><p>åªè¦åœ¨è¿™ä¹‹åæ²¡æœ‰å‘ç”Ÿæµé‡æ¿€å¢åˆ°è§¦å‘è´Ÿè½½çš„é˜ˆå€¼ï¼Œé‚£ä¹ˆå½“å‰çš„è´Ÿè½½æƒ…å†µå°±ä¼šä¸€ç›´ä¿ç•™ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯ <code>broker0</code> ä¼šä¸€ç›´æ²¡æœ‰æµé‡ã€‚</p><p>ç»è¿‡æˆ‘åå¤æµ‹è¯•ï¼Œç°è±¡ä¹Ÿç¡®å®å¦‚æ­¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pulsar-perf monitor-brokers --connect-string pulsar-test-zookeeper:2181</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/02/07/nDaOlsMprJ1hCwg.png"><br>é€šè¿‡è¿™ä¸ªå·¥å…·ä¹Ÿå¯ä»¥æŸ¥çœ‹å„ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½æƒ…å†µ</p><h1 id="ä¼˜åŒ–æ–¹æ¡ˆ"><a href="#ä¼˜åŒ–æ–¹æ¡ˆ" class="headerlink" title="ä¼˜åŒ–æ–¹æ¡ˆ"></a>ä¼˜åŒ–æ–¹æ¡ˆ</h1><p>è¿™ç§åœºæ™¯æ˜¯å½“å‰ <code>ThresholdShedder</code> æ‰€æ²¡æœ‰è€ƒè™‘åˆ°çš„ï¼Œäºæ˜¯æˆ‘åœ¨æˆ‘ä»¬æ‰€ä½¿ç”¨çš„ç‰ˆæœ¬ 2.10.3 çš„åŸºç¡€ä¸Šåšäº†ç®€å•çš„ä¼˜åŒ–ï¼š<br><img src="https://s2.loli.net/2023/02/07/iRkm2FaBz4wtbG6.png"></p><ul><li>å½“åŸæœ‰é€»è¾‘èµ°å®Œä¹‹åä¹Ÿæ²¡æœ‰è·å–éœ€è¦éœ€è¦å¸è½½çš„ bundleï¼ŒåŒæ—¶ä¹Ÿå­˜åœ¨ä¸€ä¸ªè´Ÿè½½æä½çš„ broker æ—¶(<code>emptyBundle</code>)ï¼Œå†è§¦å‘ä¸€æ¬¡ bundle æŸ¥è¯¢ã€‚</li><li>æŒ‰ç…§ broker æ‰€ç»‘å®šçš„æ•°é‡æ’åºï¼Œé€‰æ‹©ä¸€ä¸ªæ•°é‡æœ€å¤šçš„ broker çš„ ç¬¬ä¸€ä¸ª bundle è¿›è¡Œå¸è½½ã€‚</li></ul><p>ä¿®æ”¹åæ‰“åŒ…å‘å¸ƒï¼Œå†èµ°ä¸€éå‡çº§æµç¨‹åæ•´ä¸ªé›†ç¾¤è´Ÿè½½å°±æ˜¯å‡è¡¡çš„äº†ã€‚<br><img src="https://s2.loli.net/2023/02/07/oCYzJBj7xavkLub.jpg"></p><p>ä½†å…¶å®è¿™ä¸ªæ–¹æ¡ˆå¹¶ä¸ä¸¥è°¨ï¼Œç¬¬äºŒæ­¥é€‰æ‹©çš„é‡ç‚¹æ˜¯ç­›é€‰å‡ºè´Ÿè½½æœ€é«˜çš„é›†ç¾¤ä¸­è´Ÿè½½æœ€é«˜çš„ bundleï¼›è¿™é‡Œåªæ˜¯ç®€å•çš„æ ¹æ®æ•°é‡æ¥åˆ¤æ–­ï¼Œå¹¶ä¸å¤Ÿå‡†ç¡®ã€‚</p><p>æ­£å½“æˆ‘å‡†å¤‡æŒç»­ä¼˜åŒ–æ—¶ï¼Œé¬¼ä½¿ç¥å·®çš„æˆ‘æƒ³çœ‹çœ‹ master ä¸Šæœ‰äººä¿®å¤è¿™ä¸ªé—®é¢˜æ²¡ï¼Œç»“æœä¸€çœ‹è¿˜çœŸæœ‰äººä¿®å¤äº†ï¼›åªæ˜¯è¿˜æ²¡æ­£å¼å‘ç‰ˆã€‚</p><p><a href="https://github.com/apache/pulsar/pull/17456">https://github.com/apache/pulsar/pull/17456</a></p><p><img src="https://s2.loli.net/2023/02/07/7TKxPv8BfblngRc.png"></p><p>æ•´ä½“æ€è·¯æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯ç­›é€‰è´Ÿè½½éœ€è¦å¸è½½ bundle æ—¶æ˜¯æ ¹æ® bundle è‡ªèº«çš„æµé‡æ¥çš„ï¼Œè¿™æ ·ä¼šæ›´åŠ ç²¾å‡†ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¸è¿‡çœ‹ç¤¾åŒºçš„è¿›åº¦ç­‰è¿™ä¸ªä¼˜åŒ–æœ€ç»ˆèƒ½ç”¨è¿˜ä¸çŸ¥é“å¾—å¤šä¹…ï¼Œäºæ˜¯æˆ‘ä»¬å°±è‡ªå·±å‚è€ƒè¿™ä¸ªæ€è·¯åœ¨ç®¡ç†å°åšäº†ç±»ä¼¼çš„åŠŸèƒ½ï¼Œå½“å‡çº§åå‡ºç°è´Ÿè½½ä¸å‡è¡¡æ—¶äººå·¥è§¦å‘ä¸€ä¸ªé€»è¾‘ï¼š</p><ul><li>ç³»ç»Ÿæ ¹æ®å„ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½æƒ…å†µè®¡ç®—å‡ºä¸€ä¸ªè´Ÿè½½æœ€é«˜çš„èŠ‚ç‚¹å’Œ bundle åœ¨é¡µé¢ä¸Šå±•ç¤ºã€‚</li><li>äººå·¥äºŒæ¬¡ç¡®è®¤æ˜¯å¦è¦å¸è½½ï¼Œç¡®è®¤æ— è¯¯åè¿›è¡Œå¸è½½ã€‚</li></ul><p>æœ¬è´¨ä¸Šåªæ˜¯å°†ä¸Šè¿°ä¼˜åŒ–çš„è‡ªåŠ¨è´Ÿè½½æµç¨‹æ”¹ä¸ºäººå·¥å¤„ç†äº†ï¼Œç»è¿‡æµ‹è¯•æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p><p>Pulsar æ•´ä¸ªé¡¹ç›®å…¶å®éå¸¸åºå¤§ï¼Œæœ‰ç€å‡ åä¸Šç™¾ä¸ªæ¨¡å—ï¼Œå“ªæ€•æ¯æ¬¡æˆ‘åªæ”¹åŠ¨ä¸€è¡Œä»£ç å‡†å¤‡å‘å¸ƒæµ‹è¯•æ—¶éƒ½å¾—ç»è¿‡æ¼«é•¿çš„ç¼–è¯‘+ Dockeré•œåƒæ‰“åŒ…+ä¸Šä¼ ç§æœè¿™äº›æµç¨‹ï¼Œé€šå¸¸éœ€è¦1~2ä¸ªå°æ—¶ï¼›ä½†æ€»çš„æ¥è¯´æ”¶è·è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œæœ€è¿‘ä¹Ÿåœ¨æä¸€äº› issue å’Œ PRï¼Œå¸Œæœ›åé¢èƒ½æ›´æ·±å…¥çš„å‚ä¸è¿›ç¤¾åŒºã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/02/04/d4NqxaoulEXnr5s.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å‰æ®µæ—¶é—´æˆ‘ä»¬åœ¨å‡çº§ Pulsar ç‰ˆæœ¬çš„æ—¶å€™å‘ç°å‡çº§åæœ€åä¸€ä¸ªèŠ‚ç‚¹å§‹ç»ˆæ²¡æœ‰æµé‡ã€‚&lt;br&gt;&lt;img src=&quot;https://s2.loli.net/2023/02/07/ZwQ7sfVhuzb4tyv.jpg&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è™½ç„¶å¯¹ä¸šåŠ¡ä½¿ç”¨æ²¡æœ‰ä»»ä½•å½±å“ï¼Œä½†è´Ÿè½½ä¸å‡ä¼šå¯¼è‡´èµ„æºçš„æµªè´¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å’ŒåŒäº‹æ²Ÿé€šåå¾—çŸ¥ä¹‹å‰çš„å‡çº§ä¹Ÿä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œæœ€ç»ˆè¿˜æ˜¯äººå·¥è°ƒç”¨ Pulsar çš„ &lt;code&gt;admin API&lt;/code&gt; å®Œæˆçš„è´Ÿè½½å‡è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé—®é¢˜æˆ‘å°è¯•åœ¨ Google å’Œ Pulsar ç¤¾åŒºéƒ½æ²¡æœ‰æ‰¾åˆ°ç±»ä¼¼çš„ï¼Œä¸çŸ¥é“æ˜¯å¤§å®¶éƒ½æ²¡ç¢°åˆ°è¿˜æ˜¯å¾ˆå°‘å‡çº§é›†ç¾¤ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä¹‹å‰æ‰€åœ¨çš„å…¬å¸å°±æ˜¯ä¸€ä¸ªç‰ˆæœ¬èµ°åˆ°é»‘ğŸ˜‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Pulsar" scheme="http://crossoverjie.top/categories/Pulsar/"/>
    
    
    <category term="æ¶ˆæ¯é˜Ÿåˆ—" scheme="http://crossoverjie.top/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
    
    <category term="è´Ÿè½½å‡è¡¡" scheme="http://crossoverjie.top/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    
  </entry>
  
  <entry>
    <title>2022 å¹´åº¦æ€»ç»“</title>
    <link href="http://crossoverjie.top/2023/01/18/annual-summary/2022/"/>
    <id>http://crossoverjie.top/2023/01/18/annual-summary/2022/</id>
    <published>2023-01-18T00:08:08.000Z</published>
    <updated>2023-01-17T13:00:54.832Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2023/01/17/C9tczrjDlwfVqvR.png"></p><p>ä¸€è½¬çœ¼ 2022 å¹´åˆè¿‡å»äº†ï¼Œä¸å¤šä¸å°‘è·ç¦»ä¸Šæ¬¡å†™å¹´ç»ˆæ€»ç»“è¿‡å»äº† 365 å¤©ï¼›ä»Šå¹´çš„è‰°éš¾æƒ…å†µæƒ³å¿…å¤§å®¶éƒ½äº²èº«ç»å†è¿‡äº†ï¼›å¦‚æœè¦ä¸¾è¡Œå–æƒ¨å¤§ä¼šçš„è¯ä»Šå¹´ä¹Ÿè®¸æˆ‘èƒ½æ’çš„ä¸Šå·ã€‚</p><span id="more"></span><h1 id="ç”Ÿæ´»"><a href="#ç”Ÿæ´»" class="headerlink" title="ç”Ÿæ´»"></a>ç”Ÿæ´»</h1><p>ä»Šå¹´å¯¹å¤§å®¶å½±å“æœ€å¤§çš„äº‹åº”è¯¥éƒ½æ˜¯ç–«æƒ…äº†ï¼Œåœ¨å¹´åº•çš„æœ€åå‡ å¤©å®¶é‡Œçš„è€äººè¿˜æ˜¯æ²¡é¡¶ä½ç–«æƒ…çš„å†²å‡»ç¦»å¼€äº†ï¼ŒåŸä»¥ä¸ºæˆå¹´åæˆ‘å·²ç»çœ‹æ·¡äº†ç”Ÿè€ç—…æ­»ï¼Œç›´åˆ°æˆ‘ç°åœ¨æ•²ä¸‹è¿™å‡ è¡Œå­—æ—¶æ‰å‘ç°è¿™ä¹ˆéš¾è¿‡ã€‚</p><p>æ‚²ä¼¤çš„äº‹æš‚ä¸”ä¸æï¼Œè¿˜æ˜¯èŠèŠä»Šå¹´ç”Ÿæ´»ä¸Šçš„å¥½äº‹å§ã€‚</p><h2 id="å¥èº«"><a href="#å¥èº«" class="headerlink" title="å¥èº«"></a>å¥èº«</h2><p>é¦–å…ˆæ˜¯å¥èº«è¿™ä¸ªæˆ‘å¿µå¨äº†å‡ å¹´çš„è¿åŠ¨ä»Šå¹´ç»ˆäºè¢«æˆ‘æä¸Šäº†è®®ç¨‹ã€‚</p><blockquote><p>æœ¬è´¨åŸå› æ˜¯è¯·äº†ç§æ•™ï¼Œæœç„¶æ˜¯èŠ±è‡ªå·±çš„é’±æ‰ä¼šå¿ƒç–¼ã€‚</p></blockquote><p><img src="https://s2.loli.net/2023/01/17/ojP8sQXracSHM3u.png"><br><img src="https://s2.loli.net/2023/01/17/LWSkPHGEMf1R2UO.png"></p><p>ä½“é‡ä¹Ÿç”±å·…å³°çš„ 75kg é™åˆ°äº†66kg å·¦å³ã€‚<br><img src="https://s2.loli.net/2023/01/17/R38tM2FOocjHGxI.png"></p><iframe src="//player.bilibili.com/player.html?aid=685069016&bvid=BV1aU4y1X7Ya&cid=749168314&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>ä¸€æ®µè§†é¢‘ä¾¿èƒ½çœ‹å‡ºå·®è·ã€‚</p><h2 id="æ¸¸æˆ"><a href="#æ¸¸æˆ" class="headerlink" title="æ¸¸æˆ"></a>æ¸¸æˆ</h2><p>ä»Šå¹´ä¸è®°å¾—è¢«å“ªä¸ªè§†é¢‘å®‰åˆ©äº†å¾®è½¯çš„ XGP æœåŠ¡ï¼Œå†²åŠ¨ä¸‹å•äº† xboxï¼Œé¡ºé“é›†é½äº†å¾¡ä¸‰å®¶çš„å…¨å®¶æ¡¶ã€‚<br><img src="https://s2.loli.net/2023/01/17/DzUT7yHYm59iZ2R.jpg"></p><p>ä¸å¾—ä¸è¯´ XGP æœåŠ¡æ˜¯çœŸçš„é¦™ï¼Œæ¸¸æˆä¹Ÿå¾ˆå¤šï¼Œæˆ‘ç©çš„æœ€å¤šçš„å°±æ˜¯å…‰ç¯ã€åœ°å¹³çº¿5ã€å¥¥æ—¥è¿™å‡ æ¬¾æ¸¸æˆï¼›åŸä»¥ä¸º xbox åç»­ä¼šæˆä¸ºæˆ‘çš„ä¸»åŠ›æœºï¼Œç›´åˆ°å‡ ä¸ªæœˆåæˆ‘åœ¨ tb å¥¸å•†é‚£å„¿è´­ä¹°çš„ XGP æœåŠ¡è¢«å¾®è½¯é€€æ¬¾åæˆ‘å°±æ²¡æ€ä¹ˆç¢°äº†ã€‚</p><p>åé¢è€å¤´ç¯ä¸Šçº¿ï¼Œä¹Ÿæ˜¯æˆ‘å”¯ä¸€ä¸€æ¬¾èŠ±é’±è´­ä¹°çš„ xbox æ¸¸æˆï¼Œåœ¨è¢«è€å¤´ç¯æ‰æ‹§äº†å‡ å‘¨åæ‰‹æ®‹å…šä¹Ÿè¢«åŠé€€ï¼Œä¸€ç›´åˆ°ç°åœ¨ä¼°è®¡ä¸‰ä¸ªæœˆæ²¡å¼€è¿‡æœºäº†ã€‚</p><p>ä¸è¿‡æœ€è¿‘å€’è¿˜å–œæ¬¢ä¸Šç© Steam ä¸Šçš„ä¸€äº›ç‹¬ç«‹å°æ¸¸æˆï¼Œç‰¹åˆ«æ˜¯è‚‰é¸½ç±»å‹çš„ï¼Œæ¯”å¦‚è¿™ä¸ªâ€œå¸è¡€é¬¼å¹¸å­˜è€…â€ç©ç€çœŸçš„éå¸¸ä¸Šå¤´ã€‚</p><p><img src="https://s2.loli.net/2023/01/17/6Y7lmhtQRMy2TiU.png"></p><p>å½“ç„¶ä»Šå¹´æœ€æœŸå¾…ä¾ç„¶æ˜¯é‚£ä¸ªå¸¦æˆ‘å…¥ä¸»æœºå‘çš„â€œå¡å°”è¾¾ä¼ è¯´â€ï¼Œæ¨ä¸å¾—ç°åœ¨é©¬ä¸Šå¿«è¿›åˆ°5æœˆ12å·å‘å”®æ—¥ã€‚</p><h2 id="ä¸–ç•Œæ¯"><a href="#ä¸–ç•Œæ¯" class="headerlink" title="ä¸–ç•Œæ¯"></a>ä¸–ç•Œæ¯</h2><p>ä»Šå¹´è¿˜æœ‰ä»¶å¤§äº‹é‚£å°±æ˜¯ä¸–ç•Œæ¯çš„å¬å¼€ï¼ŒçœŸæ²¡æƒ³åˆ°æˆ‘è¿˜ä¼šå¯¹è¶³çƒè¿™ä¹ˆæ„Ÿå…´è¶£ï¼›å› ä¸ºå½“æ—¶æ˜¯å°æ§åœ¨å®¶è¿œç¨‹å·¥ä½œï¼Œæ‰€ä»¥æˆ‘å‡ ä¹æŠŠå‡Œæ™¨ä¸‰ç‚¹åœºçš„éƒ½çœ‹å®Œäº†ã€‚</p><p>é‚£æ®µæ—¶é—´å› ä¸ºç¦»èŒå¿ƒæƒ…è¿˜æ¯”è¾ƒ EMOï¼Œæ„Ÿè°¢ä¸–ç•Œæ¯å¸¦ç»™äº†æˆ‘ä¸€ä¸ªæœˆçš„å¿«ä¹æ—¶é—´ã€‚</p><p>å½“ç„¶ä¸å‡ºæ„å¤–çš„åœ¨ä¸–ç•Œæ¯æœŸé—´å‘ç”Ÿäº†æ„å¤–ã€‚</p><p><img src="https://s2.loli.net/2023/01/17/jUMOHidkxapyRbW.jpg"></p><p>å¤§åŠå¤œç¡å¾—å¥½å¥½çš„ï¼Œçœ¼ç›è¢«æˆ‘è€å©†çš„æ‰‹æŒ‡ç”²åˆ¨åˆ°äº†ï¼Œè¿å¤œèµ¶å¾€åŒ»é™¢ï¼Œæœ€åå°±æˆäº†â€œå¸¦åœŸâ€çš„ cos ä½é…ç‰ˆã€‚</p><h1 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h1><p>ç»å¸¸éƒ½æœ‰å¤§ä½¬è¯´ä¸‰å¹´æ˜¯åœ¨ä¸€å®¶å…¬å¸çš„æ•æ„Ÿæ—¶é—´ï¼Œå¦‚æœæ„Ÿè§‰ä¸åˆ°æå‡é‚£å°±éœ€è¦é€‚å½“çš„è·³å‡ºèˆ’é€‚åœˆï¼Œå…¶å®æˆ‘å‹æ ¹æ²¡è¿™ä¸ªæ‰“ç®—ï¼Œä½†ç”Ÿæ´»æ€»åœ¨ä½ æ²¡å‡†å¤‡å¥½çš„æ—¶å€™æ¨ä½ ä¸€æŠŠã€‚</p><p><img src="https://s2.loli.net/2023/01/17/3MGYFZ1fCvLsXBz.png"><br><img src="https://s2.loli.net/2023/01/17/qcZoD2Mr7YX1Ble.jpg"></p><p>ç”±äºä¸å¯æŠ—åŠ›å› ç´ ï¼Œæˆ‘è¿˜æ˜¯ç¦»å¼€äº†è¿™å®¶æˆ‘æœ‰ç”Ÿä»¥æ¥å‘†çš„æœ€å¼€å¿ƒçš„ä¸€å®¶å…¬å¸ï¼›è™½ç„¶æœ‰è®¸å¤šä¸èˆï¼Œä½†æ±Ÿæ¹–æ€»ä¼šç›¸è§ã€‚</p><p><img src="https://s2.loli.net/2023/01/17/ztTP1F9ChJ23AR8.png"><br><strong>è¿™ä¸æˆ‘å¾®ä¿¡é‡Œæœ€æ´»è·ƒçš„ä¾ç„¶è¿˜æ˜¯é‚£ä¸ªç¾¤ã€‚</strong></p><hr><p>åé¢æˆ‘èŠ±äº†ä¸€ä¸ªæœˆçš„æ—¶é—´æŠŠé‡åº†å¤§å¤§å°å°çš„å…¬å¸å‡ ä¹éƒ½çœ‹äº†ä¸€éï¼Œç”šè‡³è¿˜å·®ç‚¹å»æˆéƒ½å·¥ä½œäº†ï¼›æœ€åé˜´å·®é˜³é”™çš„æ¥åˆ°äº†ç°åœ¨çš„å…¬å¸åšæˆ‘ä¹‹å‰éå¸¸å‘å¾€çš„åŸºç¡€æ¶æ„+ä¸­é—´ä»¶ç ”å‘ï¼Œç›®å‰ä¹Ÿæ¯”è¾ƒæ»¡æ„ã€‚</p><blockquote><p>æ‰¾å·¥ä½œé‚£æ®µæ—¶é—´ä¹Ÿç¢°åˆ°è®¸å¤šæœ‰æ„æ€çš„å’Œç‹—è¡€çš„äº‹æƒ…ï¼Œå¹´åå•ç‹¬åˆ†äº«ã€‚</p></blockquote><h1 id="æŠ€èƒ½"><a href="#æŠ€èƒ½" class="headerlink" title="æŠ€èƒ½"></a>æŠ€èƒ½</h1><h2 id="GScript"><a href="#GScript" class="headerlink" title="GScript"></a><a href="https://github.com/crossoverJie/gscript">GScript</a></h2><p><img src="https://s2.loli.net/2023/01/17/9O4pzlC6T2ISKkA.png"></p><p>ä»Šå¹´ä¸ªäººæœ€æ»¡æ„çš„å°±æ˜¯æ¶è¡¥äº†ç¼–è¯‘åŸç†çš„çŸ¥è¯†ï¼Œé¡ºå¸¦è¿˜åšäº†ä¸€ä¸ª<a href="https://gscript.crossoverjie.top/">è„šæœ¬è¯­è¨€</a>ï¼›ç°åœ¨å·²ç»å¯ä»¥æ‹¿æ¥ç¼–å†™ç½‘ç«™äº†ï¼›ä¹Ÿç®—æ˜¯ä¸€ä¸ªå°ç›®æ ‡è¾¾æˆå§ã€‚</p><p>å›æƒ³èµ·å¼€å‘ gscript çš„é‚£æ®µæ—¶é—´ï¼ŒçœŸçš„æ˜¯æ²¡æ—¥æ²¡å¤œçš„å¹²ï¼Œæ¯å®Œæˆä¸€ä¸ªåŠŸèƒ½å°±å¼€å¿ƒçš„é£èµ·ã€‚</p><h2 id="äº‘åŸç”Ÿ"><a href="#äº‘åŸç”Ÿ" class="headerlink" title="äº‘åŸç”Ÿ"></a>äº‘åŸç”Ÿ</h2><p><img src="https://s2.loli.net/2023/01/17/kHa4Demu15OiytE.png"><br>é™¤æ­¤ä¹‹å¤–åœ¨æ¥åˆ°ç°åœ¨è¿™å®¶å…¬å¸åæ¥è§¦äº†å¤§é‡ k8s ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œä¹Ÿç®—æ˜¯æŠŠä¹‹å‰å­¦åˆ°çš„ç†è®ºå®è·µä¸Šäº†ï¼›è¿™ä¸æ˜¨æ™šä¸Šæ‰åœ¨ç”Ÿäº§ç¯å¢ƒå‡çº§äº† Pulsarï¼Œè¿™ä¸ªæŠ€èƒ½æ ‘ç»ˆäºç‚¹äº®äº†ä¸€äº›å¶å­èŠ‚ç‚¹ã€‚</p><h2 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢"></a>åšå®¢</h2><p><img src="https://s2.loli.net/2023/01/17/q3CLIhWoM8yEtGY.png"><br><img src="https://s2.loli.net/2023/01/17/hSxHZDsEArRFow1.png"></p><p>ä»Šå¹´çš„æŠ€æœ¯åšå®¢äº§å‡ºå±…ç„¶ 23 ç¯‡ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯å’Œç¼–è¯‘åŸç†ç›¸å…³çš„ï¼Œä¹Ÿæ˜¯æˆ‘ä¸€æ­¥æ­¥å­¦ä¹ ç¼–è¯‘åŸç†åˆ°å®ç°è„šæœ¬è¯­è¨€çš„è¿‡ç¨‹ã€‚</p><hr><p><img src="https://s2.loli.net/2023/01/17/mEPTMByJIAKaiwX.png"><br>åŒæ—¶ä»Šå¹´ä¹Ÿå…»æˆäº†æ¯æ—¥çœ‹ä¸€ç¯‡è‹±æ–‡åšå®¢çš„ä¹ æƒ¯ï¼ŒåšæŒäº†å‡ ä¸ªæœˆæ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ï¼›æ¯”å¦‚ä»¥å‰æˆ‘éå¸¸æ’æ–¥çœ‹ä¸€äº›è‹±æ–‡èµ„æ–™ï¼Œè¦ä¹ˆé ä¸€é”®ç¿»è¯‘ï¼Œè¦ä¹ˆå°±ç›´æ¥åªçœ‹ä¸­æ–‡å†…å®¹ã€‚</p><p>ç°åœ¨å‡ ä¹æ²¡æœ‰è¿™ç§æ’æ–¥çš„æ„Ÿè§‰äº†ï¼Œå¤§éƒ¨åˆ†è‹±æ–‡å†…å®¹ä¹Ÿä¼šè€å¿ƒçš„é˜…è¯»å®Œï¼Œè¿™ç‚¹åœ¨æˆ‘è®¢é˜…äº† Pulsar çš„å¼€å‘ç»„é‚®ä»¶åè¶Šå‘æ˜æ˜¾ï¼Œæ˜æ˜¾çš„èƒ½å¤ŸçŸ¥é“ä»–ä»¬åœ¨è®²äº›ä»€ä¹ˆï¼Œè¿™ç‚¹ä¸æˆ‘å¤šå¹´å‰è®¢é˜… Dubbo ç¤¾åŒºé‚®ä»¶çš„æ„Ÿè§‰å®Œå…¨ä¸åŒã€‚</p><h1 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h1><p>ä»¥ä¸Šå°±æ˜¯æ•´å¹´çš„æµæ°´è´¦å¼çš„å›é¡¾ï¼Œåˆåˆ°äº†ç»å…¸çš„ä¿ç•™ç«‹ flag ç¯èŠ‚ã€‚</p><ul><li>é¦–å…ˆæ˜¯å¥èº«ä¿æŒï¼Œéƒ½è¯´å¥èº«æ˜¯æŒ‰å¹´ç®—çš„ï¼Œå¸Œæœ›åˆ°ä»Šå¹´å››æœˆä»½ä¸ºæœŸä¸€å¹´çš„æ—¶å€™èƒ½çœ‹åˆ°å¥èº«çš„ç—•è¿¹ã€‚</li><li>ä»Šå¹´å¥½æ­¹çš„å‡ºå»ç©ä¸€ç©ï¼Œæ¯”å¦‚æ¸¯æ¾³åœ°åŒºæˆ–æ˜¯æ—¥æœ¬ï¼Œå¿µå¨å‡ å¹´äº†ã€‚</li><li>å·¥ä½œæŠ€æœ¯ä¸Šèƒ½å¤Ÿå†æäº¤å‡ ä¸ª Pulsar çš„ PRï¼Œæœ€å¥½æ˜¯èƒ½èå…¥ç¤¾åŒºï¼›æ··ä¸ªè„¸ç†Ÿã€‚</li><li>äº‘åŸç”Ÿå’Œç¼–è¯‘åŸç†ç›¸å…³çš„ç»§ç»­å­¦èµ·æ¥ï¼Œä¸‹åŠå¹´æŠŠ GScript å®ç°ä¸ºç¼–å†™å‹è¯­è¨€ã€‚</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://s2.loli.net/2023/01/17/C9tczrjDlwfVqvR.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä¸€è½¬çœ¼ 2022 å¹´åˆè¿‡å»äº†ï¼Œä¸å¤šä¸å°‘è·ç¦»ä¸Šæ¬¡å†™å¹´ç»ˆæ€»ç»“è¿‡å»äº† 365 å¤©ï¼›ä»Šå¹´çš„è‰°éš¾æƒ…å†µæƒ³å¿…å¤§å®¶éƒ½äº²èº«ç»å†è¿‡äº†ï¼›å¦‚æœè¦ä¸¾è¡Œå–æƒ¨å¤§ä¼šçš„è¯ä»Šå¹´ä¹Ÿè®¸æˆ‘èƒ½æ’çš„ä¸Šå·ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="annual-summary" scheme="http://crossoverjie.top/categories/annual-summary/"/>
    
    
  </entry>
  
</feed>
